Q:

Honor, cunning and realism of underhandedness in the Iliad

The heroes of the Iliad seem to be completely obsessed with honourable fighting, with Hector refusing to take sanctuary behind the walls due to that not being honourable (The Great Courses - Famous Greeks, Lecture 3: "Hector", with Professor J. Rufus Fears). However, ultimately it is the guile and cunning of Odysseus that wins the war, as well as an arrow that kills Achilles.
How would the Greeks of the time contrast the pursuit of honourable actions with the incredible effectiveness of guile? I understand that their gods had willed Troy to fall, but then why not simply allow the city to be captured by raw force?

A:

Greek authors in the centuries after Homer seem to have a strong preference for honorable fighting over guile.
This subject is touched on in a few works that deal with the conflict between Ajax and Odysseus over who would receive Achilles' armor. Ajax was the warrior who did the actual fighting, and yet Odysseus manages to convince the judges to give him the armor. Odysseus' dishonesty in general, and his having won the armor, are often described as distasteful. This scene is the premise of Sophocles' tragedy Ajax. Sophocles' chorus have more sympathy for Ajax than for Odysseus (134-171) even though Athena, the goddess of wisdom, prefers Odysseus and helps him win the armor.
Here is Pindar (Nemean 8), who prays never to be like deceitful Odysseus:

A man who was not gifted in speech, but brave in his heart, is held down by oblivion under deadly strife; and the greatest prize of honor has been offered to the shifty lie. For in a secret vote the Danaans favored Odysseus; and Aias, robbed of the golden armor, wrestled with death. Truly, they did not tear equal wounds in the warm flesh of the enemy when they were driven back under the man-protecting spear, at one time around the newly-slain corpse of Achilles, and on destructive days spent on other toils. It seems that hateful Misrepresentation existed even long ago: a fellow traveler of flattering tales, deceitful-minded, a malignant disgrace. She does violence to the illustrious, and upholds the rotten glory of the obscure. May I never have such a nature, father Zeus; may I stick to the simple paths of life, so that when I die I will not fasten a bad name to my children. 

One of the few fragments of Antisthenes that has survived are speeches for Ajax and Odysseus, in which this exact contrast is dealt with. This thesis (to which I owe the references to Pindar and Plato) by William John Kennedy translates the fragments. The thesis argues that Antisthenes' portrayal of Ajax is sympathetic. But in any case, the fragments portray each side's argument for why he deserves the armor. Ajax's claim is justice; he carried the body and he was the brave warrior. He accuses Odysseus of being a coward. Odysseus' claim is superior wisdom, the person who won the war against the Trojans with his plans.
In Plato's Hippias Minor there is an interesting subversion of the same theme with regard to Achilles and Odysseus. Hippias claims that Achilles is simple and true, while Odysseus is cunning and false. Socrates then proves to him that really Achilles is the cunning one and is able to fool even Odysseus. However, at the end of the dialogue (376b) it is Odysseus' cunning that Socrates concludes is good, despite himself:

Socrates
  Then he who voluntarily errs and does disgraceful and unjust acts, Hippias, if there be such a man, would be no other than the good man.
Hippias
  I cannot agree with you, Socrates, in that.
Socrates
  Nor I with myself, Hippias.

Since this is a Socratic dialogue, this conclusion is of course exactly the opposite of what a normal person would think. But it is noteworthy that they use the character of Odysseus, who lies on purpose (vs. Achilles who lies by accident), in order to make this point. It seems that both Socrates and Hippias find purposeful deceit, the kind demonstrated by Odysseus, to be distasteful.

