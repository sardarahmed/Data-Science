Q:

Género dos nomes próprios de empresas

Em português é preciso usar o artigo antes os nomes próprios (o João, a Susana etc). No caso de empresas, é frequentemente feminino (a Microsoft, a Apple), mas eu também vi o masculino usado (o Google, o Facebook).
A minha pergunta: há regras / heurísticas por isso ou é completamente aleatório é preciso aprender as formas diferentes?
Ou seria que "o Facebook" venha de "o site / sítio Facebook"?

A:

Uma rápida observação nos permite concluir que usa-se muito mais o artigo definido feminino quando nos referimos a empresas e marcas.

a Microsoft, a Apple, a Pfizer, a Medtronic, a Sony, a C.I.A., a Universal Films, a Longmans, a Lindt, a Nestlé, a Volkswagen, a Ford, a Honda, a Citroën, a Nike, a Adidas, a Motorola, a Samsung, a Longman, a Oxford University Press, a La Roche-Posay, a Nivea, a Shell, a Toyota, a Hyundai, a Chevron, a General Motors, a General Electric, a Hewlett-Packard, a IBM, a Mitsubishi, a Boeing, a Peugeot, a American Airlines, a Air Portugal, a Lufthansa, a/o Google(sim, uma parcela significativa da população diz "a Google" aqui no Brasil)

Poucos exemplos pude encontrar com o uso do artigo definido masculino.

o (site) Google, Facebook, Hotmail, IMDB, o (super-mercado) Walmart, Carrefour, o (banco) Citybank, Bank of America, Santander.

Minha conclusão é que, a princípio, usa-se o artigo no feminino provavelmente como se estivessemos nos referindo "à empresa tal", "à marca tal", etc. As exceções seriam os "bancos", os "sites" e os "super-mercados".
Contudo, em alguns casos podemos usar tanto o artigo masculino quanto o feminino, mas com uma diferença semântica.

"a Boeing fabricou 280 aeronaves em 2014" (empresa) x  "o Boeing 747" (o avião)
"as ações da Honda..." (empresa) x "o Honda Civic" (o carro)
"a Lindt vai lançar um novo tipo..." (empresa) x "o Lindt que comprei" (o chocolate)
"a Volkswagen fez um recall de..." (empresa) x "o Volkswagen que está estacionado/aparcado aqui em frente" (o carro)

A:

A regra geral é a de que se usa o feminino porque se subentende a palavra "empresa"/"companhia"/"sociedade"/"associação": a (empresa) Microsoft.
Mas há de facto exceções. Para algumas classes de empresas, subentendem-se outros termos como "banco":

(1) O [banco] Barclays escolheu o antigo banqueiro do [banco] JPMorgan, Jes Staley, para CEO.

No caso do J.P. Morgan, também se pode contudo usar o feminino. Porquê não sei.
Outro tipo de empresas com que subentende outra palavra são "fundo de investimento" e "supermercado":

(2) O [fundo] Mill Residential Reit, o primeiro fundo de investimento britânico que comprava casas para depois as colocar no mercado de arrendamento (conhecido como “buy-to-let”), encerrou menos de um ano depois de entrar na bolsa.
  (3) O [supermercado] Lidl Portugal é mais uma vez a cadeia de distribuição que mais Maçã de Alcobaça embalada comprou e vendeu no decorrer da campanha de comercialização 2014/2015.

No entanto, se o fundo ou o supermercado for distinto da empresa que o detém, usar-se-á na mesma o feminino para a empresa.
O caso dos sites é mais ambíguo. Pode dizer-se "o/a Google" ou "o/a Yahoo" para referir a empresa (mas apenas "o" para referir o site). O masculino usar-se-á tanto mais quanto, na mente do falante, o site se confunde com a empresa.
A outra exceção ocorre quando o nome da empresa é um nome comum, mesmo que seja uma sigla ou até uma palavra inglesa (mas nesse caso menos marcado):

(4) Os CTT [Correios, Telégrafos e Telefones] foram privatizados em 2013.  

Penso que é esta a principal razão por que "a Facebook" é muito incomum. "Book" significa "livro" em português, que é um nome masculino.
Este fenómeno ocorre com outros tipos de nomes:

(5) Compra isso antes na Amazon.  

Repara que (5) se refere ao site, não à empresa e que mesmo assim se usa "a" ("Amazónia" é feminino).

