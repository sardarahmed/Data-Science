Q:

Questions about "Lhe" in sentences from "O cortiço"

I sometimes have trouble understanding what lhe stands for.

Entretanto, a tal carta de liberdade era obra do próprio João Romão, e nem mesmo o selo, que 
  ele entendeu de pespegar-lhe em cima, para dar à burla maior formalidade, representava despesa porque o esperto 
  aproveitara uma estampilha já servida.

I'm not really sure what lhe replaces in that sentence, my guess is it's "da carta"... am i right?
É o selo que ele entendeu de pespegar-lhe em cima. <=> É o selo que ele entendeu de pespegar em cima da carta.

O senhor de Bertoleza não teve sequer conhecimento do fato; o que lhe constou, 
  sim, foi que a sua escrava lhe havia fugido para a Bahia depois da morte do amigo. 

Here I think my problem comes from the verb "constar", how is it constructed? What/who is the subject of constar and what/who is "lhe" in that sentence?
Does it work like "be admited" in english? Like "What (o que) was admited by him (lhe)..." with the subject being "o que"
Thanks for your time.

A:

Yes, "lhe" in the sentence you quote refers to "carta", and we easily understand that by context (stamps will be attached to letters). In the second sentence, "constar [a]" (meaning "to be known [to]", "to be understood [by]") is in this case indirect transitive, meaning that is object has to be preceded by a preposition, and that is why "lhe" is used. 
Here's how the same excerpt could be written, without the pronoun "lhe". 

O senhor de Bertoleza não teve sequer conhecimento do fato; o que constou a ele, sim, foi que a sua escrava havia fugido dele para a Bahia depois da morte do amigo.

Which could be translated this way:

Senhor de Bertoleza didn't even have knowledge of the fact; what was understood by him, yes, was that his slave had fled from him to Bahia after the death of his friend.  

