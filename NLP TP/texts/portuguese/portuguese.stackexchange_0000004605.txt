Q:

Quais são as regras para o uso da vírgula?

Quais são as regras para o uso da vírgula em uma frase?
Já ouvi várias explicações sobre como usá-la, mas ainda não consegui definir um padrão. Já ouvi também, que existem mais de 10 "regrinhas" para usá-la. Quais são elas?

A:

Cada guia de estilo diverge quanto ao uso da vírgula, discordando do senso comum em menor ou maior grau. Um dos tópicos de divergência mais famosos é o uso da vírgula antes do último item de uma enumeração. Enquanto alguns guias de estilo requerem a vírgula antes de uma conjunção coordenada (e.g. "França, Suíça, e Itália"), outros não requerem-no (e.g., "França, Suíça e Itália"). Eis alguns guias de estilo:

Lexikon;
Manual de Estilo da Presidência do Brasil, que na pg.
61 permite que o sujeito seja separado do predicado em casos
específicos;
Só Português.

A vírgula basicamente separa coisas. Tal mecanismo de separação funciona mais ou menos assim:

Uma única vírgula separa dois elementos:

Mal fui, e já voltei.

Um par de vírgulas possui função ambígua. Pode ou separar 3 elementos uns dos outros ou separar um elemento interno do restante que comporta-se como uma única coisa. Por exemplo:

"Vim, vi, venci." (Nesse caso, a vírgula está separando 3 elementos).
"Elisabeth, rainha da Inglaterra, está viajando" (Nesse caso, a vírgula está separando o elemento interno do restante).

A vírgula nesses exemplos poderiam ser substituídas por ponto-e-vírgula, no primeiro, e pela eliminação do elemento interno, no segundo, desambiguando e mantendo a sintaxe:

"Vim; vi; venci."
"Elisabeth está viajando."

Frases coordenadas
A vírgula é usada para separar orações coordenadas onde nenhuma é precedida por conjunção; para separar orações coordenadas onde todas são precedidas por conjunção; para separar frases nominais (vocativos, interjeições, etc.) entre si; e para separar frases nominais e uma oração:

"Vim, vi, venci." — Separação de três orações coordenadas, nenhuma precedida por conjunção.
"Você tinha razão, o problema estava no motor do carro." — Separação de duas orações coordenadas, nenhuma precedida por conjunção.
"Ou você ama, ou você odeia, ou você ignora." — Separação de três orações coordenadas, todas precedidas por conjunção.
"Essa linda mulher dominou meu coração, e que mulher!" — Separação de uma oração e uma frase nominal exclamativa.
"Boa sorte, meu amigo." — Separação de uma frase nominal desirativa (boa sorte) e uma frase nominal vocativa (meu amigo)
"Então, você vem me ver hoje?" — Separação de uma frase nominal interjectiva (então) e uma oração.
"Filho, já pensaste no que quer ser?" — Separação de uma frase nominal vocativa (filho) e uma oração.
"Gostou da blusa?Sim, eu adorei!" — No segundo período, há a separação de uma frase nominal interjectiva (sim) e uma oração. "Sim" e "não" são advérbios, mas quando usados como único elemento de uma frase para resposta, comportam-se como interjeição.

No caso de orações coordenadas em que apenas a última oração é precedida por conjunção, as regras de uso da vírgula variam. No geral, todas as orações exceto a última são obrigatoriamente separadas por vírgula, a última pode ser separada dependendo do guia de estilo em uso:

"Aproveite, divirta-se e comemore" vs. "aproveite, divirta-se, e comemore".
"Todo humano nasce, cresce e morre" — Muitos guias de estilo optam por não separar a última oração por vírgula, quando todas as orações coordenadas compartilham o mesmo sujeito.

Em alguns casos, uma das frases pode ocorrer dentro da outra; um fenómeno chamado "parêntese" (a figura de linguagem, não o sinal gráfico). Nesse caso, a vírgula é usada para separar a frase interna daquela onde está contida:

"Essa linda mulher, e que mulher, dominou meu coração!".
"O problema, você tinha razão, estava no motor do carro."
"Já pensaste, filho, no que quer ser?".

Termos coordenados
A vírgula é usada para separar termos sintaticamente equivalentes (i.e., que possuem a mesma função sintática) que estejam coordenados (ou repetidos).

"Maria, Paulo, e Artur foram passear." — Separação de sujeitos coordenados.
"Viajarei Terça, Quarta, ou Sexta." — Separação de advérbios coordenados.
"Sua pele ficou vermelha, vermelha de tanto tomar sol". — Separação das repetições de um predicativo do sujeito.

Diferentes guias de estilo possuem diferentes regras quanto à separação de termos coordenados. Enquanto uns usam a vírgula para separar todos os elementos, outros não usam a vírgula antes da conjunção. A frase "Maria, Paulo, e Artur foram passear" pode ser reescrita como "Maria, Paulo e Artur foram passear" (sem a vírgula antes do "e").
Note que, ao separar verbos por vírgula você está criando duas orações, e portanto cai no caso especificado pela seção anterior (Frases coordenadas):

"Eu plantei, colhi e preparei cada flor." — Separação de 3 verbos e, consequentemente, de 3 orações, que compartilham o mesmo sujeito (e possivelmente o mesmo complemento verbal, mas isso depende da interpretação).

Termos essenciais da oração
Como norma geral, não deve-se separar termos essenciais uns dos outros. Ou seja, não deve-se separar o sujeito, verbo (ou locução verbal) e predicativo por vírgula. Porém, note que pode sim haver vírgulas entre o sujeito e o predicado, quando há entre eles algo que é separado dos demais, tal como no exemplo anterior:

"Elisabeth, rainha da Inglaterra, está viajando." — Correto.
"Elisabeth, está viajando." — Errado.
"Elisabeth está viajando." — (Igual à anterior, mas sem vírgula) Correto.
"Pedro é, como todos dizem, iteligentíssio." — Correto.
"Pedro é, inteligentíssimo." — Errado.
"Pedro é inteligentíssimo." — (Igual à anterior, mas sem vírgula) Correto.

Complementos verbais
Os complementos do verbo (objeto direto, objeto indireto, agente da passiva) são separados dos demais quando apresentados em posições diferentes da ordem direta. Por exemplo:

"Meu livro, você trouxe?" vs. "Você trouxe meu livro?".
"Por Aristóteles, Alexandre Magno foi educado" vs. "Alexandre Magno foi educado por Aristóteles".

Adjuntos adverbiais
Adjuntos adverbiais são geralmente livres, e o uso da vírgula para separá-los do restante da frase é arbitrário. Certas locuções adverbiais explicativas ("isto é", "por exemplo", "ou seja", etc.) e suas abreviações ("i.e.", "p.ex.", etc.) são separados por vírgula, tal como consagradas pelo uso. Por exemplo:

"Essa escola, com toda certeza, está falida" vs. "Essa escola com toda certeza está falida". — Ambos corretos.
"Quando crescer, quero ser forte" vs. "Quando crescer quero ser forte". — Ambos corretos.
"Fique, porém, conosco" vs. "Fique porém conosco". — Ambos corretos, embora o primeiro seja mais aceito.
"Não existe, em todo continente, espécime tão bem preservado" vs. "Não existe em todo continente espécime tão bem preservado". — Ambos corretos, embora o primeiro seja mais aceito.

Aposto
O aposto restritivo não é separado do restante da frase por vírgula, mas o aposto explicativo é. Note que o uso da vírgula definirá se um aposto é restritivo ou explicativo. Por exemplo:

"O poeta português Fernando Pessoa tinha vários pseudónimos". — "Fernando Pessoa" é um aposto restritivo, portanto não é separado por vírgula.
"Fernando Pessoa, poeta português, tinha vários pseudónimos" — "Poeta português" é um aposto explicativo, portanto é separado por vírgula.
"A árvore florida, que Pedro cultivou, faleceu anteontem". — "Que Pedro cultivou" é uma oração apositiva explicativa, portanto é separada por vírgula.
"A árvore florida que Pedro cultivou faleceu anteontem". — "Que Pedro cultivou" é uma oração apositiva restritiva, portanto não é separada por vírgula.

Notações
O uso de vírgula em notações de títulos, números, cabeçalhos, etc. é a que mais está sujeita a regulação divergente por guias de estilo:

10,055 (Dez inteiros e cinquenta e cinco milésimos) — Vírgula como separador decimal.
10,055 (Dez mil e cinquenta e cinco) — Vírgula como separador de milhares.
Roma, 17 de Julho de 2017. — Datação.

