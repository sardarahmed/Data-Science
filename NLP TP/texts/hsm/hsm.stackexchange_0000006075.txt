Q:

History of molecular constituency and structure

During times when there was no spectroscopy of any kind, people did make guesses on the molecular constituency and structure.
For example, John Dalton's original atomic hypothesis was that all elements were mono-atomic and that the atoms in compounds have the simplest possible ratios. However, this was proved to be wrong and later it was recognized that oxygen and various other gases were actually diatomic.

How? How were the constitution of various compounds, in terms of both number and structure discerned? [for example, in this case, the atomicity of gases].

Note: This question here also deals with a similar problem but for the specific case of water. But, my question is about how this is done generally, what are the techniques and experiments and hypotheses.
Edit: This question and answer therein and the current answer to this question are specific to gases and water. Is there anything more generally applicable to organic and inorganic compounds (other than only gases)?

A:

Avogadro's Law says that the number of molecules in a fixed volume of gas under fixed temperature and pressure does not depend on the gas. So the number of water molecules in one cubic meter of vapor under temperature T and pressure P  is the same as the number of molecules of pure oxygen in the same volume and under the same conditions. Now add hydrogen to this oxygen and burn them together,
then condense water and release the excess hydrogen. Then evaporate water,
and see how much volume the resulting water vapor will occupy under the same 
temperature and pressure as before. It will be two cubic meters (experimental fact). Conclusion: one molecule of oxygen produces two molecules of water.
Repeating this experiment with hydrogen as a starting substance, we conclude that one molecule of hydrogen produces one molecule of water.
Moreover, if you try to combine hydrogen with oxigen so that nothing but water remains, you discover that they combine in proportion $2:1$ (volumes under the same pressure and temperature).
Therefore water composition must be $H_2O$ and
one molecule of oxygen must contain two atoms of oxygen.
This is the general principle. Technical detail of the experiment are not addressed.

