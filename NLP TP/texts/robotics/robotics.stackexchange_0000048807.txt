Q:

rosmake fails on OS X

Running rosmake -a as per http://www.ros.org/wiki/groovy/Installation/OSX/Homebrew/Source fails on OS X 10.8.2. Previous steps succeeded find.
Most of the errors seemed to be concerned with this Python module urandom... These have been fixed now. The remaining errors concern x86_64/i386 symbols not being found?
Here's the full log:
http://pastie.org/pastes/6368348/text
Any ideas, folks?

Originally posted by Noldorin on ROS Answers with karma: 161 on 2013-02-27
Post score: 2

Original comments
Comment by Noldorin on 2013-03-12:
Guys, does anyone know how to solve this?
Comment by William on 2013-03-12:
@Noldorin There are three separate errors in that log. I'll try to answer them each, but in the future you should try to narrow the question down.
Comment by Noldorin on 2013-03-12:
@William: Okay, fair enough; I did just think they were somewhat related, but maybe not... Thanks, look forward to your response.

A:

The first error is with nodelet_tutorial_math:
{-------------------------------------------------------------------------------
  -- Configuring done
  -- Generating done
  -- Build files have been written to: /Users/alex/ros_ws/common_tutorials/nodelet_tutorial_math/build
  cd build && make -j -l8
  Scanning dependencies of target rospack_genmsg_libexe
  [  0%] Built target rospack_genmsg_libexe
  Scanning dependencies of target rosbuild_precompile
  [  0%] Built target rosbuild_precompile
  Scanning dependencies of target nodelet_math
  [100%] Building CXX object CMakeFiles/nodelet_math.dir/src/plus.cpp.o
  Linking CXX shared library ../lib/libnodelet_math.dylib
  clang: warning: argument unused during compilation: '-pthread'
  Undefined symbols for architecture x86_64:
    "class_loader::class_loader_private::AbstractMetaObjectBase::addOwningClassLoader(class_loader::ClassLoader*)", referenced from:
        void class_loader::class_loader_private::registerPlugin<nodelet_tutorial_math::Plus, nodelet::Nodelet>(std::string const&, std::string const&) in plus.cpp.o
    "class_loader::class_loader_private::AbstractMetaObjectBase::setAssociatedLibraryPath(std::string)", referenced from:
        void class_loader::class_loader_private::registerPlugin<nodelet_tutorial_math::Plus, nodelet::Nodelet>(std::string const&, std::string const&) in plus.cpp.o
    "class_loader::class_loader_private::AbstractMetaObjectBase::AbstractMetaObjectBase(std::string const&, std::string const&)", referenced from:
        class_loader::class_loader_private::AbstractMetaObject<nodelet::Nodelet>::AbstractMetaObject(std::string const&, std::string const&) in plus.cpp.o
    "class_loader::class_loader_private::AbstractMetaObjectBase::~AbstractMetaObjectBase()", referenced from:
        class_loader::class_loader_private::AbstractMetaObject<nodelet::Nodelet>::AbstractMetaObject(std::string const&, std::string const&) in plus.cpp.o
    "class_loader::class_loader_private::getFactoryMapForBaseClass(std::string const&)", referenced from:
        std::map<std::string, class_loader::class_loader_private::AbstractMetaObjectBase*, std::less<std::string>, std::allocator<std::pair<std::string const, class_loader::class_loader_private::AbstractMetaObjectBase*> > >& class_loader::class_loader_private::getFactoryMapForBaseClass<nodelet::Nodelet>() in plus.cpp.o
    "class_loader::class_loader_private::getCurrentlyActiveClassLoader()", referenced from:
        void class_loader::class_loader_private::registerPlugin<nodelet_tutorial_math::Plus, nodelet::Nodelet>(std::string const&, std::string const&) in plus.cpp.o
    "class_loader::class_loader_private::getCurrentlyLoadingLibraryName()", referenced from:
        void class_loader::class_loader_private::registerPlugin<nodelet_tutorial_math::Plus, nodelet::Nodelet>(std::string const&, std::string const&) in plus.cpp.o
    "class_loader::class_loader_private::getPluginBaseToFactoryMapMapMutex()", referenced from:
        void class_loader::class_loader_private::registerPlugin<nodelet_tutorial_math::Plus, nodelet::Nodelet>(std::string const&, std::string const&) in plus.cpp.o
    "class_loader::class_loader_private::hasANonPurePluginLibraryBeenOpened(bool)", referenced from:
        void class_loader::class_loader_private::registerPlugin<nodelet_tutorial_math::Plus, nodelet::Nodelet>(std::string const&, std::string const&) in plus.cpp.o
    "console_bridge::log(char const*, int, console_bridge::LogLevel, char const*, ...)", referenced from:
        void class_loader::class_loader_private::registerPlugin<nodelet_tutorial_math::Plus, nodelet::Nodelet>(std::string const&, std::string const&) in plus.cpp.o
        __GLOBAL__I_a in plus.cpp.o
  ld: symbol(s) not found for architecture x86_64
  clang: error: linker command failed with exit code 1 (use -v to see invocation)
  make[3]: *** [../lib/libnodelet_math.dylib] Error 1
  make[2]: *** [CMakeFiles/nodelet_math.dir/all] Error 2
  make[1]: *** [all] Error 2
-------------------------------------------------------------------------------}
[ rosmake ] Output from build of package nodelet_tutorial_math written to:
[ rosmake ]    /Users/alex/.ros/rosmake/rosmake_output-20130302-173409/nodelet_tutorial_math/build_output.log
[rosmake-5] Finished <<< nodelet_tutorial_math [FAIL] [ 41.04 seconds ]

It appears that it is not linking against class_loader correctly.
I created a ticket:
https://github.com/ros/common_tutorials/issues/3

Next is orocos_kdl, which appears to be missing a link against CppUnit:
{-------------------------------------------------------------------------------
        FramesTest::suite() in framestest.cpp.o
    "CppUnit::TextTestRunner::result() const", referenced from:
        _main in test-runner.cpp.o
    "CppUnit::TestSuiteBuilderContextBase::getTestNameFor(std::string const&) const", referenced from:
        FramesTest::addTestsToSuite(CppUnit::TestSuiteBuilderContextBase&) in framestest.cpp.o
    "CppUnit::TestSuiteBuilderContextBase::makeTestFixture() const", referenced from:
        FramesTest::addTestsToSuite(CppUnit::TestSuiteBuilderContextBase&) in framestest.cpp.o
    "CppUnit::Test::findTestPath(CppUnit::Test const*, CppUnit::TestPath&) const", referenced from:
        vtable for CppUnit::TestCaller<FramesTest> in framestest.cpp.o
    "CppUnit::Test::findTestPath(std::string const&, CppUnit::TestPath&) const", referenced from:
        vtable for CppUnit::TestCaller<FramesTest> in framestest.cpp.o
    "CppUnit::Test::getChildTestAt(int) const", referenced from:
        vtable for CppUnit::TestCaller<FramesTest> in framestest.cpp.o
    "CppUnit::Test::resolveTestPath(std::string const&) const", referenced from:
        vtable for CppUnit::TestCaller<FramesTest> in framestest.cpp.o
    "CppUnit::Test::checkIsValidIndex(int) const", referenced from:
        vtable for CppUnit::TestCaller<FramesTest> in framestest.cpp.o
    "CppUnit::Test::findTest(std::string const&) const", referenced from:
        vtable for CppUnit::TestCaller<FramesTest> in framestest.cpp.o
    "CppUnit::TestCase::getName() const", referenced from:
        vtable for CppUnit::TestCaller<FramesTest> in framestest.cpp.o
    "CppUnit::TestLeaf::countTestCases() const", referenced from:
        vtable for CppUnit::TestCaller<FramesTest> in framestest.cpp.o
    "CppUnit::TestLeaf::doGetChildTestAt(int) const", referenced from:
        vtable for CppUnit::TestCaller<FramesTest> in framestest.cpp.o
    "CppUnit::TestLeaf::getChildTestCount() const", referenced from:
        vtable for CppUnit::TestCaller<FramesTest> in framestest.cpp.o
    "typeinfo for CppUnit::TestSuiteBuilderContextBase", referenced from:
        typeinfo for CppUnit::TestSuiteBuilderContext<FramesTest> in framestest.cpp.o
    "typeinfo for CppUnit::TestCase", referenced from:
        typeinfo for CppUnit::TestCaller<FramesTest> in framestest.cpp.o
    "vtable for CppUnit::TestSuiteBuilderContextBase", referenced from:
        CppUnit::TestSuiteBuilderContext<FramesTest>::TestSuiteBuilderContext(CppUnit::TestSuiteBuilderContextBase&) in framestest.cpp.o
    NOTE: a missing vtable usually means the first non-inline virtual member function has no definition.
  ld: symbol(s) not found for architecture i386
  clang: error: linker command failed with exit code 1 (use -v to see invocation)
  make[3]: *** [tests/framestest] Error 1
  make[2]: *** [tests/CMakeFiles/framestest.dir/all] Error 2
  make[1]: *** [all] Error 2
-------------------------------------------------------------------------------}
[ rosmake ] Output from build of package orocos_kdl written to:
[ rosmake ]    /Users/alex/.ros/rosmake/rosmake_output-20130302-173409/orocos_kdl/build_output.log
[rosmake-0] Finished <<< orocos_kdl [FAIL] [ 43.92 seconds ]

In this case I would suggest you ensure you have cppunit installed and try building orocos_kdl by itself (rosmake orocos_kdl).

Finally there is rviz_plugin_tutorials, which seems to have some c++ which clang is not happy with:
{-------------------------------------------------------------------------------
  -- Looking for Q_WS_MAC
  -- Looking for Q_WS_MAC - found
  -- Looking for QT_MAC_USE_COCOA
  -- Looking for QT_MAC_USE_COCOA - found
  -- Found Qt4: /usr/local/bin/qmake (found version "4.8.4") 
  [rosbuild] Couldn't find source file /Users/alex/ros_ws/visualization_tutorials/rviz_plugin_tutorials/build/src/moc_drive_widget.cxx; assuming that it is in /Users/alex/ros_ws/visualization_tutorials/rviz_plugin_tutorials and will be generated later
  [rosbuild] Couldn't find source file /Users/alex/ros_ws/visualization_tutorials/rviz_plugin_tutorials/build/src/moc_imu_display.cxx; assuming that it is in /Users/alex/ros_ws/visualization_tutorials/rviz_plugin_tutorials and will be generated later
  [rosbuild] Couldn't find source file /Users/alex/ros_ws/visualization_tutorials/rviz_plugin_tutorials/build/src/moc_plant_flag_tool.cxx; assuming that it is in /Users/alex/ros_ws/visualization_tutorials/rviz_plugin_tutorials and will be generated later
  [rosbuild] Couldn't find source file /Users/alex/ros_ws/visualization_tutorials/rviz_plugin_tutorials/build/src/moc_teleop_panel.cxx; assuming that it is in /Users/alex/ros_ws/visualization_tutorials/rviz_plugin_tutorials and will be generated later
  -- Configuring done
  -- Generating done
  -- Build files have been written to: /Users/alex/ros_ws/visualization_tutorials/rviz_plugin_tutorials/build
  cd build && make -j -l8
  Scanning dependencies of target rospack_genmsg_libexe
  [  0%] Built target rospack_genmsg_libexe
  Scanning dependencies of target rosbuild_precompile
  [  0%] Built target rosbuild_precompile
  [  7%] Generating src/moc_teleop_panel.cxx
  [ 15%] Generating src/moc_plant_flag_tool.cxx
  [ 23%] Generating src/moc_imu_display.cxx
  [ 30%] Generating src/moc_drive_widget.cxx
  Scanning dependencies of target rviz_plugin_tutorials
  [ 38%] Building CXX object CMakeFiles/rviz_plugin_tutorials.dir/src/drive_widget.cpp.o
  /Users/alex/ros_ws/visualization_tutorials/rviz_plugin_tutorials/src/drive_widget.cpp:113:23: error: variable length array of non-POD element type 'QPointF'
      QPointF left_track[ step_count ];
                        ^
  /Users/alex/ros_ws/visualization_tutorials/rviz_plugin_tutorials/src/drive_widget.cpp:114:24: error: variable length array of non-POD element type 'QPointF'
      QPointF right_track[ step_count ];
                         ^
  In file included from /Users/alex/ros_ws/visualization_tutorials/rviz_plugin_tutorials/src/drive_widget.cpp:34:
  In file included from /usr/local/Cellar/qt/4.8.4/include/QtGui/QMouseEvent:1:
  In file included from /usr/local/Cellar/qt/4.8.4/include/QtGui/qevent.h:52:
  /usr/local/Cellar/qt/4.8.4/include/QtGui/qmime.h:119:10: warning: private field 'type' is not used [-Wunused-private-field]
      char type;
           ^
  1 warning and 2 errors generated.
  make[3]: *** [CMakeFiles/rviz_plugin_tutorials.dir/src/drive_widget.cpp.o] Error 1
  make[2]: *** [CMakeFiles/rviz_plugin_tutorials.dir/all] Error 2
  make[1]: *** [all] Error 2
-------------------------------------------------------------------------------}
[ rosmake ] Output from build of package rviz_plugin_tutorials written to:
[ rosmake ]    /Users/alex/.ros/rosmake/rosmake_output-20130302-173409/rviz_plugin_tutorials/build_output.log
[rosmake-3] Finished <<< rviz_plugin_tutorials [FAIL] [ 25.69 seconds ]

I filed a ticket:
https://github.com/ros-visualization/visualization_tutorials/issues/3

Finally, I would say that you don't need any of these packages, the two tutorial packages obviously need to be fixed but are not crucial for you to run ROS stuff, and orocos_kdl should be removed as it has been replaced by a newer catkin version of the package. I just now removed it from the list of dry (rosbuild) packages to be downloaded as part of the source installation, so in the future this version of orocos_kdl will not even be downloaded.

Originally posted by William with karma: 17335 on 2013-03-12
This answer was ACCEPTED on the original site
Post score: 3

Original comments
Comment by Noldorin on 2013-03-12:
Thanks for this, William. I appreciate your filing those bug reports too! As to the orocos_kdl issue, indeed I have cppunit installed, and running that command individually doesn't help unfortunately. It sounds either like an issue with the code, or one with the CLang compiler on OS X...
Comment by hersh on 2013-03-13:
I believe I fixed the bug in "visualization_tutorials" (by adding the word "const").  If that doesn't make it work, please re-open the bug on github.  Thanks!
Comment by Noldorin on 2013-03-13:
Thanks @hersh. That's great. Perhaps some instructions should be put on the OS X installation wiki page now, so people can patch it appropiately. :)

