Q:

How to use libgazebo_ros_camera.so in gazebo (urdf)

I was using a .model file in gazebo with a libgazebo_ros_camera.so camera. But for the PR2 controllers I needed to switch to urdf file. I am now using the libgazebo_ros_prosilica.so camera. But the performance of the tracking of markers using ar_pose seems worse. Therefore I want to try the libgazebo one again. But I cannot get a good urdf description of it.
How can I convert this model code to urdf syntax?
 <sensor name='camera' type='camera' always_on='1' update_rate='30' visualize='true'>
        <camera>
          <horizontal_fov angle='1.57079633'/>
          <image width='640' height='480' format='R8G8B8'/>
          <clip near='0.1' far='100'/>
        </camera>
        <plugin name="camera_plugin" filename="libgazebo_ros_camera.so">
            <alwaysOn>true</alwaysOn>
            <imageTopicName>image_raw</imageTopicName>
            <cameraInfoTopicName>camera_info</cameraInfoTopicName>
            <updateRate>30.0</updateRate>
            <cameraName>usb_cam</cameraName>
            <frameName>/robot_camera_link</frameName>
            <CxPrime>320.5</CxPrime>
            <Cx>320.5</Cx>
            <Cy>240.5</Cy>
            <hackBaseline>0</hackBaseline>
            <focalLength>320.000101</focalLength>
            <distortionK1>0.0</distortionK1>
            <distortionK2>0.0</distortionK2>
            <distortionK3>0.0</distortionK3>
            <distortionT1>0.0</distortionT1>
            <distortionT2>0.0</distortionT2>
        </plugin>
      </sensor>

Originally posted by davinci on ROS Answers with karma: 2573 on 2013-04-28
Post score: 1

Original comments
Comment by Gazer on 2013-07-03:
hey. Did you solve your issue? I am looking for a camera plugin that could publish pointcloud2, and I used the depth_camera plugin instead. Please update on your problem; which might be solve my problem.Thank you
Comment by davinci on 2013-07-03:
I use the description like the one below with libgazebo_ros_prosilica.so instead of libgazebo_ros_camera. But it is not a depth camera.
Comment by Gazer on 2013-07-03:
could I ask you, what is that  means?
Comment by davinci on 2013-07-03:
CxPrime is an intrisic parameter of the camera. Not sure what it stands for, cx is the distance to the optical center.

A:

I can't find any reference to the gazebo_ros_camera plugin in more recent URDFs; however, there are some old ones around like this one, where the camera block looks like this:
<gazebo reference="wide_stereo_gazebo_l_stereo_camera_frame">
  <sensor:camera name="wide_stereo_gazebo_l_stereo_camera_sensor">
    <imageSize>640 480</imageSize>
    <imageFormat>BAYER_BGGR8</imageFormat>
    <hfov>90</hfov>
    <nearClip>0.1</nearClip>
    <farClip>100</farClip>
    <updateRate>25.0</updateRate>
    <controller:gazebo_ros_camera name="wide_stereo_gazebo_l_stereo_camera_controller" plugin="libgazebo_ros_camera.so">
      <alwaysOn>true</alwaysOn>
      <updateRate>25.0</updateRate>
      <imageTopicName>wide_stereo/left/image_raw</imageTopicName>
      <cameraInfoTopicName>wide_stereo/left/camera_info</cameraInfoTopicName>
      <frameName>wide_stereo_optical_frame</frameName>
      <hackBaseline>0</hackBaseline>
      <CxPrime>320.5</CxPrime>
      <Cx>320.5</Cx>
      <Cy>240.5</Cy>
      <!-- image_width / (2*tan(hfov_radian /2)) -->
      <!-- 320 for wide and 772.55 for narrow stereo camera -->
      <focal_length>320</focal_length>
      <distortion_k1>0.00000001</distortion_k1>
      <distortion_k2>0.00000001</distortion_k2>
      <distortion_k3>0.00000001</distortion_k3>
      <distortion_t1>0.00000001</distortion_t1>
      <distortion_t2>0.00000001</distortion_t2>
      <interface:camera name="wide_stereo_gazebo_l_stereo_camera_iface"/>
    </controller:gazebo_ros_camera>
  </sensor:camera>
  <turnGravityOff>true</turnGravityOff>
  <material>PR2/Blue</material>
</gazebo>

Originally posted by Martin Günther with karma: 11816 on 2013-04-29
This answer was ACCEPTED on the original site
Post score: 2

Original comments
Comment by davinci on 2013-04-30:
Thanks for your response! I tried this but there are no images published unfortunately. Do you know other camera implementations than the proscilla and this?
Comment by Martin Günther on 2013-05-02:
Sorry, I don't know of any other implementations. Seems like the gazebo_ros_camera plugin is outdated. Maybe someone else knows a better alternative?
Comment by Gazer on 2013-07-03:
hey. What is that CxPrime means. Also, does this plugin publishes pointcloud 2?

