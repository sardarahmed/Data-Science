Q:

getNamespace returns double slash

Hello everybody,
I am experiencing a weird error. Considering a launch file where I launch a node in either of the two following ways
<node name="velocity_control" pkg="uav_velocity_control" type="ControlNode"  ns="vtol" output="screen"/>

or
  <group ns="vtol">
    <node name="velocity_control" pkg="uav_velocity_control" type="ControlNode"  output="screen"/>   
  </group>

In my node I have the following line of code
ros::Subscriber sub = n.subscribe(ros::this_node::getNamespace() + "/attitude", queue_size, callbackAngularVelocities);

However if I print the obtained topic name
std::cout << ros::this_node::getNamespace() << "/attitude" << std::endl;

I obtain

//vtol/attitude

I cannot understand this behaviour. I temporarily solved hardcoding the namespace in the node, but I believe you understand the importance of setting the namespaces in the launch file.
Thank you very much
Andrea

Originally posted by Mago Nick on ROS Answers with karma: 385 on 2015-06-01
Post score: 1

Original comments
Comment by debonair on 2018-10-19:
can you please answer :https://answers.ros.org/question/306197/getnamespace-returns-incorrect-namespace/
Comment by gvdhoorn on 2018-10-19:
@debonair: that is not how this works.
Comment by 130s on 2021-06-11:
The issue in OP, which is a duplicate slash, same as what https://answers.ros.org/question/306197/getnamespace-returns-incorrect-namespace/ is asking, seems to be a bug. I posted some info in the same link.

A:

You should use a nodehandle with a relative namespace instead.
The node's namespace includes the full path of the node, including the root. However, your nodehandle is probably the default, which is relative to the node. In this case, it's / . Creating a new nodehandle with the node's private namespace, ~  should fix your error.
Try this:
ros::NodeHandle private_n("~");
ros::Subscriber sub = private_n.subscribe("attitude", queue_size, callbackAngularVelocities);

EDIT for further reading:
http://wiki.ros.org/roscpp/Overview/NodeHandles
http://wiki.ros.org/Names

Originally posted by thebyohazard with karma: 3562 on 2015-06-01
This answer was ACCEPTED on the original site
Post score: 2

Original comments
Comment by Mago Nick on 2015-06-01:
That actually solved the issue. Thank you!!!

