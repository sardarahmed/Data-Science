Q:

Programming style question: getting data from odometry or tf?

Hello,
I wrote the following two programs to get my robot move in a particular direction and distance.
https://github.com/altineller/rospilot_client/blob/1f5f518d26d69643b39c3895be10732cbc723924/scripts/move_ekf_topic.py
and
https://github.com/altineller/rospilot_client/blob/1f5f518d26d69643b39c3895be10732cbc723924/scripts/move_ekf_tf.py
where the first program subscribes to odometry topic, and the second program gets the position of the robot with a transform listener, more specifically with:
self.tf_listener.lookupTransform(self.odom_frame, self.base_frame, rospy.Time(0))
Both programs work equally good. This is more of a programming style question.
What are the pros/cons of each one, and which one is considered best practice?
The odometry could stop sendign messages. Is that the case with the tf?
I would like to choose one style for my future programs. Which one should I prefer?
Best Regards,
C.A.

Originally posted by wintermute on ROS Answers with karma: 180 on 2019-11-16
Post score: 0

Original comments
Comment by jayess on 2019-11-18:
The links that you've included return 404s, perhaps you can repost them?
Comment by wintermute on 2019-11-18:
hello, I have changed the links

A:

Use TF.
The odom topic is going to be the raw output of your wheel encoders (or whatever the odometry source is). If you fuse multiple sensor sources together using something like robot_localization or robot_pose_ekf, its going to publish on TF the fused positioning.
Also if you want to ever get not just the current odometry information but information at a specific time (even if only 100ms ago) you're going to need to use TF or you need to buffer a bunch of measurements for "just in case". TF will store the buffer for you and also do interpolation between nearby measurements for a best-possible estimation.
Also the case you mention for odometry not publishing, you're dead in the water. TF will be valid as long as the transforms are valid at least.

Originally posted by stevemacenski with karma: 8272 on 2019-11-17
This answer was ACCEPTED on the original site
Post score: 4

Original comments
Comment by wintermute on 2019-11-18:
thank you very much. I had decided to go with TF, because the topic based one has difficulty getting the initial values.

