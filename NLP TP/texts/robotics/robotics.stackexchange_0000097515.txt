Q:

Snap failing with error: Failed to install GPG key

I'm trying to create a snap for my ROS package but it fails with the following error even though dirmngr is installed.
Failed to install GPG key: Executing: /tmp/apt-key-gpghome.5dGB3qgLls/gpg.1.sh --keyserver keyserver.ubuntu.com --recv-keys XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
gpg: failed to start the dirmngr '/usr/bin/dirmngr': No such file or directory
gpg: connecting dirmngr at '/tmp/apt-key-gpghome.5dGB3qgLls/S.dirmngr' failed: No such file or directory
gpg: keyserver receive failed: No dirmngr

Recommended resolution:
Verify any configured GPG keys.

Detailed information:
GPG key ID: XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
GPG key server: keyserver.ubuntu.com

I really do not know how to verify configured GPG keys. How should I fix this?

Originally posted by Py on ROS Answers with karma: 501 on 2020-11-06
Post score: 0

Original comments
Comment by gvdhoorn on 2020-11-06:
Is this ROS related? Not having dirmngr installed is a general Ubuntu problem.
Comment by kyrofa on 2020-11-06:
This implies that you don't have gnupg installed, is that true? Your log is very clipped so it's impossible to know, but this gives the impression that you're running snapcraft without a build VM or a container where it manages the image. Are you using --destructive-mode, or building in Docker or something? Assuming so, install gnupg and you should be good.
Comment by Py on 2020-11-08:
I have just confirmed that I have gnupg installed (this is version 2.2.4). Any other ideas?
Comment by Py on 2020-11-10:
I am not using --destructive-mode or building in Docker either. How could I make sure I am using the necessary build VM? Is there any more information needed to work out this problem?

A:

I managed to solve this problem after some misunderstanding about where dirmgr was installed. It turns out that this was only on my local machine rather than the VM used to build the Snap. The solution was therefore to run snapcraft --debug and then apt install dirmngr -y. After that, snapcraft runs sucessfully.

Originally posted by Py with karma: 501 on 2020-11-10
This answer was ACCEPTED on the original site
Post score: 0

