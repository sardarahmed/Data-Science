Q:

Cannot include rosbag as catkin dependency

I am having trouble including rosbag as a catkin dependency for my package (to use the C++ API). I have added it as both a build and run dependency in package.xml; i.e.,
<build_depend>rosbag</build_depend>
<run_depend>rosbag</build_depend>

And it is included in the correct places in CMakeLists.txt; i.e.,
find_package(catkin REQUIRED COMPONENTS
   pcl_ros
   roscpp
   rosbag
   sensor_msgs
)

and
catkin_package(
  INCLUDE_DIRS include
  CATKIN_DEPENDS pcl_ros roscpp sensor_msgs rosbag
)

Yet when I write the simple file
#include <ros/ros.h>
#include <rosbag/bag.h>
#include <string>
#include <iostream>

int main()
{
  rosbag::Bag bag;
  bag.open("test.bag", rosbag::bagmode::Read);

  std::vector<std::string> topics;
  topics.push_back(std::string("chatter"));
  topics.push_back(std::string("numbers"));

  bag.close();
}

I get the following when I invoke catkin_make:
CMakeFiles/write_json.dir/src/write_json.cpp.o: In function `main':
write_json.cpp:(.text.startup+0xe): undefined reference to `rosbag::Bag::Bag()'
write_json.cpp:(.text.startup+0x32): undefined reference to `rosbag::Bag::open(std::string const&, unsigned int)'
write_json.cpp:(.text.startup+0xd1): undefined reference to `rosbag::Bag::close()'
write_json.cpp:(.text.startup+0xe5): undefined reference to `rosbag::Bag::~Bag()'
write_json.cpp:(.text.startup+0xfd): undefined reference to `rosbag::Bag::~Bag()'
collect2: error: ld returned 1 exit status

Does anyone have any idea what I'm doing wrong?

Originally posted by kamek on ROS Answers with karma: 79 on 2015-02-17
Post score: 0

A:

Those are linking errors, you need to link your library or executable (which contains write_json.cpp) against the rosbag libraries:
target_link_libraries(my_executable_or_library ${catkin_LIBRARIES})

Originally posted by William with karma: 17335 on 2015-02-17
This answer was ACCEPTED on the original site
Post score: 4

