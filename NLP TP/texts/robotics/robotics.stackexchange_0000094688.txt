Q:

rosdep *_python3 style rules

The rosdep contribution guide points out:

You may see existing rules that use _python3-suffixed distribution codenames. These were trialed as a possible style of Python 3 rules and should not be used for newly added definitions.

I just ran into one, and I'm not sure how to utilize it. I'm talking about python-serial. There seems to  be no way to get rosdep to resolve the python-serial key to the python3-serial Debian package. I'm running with ROS 2 Dashing on Ubuntu Bionic, and I've tried the following combinations:
$ rosdep resolve python-serial
#apt
python-serial
$ ROS_PYTHON_VERSION=3 rosdep resolve python-serial
#apt
python-serial
$ rosdep resolve python3-serial
ERROR: no rosdep rule for 'python3-serial'

_python3-suffixed rules sound deprecated, but at least in practice they actually appear dead. Is there a special way to use these of which I'm unaware, or should we be rewriting such rules to be python3-* top-level rules alongside the python-* ones, as is the now-established practice for new rules?

Originally posted by kyrofa on ROS Answers with karma: 347 on 2020-02-11
Post score: 0

A:

Is there a special way to use these of which I'm unaware

The way to use those is to tell rosdep that your OS is "*_python3"
e.g.
root@cdf6f1d3bd1c:/# rosdep resolve python-serial
#apt
python-serial
root@cdf6f1d3bd1c:/# rosdep resolve python-serial --os ubuntu:bionic_python3
#apt
python3-serial

should we be rewriting such rules to be python3-* top-level rules alongside the python-* ones, as is the now-established practice for new rules?

I believe yes, you would need to use a conditional dependency similarly to https://github.com/ros/ros/blob/ee5469facade6ff917d56ea9340b7c5a90f8f574/core/roslib/package.xml#L31-L32
Note that you will also need to add a python3-serial key to the rosdep database as it doesn't currently exist

Originally posted by marguedas with karma: 3606 on 2020-02-11
This answer was ACCEPTED on the original site
Post score: 0

Original comments
Comment by kyrofa on 2020-02-11:
Oh wow, I didn't even think about trying a different os! In that case, I see no downside to adding the new rule as well. Thank you!
Comment by Dirk Thomas on 2020-02-11:
That approach is explicitly discouraged.

