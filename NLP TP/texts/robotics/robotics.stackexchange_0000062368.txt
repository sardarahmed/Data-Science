Q:

How to write a motor controller driver?

Hi All,
I need to interface with Orion Robotics' RoboClaw motor controllers and so require some kind of driver.
More info on the device here.
I will have several of them connected via USB and need to talk to them individually.
I would like to write the generic driver and create a new instance for each physical device.
I was thinking that I will need a node to run to maintain the connection to the device...?
But should requests be received using services or messages?
Thanks for any help,
Chris.

Originally posted by anonymous8676 on ROS Answers with karma: 327 on 2014-09-04
Post score: 0

A:

I recently wrote a python ROS node for Roboclaw that runs on Indigo. I'm cleaning it up for release but it didn't take too long to get a basic driver working with pyserial. My biggest issue has been read errors that sometimes need to trigger a reset of the port connection. You'll want to subscribe to a /cmd_vel topic with geometry_msgs/Twist message type to handle your linear and angular velocity commands, if that's suitable with your use case. I read encoder values and publish them on /odom for odometry.
Service calls would make sense if you want to change change PID parameters, voltage cutouts, etc.

Originally posted by dpiet with karma: 26 on 2014-09-07
This answer was ACCEPTED on the original site
Post score: 1

Original comments
Comment by epascual on 2015-01-12:
Hello,
I was just about doing the same thing. Do you plan to publish your work ?
Using Twist messages sounds fine for a differential robot powered by the RoboClaw, but what about using it as a 2 independent motors controller ? Twist messages don't make that much sense here. What would you use ?
Comment by sonyccd on 2016-03-21:
I am maintaining the roboclaw driver now, let me know if you have any problems with it.
https://github.com/sonyccd/roboclaw_ros

