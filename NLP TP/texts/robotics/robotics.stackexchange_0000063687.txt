Q:

Cannot use java classes to execute prolog predicates

Hi.
I wanted to instantiate some classes from my owl file using the data received from sensor ROS node. So I defined some predicates to do that (very similar to the predicates given in knowron_perception_tutorial package) in a .pl file. I am loading this prolog file while launching json_prolog launcher. I also made a subscriber and knowledge_update functions/threads in java, following the same package. I am using a python node that publishes sensor data.
The problem is that when I try to query the knowledge base using a python script, I get the following error:
Prolog query failed: PrologException: error(java_exception(@('J#00000000001832433860')), 'java.lang.NoClassDefFoundError')"
I am guessing that the java class files(generated using ROSMAKE) is not accessible. I have made the file path reference in java and CMakeList similar to the way done in knowledge_perception_tutorial. What am I missing?  Thanks.

Originally posted by olchandra on ROS Answers with karma: 7 on 2014-10-30
Post score: 0

A:

Do you export the bin folder of your package in the manifest.xml?
Please have a look at this file as an example:
https://github.com/knowrob/knowrob/blob/master/mod_vis/manifest.xml#L25
EDIT:
The problem seems to be the launch file you are using that starts the json_prolog executable directly. Once this node has been started, the JVM is initialized and modifications of the CLASSPATH variable do not have any effect any more. There is a special script in the rosprolog package called run_with_prolog_env that exports the CLASSPATH before launching json_prolog. You can have a look at an example in the launch file of the ias_semantic_map package.

Originally posted by moritz with karma: 2673 on 2014-11-08
This answer was ACCEPTED on the original site
Post score: 0

Original comments
Comment by olchandra on 2014-11-10:
Yes, I have imported the bin folder in manifest.xml. Still the same error. I think it has to do with this issue https://github.com/knowrob/knowrob/issues/40
Comment by moritz on 2014-11-10:
That issues applies only if the JVM has already been initialized, i.e. normally if you manually load a package after KnowRob has been started. If you load packages from within the init.pl, that usually does not apply.
Comment by moritz on 2014-11-10:
Could you please post your CMakelists, manifest and init.pl and the command you use for launching?
Comment by olchandra on 2014-12-03:
Thanks Moritz. That solved the problem. There is another problem, different but related. I will ask it separately.

