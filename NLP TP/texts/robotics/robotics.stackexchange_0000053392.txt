Q:

How to create a node that listens to particular topic and publishes tf

How can I create a node that listens to that particular topic and publishes the required required tf. I have succesfully published data on a topic. Now I want to exhibit it in TF. Do I need a TF broadcaster, something like this
tf::TransformBroadcaster br;
tf::Transform transform;
transform.setOrigin( tf::Vector3(0,0,0)); 
transform.setRotation( tf::Quaternion(x,y,z,w) ); 
br.sendTransform(tf::StampedTransform(transform, ros::Time::now(), "optical", "base_link"));

Even If I have something like this. How do I listen and display it. Forexample do I need a tf listener to listen to some topic which is publishing data. If thats the case. What would the code look like if my topic is /mytopic

Originally posted by micheal on ROS Answers with karma: 121 on 2013-08-08
Post score: 0

A:

Here is a piece of code that publishes an odometry transform over tf.
void pub_odom::odom_callback(const nav_msgs::Odometry& odom) {

btVector3 Position;
btQuaternion Orientation;
tf::TransformBroadcaster odom_broadcaster_;
tf::StampedTransform odom_transform;

Position.setValue(odom.pose.pose.position.x,odom.pose.pose.position.y,odom.pose.pose.position.z);
Orientation.setW(odom.pose.pose.orientation.w);
Orientation.setX(odom.pose.pose.orientation.x);
Orientation.setY(odom.pose.pose.orientation.y);
Orientation.setZ(odom.pose.pose.orientation.z);

odom_transform.setOrigin(map_center);
odom_transform.setRotation(tf::Quaternion(tf::Vector3(0,0,1),-yaw_init));
odom_transform.stamp_ = odom.header.stamp;
odom_transform.child_frame_id_= "/odom";
odom_transform.frame_id_= "/center_map";
odom_broadcaster_.sendTransform(odom_transform);}

Hope it helps you

Originally posted by Mario Garzon with karma: 802 on 2013-08-08
This answer was ACCEPTED on the original site
Post score: 3

Original comments
Comment by BennyRe on 2013-08-08:
You also could replace btVector3 and btQuaternion by tf::Vector3 and tf::Quaternion.
Comment by micheal on 2013-08-10:
@Mario Garzon Can you please send me a link to your whole  package so that I can visualise your package with tf. danke Schoen. Right now i cannot run your program so that I can understand better.

