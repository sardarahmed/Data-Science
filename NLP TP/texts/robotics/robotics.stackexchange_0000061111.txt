Q:

Limit linear velocity

Hi everyone,
I wrote a node that subscribes to the topic sensor_msgs/LaserScan and publishes in the topic geometry_msgs/Twist. I want to limit the maximum linear velocity that a powered wheelchair can reach. How can I do that?
Here's the code of how I publish the velocity: (this is just an example, I don't want to set the linear velocity to 1.4m/s, I want that the maximum velocity reachable is 1.4 m/s)
ros::Publisher vel_pub_=n.advertise<geometry_msgs::Twist>("cmd_vel", 1);
(...)
vel.linear.x=1.4;
vel.angular.z+=M_PI/8;
vel_pub_.publish(vel);

Originally posted by anamcarvalho on ROS Answers with karma: 123 on 2014-07-23
Post score: 0

Original comments
Comment by bvbdort on 2014-07-23:
can you describe more
Comment by anamcarvalho on 2014-07-23:
+bvbdort Hi want to limit the max linear velocity. I am new to ROS and I don't know which topic should I publish or with what parameter can I limit the linear velocity.
Comment by McMurdo on 2014-07-24:
Divide your 'linear.x' by a factor in the Twist message that you send to /command_velocity or cmd_vel.
Or limit your linear.x
Comment by bvbdort on 2014-07-24:
please post your code how you are publishing your linear velocity.
Comment by anamcarvalho on 2014-07-24:
+McMurdo divide linear.c by what factor?? I want to limit my linear velocity (linear.x) just like you said, but I don't know how, please explain it to me...
+bvbdort I'll post the code now!
Comment by dornhege on 2014-07-24:
linear.x is zero in the code you posted. I don't know how you want to limit that more.
Comment by sterlingm on 2014-07-24:
If you just want to enforce a max velocity, check the value of vel.linear.x and change it if it is too large. If you want to scale the velocity to another range, that can be done in one line -  see http://stackoverflow.com/questions/929103/convert-a-number-range-to-another-range-maintaining-ratio
Comment by anamcarvalho on 2014-07-24:
+dornhege This was just an example of how I publish the velocity. I want to limit the maximum linear velocity of the wheelchair. I want that, no matter which part of my code is executing, the maximum velocity that the power wheelchair user can reach (joystick is the HMI) is for example 1.4m/s!
Comment by anamcarvalho on 2014-07-24:
+sterlingm this is a powered wheelchair that is not autonomous. It is navigated through a joystick and the maximum velocity is too high for what I want to do. I need to limit the velocity to for example 1.4m/s, no matter what is the velocity applied in a certain moment!
Comment by sterlingm on 2014-07-24:
So... if(vel.linear.x > 1.4) vel.linear.x = 1.4;  and then publish the twist message? Is that not working?
Comment by dornhege on 2014-07-24:
Maybe add a fabs and sign in there.
Comment by anamcarvalho on 2014-07-24:
+sterlingm but idn't a way of doing that without doing an if? I mean, if there isn't a way of doing something like vel.linear.x=1.4 (no if needed) but for the max velocity!
Comment by sterlingm on 2014-07-24:
Not that I'm aware of

A:

Write another node the subscribes to the Twist message, enforces any limits you want to set (such as maximum speed), and then publishes the new, modified Twist.  Have this node subscribe to the topics published by your original node, and publish to the lower-level drivers for the wheelchair.

Originally posted by Bill Smart with karma: 1263 on 2014-07-24
This answer was ACCEPTED on the original site
Post score: 2

