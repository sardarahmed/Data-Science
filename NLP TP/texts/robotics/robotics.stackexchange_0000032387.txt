Q:

from PoseStamped message to tf StampedTransform

What's the neatest way to change a PoseStamped message into a StampedTransform to be published through a transform_broadcaster?

Originally posted by quimnuss on ROS Answers with karma: 169 on 2011-06-19
Post score: 3

A:

Have a look at those:
name: tf::poseStampedTFToMsg
cmd: /^static inline void poseStampedTFToMsg(const Stamped<Pose>& bt, geometry_msgs::PoseStamped & msg)$/
namespace: tf
signature: (const Stamped<Pose>& bt, geometry_msgs::PoseStamped & msg)
filename: /opt/ros/diamondback/stacks/geometry/tf/include/tf/transform_datatypes.h

name: tf::poseStampedMsgToTF
cmd: /^static inline void poseStampedMsgToTF(const geometry_msgs::PoseStamped & msg, Stamped<Pose>& bt)$/
namespace: tf
signature: (const geometry_msgs::PoseStamped & msg, Stamped<Pose>& bt)
filename: /opt/ros/diamondback/stacks/geometry/tf/include/tf/transform_datatypes.h

This is code I used a while ago for the inverse transformation:
  tf::Transform grasp_tf(gripperRotation, gripperOrigin);
  tf::Stamped<tf::Pose> grasp_tf_pose(grasp_tf);
  geometry_msgs::PoseStamped msg;
  tf::poseStampedTFToMsg    (grasp_tf_pose, msg);

Edit:
I just needed to to that exact thing, so I mixed tf::poseStampedMsgToTF and tf::TransformStampedMsgToTF
namespace //anonymous
{ 
using namespace tf;
inline void myPoseMsgToTF(const geometry_msgs::Pose& msg, Transform& bt)
{
  bt = Transform(Quaternion(msg.orientation.x,
                            msg.orientation.y,
                            msg.orientation.z,
                            msg.orientation.w),
                 Vector3(msg.position.x, msg.position.y, msg.position.z));
}

///Sets the child frame fixed to "camera"
inline void myPoseStampedMsgToTF(const geometry_msgs::PoseStamped & msg, StampedTransform& bt)
{
  myPoseMsgToTF(msg.pose, bt); 
  bt.stamp_ = msg.header.stamp;
  bt.frame_id_ = msg.header.frame_id;
  bt.child_frame_id_ = "camera";
  ROS_WARN_ONCE("You are using a path which does not carry the information about the "
                "name of the sensor frame. Using 'camera' as child_frame_id.\n"
                "Make sure the positions in your path are those of the 'camera' frame.");
}
}//anon namespace

Originally posted by Felix Endres with karma: 6468 on 2011-06-19
This answer was ACCEPTED on the original site
Post score: 8

Original comments
Comment by aknirala on 2013-04-12:
I find these easy to use.
Comment by shamitb on 2016-03-07:
Does this still work in ROS Indigo?
Comment by Felix Endres on 2016-03-09:
I don't know. In Indigo you should probably use tf2 anyway.

