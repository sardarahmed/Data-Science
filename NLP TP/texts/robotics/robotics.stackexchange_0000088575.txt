Q:

rospy.Time.now() returns 0

 #! /usr/bin/env python

import rospy
rospy.init_node('h')
print(rospy.Time.now()) => 0

Prints zero? Here is the context

Kinetic

rosparam get /use_sim_time -> true
$ rostopic info /clock
Type: rosgraph_msgs/Clock
Publishers:

/gazebo (http://10.0.0.95:36787/)

Subscribers:

/rosout (http://10.0.0.95:45435/)
/gazebo (http://10.0.0.95:36787/)
/gazebo_gui (http://10.0.0.95:43597/)

Originally posted by pitosalas on ROS Answers with karma: 628 on 2018-08-19
Post score: 2

Original comments
Comment by gvdhoorn on 2018-08-19:
Is Gazebo paused?
Comment by pitosalas on 2018-08-19:
No, itâ€™s up. Also when I rostopic echo /clock I
see the messages go by. Also when I set /use_sim_time to
False the same code works.
Comment by pitosalas on 2018-08-21:
Anyone? I am stumped. Thinking that I had corrupted something in my install, i see the same behavior on a different computer altogether.

A:

I know you've already reinstalled -- but in case someone else (or even you) runs into this later -- it is possible you simply have a race condition. If you put the print() statement in a loop, I imagine your values would start to increase. It is possible that either the python node came up and printed before gazebo really started publishing /clock, or that the print statement happened before the first clock message came in.
I've seen some codebases where the developers explicitly wait until time > 0 before letting the rest of the initialization proceed.

Originally posted by fergs with karma: 13902 on 2018-08-24
This answer was ACCEPTED on the original site
Post score: 2

Original comments
Comment by pitosalas on 2018-08-24:
Interesting information... In my case I just extracted that code sample to show the problem starkly but it was actually in a loop and I did wait a while. I also did see some kind of weird behavior as I toggled /use_simtime and watched what happened.
Comment by lucasw on 2021-10-28:
It appears rospy.sleep(0.0) works (at least in noetic), at least a single clock message has to arrive to return from that sleep.

