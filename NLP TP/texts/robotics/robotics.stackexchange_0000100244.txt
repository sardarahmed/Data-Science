Q:

Collision between gripper flange and robot flange detected

Hi!
At the moment I am trying to attach a gripper to my FANUC robot. The gripper appears in the visualization at the correct place but the moveit motion planning did not work anymore. I am thinking the problem is a detected collision between the gripper base body (base_gripper) and the gripper fingers (left_gripper) of the robot.
[ INFO] [1633519835.487152730]: Found a contact between 'base_gripper' (type 'Robot link') and 'left_gripper' (type 'Robot link'), which constitutes a collision. Contact information is not stored. [ INFO] [1633519835.487205588]: Collision checking is considered complete (collision was found and 0 contacts are stored) [ INFO] [1633519835.487263046]: Start state appears to be in collision with respect to group manipulator

Following the definition of the combination of gripper and robot:
<?xml version="1.0" ?>
<robot name="fanuc_cr7ial" xmlns:xacro="http://wiki.ros.org/xacro">
  <xacro:include filename="$(find fanuc_cr7ia_support)/urdf/cr7ial_macro.xacro"/>
  <xacro:fanuc_cr7ial prefix=""/>
  
  <xacro:include filename="$(find laborroboter)/urdf/gripper_macro.xacro"/>
  <xacro:gripper prefix=""/>
  
  <!-- attach gripper to Cr7iAl model -->
  <joint name="robot_flange-top_link" type="fixed">
    <origin xyz="0 0 0" rpy="${pi} ${-pi/2} 0" />
    <parent link="flange" />
    <child link="top_link" />
  </joint>
</robot>

How can I add contact information for this joint?
Thanks in advance!
nico

Originally posted by nicob on ROS Answers with karma: 37 on 2021-10-06
Post score: 0

Original comments
Comment by gvdhoorn on 2021-10-06:
Doesn't the error message say something else? Specifically:

Found a contact between 'base_gripper' [..] and 'left_gripper'

those are both not flange, but different links.
Probably in your gripper model.
Also: why are you not using a prefix for the robot and the gripper models?
Comment by nicob on 2021-10-06:
You are right. I tested it without the gripperfingers and than the error was like descripted. Sorry for this misconception. The fault is the same, a collision between to parts of the robot which are fixed together.
I do not use a prefix because I do not understand the reason for this. My robot is really simple. In a first step I try it to work and I will understand it on the way to this. ;)
Comment by gvdhoorn on 2021-10-06:\

You are right. I tested it without the gripperfingers and than the error was like descripted. Sorry for this misconception. The fault is the same, a collision between to parts of the robot which are fixed together.

Then please either update your description, or update the error message to agree with what you describe.
Right now it's just confusing.
In any case: did you re-run the MoveIt Setup Assistant (MSA) after changing your .xacro? And more specifically: did you update the Allowed Collision Matrix using the MSA?
Comment by nicob on 2021-10-06:
I updated it.
MSA: No, I just edited and created the xacro files and after that I started ros with "roslaunch...".
Now, I am in the process of re-run it. But do I have to configure the standard FANUC CR-7iaL complete on my one at the first time? I can not load an Moveit configuration package at the standard pkg folder of the fanuc pkg.
Comment by gvdhoorn on 2021-10-06:\

No, I just edited and created the xacro files and after that I started ros with "roslaunch...".

As I tried to make clear in your previous question (#q387430), you need to tell MoveIt about your specific setup.
You cannot reuse an existing MoveIt configuration package with a different or new robot (well, you can, but it would require runtime changes, and if you're just starting out that may not be the approach I'd recommend to try first).
Adding a gripper to an existing robot model is essentially the same as "a new robot".
MoveIt not being aware of two links always being in contact because they are right next to each other due to how the robot is constructed is exactly one of those things which the MoveIt Setup Assistant will discover and then store in your MoveIt configuration package.
In this case you need to update the ACM.
Comment by nicob on 2021-10-12:
Hi!
I am sorry for my late reply. For me, it is not possible to work fulltime at this project, but I am still track on it.
In the last days, it was possible for me to create a new (own) robot with gripper, based on the FANUC package. For this I created two more packages (rebuild multiple times):
Gripper (contains the xacro file with gripper geometrie)

Laborroboter (contains the script to assembly the FANUC Cr-7iAl and the gripper to a new robot)

Laborroboter_moveit_config (contains all the files created by the MSA)

After this warm feeling of success I get new problems… I think the geometry is correct. The output of urdf_to_graphiz shows a smooth and logical structure.
I carried out the MSA accordingly to this tutorial:
https://ros-planning.github.io/moveit_tutorials/doc/setup_assistant/setup_assistant_tutorial.html
Comment by nicob on 2021-10-12:
A first test of the new moveit package with the command “roslaunch laborroboter_moveit_config demo.launch” starts successfully and I can move and plan the robot. But I get some error messages in the background (extract of messages):
[ERROR] [1634020992.972334113]: Tried to advertise on topic [/move_group/filtered_cloud] with md5sum [060021388200f6f0f447d0fcd9c64743] and datatype [sensor_msgs/Image], but the topic is already advertised as md5sum [1158d486dd51d683ce2f1be655c3c181] and datatype [sensor_msgs/PointCloud2]
[ERROR] [1634020993.027397108]: Tried to advertise a service that is already advertised in this node [/move_group/model_depth/compressedDepth/set_parameters]

Do you have an idea whats the problem?
Best regards!
nico
Comment by gvdhoorn on 2021-10-12:
Those appear to be different problems. It's not a good idea to post (follow-up) questions in comments.
You should post a new question.
If you've solved your current one, please post an answer and accept your own answer.

A:

In the last days, it was possible for me to create a new (own) robot with gripper supported by MoveIt, based on the FANUC package. For this I created three more packages (rebuild multiple times):

Gripper (contains the xacro file with gripper geometrie)
Laborroboter (contains the script to assembly the FANUC Cr-7iAl and the gripper to a new robot)
Laborroboter_moveit_config (contains all the files created by the MSA)

I think the geometry of the assembly is correct. I checked it with the command urdf_to_graphiz. The output shows a smooth and logical structure.
After that I carried out the MSA accordingly to this tutorial: https://ros-planning.github.io/moveit_tutorials/doc/setup_assistant/setup_assistant_tutorial.html
Now I can load and plan the robot in a demo mode by using the command:
roslaunch laborroboter_moveit_config demo.launch

Furthermore helpfull is this source to understand the importance of the MSA and the basic understanding: http://wiki.ros.org/Industrial/Tutorials/Create_a_MoveIt_Pkg_for_an_Industrial_Robot

Originally posted by nicob with karma: 37 on 2021-10-12
This answer was ACCEPTED on the original site
Post score: 0

