Q:

Had a working groovy costmap_2d -> won't work on hydro

Hi folks,
I've had a working costmap_2d setup in Groovy but upgraded to Hydro and now it doesn't work anymore. Here's my launch configuration of move_base:

http://pastebin.com/aFEASNNe

And my configuration files for common, local and global costmap as well as local planner:

http://pastebin.com/4gHGpFKb (common)
http://pastebin.com/6DqhSP7d (local costmap)
http://pastebin.com/ertA8ntu (global costmap)
http://pastebin.com/Uc08H2r0 (local planner)

// edit1: here's the output of the move_base launch:

http://pastebin.com/dC4Tu360

// edit2: is there maybe a costmap_2d layer plugin missing? One that provides an occupancy grid to rviz?

In Groovy I got valid obstacle information and could issue goals which most of the time were successfully reached.
In Hydro however the corresponding topics aren't posted anymore. In rviz I cannot see any valid topic for GridCells anymore which I used previously to visualize occupied space.
I don't see why it isn't working anymore. All I've done is upgrading my ROS to Hydro and catkin rebuilding my workspace.
I'd appreciate any kind of help here. If you need further information I'll happily try to deliver...
Cheers,
Hendrik

Originally posted by Hendrik Wiese on ROS Answers with karma: 1145 on 2013-09-17
Post score: 0

A:

Not sure if the following fully answers your question as I cannot tell which is your exact problem. There is no real error message in the output you pasted. Does your robot hit the obstacles or are you just missing the costmap visualization (see below)?
The costmap_2d package has undergone a rework in ROS hydro and the costmap is organized in layers now. Check the hydro Migration Guide and the costmap_2d wiki page for some details. Unfortunately not all of the updates and new features are reflected in the wiki pages yet.

The fact that both costmaps, local and global, subscribe to the /map topic looks strange as the static_map parameter is set to false for the local_costmap. Are you sure that the new local_costmap/plugins parameter was not set with a static map layer in the list? Just uncommenting it in the yaml file and restart without restarting the roscore, too, will not unset the parameter on the parameter server.

The resulting costmap will be advertised as nav_msgs/OccupancyGrid message in the private namespace of the costmap. rviz supports additional color schemes for costmaps now. The old GridCell publisher obviously has been dropped. If you want to visualize the costmaps you have to update your rviz config and add a Map display with the appropriate settings.

Note that dynamic updates of the static layer via the /map topic are currently broken in hydro. Only the first map received will be used for navigation.

Originally posted by Johannes Meyer with karma: 1266 on 2013-09-17
This answer was ACCEPTED on the original site
Post score: 1

Original comments
Comment by Hendrik Wiese on 2013-09-17:
Aaah, I see. One should occasionally do an apt-get upgrade. Now I've got a working costmap with obstacle detection and rviz again. For testing purposes I removed global_frame parameter in the local costmap config. I'll have to investigate what changing that brings about. Thanks a lot!
Comment by Hendrik Wiese on 2013-09-17:
Additionally, the "Tried to advertise a service that is already advertised in this node" error message is gone as well now... seems it's really just been a bunch of outdated packages.

