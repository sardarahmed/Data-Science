Q:

Inbound TCP/IP connection failed... help?

Hi,
Has anyone come across the warning message:
[WARN] [WallTime 1395255145.292842] Inbound TCP/IP connection failed: connection from sender terminated before handshake header received. 0 bytes were received.  Please check sender for additional details.

I experience this multiple times when running different nodes in my system.  The only thing they have in common is a class that I made to handle a lot of the communication such that all the publishers and subscribers together.  Could launching several instances of this class in each node cause an error such as above?
I am lost as regards what the problem may be as I haven't noticed any actual loss of functionality but given that it is to be used for a control system I would prefer it not to continuously give warning messages!
I am using ROS on a ubuntu 12.04 LTS machine with 8 core i7 processor.
Any ideas much appreciated :)

Originally posted by lvsteenson on ROS Answers with karma: 41 on 2014-03-20
Post score: 4

Original comments
Comment by demmeln on 2014-03-21:
Please don't open duplicates. It seems nobody knows the answer, and opening your question over and over again doesn't convince people to investige for you.
Comment by lvsteenson on 2014-03-21:
Sorry I know this looks bad but actually it was a problem trying to log in resulting in my question being posted multiple times!
Comment by demmeln on 2014-03-21:
Oh ok, thanks for clarifying ;-). I hope you can login fine now. Sorry I can't help with the question. You could try dig in the code and see where this message comes from exactly.
Comment by sumit6887 on 2016-01-22:
getting the same problem over and over again
Comment by lvsteenson on 2016-01-22:
I never found a solution to this and instead switched away from using topics to solely using the parameter server.  Its okay for my application where the data throughput isn't that high but certainly isn't as efficient as using topics.
Comment by gvdhoorn on 2016-01-22:\

switched away from using topics to solely using the parameter server.

@lvsteenson: you are using the parameter server as a surrogate for topics?
Comment by gvdhoorn on 2016-01-22:
@lvsteenson: if you can share that 'common class' somehow, we can perhaps find out why this is happening. Are you creating/destroying publishers/subscribers at a high rate?
Comment by lvsteenson on 2016-01-22:
Basically my system now uses the parameter server to save the latest data from all of the sensors, the controller setpoints etc.  Before I was simply creating a publisher once upon the node being launched as would be normal but any other node that was subscribed would have that warning.
Comment by lvsteenson on 2016-01-22:
Oh and regards the Class that I was sharing, yes it was launching a subscription every time it was called but this has been remedied since thus the warnings have decreased in number but like I said in the previous post one publisher node to another simple subscriber node causes problems.
Comment by gvdhoorn on 2016-01-22:
Can you create an MWE that shows this behaviour on your machine? Doesn't need to be elaborate.
Also: OS, version, ROS version, how installed, network setup (nat/firewall/multiple nics/ROS_IP/ROS_HOSTNAME/etc)?
Comment by gvdhoorn on 2016-01-22:\

Basically my system now uses the parameter server to save the latest data from all of the sensors, the controller setpoints etc.

You already know (obviously), but this is really not what it was designed or intended for. It also sounds like you then have a complete polling based system?
Comment by gvdhoorn on 2016-01-22:
O and do you observe the same error when running 'official' nodes (ie: pkgs released by others)?
Comment by azerila on 2020-05-30:
Is it clear yet what the source of this problem can be? or what this warning means really. Does it also happen randomly for everyone?

A:

I have gotten this message regularly when running in VirtualBox on one particular machine I use.
I regularly use VMs on different platforms and I'd never run into this issue before.
This BASHonWindows issue helped me realize 1) that I wasn't alone 2) there's a PR.
The root of the matter was that ROS:

assumes that the connect method of non-blocking scoket should return -1 and last_socket_error() should return ROS_SOCKETS_ASYNCHRONOUS_CONNECT_RETURN(=EINPROGRESS).
But a non-blocking connect can return 0 when TCP connection to 127.0.0.1 (localhost).

Originally posted by SL Remy with karma: 2022 on 2017-09-15
This answer was ACCEPTED on the original site
Post score: 0

Original comments
Comment by SL Remy on 2017-09-15:
The issue also has code, so you can patch yourself if you're in a hurry.
Comment by gvdhoorn on 2017-09-20:
Answering such an old question is definitely commendable, but it's quite a statement that what the OP was seeing is caused by that particular piece of code. Can you explain how you came to that conclusion?
Comment by azerila on 2020-05-30:
So this problem is mainly about using ros applications with TCP connection to 127.0.0.1 (localhost)?

