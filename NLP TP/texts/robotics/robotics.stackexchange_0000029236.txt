Q:

Ignition crashes directly after start

Hi,
hope you guys can help me out. I want to start ignition, but it directly crashes on start. Any ideas?
Ignition / Gazebo:
Version:

https://ignitionrobotics.org/docs/fortress
Installation: According to    https://ignitionrobotics.org/docs/fortress/install_ubuntu

System:

OS: Ubuntu 20.04.3 LTS, virtualization via VMWare / ESXi 7

GPU: 1x Nvidia RTX A4000 (OpenGL 4.5) via GPU passthrough

GPU drivers:  Ubuntu meta-package, 470, (proprietary, tested) - I've tried different ones, also from nvdia homepage, same error
glxinfo | grep "OpenGL version"
OpenGL version string: 3.1 Mesa 21.2.2
ign gazebo shapes.sdf

ibEGL warning: DRI2: failed to create dri screen
libEGL warning: DRI2: failed to create dri screen
VMware: No 3D enabled (0, Success).
libEGL warning: DRI2: failed to create dri screen
VMware: No 3D enabled (0, Success).
libEGL warning: DRI2: failed to create dri screen
[GUI] [Err] [Ogre2RenderEngine.cc:905]  Unable to create the rendering window: OGRE EXCEPTION(3:RenderingAPIException): OpenGL 3.3 is not supported. Please update your graphics card drivers. in GL3PlusRenderSystem::initialiseContext at /var/lib/jenkins/workspace/ogre-2.2-debbuilder/repo/RenderSystems/GL3Plus/src/OgreGL3PlusRenderSystem.cpp (line 3364)
[GUI] [Err] [Ogre2RenderEngine.cc:905]  Unable to create the rendering window: OGRE EXCEPTION(3:RenderingAPIException): OpenGL 3.3 is not supported. Please update your graphics card drivers. in GL3PlusRenderSystem::initialiseContext at /var/lib/jenkins/workspace/ogre-2.2-debbuilder/repo/RenderSystems/GL3Plus/src/OgreGL3PlusRenderSystem.cpp (line 3364)
[GUI] [Err] [Ogre2RenderEngine.cc:905]  Unable to create the rendering window: OGRE EXCEPTION(3:RenderingAPIException): OpenGL 3.3 is not supported. Please update your graphics card drivers. in GL3PlusRenderSystem::initialiseContext at /var/lib/jenkins/workspace/ogre-2.2-debbuilder/repo/RenderSystems/GL3Plus/src/OgreGL3PlusRenderSystem.cpp (line 3364)
[GUI] [Err] [Ogre2RenderEngine.cc:905]  Unable to create the rendering window: OGRE EXCEPTION(3:RenderingAPIException): OpenGL 3.3 is not supported. Please update your graphics card drivers. in GL3PlusRenderSystem::initialiseContext at /var/lib/jenkins/workspace/ogre-2.2-debbuilder/repo/RenderSystems/GL3Plus/src/OgreGL3PlusRenderSystem.cpp (line 3364)
[GUI] [Err] [Ogre2RenderEngine.cc:905]  Unable to create the rendering window: OGRE EXCEPTION(3:RenderingAPIException): OpenGL 3.3 is not supported. Please update your graphics card drivers. in GL3PlusRenderSystem::initialiseContext at /var/lib/jenkins/workspace/ogre-2.2-debbuilder/repo/RenderSystems/GL3Plus/src/OgreGL3PlusRenderSystem.cpp (line 3364)
[GUI] [Err] [Ogre2RenderEngine.cc:905]  Unable to create the rendering window: OGRE EXCEPTION(3:RenderingAPIException): OpenGL 3.3 is not supported. Please update your graphics card drivers. in GL3PlusRenderSystem::initialiseContext at /var/lib/jenkins/workspace/ogre-2.2-debbuilder/repo/RenderSystems/GL3Plus/src/OgreGL3PlusRenderSystem.cpp (line 3364)
[GUI] [Err] [Ogre2RenderEngine.cc:905]  Unable to create the rendering window: OGRE EXCEPTION(3:RenderingAPIException): OpenGL 3.3 is not supported. Please update your graphics card drivers. in GL3PlusRenderSystem::initialiseContext at /var/lib/jenkins/workspace/ogre-2.2-debbuilder/repo/RenderSystems/GL3Plus/src/OgreGL3PlusRenderSystem.cpp (line 3364)
[GUI] [Err] [Ogre2RenderEngine.cc:905]  Unable to create the rendering window: OGRE EXCEPTION(3:RenderingAPIException): OpenGL 3.3 is not supported. Please update your graphics card drivers. in GL3PlusRenderSystem::initialiseContext at /var/lib/jenkins/workspace/ogre-2.2-debbuilder/repo/RenderSystems/GL3Plus/src/OgreGL3PlusRenderSystem.cpp (line 3364)
[GUI] [Err] [Ogre2RenderEngine.cc:905]  Unable to create the rendering window: OGRE EXCEPTION(3:RenderingAPIException): OpenGL 3.3 is not supported. Please update your graphics card drivers. in GL3PlusRenderSystem::initialiseContext at /var/lib/jenkins/workspace/ogre-2.2-debbuilder/repo/RenderSystems/GL3Plus/src/OgreGL3PlusRenderSystem.cpp (line 3364)
[GUI] [Err] [Ogre2RenderEngine.cc:905]  Unable to create the rendering window: OGRE EXCEPTION(3:RenderingAPIException): OpenGL 3.3 is not supported. Please update your graphics card drivers. in GL3PlusRenderSystem::initialiseContext at /var/lib/jenkins/workspace/ogre-2.2-debbuilder/repo/RenderSystems/GL3Plus/src/OgreGL3PlusRenderSystem.cpp (line 3364)
[GUI] [Err] [Ogre2RenderEngine.cc:913] Unable to create the rendering window after [11] attempts.
[GUI] [Err] [Ogre2RenderEngine.cc:834] Failed to create dummy render window.
shw -c video

*-display
description: VGA compatible controller
product: SVGA II Adapter
vendor: VMware
physical id: f
bus info: pci@0000:00:0f.0
version: 00
width: 32 bits
clock: 33MHz
capabilities: vga_controller bus_master cap_list rom
configuration: driver=vmwgfx latency=64
resources: irq:16 ioport:1070(size=16) memory:e8000000-efffffff memory:fe000000-fe7fffff memory:c0000-dffff
*-display
description: VGA compatible controller
product: NVIDIA Corporation
vendor: NVIDIA Corporation
physical id: 0
bus info: pci@0000:0b:00.0
version: a1
width: 64 bits
clock: 33MHz
capabilities: pm msi pciexpress vga_controller bus_master cap_list
configuration: driver=nvidia latency=64
resources: irq:64 memory:fc000000-fcffffff memory:d0000000-dfffffff memory:e4000000-e5ffffff ioport:5000(size=128)

Originally posted by Nils_ on Gazebo Answers with karma: 1 on 2021-11-23
Post score: 0

A:

Things I've tried:

Forcing newer OpenGL with MESA_GL_VERSION_OVERRIDE=...
Forcing dedicated GPU with DRI_PRIME=...
Different variations of GPU driver installation approaches (incl. blacklist nouveau driver, different versions, insecure-mode)

Results so far:
Best I can get is that it doesn't crash. World window remains black. (Error: libEGL warning: DRI2: failed to create dri screen)
Edit:
Result - not a gazebo issue - no solution:
Issue is most likely linked to incompatibilities between VMware display driver and Nvidia driver. Dedicated GPU is not accessible in this setting. According to Nvidia support, an external display has to be connected to the dedicated gpu port in order to make the gpu accessible in an Ubuntu guest.

Originally posted by Nils_ with karma: 1 on 2021-11-23
This answer was ACCEPTED on the original site
Post score: 0

