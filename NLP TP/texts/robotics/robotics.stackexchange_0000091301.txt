Q:

Cannot save data Callback function

What I am really looking for is a way to save all value's message that a node receives (in a list, CSV file..) in a way that I can later do something with this values.
So this is data received :

I tried to put all these values in myData List:
def callback(data):
    id = data.id
    x = data.pose.x
    y = data.pose.y
    
    #print data
    #list_x.append(x)
    #print id ,x,y
    goals={}
    goals["x"]=x
    goals["y"]=y
    #print goals
    myData=[goals]
    print myData

but it's not what I want(Even with append) ! it put every value in a list like this :

Also, I tried to save this value in a CSV File :
with open('goals_point.csv', 'with') as csvFile:
       writer = csv.writer(csvFile)
       writer.writerows([myData])
       csvFile.close()

it saves only the last value :

So how can I save collected messages (data)? Any idea?
Thanks for answering and for your time in advance,
Tayssir

Originally posted by Tayssir Boubaker on ROS Answers with karma: 17 on 2019-04-09
Post score: 0

Original comments
Comment by jayess on 2019-04-09:
Please don't use an image to display text. Images are not searchable and people cannot copy and paste the text from the image. Please see the support page

A:

You could save the data into a text file, and import this to excel ( or similar ).
file = open("yourfile.txt", "w+")
data_to_save = str(data.pose.x) + "\t" + str(data.pose.y) + "\n"
file.write(data_to_save)

With this code above you'll be able to create a multi-lines into your file. However, if you call the same program again the data will be overwritten.
If you need: https://www.guru99.com/reading-and-writing-files-in-python.html

Originally posted by Teo Cardoso with karma: 378 on 2019-04-09
This answer was ACCEPTED on the original site
Post score: 1

Original comments
Comment by Tayssir Boubaker on 2019-04-09:
thank you, I try it but it saves only the last value,
a = open('goals.txt', 'w+')
    data_to_save = str(data.pose.x) + "\t" + str(data.pose.y) + "\n"
    a.write(data_to_save)

output txtfile :
10.0    20.0

I think that i should not put it in my callback.
So the problem now is who can I got data.pose out of my callback !??
Comment by Teo Cardoso on 2019-04-09:
A parte de open('goals.txt', 'w+') você deve colocar em uma parte onde isso não se repita, ou sejá, no começo do programa não pode colocar essa linha dentro do callback, somente a parte de escrever.
Comment by Teo Cardoso on 2019-04-09:
Sorry, You shouldn't put the line:
a = open('goals.txt', 'w+')

inside the callback function, this line must be call once.
The lines which write inside the text file must be in the callback function.
something like this:
a = open('goals.txt', 'w+')

def   callbackFunction():
      data_to_save = str(data.pose.x) + "\t" + str(data.pose.y) + "\n"
      a.write(data_to_save)

Comment by Tayssir Boubaker on 2019-04-09:
Thanks i got it ;)

