Q:

Errors in Velodyne driver

Hi, I am working with a VLP-16. I am using the ros driver to get de pointcloud. However I think there are some mistakes in the driver. If you change the angle in the web, for example, using only 90 degrees, the total amount of points per scan changes, and in the driver is kept constant. When you change the rpm of the velodyne to 1200 the rate should be 20 Hz, however the driver still thinks te speed is 600rpm.
I have made a couple of changes and I have been able to solve the problem with the angle by ading a new parameter, with the speed I have done something similar but it still have some issues.
Have anybody else seen those mistakes?
The best way to solve them would be retrieving the information directly from the velodyne, but that is not so easy and it would requiere a big effort from me (I am still new to this).
EDIT:
I mean changing the angle and the speed here:
http://s2.subirimagenes.com/privadas/previo/thump_2372757captura-de-pantalla.png
If the angle is different from 359 it does not work well. It accumulates measurments until reach the equivalent number of points to 359 Hz, and therefore the laser rate decreases. For example, if yo select 90 degrees, it will work at
Hz.
How do I open a git issue? I have been able to solve both problems using arguments, however I think that someone should make the driver to read the parameters from within the Velodyne
Thanks a lot!

Originally posted by Kailegh on ROS Answers with karma: 146 on 2016-06-09
Post score: 1

Original comments
Comment by joq on 2016-06-09:
Your questions are unclear. What is the "angle in the web"? Did you set the "rpm" parameter correctly?
Comment by joq on 2016-06-09:
If you believe you have found a bug in the driver, please open a github issue, explaining how to reproduce the error.
Comment by Kailegh on 2016-06-13:
sorry, I did not see that the rpm parameter is in other file launch, I included one myself. However the problem with the selected angle is real.
Comment by joq on 2016-06-15:
I still have no idea which angle you are talking about. Note that, as a ROS standard, angles are always represented in radians.
Comment by Kailegh on 2016-06-16:
when you put the velodyne IP in the web browser you can configure it (the image I showed). There is a parameter called FOV, you can change the start and the end, by the defaul is set to 0-359, so the VLP-16 gives a whole turn. If you change it, eg 0-90 the driver does not works properly.

A:

Changes you make in the device configuration menus are not known to the ROS driver.
EDIT: as you discovered, the driver has no knowledge of changes you made in the device configuration page.
For example: if you reconfigure the rotational speed, you also need to set the driver's rpm parameter. But, the driver has no parameters for you to notify it that you have changed the device's field of view.
The point cloud generator does provide an alternative via its view_direction and view_width parameters. Those options have some advantages and disadvantages when compared with changing the device configuration:

A disadvantage is that the device still needs to send the entire 360 degree field of view, which uses more ethernet bandwidth.
An advantage is that the view direction and width can be steered dynamically while the system is running via the various ROS dynamic reconfiguration interfaces.
Most of the system-level overhead is converting the raw data to 3D points. That can be reduced by using those parameters intelligently.

Originally posted by joq with karma: 25443 on 2016-06-15
This answer was ACCEPTED on the original site
Post score: 1

Original comments
Comment by Kailegh on 2016-06-17:
ok, thanks a lot then, I will try my alternative and your proposal and see what works better.
thanks again
Comment by joq on 2016-06-17:
Please report back the results of your experiments.
Comment by Kailegh on 2016-06-23:
excuse me, I know it may be a silly question, but I do not see the view_direction and view_width parameters in the launche files. I see them in the rawdata.cc, and I think they will work fine, but I try passing them as arguments and it does not work for me.
Are you sure everything is ok?
Comment by Kailegh on 2016-06-23:
I mean, where do I have to pass the desired view_direction and view_width?
Thanks a lot
Comment by joq on 2016-06-27:
It's not an argument to the launch scripts. You can make a copy of the cloud_nodelet.launch, and add the appropriate <param ... /> lines. For a quick experiment: run the rqt GUI and select Plugins>Configuration>Dynamic Reconfigure.
Comment by joq on 2016-06-27:
I would accept a pull request adding those parameters as arguments to the various launch scripts.

