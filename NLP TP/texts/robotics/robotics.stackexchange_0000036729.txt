Q:

Splitting work between ROS and a custom motor controller board

I'm designing a hobby bartending robot arm around ROS, and I'm wondering what's the best way to implement motor control.
Some background: I'm using brushed DC motors with homemade encoders controlled by various Atmega microcontrollers + H-bridges. Right now, I'm planning on having them communicate via RS-485, with an Atmega32u4 usb bridge to the computer running ROS.
I looked at how the PR2 motor controller boards work, and the only onboard control they do is a 100kHz control loop around the motor current. All other control is done in a realtime Linux loop and communicated using EtherCAT (more details). I'm tempted to copy what they've done, but I'm worried that my lower-cost approach means more onboard control (ie, position/velocity) will work better.
I'm relatively new to this, so any advice on how to implement it, or even recommendations on a better way to do the multi-drop communications would be greatly appreciated. Thanks!

Originally posted by mrjogo on ROS Answers with karma: 164 on 2011-12-26
Post score: 3

A:

The main motivation behind running all of the PID control loops for the PR2 on the main computer is to reduce the number of languages and environments that a user has to know in order to write software for the PR2.
If you're building your own motor control boards and writing the software for them yourself, putting the postion control on the motor board is probably a better idea. You'll have less data on your bus, because you won't need real-time feedback from all of your encoders, and you won't need to run a realtime kernel on your main computer (the real-time kernel on the PR2 is one of its weak points).
If you're looking for a low-cost system as a model, take a look at the Arbotix board and drivers. It uses an atmel microcontroller as a bridge between the main computer and an AX servo bus, and the AX servos have a built-in microcontroller that does all of the motor and position control.

Originally posted by ahendrix with karma: 47576 on 2011-12-30
This answer was ACCEPTED on the original site
Post score: 2

Original comments
Comment by mrjogo on 2012-01-16:
Ah, that makes a lot of sense. Thanks!

