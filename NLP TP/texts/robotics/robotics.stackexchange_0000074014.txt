Q:

Linking opencv with ROS using cmake issue

Am getting this compilation error

../devel/lib/libXY.so: undefined
reference to `cv::calcOpticalFlowPyrLK

In my CMake
find_package(OpenCV REQUIRED core imgproc highgui videoio  PATHS /home/polar/soft/lib/opencv/opencv-3.1.0/cmake)

... then
target_link_libraries(${file2link}
    ${catkin_LIBRARIES}
    ${MY_LIB}
    ${MY_LIB}
    ${gsl_LIBRARIES}
    # ${Boost_PROGRAM_OPTIONS_LIBRARY} ${Boost_REGEX_LIBRARY}
    ${Boost_LIBRARIES}
    ${OpenCV_LIB} 
    ${OpenCV_LIBRARIES}
    ${OpenCV_LIBS} 
   )

For info, I installled opencv  3.1.0 myself. In XY.h I just call opencv like
#include <opencv2/core/core.hpp>
#include <opencv2/highgui/highgui.hpp>
#include <opencv2/opencv.hpp>
#include "opencv2/video/tracking.hpp"
#include "opencv2/imgproc/imgproc.hpp"
#include "opencv2/imgproc/imgproc_c.h"
#include <opencv2/features2d.hpp>
#include "opencv2/xfeatures2d.hpp"

Any idea on the source of the problem?

Originally posted by polar on ROS Answers with karma: 33 on 2016-05-18
Post score: 0

A:

Make sure you have added all run and build dependencies in your package.xml
If you used catkin_create_package YOUR_PACKAGE_NAME dependecy1 dependency2 as given in http://wiki.ros.org/ROS/Tutorials/catkin/CreatingPackage , then it is automatically added in your package.xml
Otherwise add these and any other dependencies you may need:
 <build_depend>cv_bridge</build_depend>
 <build_depend>image_transport</build_depend>
 <build_depend>roscpp</build_depend>
 <build_depend>sensor_msgs</build_depend>
 <build_depend>std_msgs</build_depend>
 
 <run_depend>cv_bridge</run_depend>
 <run_depend>image_transport</run_depend>
 <run_depend>roscpp</run_depend>
 <run_depend>sensor_msgs</run_depend>
 <run_depend>std_msgs</run_depend>
 <run_depend>OpenCV</run_depend>

Originally posted by A_KN with karma: 16 on 2016-10-12
This answer was ACCEPTED on the original site
Post score: 0

Original comments
Comment by jayess on 2017-08-22:
@A_KN: I edited your answer for you but in the future please make sure to use the Preformatted Text (101010) button to make code snippets easier to read.

