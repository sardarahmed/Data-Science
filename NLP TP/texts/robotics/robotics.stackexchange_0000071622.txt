Q:

ira_laser_tools merger doesn't subscribe to topics from laser in gazebo

Hey together,
please see edit #1 and #2. The node for the laser scanner won't subscribe to the topics given in its parameters in the launch file. But the scan topics are published correctly.
I am trying to merge 3 laserscans together to one. For this I am trying to use the ira_laser_tools packaged and in this the laser_multi_merge.
My setup is following: 3 simulated Lasers in gazebo mounted to my robot, publishing 3 different topics. I am able to view the scan topics in rviz with no problem.
After launching the laser_multi_merger with following launch file part:
<node pkg="ira_laser_tools" name="laserscan_multi_merger" type="laserscan_multi_merger" output="screen">
     <param name="destination_frame" value="/ibeo_frame"/>
     <param name="cloud_destination_topic" value="/merged_cloud"/>
     <param name="scan_destination_topic" value="/scan_multi_merged"/>
     <param name="laserscan_topics" value ="scan_hokuyo1 scan_hokuyo2 scan_ibeo1" /> 
</node>

rostopic list comfirms that the topics /scan_hokuyo1 /scan_hokuyo2 and /scan_ibeo1 are being published.
It also shows the topic /scan_multi_merged, but if I subscribe to it whit rostopic echo /scan_multi_merged the following output appears:
rostopic echo /scan_multi_merged 
WARNING: no messages received and simulated time is active.
Is /clock being published?

If i enable via rqt the debug level of the node it also says that something is wrong with the /clock topic. Output of ROS_DEBUG message:
[DEBUG] [1453887963.432518126, 100.157000000]: Incoming queue full for topic "/clock".  Discarding oldest message (current queue size [0])

Can someone of you lead me to the right way and show me my faults I did?
Thanks in advance :)
Edit #1 Output of rosnode info /laserscan_multi_merger
rosnode info /laserscan_multi_merger 
--------------------------------------------------------------------------------
Node [/laserscan_multi_merger]
Publications: 
 * /laserscan_multi_merger/parameter_descriptions [dynamic_reconfigure/ConfigDescription]
 * /merged_cloud [sensor_msgs/PointCloud2]
 * /rosout [rosgraph_msgs/Log]
 * /laserscan_multi_merger/parameter_updates [dynamic_reconfigure/Config]
 * /scan_multi_merged [sensor_msgs/LaserScan]

Subscriptions: 
 * /tf [tf2_msgs/TFMessage]
 * /tf_static [tf2_msgs/TFMessage]
 * /clock [rosgraph_msgs/Clock]

Services: 
 * /laserscan_multi_merger/set_parameters
 * /laserscan_multi_merger/set_logger_level
 * /laserscan_multi_merger/get_loggers

contacting node http://aschultz-ThinkPad-T450s:42260/ ...
Pid: 21244
Connections:
 * topic: /rosout
    * to: /rosout
    * direction: outbound
    * transport: TCPROS
 * topic: /clock
    * to: /gazebo (http://aschultz-ThinkPad-T450s:33525/)
    * direction: inbound
    * transport: TCPROS
 * topic: /tf
    * to: /vehicle_state_publisher (http://aschultz-ThinkPad-T450s:55570/)
    * direction: inbound
    * transport: TCPROS
 * topic: /tf_static
    * to: /vehicle_state_publisher (http://aschultz-ThinkPad-T450s:55570/)
    * direction: inbound
    * transport: TCPROS

Edit #2: Changed launch file because Laser merger is not subscribing to topics
<node pkg="ira_laser_tools" name="laserscan_multi_merger" type="laserscan_multi_merger" output="screen">
         <param name="destination_frame" value="/ibeo_frame"/>
         <param name="cloud_destination_topic" value="/merged_cloud"/>
         <param name="scan_destination_topic" value="/scan_multi_merged"/>
         <param name="laserscan_topics" value ="/scan_hokuyo1 /scan_hokuyo2 /scan_ibeo1" /> 
 </node>

Output of rostopic info /scan_hokuyo1 /scan_hokuyo2 /scan_ibeo1
rostopic info /scan_hokuyo1
Type: sensor_msgs/LaserScan

Publishers: 
 * /gazebo (http://aschultz-ThinkPad-T450s:51633/)

Subscribers: 
 * /rviz (http://aschultz-ThinkPad-T450s:55316/)

rostopic info /scan_hokuyo2
Type: sensor_msgs/LaserScan

Publishers: 
 * /gazebo (http://aschultz-ThinkPad-T450s:51633/)

Subscribers: 
 * /rviz (http://aschultz-ThinkPad-T450s:55316/)

rostopic info /scan_ibeo1
Type: sensor_msgs/LaserScan

Publishers: 
 * /gazebo (http://aschultz-ThinkPad-T450s:51633/)

Subscribers: 
 * /rviz (http://aschultz-ThinkPad-T450s:55316/)

Originally posted by schultza on ROS Answers with karma: 232 on 2016-01-27
Post score: 2

Original comments
Comment by F.Brosseau on 2016-01-27:
Do you see your topics if you do a "rosnode info laserscan_multi_merger" ?
Comment by schultza on 2016-01-27:
I just see the following
rosnode list /laserscan_multi_merger 
/laserscan_multi_merger

while
rostopic list
/scan_hokuyo1
/scan_hokuyo2
/scan_ibeo1
/scan_multi_merged

gives me this output. So if I understood you correctly I can't see the topics with the command
Comment by F.Brosseau on 2016-01-27:
If you do a rosnode info /laserscan_multi_merger you will see which topics are published and subscribed by the node. It will allow you to check if your topics are connected to your node.
Comment by schultza on 2016-01-27:
Okay. Sorry i had a copy paste error and pastet the output of rosnode list /laserscan_multi_merger which is complete nonsense :D sry. See my edit of my question for the output of rosnode info /laser_scan_merger
Comment by F.Brosseau on 2016-01-27:
Seems like your node is not subscribing to your topics /scan_hokuyo1, /scan_hokuyo2 and /scan_ibeo1. Do these topics are sensor_msgs::LaserScan type?
Comment by schultza on 2016-01-27:
Yeah thats correct. Do you have an idea why or should i open an new topic for that
Comment by schultza on 2016-01-27:
I edited the question with the output of all rostopic info
Comment by F.Brosseau on 2016-01-27:
I have no idea why, sorry. I hope that somebody else will be able to help you.
Comment by F.Brosseau on 2016-01-28:
I look into the git repository of the ira tools and maybe you can try to directly contact the team https://github.com/iralabdisco/ira_laser_tools
Comment by ahendrix on 2016-03-16:
From a quick read of the source code, you should see some kind of message once the merge node starts up; either Subscribing to topics %d or Not subscribed to any topic

A:

Thanks for all your answers!
As ahendrix said, the node really needs the topics to be published before starting the node. However it is not possible to start nodes in a specific order in a launch file. For now we found a solution in letting the node sleep 5 seconds before trying to get the topics (with ros::Duration(5).sleep(); directly in the constructor). This works in simulation as well at our real robot. But it is not a very clean solution. So I will try to get the PR from the link ahendrix posted and look at it again.
Thanks so for :)

Originally posted by schultza with karma: 232 on 2016-03-16
This answer was ACCEPTED on the original site
Post score: 1

