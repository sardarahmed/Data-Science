Q:

rviz segfault OpenGL Warning

I'm currently going through the tf tutorials, and when I try to run rviz it segfaults. I'm running groovy on an ubuntu 12.04 virtualbox VM.
vboxuser@vboxuser-VirtualBox:~$ rosrun rviz rviz -d turtle_tf_configuration
[ INFO] [1372469887.831357672]: rviz version 1.9.30
[ INFO] [1372469887.833052656]: compiled against OGRE version 1.7.4 (Cthugha)
OpenGL Warning: glFlushVertexArrayRangeNV not found in mesa table
OpenGL Warning: glVertexArrayRangeNV not found in mesa table
OpenGL Warning: glCombinerInputNV not found in mesa table
OpenGL Warning: glCombinerOutputNV not found in mesa table
OpenGL Warning: glCombinerParameterfNV not found in mesa table
OpenGL Warning: glCombinerParameterfvNV not found in mesa table
OpenGL Warning: glCombinerParameteriNV not found in mesa table
OpenGL Warning: glCombinerParameterivNV not found in mesa table
OpenGL Warning: glFinalCombinerInputNV not found in mesa table
OpenGL Warning: glGetCombinerInputParameterfvNV not found in mesa table
OpenGL Warning: glGetCombinerInputParameterivNV not found in mesa table
OpenGL Warning: glGetCombinerOutputParameterfvNV not found in mesa table
OpenGL Warning: glGetCombinerOutputParameterivNV not found in mesa table
OpenGL Warning: glGetFinalCombinerInputParameterfvNV not found in mesa table
OpenGL Warning: glGetFinalCombinerInputParameterivNV not found in mesa table
OpenGL Warning: glDeleteFencesNV not found in mesa table
OpenGL Warning: glFinishFenceNV not found in mesa table
OpenGL Warning: glGenFencesNV not found in mesa table
OpenGL Warning: glGetFenceivNV not found in mesa table
OpenGL Warning: glIsFenceNV not found in mesa table
OpenGL Warning: glSetFenceNV not found in mesa table
OpenGL Warning: glTestFenceNV not found in mesa table
OpenGL Warning: Assertion failed: isNewKey, file /mnt/tinderbox/add-4.2/src/VBox/GuestHost/OpenGL/state_tracker/state_texture.c, line 631

#This error repeats several hundred times

[ INFO] [1372469909.140558993]: OpenGl version: 2.1 (GLSL 1.2).
OpenGL Warning: Assertion failed: isNewKey, file /mnt/tinderbox/add-4.2/src/VBox/GuestHost/OpenGL/state_tracker/state_texture.c, line 631
Segmentation fault (core dumped)

Other segfault issues I've seen around have been graphics driver related. It did complain when I forgot to enable 3d acceleration for the VM, and I gave it 88MB of video memory after fixing this.
I did notice a mesa error entry in the troubleshooting article: http://www.ros.org/wiki/rviz/Troubleshooting however it was complaining about not having 3d acceleration initially.
Has anyone come across this error before? Thanks!
EDIT: I managed to get it working. The entry on the wiki was actually helpful. Even though I had enabled the 3D acceleration for the VM, it still wasn't able to support OpenGL. Forcing software only mode with
export LIBGL_ALWAYS_SOFTWARE=1

solved the issue.

Originally posted by AlphaSierra on ROS Answers with karma: 124 on 2013-06-28
Post score: 1

Original comments
Comment by gvdhoorn on 2013-07-04:
According to Chapther 4: Guest Additions - Hardware-accelerated graphics of the VirtualBox manual, you should be able to get accelerated OpenGL in Linux guests?
Comment by AlphaSierra on 2013-07-04:
I do have the guest additions installed, but for some reason it's still not working. At least I have the application running now.
Comment by NickT on 2013-08-07:
I have come across a similar issue using VirtualBox 4.2.16 to host Ubuntu 12.04 trying to run Gazebo. I came across this bug report for VirtualBox https://www.virtualbox.org/ticket/11894 .  Possibly a bug in Virtualbox?
Comment by AlphaSierra on 2013-08-08:
Possibly, I can't really say anything much about the issue. All I can say is the workaround was effective.
Comment by kurt on 2013-08-27:
Hey, I'm running into the exact same issue. Any of {uninstalling guest additions,LIBGL_ALWAYS_SOFTWARE=1,turn off 3d accel option} solve the issue. however, it makes the gazebo simulator impossibly slow. @AlphaSierra, what is your performance like? Would be great to hear from you!
Comment by AlphaSierra on 2013-08-27:
I haven't tried gazebo yet, only rviz. For that application it seems to run fine with the basic stuff that I have tried so far. Why not try running another 3d application like tanks or red eclipse and see if that throws opengl errors? That way we know if the issue is with virtualbox or gazebo.
Comment by NickT on 2013-08-27:
@AlphaSierra I tried with rviz and got the same error as you.  Using a duplicate VM in VMWare Player instead of Virtualbox allowed me to run both rviz and gazebo with 3d enabled with no issues.
Comment by AlphaSierra on 2013-08-27:
That may not work for me. I have my VM setup to use the internal network mode so I can run the IDE and whatnot through PuTTy and XMing. From what I recall using VMWare player it only lets you do NAT networking.

A:

@AlphaSierra  I had the same issue with rviz, which your workaround fixed.  @kurt my interim solution was to export my VBox disk to ova and use VMWare Player instead.  Both rviz and gazebo ran fine with 3d enabled in VMWare Player.

Originally posted by NickT with karma: 16 on 2013-08-27
This answer was ACCEPTED on the original site
Post score: 0

