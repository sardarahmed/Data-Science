Q:

hand_interaction unaligned array assertion

I'm trying to run the detecthands (without skeleton) demo from mit-ros-pkg, and while it runs fine on my laptop (running Ubuntu 10.04 for x86_64) it crashes when I run it on the PC on our robot (which runs Ubuntu 10.10 for i686). Both of them have ROS Diamondback installed.
The demo fails by failing an assertion related to Eigen object alignment, which by reading the backtrace seems to correspond to the "Cause 2" in [1]. This is an issue that arises when using STL containers together with fixed-size vectorizable Eigen objects. In this case, it is raised when push back is called on a std::vector<pcl::PointCloud<pcl::PointXYZ> >, which I guess in turn uses such kind of Eigen objects. See the full gdb backtrace below for more information.
Given the above, I'm not sure if this is an issue that should be treated at the hand_interaction package level or at the pcl package level (or even elsewhere). Any idea or suggestion?
Please ask if I'm missing any important detail.
[1] Explanation of the assertion on unaligned arrays
Full gdb backtrace:
 pre blob time:  0.016093  very few points  no hands detected 
 pre blob time:  0.015678  very few points  no hands detected 
detecthands: /opt/ros/diamondback/stacks/geometry/eigen/include/Eigen/src/Core/DenseStorage.h:69: Eigen::internal::plain_array<T, Size, MatrixOrArrayOptions, 16>::plain_array() [with T = float, int Size = 4, int MatrixOrArrayOptions = 0]: Assertion `(reinterpret_cast<size_t>(array) & 0xf) == 0 && "this assertion is explained here: " "http://eigen.tuxfamily.org/dox/UnalignedArrayAssert.html" " **** READ THIS WEB PAGE !!! ****"' failed.
 pre blob time:  0.016067  
Program received signal SIGABRT, Aborted.
0x0012e416 in __kernel_vsyscall ()
(gdb) bt
#0  0x0012e416 in __kernel_vsyscall ()
#1  0x02329941 in raise () from /lib/libc.so.6
#2  0x0232ce42 in abort () from /lib/libc.so.6
#3  0x023228e8 in __assert_fail () from /lib/libc.so.6
#4  0x0805cfaf in plain_array (this=0x80d1228) at /opt/ros/diamondback/stacks/geometry/eigen/include/Eigen/src/Core/DenseStorage.h:69
#5  DenseStorage (this=0x80d1228) at /opt/ros/diamondback/stacks/geometry/eigen/include/Eigen/src/Core/DenseStorage.h:105
#6  PlainObjectBase (this=0x80d1228) at /opt/ros/diamondback/stacks/geometry/eigen/include/Eigen/src/Core/PlainObjectBase.h:371
#7  Matrix (this=0x80d1228) at /opt/ros/diamondback/stacks/geometry/eigen/include/Eigen/src/Core/Matrix.h:293
#8  Quaternion (this=0x80d1228) at /opt/ros/diamondback/stacks/geometry/eigen/include/Eigen/src/Geometry/Quaternion.h:231
#9  pcl::PointCloud<pcl::PointXYZ>::PointCloud (this=0x80d1228) at /opt/ros/diamondback/stacks/perception_pcl/pcl/include/pcl/point_cloud.h:81
#10 0x0805fd10 in construct (this=0xbfffee48, __position=..., __x=...) at /usr/include/c++/4.4/ext/new_allocator.h:105
#11 std::vector<pcl::PointCloud<pcl::PointXYZ>, std::allocator<pcl::PointCloud<pcl::PointXYZ> > >::_M_insert_aux (this=0xbfffee48, __position=..., __x=...) at /usr/include/c++/4.4/bits/vector.tcc:330
#12 0x08057403 in push_back (cloud=..., clouds=..., nearcents=...) at /usr/include/c++/4.4/bits/stl_vector.h:741
#13 getNearBlobs2 (cloud=..., clouds=..., nearcents=...) at /home/pekee/ros_overlay/diamondback/kinect_demos/mit-ros-pkg/kinect_utils/hand_interaction/src/detect_hands.cpp:265
#14 0x08069771 in HandDetector::cloudcb (this=0xbffff3e0, scan=...) at /home/pekee/ros_overlay/diamondback/kinect_demos/mit-ros-pkg/kinect_utils/hand_interaction/src/detect_hands.cpp:375
#15 0x0805ea45 in operator() (function_obj_ptr=..., a0=...) at /usr/include/boost/function/function_template.hpp:1013
#16 boost::detail::function::void_function_obj_invoker1<boost::function<void(const boost::shared_ptr<const sensor_msgs::PointCloud2_<std::allocator<void> > >&)>, void, boost::shared_ptr<const sensor_msgs::PointCloud2_<std::allocator<void> > > >::invoke(boost::detail::function::function_buffer &, boost::shared_ptr<sensor_msgs::PointCloud2_<std::allocator<void> > const>) (function_obj_ptr=..., a0=...) at /usr/include/boost/function/function_template.hpp:153
#17 0x08063770 in operator() (this=0x80d0398, params=...) at /usr/include/boost/function/function_template.hpp:1013
#18 ros::SubscriptionCallbackHelperT<boost::shared_ptr<sensor_msgs::PointCloud2_<std::allocator<void> > const> const&, void>::call (this=0x80d0398, params=...)
    at /opt/ros/diamondback/stacks/ros_comm/clients/cpp/roscpp/include/ros/subscription_callback_helper.h:173
#19 0x01e78d72 in ros::SubscriptionQueue::call (this=0x80d05e8) at /tmp/buildd/ros-diamondback-ros-comm-1.4.5/debian/ros-diamondback-ros-comm/opt/ros/diamondback/stacks/ros_comm/clients/cpp/roscpp/src/libros/subscription_queue.cpp:164
#20 0x01ebd54a in ros::CallbackQueue::callOneCB (this=0x80c2908, tls=0x80d1700)
    at /tmp/buildd/ros-diamondback-ros-comm-1.4.5/debian/ros-diamondback-ros-comm/opt/ros/diamondback/stacks/ros_comm/clients/cpp/roscpp/src/libros/callback_queue.cpp:381
#21 0x01ebdc3f in ros::CallbackQueue::callAvailable (this=0x80c2908, timeout=...)
    at /tmp/buildd/ros-diamondback-ros-comm-1.4.5/debian/ros-diamondback-ros-comm/opt/ros/diamondback/stacks/ros_comm/clients/cpp/roscpp/src/libros/callback_queue.cpp:333
#22 0x01ec4210 in ros::SingleThreadedSpinner::spin (this=0xbffff3ac, queue=0x80c2908)
    at /tmp/buildd/ros-diamondback-ros-comm-1.4.5/debian/ros-diamondback-ros-comm/opt/ros/diamondback/stacks/ros_comm/clients/cpp/roscpp/src/libros/spinner.cpp:49
#23 0x01e487e9 in ros::spin (s=...) at /tmp/buildd/ros-diamondback-ros-comm-1.4.5/debian/ros-diamondback-ros-comm/opt/ros/diamondback/stacks/ros_comm/clients/cpp/roscpp/src/libros/init.cpp:493
#24 0x01e48819 in ros::spin () at /tmp/buildd/ros-diamondback-ros-comm-1.4.5/debian/ros-diamondback-ros-comm/opt/ros/diamondback/stacks/ros_comm/clients/cpp/roscpp/src/libros/init.cpp:488
#25 0x08057739 in main (argc=1, argv=0xbffff574) at /home/pekee/ros_overlay/diamondback/kinect_demos/mit-ros-pkg/kinect_utils/hand_interaction/src/detect_hands.cpp:424

Originally posted by Miguel Prada on ROS Answers with karma: 1071 on 2011-05-23
Post score: 1

A:

same problem as: http://answers.ros.org/question/981/eigen-package-error-while-running-tod_detecting  (?)

Originally posted by Straszheim with karma: 426 on 2011-06-17
This answer was ACCEPTED on the original site
Post score: 0

