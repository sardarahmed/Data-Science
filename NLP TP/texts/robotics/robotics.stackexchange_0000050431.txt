Q:

kill python listener which opened matplotlib figure

Hello,
i wrote a visualization with matplotlib in python.
import matplotlib.pyplot as plt

def callback(data):
do something
plt.show()

def listener():
rospy.Subscriber('topic', data, callback)
rospy.spin()

 Main function.
if __name__ == '__main__':
# Initialize the node and name it.

   rospy.init_node('pylistener', anonymous = True)
   # Go to the main loop.
   listener()

i want to print my figure. The problem is when he get a message he stop till i close the figure. That is fine. But when i want to close the program with ctrl+c the program crash and i have to close the terminal.
It is possible to kill the node and the python program after i close the figure?
Or what i can do against this crashing? It is really annoying that i have to close the terminal and restart it.
thank you for your help and sry i am new on python

Originally posted by Hunk on ROS Answers with karma: 222 on 2013-04-16
Post score: 1

Original comments
Comment by SL Remy on 2013-04-19:
Also, where do you define data?

A:

My guess is that you're sending more than just one data packet, thus attempting plot more than once. That's the reason why it hangs.
ps -ef in another terminal will show you the PID for the program and a kill PID should stop the process.
In any case, to get past the core issue, I'd suggest using savefig saving files with a unique name, appending timestamp is one approach, and the you can print at your leisure. You should use clf after you save the figure though.

Originally posted by SL Remy with karma: 2022 on 2013-04-17
This answer was ACCEPTED on the original site
Post score: 0

Original comments
Comment by Hunk on 2013-04-17:
yes i send more then one message. It is not possible to kill the node and the python program after i received the first one and I closed the figure?
Comment by SL Remy on 2013-04-17:
if you kill the node then the data that you're also killing the subscriber to the data that trying to plot.
Comment by SL Remy on 2013-04-17:
My suggestion is to use savefig/clf instead of using show(), since that method "block[s] until the figures have been closed"
Comment by Hunk on 2013-04-18:
I only want to see one plot. So it doesn't matter if my plot get more data. When i save my figure i get every time i receive the message a new identical  file.
Comment by SL Remy on 2013-04-19:
Is the published data actually changing? (rostopic echo -p /yourtopic)...

