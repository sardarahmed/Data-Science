Q:

Problem with catkin_make

One of my teamates can't compile our school project. The catkin_make command give this error :
ImportError: "from catkin_pkg.topological_order import topological_order" failed: No module named catkin_pkg.packages
Make sure that you have installed "catkin_pkg", it is up to date and on the PYTHONPATH.

We compared our PYTHONPATH and we have the same :
/opt/ros/groovy/lib/python2.7/dist-packages

We tried to reinstall ROS completely, but it doesn't work even after that.
Any suggestion to fix this?

Originally posted by phbou72 on ROS Answers with karma: 130 on 2013-03-03
Post score: 7

Original comments
Comment by dornhege on 2013-03-03:
Did you do sudo apt-get install python-catkin-pkg? It should tell you that it's already installed.
Comment by phbou72 on 2013-03-03:
Yes we dit.
Comment by KruseT on 2013-03-03:
And if so, make sure there is no old version of catkin_pkg in /usr/local/lib/python2.7/dist-packages
Comment by phbou72 on 2013-03-03:
What should we do? Delete catkin_pkg in  /usr/local/lib/python2.7/dist-packages?
Comment by joq on 2013-03-03:
Yes, delete any catkin stuff in /usr/local.
Comment by phbou72 on 2013-03-03:
There's nothing : (. His ubuntu install is almost pristine too...

A:

sudo apt-get install python-catkin-pkg
sudo rm -rf /usr/local/lib/python2.7/dist-packages/catkin*
sudo dpkg -L python-catkin-pkg

This shows you where apt installed catkin_pkg to, this one should be found.

python -c 'import catkin_pkg; print(catkin_pkg.file)'

This shows you where it actually finds catkin_pkg, if it is different from the above, delete the folder

python -c 'import sys; print(sys.path)'

This shows you all places where it looks for catkin_pkg
UPDATE:
python2.7 finds the installed code at /usr/lib/pymodules/python2.7, As explained by @joq. if you do not see catkin_pkg folder in there, you need to
sudo apt-get install --reinstall python-catkin-pkg

Originally posted by KruseT with karma: 7848 on 2013-03-03
This answer was ACCEPTED on the original site
Post score: 9

Original comments
Comment by oferbtl on 2013-10-08:
Using the above, I found that my catkin_pkg is installed in '/usr/share/pyshared/catkin_pkg', so I added this to my .bashrc file:
export PYTHONPATH=/usr/share/pyshared:${PYTHONPATH}
Comment by joq on 2013-10-08:
The package installs there, but it is not where PYTHONPATH should point. Post-install should have created compiled modules for each python version you have installed, e.g. /usr/lib/pymodules/python2.7/catkin_pkg/*. Those should be in your python path automatically.
Comment by KruseT on 2013-10-24:
Could reproduce on some machine with electirc and fuerte installed. When running sudo aptitude reinstall python-catkin-pkg, the relay code appeared.
Comment by Mo on 2013-12-18:
@joq, I tried the: "sudo apt-get install --reinstall python-catkin-pkg" and it did install the catkin_pkg in /usr/lib/pymodules/python2.7. However, I checked afterward and did not find that folder in the python search path (python also failed to import the catkin_pkg).
I manually appended the path to the PYTHONPATH and python succeeded to find the catkin_pkg. However, I hesitate to change the PYTHONPATH and was hoping that the post install adds it to the search path, but it doesn't seem so. Is it supposed to? what could be wrong? I would appreciate your help. Thanks.
Comment by joq on 2013-12-18:
That should be in your PYTHONPATH. Did you source /opt/ros/groovy/setup.bash correctly? What does echo $PYTHONPATH show?
Comment by Dirk Thomas on 2013-12-18:
catkin_pkg is a system package - not a catkin package. It is not necessary to source any setup file nor does the PYTHONPATH need to be set.
Comment by Dirk Thomas on 2013-12-18:
@Mo please consider posting the output of the commands (especially 3, 4 and 5) @KruseT has mentioned in his answer for further help.
Comment by Mo on 2013-12-18:
Thanks for the reply. I source the setup.bash since afterward I want to catkin a workspace. Below are the variables and python search path. Please note this is running on a test server (travis).
*** Sourcing ROS setup: /opt/ros/hydro
ROS_PACKAGE_PATH: /opt/ros/hydro/share:/opt/ros/hydro/stacks
***PYTHONPATH: /opt/ros/hydro/lib/python2.7/dist-packages
***Python search path (sys.path):
['', '/opt/ros/hydro/lib/python2.7/dist-packages', '/home/travis/virtualenv/python2.7/lib/python2.7', '/home/travis/virtualenv/python2.7/lib/python2.7/plat-linux2', '/home/travis/virtualenv/python2.7/lib/python2.7/lib-tk', '/home/travis/virtualenv/python2.7/lib/python2.7/lib-old', '/home/travis/virtualenv/python2.7/lib/python2.7/lib-dynload', '/usr/lib/python2.7', '/usr/lib/python2.7/plat-linux2', '/usr/lib/python2.7/lib-tk', '/home/travis/virtualenv/python2.7/local/lib/python2.7/site-packages', '/home/travis/virtualenv/python2.7/lib/python2.7/site-packages']
Comment by Mo on 2013-12-18:
This thread raises a similar issue (read through comments) with no resolution: http://answers.ros.org/question/44669/fuerte-no-module-named-rospkg/
Comment by Dirk Thomas on 2013-12-18:
Your comment is unreadable. Please update your original question with the information and format them to be readable.
Comment by Mo on 2013-12-18:
I am sorry about that (I am not sure how to format it so it looks better). Anyway, here is the PYTHONPATH after sourcing setup.bash: /opt/ros/hydro/lib/python2.7/dist-packages.
Comment by Dirk Thomas on 2013-12-18:
You are using a virtualenv. You might need to install catkin_pkg into your virtual environment in order to be findable.
Comment by Mo on 2013-12-18:
And here is the sys.path: ['', '/opt/ros/hydro/lib/python2.7/dist-packages', '/home/travis/virtualenv/python2.7/lib/python2.7', '/home/travis/virtualenv/python2.7/lib/python2.7/plat-linux2', '/home/travis/virtualenv/python2.7/lib/python2.7/lib-tk'...
Comment by Mo on 2013-12-18:
Thanks @Dirk, that might be it. Would installing through pip do it?
Comment by Dirk Thomas on 2013-12-18:
Yes.......
Comment by Mo on 2013-12-18:
Thanks. Yes, you are right. I was not aware of the test server running the setup script in a virtual env. I used pip install and that did it.

