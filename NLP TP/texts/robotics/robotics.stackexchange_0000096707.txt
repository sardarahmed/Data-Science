Q:

Best practice for the correct user setup within a ROS docker container?

docker ros states: By default, the container runs as the root user
http://wiki.ros.org/rosdep states:
Do NOT run rosdep update with sudo. It is not required and will result in permission errors later on.
Trying to follow http://docs.ros.org/melodic/api/moveit_tutorials/html/doc/getting_started/getting_started.html, running in osrf/ros:melodic-desktop-full  I am getting to Warning: running 'rosdep update' as root is not recommended. as below
Is there a recommended best practice for the correct user setup within a ROS docker container?

docker run -it -v ~/catkin_wses:/root osrf/ros:melodic-desktop-full

root@0ebd9e5101b5:/# cd /root/ws_moveit-tuts/src/

root@0ebd9e5101b5:~/ws_moveit-tuts/src# rosdep update

reading in sources list data from /etc/ros/rosdep/sources.list.d
Warning: running 'rosdep update' as root is not recommended.

Originally posted by bgraysea on ROS Answers with karma: 29 on 2020-08-03
Post score: 1

Original comments
Comment by doisyg on 2022-10-06:
On the same topic, is it possible to init and update rosdep at the creation of the docker so it is available and ready for the user (regular account) ? I can do it but then the user has to use sudo before for intance 'rosdep install'. Anyway to do it without sudo, i.e. init and update rosdep in the Dockerfile as a regular user ?

A:

http://wiki.ros.org/rosdep states: Do NOT run rosdep update with sudo. It is not required and will result in permission errors later on.

What that page writes is good advice, for normal usage scenarios.
Setting up a Docker image is "not" normal usage, in the sense that typically, everything in a Docker container runs as root (by default).
The potential issues wiki/rosdep is warning about are what you can run into when first running things as root and then switching to a regular account. But as I wrote above, that's typically not how Dockerfiles are written.
So I believe what you are doing is OK -- inside a Docker image.

Originally posted by gvdhoorn with karma: 86574 on 2020-08-03
This answer was ACCEPTED on the original site
Post score: 1

Original comments
Comment by gvdhoorn on 2020-08-03:
But of course: if you later switch to another user in a Docker container, then you should be mindful of the recommended usage of rosdep.

