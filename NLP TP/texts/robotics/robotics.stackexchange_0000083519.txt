Q:

robot_localization navsat_transform yaw offset and phidgets imu

Hi,
I am currently using the robot_localization package for the state estimation of my robot. I also have a RTK GPS Device which I would like to include in robot_localization. The problem is that I don't know my yaw offset because I am using a phidgets IMU and I am not including the magnetic field when using the madgwick orientation filter because that causes poor results as the IMU is located close to the motor.
My idea would be to calculate the yaw offset by getting the course over ground from my GPS-Receiver. I would then first start navsat_transform when I calculated the new yaw offset or I would add a service to navsat_transform to set the yaw offset during runtime.
Has any one had similar problems and a good solution?

Originally posted by blasalat on ROS Answers with karma: 51 on 2017-10-25
Post score: 0

A:

It's not so much that you need the offset; you just need an earth-referenced heading. The yaw_offset and magnetic_declination parameters are there to allow you to compensate for the fact that (a) most magnetometers read 0 at north, not east, and (b) they read 0 at magnetic north, not true north.
So you could just calculate that heading from course over ground and generate a sensor_msgs/Imu message that navsat_transform_node would listen to instead of your actual IMU message. Just make sure it conforms to standards: a heading of 0 means you are moving directly east, and turning left is positive rotation. I would imagine course over ground assumes 0 at north, so you can either manually adjust for that in your course-over-ground-heading-node, or you can set yaw_offset to pi/2.

Originally posted by Tom Moore with karma: 13689 on 2018-01-24
This answer was ACCEPTED on the original site
Post score: 1

