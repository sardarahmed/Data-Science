Q:

Static object in Gazebo moves in RViz with respect to the world frame

Hi community!
There is a pillar in my gazebo simulation world and a cart driving around, as shown below:

https://drive.google.com/file/d/1DKzFzQuhfnstqBMqZySwT_iA2Ue1EEUF/view?usp=sharing

When the Rviz starts, the pillar is at the same location as in the gazebo world, with respect to the odom frame:

https://drive.google.com/file/d/1TJSSLlfdwrIELialTmtBYpUPelH-sPfs/view?usp=sharing

However, when the cart is moving, the pillar's location is strangely changing:

https://drive.google.com/file/d/1icZQgp5Dh-X6WpwHY5lkD0zPmc1vRr1S/view?usp=sharing

Why is it the case? And how could I fix it? Sorry I just joined the community and I could only post link with images. Thank you so much for your consideration and help!
Appreciatively,
William
PS: The tf trees is attached:

https://drive.google.com/file/d/1_Dby3Ofx_Pulx2YakEkmLIfy3jYDW20W/view?usp=sharing

Originally posted by WilliamLinOuO on ROS Answers with karma: 16 on 2023-02-24
Post score: 0

Original comments
Comment by Davies Ogunsina on 2023-02-24:
Can you set your fixed frame to base_link or your robot base frame  and see if the pillar still moves while teleoperating your robot.
Comment by WilliamLinOuO on 2023-02-26:
Hi Davies, thanks for your reply! I tried and it doesn't work, the pillar wrt odom is still moving as the cart moves, moreover, if I set the fixed frame to base_link the grid is moving with the cart now. What I would like to achieve is the grid of the world frame is fixed with odom, while the pillar is static as it's in the gazebo simulation.
Comment by Davies Ogunsina on 2023-02-26:
If you set your fixed  frame to odom , it tracks the pose of the robot ..tell you where the robot is when visualising with  rviz .what is your tf tree like ?
Comment by WilliamLinOuO on 2023-02-26:
Hi Davies, the tree is shown on the left of the updated picture in the original question.

A:

I got the answer: the coordinate system in rviz is based on odom, which is an estimation of the robot's coordinate and it's not the "real" coordinate in Gazebo. There are many reasons these two coordinates don't fit: the wheels slip when you give a large velocity command; in this case, the robot doesn't move in "real" world, but in odom(the estimation of coordinate), the estimator "thinks" it moves forward already. What the laserscan returns are the relative coordinates of the point cloud wrt the cart, which is correct; only the cart's estimated coordinate wrt the world's origin is wrong. This is why the point cloud's relative position wrt to the cart is correct but the position wrt to the world's origin is wrong.

Originally posted by WilliamLinOuO with karma: 16 on 2023-02-27
This answer was ACCEPTED on the original site
Post score: 0

Original comments
Comment by Davies Ogunsina on 2023-02-27:
So the right fixed frame is odom.
Comment by WilliamLinOuO on 2023-02-27:
Indeed, if the estimated states are accurate, the coordinates in Rviz would be the same as in Gazebo.

