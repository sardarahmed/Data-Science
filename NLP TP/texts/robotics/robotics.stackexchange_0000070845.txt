Q:

Transform a pose to another frame with tf2 in Python

I have a pose stamped given in camera frame. Now I want to transform the pose to get its coordinates in the base_link frame.

Originally posted by fivef on ROS Answers with karma: 2756 on 2015-12-10
Post score: 9

A:

Import the needed modules:
import tf2_ros
import tf2_geometry_msgs

Initialize the tf buffer and listener somewhere in your init function:
tf_buffer = tf2_ros.Buffer(rospy.Duration(100.0))  # tf buffer length
tf_listener = tf2_ros.TransformListener(self.tf_buffer)

Do the actual transformation:
transform = tf_buffer.lookup_transform(target_frame,
                                       # source frame:
                                       pose_stamped.header.frame_id,
                                       # get the tf at the time the pose was valid
                                       pose_stamped.header.stamp,
                                       # wait for at most 1 second for transform, otherwise throw
                                       rospy.Duration(1.0))

pose_transformed = tf2_geometry_msgs.do_transform_pose(pose_stamped, transform)

Originally posted by fivef with karma: 2756 on 2015-12-10
This answer was ACCEPTED on the original site
Post score: 16

Original comments
Comment by bit-pirate on 2016-03-22:
The lookup should better be wrapped inside a try-except block in case the transform is not found: http://wiki.ros.org/tf2/Tutorials/Writing%20a%20tf2%20listener%20%28Python%29#The_Code_Explained

