Q:

Maximum mapping distance rtabmap

Hi,
I am using a Kinect.
Is there a way to set the max mapping distance to like 3.5 Meters to prevent noise from being in the image?

Originally posted by gijsje170 on ROS Answers with karma: 171 on 2017-01-13
Post score: 0

A:

Hi,
In rtabmapviz, this parameter is under Preferences->3D Rendering. In RVIZ, the rtabmap_ros/MapCloud plugin has also this parameter. For the output /rtabmap/cloud_map, the ros parameter (default 4 meters) is cloud_max_depth (for rtabmap < 0.11.11) or Grid/DepthMax (for rtabmap >= 0.11.11).
EDIT
To limit the distance of the extracted visual features used for visual odometry or loop closure detection, the parameter is Vis/MaxDepth. You can set it in rtabmap_args:="--Vis/MaxDepth 3.5" or in launch file:
<node pkg="rtabmap_ros" type="rtabmap" name="rtabmap">
   ...
   <param name="Vis/MaxDepth" type="string" value="3.5"/> <!-- loop closure detection -->
</node>
<node pkg="rtabmap_ros" type="rgbd_odometry" name="rgbd_odometry">
   ...
   <param name="Vis/MaxDepth" type="string" value="3.5"/> <!-- odometry -->
</node>

Note that parameter Vis/EstimationType set to 1 (PnP transform estimation) is more robust to far noisy features.
cheers,
Mathieu

Originally posted by matlabbe with karma: 6409 on 2017-01-13
This answer was ACCEPTED on the original site
Post score: 0

Original comments
Comment by gijsje170 on 2017-01-16:
I am using rtabmap 0.11.8 but whenever I use my launch file with the adjusted parameters it will continue mapping to far away. Also tried changing the Vis/Maxdepth without any result.
Comment by matlabbe on 2017-01-16:
Can you tell which topic is the problem?
Comment by gijsje170 on 2017-01-16:
Hi, I think the depthimage, the problem is because it is taking points from a large distance much noise comes into the image + the ceiling. Is there a way to only take points which are closer then like 2 meters or something?
Comment by matlabbe on 2017-01-16:
Updated answer.
Comment by gijsje170 on 2017-01-17:
Hi matlabbe I think I am a big to vague, I want to only map points which are closer then 3.5 meters. So still take features from the points far away but only put the points in the map when they are closer then 3.5 meter from the Kinect.
Comment by matlabbe on 2017-01-23:
Can you add an image of which points you are referring. For the point cloud in rtabmapviz, in Preferences->3D Rendering there is a Max Depth parameters that can be set for example so the 3D point cloud map includes only points under this range from the kinect.

