Q:

Get forward kinematics tutorial failed

I've tried this tutorial
But the service call failed, and I got the following error on the terminal where I ran [ roslaunch pr2_3dnav right_arm_navigation.launch ]:
[ERROR] [1354979145.382429702, 11715.590000000]: client wants service /pr2_right_arm_kinematics/get_fk to have md5sum 47de11a2bc125445e74531db0e2d1c21, but it has 2088007c8963e2252a67c872affa0985. Dropping connection.

If I do [ rosrun pr2_arm_navigation_tutorials get_fk ], the service call will succeed and get the correct result. But if I copy and paste the same code and run from my own package, it gets the above problem.
I'm using Fuerte.
Any idea? Thanks~

modified):
files that contain md5 [47de11a2bc125445e74531db0e2d1c21]:
/opt/ros/fuerte/lib/python2.7/dist-packages/kinematics_msgs/srv/_GetPositionFK.py
/opt/ros/fuerte/share/common-lisp/ros/kinematics_msgs/srv/GetPositionFK.lisp
/opt/ros/fuerte/include/kinematics_msgs/GetPositionFK.h

Originally posted by Albert K on ROS Answers with karma: 301 on 2012-12-08
Post score: 1

A:

The tutorial seems to be written for electric. Are you building the code for electric? The message hints that you have an inconsistent ROS setup. You are probably mixing distributions or release versions between who provides the service and the node calling it.
Make sure that the ROS node providing the service is using the same service definition as your code.
The service definition has changed between distributions:

electric GetPositionFK
fuerte GetPositionFK

Originally posted by dornhege with karma: 31395 on 2012-12-08
This answer was ACCEPTED on the original site
Post score: 1

Original comments
Comment by Albert K on 2012-12-09:
My working environment is Feurte, but isn't Feurte compatible with Electric? The server node is from pr2_arm_kinematics/pr2_arm_kinematics_node. Could you give an example about different service definition? Thanks~
Comment by dornhege on 2012-12-09:
No, in general different distributions are not compatible. You can mix them, but you should not rely on that working. The most obvious example is the service you are using.
Comment by Albert K on 2012-12-09:
OK...I see the difference. But I install the package <pr2_kinematics> in Feurte using [apt-get install ros-fuerte-pr2-kinematics], shouldn't I suppose that this node/service is meant for Feurte? Besides installing another ros distribution (Electric), what else can I do to solve this problem? Thanks
Comment by dornhege on 2012-12-09:
Yes, definitely. My suspicion would be that you are mixing in old code. Try enabling electric/fuerte and do rossrv md5 on the service type. That should show you the md5 sums. Then you can compare what you get in the error.
Comment by Albert K on 2012-12-10:
I type : [rossrv md5 GetPositionFK] and get [kinematics_msgs/GetPositionFK]: 47de11a2bc125445e74531db0e2d1c21. I don't know what "rossrv md5" mean, does that mean I use the old version?
Comment by dornhege on 2012-12-10:
It means that whatever you are running/connecting to has another service definition than you have on your system as what you have setup now. My suspicion is that you are connecting to an electric system with your fuerte code.
Comment by Albert K on 2012-12-10:
The weird point I can't understand is that the server node and all the system is install using ros-fuerte-* , how come that node is from older distribution?
Comment by Albert K on 2012-12-10:
albert@Albert-PC:/opt/ros$ ls
fuerte
Comment by dornhege on 2012-12-10:
Something seems odd, I get: rossrv md5 kinematics_msgs/GetPositionFK
2088007c8963e2252a67c872affa0985, which seems to be the right one that your service also provides.
Comment by Albert K on 2012-12-10:
Does that mean my kinematics_msgs package is old? I open GetPositionFK.srv and find that the definition is the same as the Fuerte one.
Comment by dornhege on 2012-12-10:
What does rospack find kinematics_msgs point to? Maybe you can manually check the file in kinematics_msgs/srv_gen/cpp/include/kinematics_msgs/GetPositionFK.h and what md5 sum is in there somewhere.
Comment by dornhege on 2012-12-10:
You should do this from the same terminal that you build the tutorial from.
Comment by Albert K on 2012-12-10:
It points to "/opt/ros/fuerte/stacks/arm_navigation/kinematics_msgs". However, if I search the header file, I can only find 2088007c8963e2252a67c872affa0985 while I still get 47de11a2bc125445e74531db0e2d1c21 from rossrv md5 kinematics_msgs/GetPositionFK
Comment by dornhege on 2012-12-10:
Interesting... What do you get for echo $ROS_ROOT and echo $ROS_PACKAGE_PATH.
I suspect the md5 in src/kinematics_msgs/srv/_GetPositionFK.py is also 208...?
Comment by Albert K on 2012-12-10:
I get "/opt/ros/fuerte/share/ros" for     echo $ROS_ROOT
and "/home/albert/fuerte_workspace/sandbox:/opt/ros/fuerte/stacks:/opt/ros/fuerte/share:/opt/ros/fuerte/share/ros" for     echo $ROS_PACKAGE_PATH
The md5sum in _GetPositionFK.py is 2088007c8963e2252a67c872affa0985
Comment by dornhege on 2012-12-10:
Everything seems fine... Could you remove the sandbox and recheck rossrv md5 ...? Otherwise I'm out of ideas.
Comment by Albert K on 2012-12-11:
I've tried three other computer (with same environment), and got the same error. But I found something interesting. I tried to find all the files that contain the wrong md5 47de11a2bc125445e74531db0e2d1c21, and append the list of files to the original question.
Comment by Albert K on 2012-12-11:
I doubt that rosmake tried to link the header file [/opt/ros/fuerte/include/kinematics_msgs/GetPositionFK.h], which has the md5=47de..., rather than [/opt/ros/fuerte/stacks/arm_navigation/kinematics_msgs/srv_gen/cpp/include/kinematics_msgs/GetPositionFK.h], which has the md5=2088...
Comment by dornhege on 2012-12-11:
Actually I think it will. For me those FHS-compliant files do not exist under /opt/ros/fuerte/include/kinematics_msgs. What ubuntu version are you using? Did you maybe do a manual install for ROS at some time?
Comment by dornhege on 2012-12-11:
I guess the easiest solution would be to uninstall ros completely, check that /opt/ros/fuerte is empty and reinstall that. (Besides time and network load that shouldn't be an issue). A clean ROS install shouldn't disagree about the headers md5 sums anymore. If it does, it is a bug.
Comment by Albert K on 2012-12-11:
My Ubuntu is 12.04 and I only install ros-related package using apt-get install, no svn or hg. I would try to ask a question about the include header problem in rosanswer first. If no solution though, I will clean it up and reinstall. Thanks a lot for your help~!
Comment by Albert K on 2012-12-11:
I tried to manually install kinematics_msgs using [svn co https://code.ros.org/svn/wg-ros-pkg/stacks/kinematics/trunk]. However, when I tried to rosamke it, it said that missing dependency motion_planning_msgs, which belonged to the service definition of electric distribution.
Comment by dornhege on 2012-12-11:
I wouldn't go for repository versions. The fuerte debian package should all fit together. My suspicion is that somehow something get messed up. A ROS reinstall from a clean /opt/ros should fix that.
Comment by Albert K on 2012-12-12:
I've asked another question http://answers.ros.org/question/50241/wrong-header-included-by-compiler/, instead of cleaning ros up and reinstall, we can simply remove ros-fuerte-moveit-msgs. Thanks for the efforts you've spent on solving this problem!

