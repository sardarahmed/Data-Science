Q:

How to use variable's value (subscriber function) in another function

Hello all !
I want to pass the variable which is set to its value when called the callback function. and then want to use the value of the variable in another function.
def where1(msg):
    global x1
    x1 = msg.data
    
def where2(gsm):
    global y1
    y1 = gsm.data
def ground():
    global x1
    global y1
    rospy.init_node("ground")
    rospy.Subscriber("/box_positiona", Float64, where1)
    rospy.Subscriber("/box_positionb", Float64, where2)
        
    print x1
    print y1
    rospy.spin() # this will block untill you hit Ctrl+C

if __name__ == '__main__':
    try:
            ground()
    except rospy.ROSInterruptException:
            rospy.loginfo("Ground  motion node is shut down.")

But i got the following error
print x1
NameError: global name 'x1' is not defined

Originally posted by jashanvir on ROS Answers with karma: 68 on 2014-06-30
Post score: 0

A:

You are printing values, i.e. x1, y1 before they have been assigned. The subscribers won't do anything until spin is called and messages are received.

Originally posted by dornhege with karma: 31395 on 2014-06-30
This answer was ACCEPTED on the original site
Post score: 1

Original comments
Comment by jashanvir on 2014-06-30:
But when i check by rostopic echo /box_positiona then it prints the data ?
Comment by jashanvir on 2014-07-01:
how to get the values from the callback function and use them ? Can you give me the reference or a simple demo code which i can use. ! @dornhege
Comment by McMurdo on 2014-07-01:
Try putting your spin() above the print statements.
Comment by jashanvir on 2014-07-01:
@McMurdo no, it doesnt help...
it prints the value when i terminate the program using ctrl+c
Comment by jashanvir on 2014-07-01:
@McMurdo no it shows the same error, but this time when i terminate the program.
Comment by dornhege on 2014-07-02:
Check your own comment. The spin will retrieve the messages and BLOCK. You should handle message data in the callbacks.
Comment by jashanvir on 2014-07-03:
Yeah ! I know..
But I solved the problem by putting all these in one class.
Comment by DannyMB on 2016-10-13:
@jashanvir Hi, can you explain me how do you solved that? I have the same error, other thing, how do you do for use Float64? I am new, and a few noob, in ROS.

