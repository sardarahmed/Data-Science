Q:

rosdep update Permission error

Hi there, can't figure this out.
After following this to the letter:
http://wiki.ros.org/fuerte/Installation/Ubuntu
I am now trying to follow this:
http://robohub.org/up-and-flying-with-the-ar-drone-and-ros-getting-started/
Running 'rosdep update' does not work. I keep getting a permission error regarding some temporary pickle files in .ros/rosdep/sources.cache . I have tried setting all files in that directory to have all permissions for others but this has not worked. I've tried purging, reinstalling, etc, doesn't work. I cannot find a process that fixes this.
Any help at all would be greatly appreciated. Below is a complete error readout:
thursday@daedalus:~$ rosdep update
reading in sources list data from /etc/ros/rosdep/sources.list.d

ERROR: Rosdep experienced an error: [Errno 13] Permission denied: '/home/thursday/.ros/rosdep/sources.cache/5f44c73fb5a0e187f088839519d453ff8aa3699e.pickle.tmp.UGtFKu'
Please go to the rosdep page [1] and file a bug report with the stack trace below.
[1] : CANNOTPOSTHYPERLINK

rosdep version: 0.10.27

Traceback (most recent call last):
  File "/usr/lib/pymodules/python2.7/rosdep2/main.py", line 121, in rosdep_main
    exit_code = _rosdep_main(args)
  File "/usr/lib/pymodules/python2.7/rosdep2/main.py", line 277, in _rosdep_main
    return _no_args_handler(command, parser, options, args)
  File "/usr/lib/pymodules/python2.7/rosdep2/main.py", line 285, in _no_args_handler
    return command_handlers[command](options)
  File "/usr/lib/pymodules/python2.7/rosdep2/main.py", line 456, in command_update
    error_handler=update_error_handler)
  File "/usr/lib/pymodules/python2.7/rosdep2/sources_list.py", line 423, in update_sources_list
    retval.append((source, write_cache_file(sources_cache_dir, source.url, rosdep_data)))
  File "/usr/lib/pymodules/python2.7/rosdep2/sources_list.py", line 495, in write_cache_file
    write_atomic(filepath + PICKLE_CACHE_EXT, pickle.dumps(rosdep_data, -1), True)
  File "/usr/lib/pymodules/python2.7/rosdep2/sources_list.py", line 504, in write_atomic
    fd, filepath_tmp = tempfile.mkstemp(prefix=os.path.basename(filepath) + '.tmp.', dir=os.path.dirname(filepath))
  File "/usr/lib/python2.7/tempfile.py", line 300, in mkstemp
    return _mkstemp_inner(dir, prefix, suffix, flags)
  File "/usr/lib/python2.7/tempfile.py", line 235, in _mkstemp_inner
    fd = _os.open(file, flags, 0600)
OSError: [Errno 13] Permission denied: '/home/thursday/.ros/rosdep/sources.cache/5f44c73fb5a0e187f088839519d453ff8aa3699e.pickle.tmp.UGtFKu'

For further reference here are what some file permissions look like in folders that may have something to do with this:
thursday@daedalus:~$ sudo ls -la /etc/ros/rosdep/sources.list.d
[sudo] password for thursday: 
total 12
drwxr-xr-x 2 root root 4096 Jun 28 12:02 .
drwxr-xr-x 3 root root 4096 Jun 28 12:02 ..
-rw-r--r-- 1 root root  533 Jun 28 12:02 20-default.list

///
thursday@daedalus:~$ sudo ls -la /home/thursday/.ros/rosdep
total 12
drwxr-xr-x 3 root root 4096 Jun 28 11:36 .
drwxr-xr-x 4 root root 4096 Jun 28 11:34 ..
drwxr-xr-x 2 root root 4096 Jun 28 11:36 sources.cache

/// This is where i tried making all these files read/write for all groups. How do you give something the 'd' permission?
thursday@daedalus:~$ sudo ls -la /home/thursday/.ros/rosdep/sources.cache
total 720
drwxr-xr-x 2 root root   4096 Jun 28 11:36 .
drwxr-xr-x 3 root root   4096 Jun 28 11:36 ..
-rwxrwxrwx 1 root root  88922 Jun 28 11:36 0a12d6e7b0d47be9b76e7726720e4cb79528cbaa.pickle
-rwxrwxrwx 1 root root   1648 Jun 28 11:36 3db3f31778bf426ad9e41bef6144c78168b3c623.pickle
-rwxrwxrwx 1 root root 111972 Jun 28 11:36 438a85d0c4400de8ca8f108d20ec905de5df6a19.pickle
-rwxrwxrwx 1 root root 295051 Jun 28 11:36 592c4c18fd82522323a9f5646b8e648e18c9ef70.pickle
-rwxrwxrwx 1 root root  10877 Jun 28 11:36 5f44c73fb5a0e187f088839519d453ff8aa3699e.pickle
-rwxrwxrwx 1 root root 142972 Jun 28 11:36 81e56836490151bf3e2bf2b6790848a29cb90f6b.pickle
-rwxrwxrwx 1 root root  10718 Jun 28 11:36 82cbc7008b5117bcc6ce794832659e4f7763d2db.pickle
-rwxrwxrwx 1 root root  46374 Jun 28 11:36 f6f4ef95664e373cd4754501337fa217f5b55d91.pickle
-rwxrwxrwx 1 root root    666 Jun 28 11:36 index

Originally posted by thursday on ROS Answers with karma: 1 on 2014-06-28
Post score: 0

A:

Changing ownership of the ~/.ros directory is the correct fix. rosdep recently go a fix-permissions verb that does exactly that and improves the error message, but it has not been released yet, so for now it is easiest to do it manually as @mehdi tlili suggests.
Edit: rosdep has been re-released, so if you update it from pip/apt, you shoul have gotten a more useful error message that indicates to run sudo rosdep fix-permissions

Originally posted by demmeln with karma: 4306 on 2014-06-30
This answer was ACCEPTED on the original site
Post score: 5

