Q:

Error of a map made by gmapping

I'm trying to run a waffle pi along a path of 60cm width.
During the test, I noticed that there is difference between a map made by gmapping and local map made during navigation.
Please see the attached image or link.
Black line is made by gmapping and green dotted line is made during navigation.
These lines are misaligned and the difference is approximately 20cm.
This phenomenon still happens after update of a Turtlebot3 package (v1.0.0) and a OpenCR firmware (v1.2.0).
Please give me your comment and/or advise.
BRs.
Attached image
Direct link

Originally posted by taka on ROS Answers with karma: 3 on 2018-07-24
Post score: 0

Original comments
Comment by billy on 2018-07-24:
I don't see any error in mapping. I see an offset in localization. Are you running any nodes to locate the robot in the map like AMCL?
Comment by taka on 2018-07-25:
Thanks.
There is an offset between a map made by gmapping and local map made during navigation. I think this offset has a bad influence for navigation.
I'm not sure why the offset occurs and how to minimize the offset. I use AMCL particles for localization.
Thank you in advance.

A:

This seams like error in odometry data or that you are running a robot without localization. Try to run AMCL node for localization. See here.

Originally posted by destogl with karma: 877 on 2018-07-25
This answer was ACCEPTED on the original site
Post score: 1

Original comments
Comment by taka on 2018-07-25:
Thanks. As shown in rqt, I run the AMCL node during navigation. As you say, there may be error in odometory data, but I don't know how I can fix it.
Comment by taka on 2018-07-25:
I think there is a problem during map making. I noticed two things.
(1) When location of robot changes, results of laser scan (green dot in rviz) points to different  position. Please compare red circle in image1 and image2.
Comment by taka on 2018-07-25:
(2) While the robot slowly goes forward during map making, it looks like that the robot goes back and forth in rviz. Please see video. I think this is related to (1).
Thanks in advance.
Comment by destogl on 2018-07-26:
this is all OK. The robot "jumps" when slam calculates data. It seams that your odometry data says that robot moves slower than it really moves. Please check your odometry data, this should be in some yaml file of your diff drive controller. It could be that your wheels are too small...
Comment by destogl on 2018-07-26:
Also you can change the covarinance of your odometry. I am just not sure where, It should be published by your differential controller or it is defined in configuations of your slam/localization.

