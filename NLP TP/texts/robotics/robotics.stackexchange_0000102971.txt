Q:

Why cann't I define a publisher in a loop?

This does not work, because the listener will not receive any message. why is that?
 while (ros::ok())
 {
      ros::Publisher chatter_pub = n.advertise<std_msgs::String>("chatter", 1000);
      ros::spinOnce();
      std_msgs::String msg;
      std::stringstream ss;
      ss << "hello world ";
      msg.data = ss.str();
      chatter_pub.publish(msg);
      loop_rate.sleep();
  }

Originally posted by robinvista on ROS Answers with karma: 3 on 2023-01-26
Post score: 0

A:

the listener will not receive any message. why is that?

Because it takes time for publishers and subscribers to "find" each other.
Your loop does not give subscribers enough time to find the publishers, hence no messages can be exchanged.
(I'm hoping this is not an xy-problem)
And pedantic, but:

Why cann't I define a publisher in a loop?

it's perfectly possible to instantiate multiple ros::Publishers in a loop. But destroying them in the same scope and then expecting subscribers to resubscribe the next iteration is not something you can do.

Originally posted by gvdhoorn with karma: 86574 on 2023-01-27
This answer was ACCEPTED on the original site
Post score: 3

Original comments
Comment by robinvista on 2023-01-27:
On my machine, the time for the receiver to find the publisher is about 250ms.

