Q:

colcon can't build turtlesim

I was following official tutorials here in Python.
After "Creating custom msg and srv files" tutorial I decided to switch language from Python to C++ and start tutorials from scratch. I moved "~/dev_ws" folder, and created empty "~/dev_ws" folder on its place. I started tutorials from Creating a workspace. And I have the following error when I do colcon build (Ubuntu 20.04, installed from deb,  --allow-overriding turtlesim doesn't help):
[0.227s] WARNING:colcon.colcon_core.package_selection:Some selected packages are already built in one or more underlay workspaces:
        'turtlesim' is in: /opt/ros/galactic
If a package in a merged underlay workspace is overridden and it installs headers, then all packages in the overlay must sort their include directories by workspace order. Failure to do so may result in build failures or undefined behavior at run time.
If the overridden package is used by another package in any underlay, then the overriding package in the overlay must be API and ABI compatible or undefined behavior at run time may occur.

If you understand the risks and want to override a package anyways, add the following to the command line:
        --allow-overriding turtlesim

This may be promoted to an error in a future release of colcon-override-check.
Starting >>> turtlesim
--- stderr: turtlesim                             
In file included from /opt/ros/galactic/include/rclcpp/topic_statistics/subscription_topic_statistics.hpp:31,
                 from /opt/ros/galactic/include/rclcpp/subscription.hpp:50,
                 from /opt/ros/galactic/include/rclcpp/any_executable.hpp:25,
                 from /opt/ros/galactic/include/rclcpp/memory_strategy.hpp:25,
                 from /opt/ros/galactic/include/rclcpp/memory_strategies.hpp:18,
                 from /opt/ros/galactic/include/rclcpp/executor_options.hpp:20,
                 from /opt/ros/galactic/include/rclcpp/executor.hpp:36,
                 from /opt/ros/galactic/include/rclcpp/executors/multi_threaded_executor.hpp:26,
                 from /opt/ros/galactic/include/rclcpp/executors.hpp:21,
                 from /opt/ros/galactic/include/rclcpp/rclcpp.hpp:156,
                 from /home/alexander/dev_ws/src/ros_tutorials/turtlesim/tutorials/teleop_turtle_key.cpp:5:
/opt/ros/galactic/include/rclcpp/publisher.hpp: In instantiation of ‘void rclcpp::Publisher<MessageT, AllocatorT>::do_inter_process_publish(const MessageT&, uint32_t*) [with MessageT = geometry_msgs::msg::Twist_<std::allocator<void> >; AllocatorT = std::allocator<void>; uint32_t = unsigned int]’:
/opt/ros/galactic/include/rclcpp/publisher.hpp:233:52:   required from ‘void rclcpp::Publisher<MessageT, AllocatorT>::publish(const MessageT&, uint32_t*) [with MessageT = geometry_msgs::msg::Twist_<std::allocator<void> >; AllocatorT = std::allocator<void>; uint32_t = unsigned int]’
/opt/ros/galactic/include/rclcpp/publisher.hpp:228:3:   required from here
/opt/ros/galactic/include/rclcpp/publisher.hpp:328:38: error: ‘rcl_publish_with_id’ was not declared in this scope; did you mean ‘rmw_publish_with_id’?
  328 |     auto status = rcl_publish_with_id(publisher_handle_.get(), &msg, nullptr, id);
      |                   ~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      |                   rmw_publish_with_id
make[2]: *** [CMakeFiles/turtle_teleop_key.dir/build.make:63: CMakeFiles/turtle_teleop_key.dir/tutorials/teleop_turtle_key.cpp.o] Error 1
make[1]: *** [CMakeFiles/Makefile2:339: CMakeFiles/turtle_teleop_key.dir/all] Error 2
make[1]: *** Waiting for unfinished jobs....
In file included from /opt/ros/galactic/include/rclcpp/topic_statistics/subscription_topic_statistics.hpp:31,
                 from /opt/ros/galactic/include/rclcpp/subscription.hpp:50,
                 from /opt/ros/galactic/include/rclcpp/any_executable.hpp:25,
                 from /opt/ros/galactic/include/rclcpp/memory_strategy.hpp:25,
                 from /opt/ros/galactic/include/rclcpp/memory_strategies.hpp:18,
                 from /opt/ros/galactic/include/rclcpp/executor_options.hpp:20,
                 from /opt/ros/galactic/include/rclcpp/executor.hpp:36,
                 from /opt/ros/galactic/include/rclcpp/executors/multi_threaded_executor.hpp:26,
                 from /opt/ros/galactic/include/rclcpp/executors.hpp:21,
                 from /opt/ros/galactic/include/rclcpp/rclcpp.hpp:156,
                 from /home/alexander/dev_ws/src/ros_tutorials/turtlesim/tutorials/mimic.cpp:1:
/opt/ros/galactic/include/rclcpp/publisher.hpp: In instantiation of ‘void rclcpp::Publisher<MessageT, AllocatorT>::do_inter_process_publish(const MessageT&, uint32_t*) [with MessageT = geometry_msgs::msg::Twist_<std::allocator<void> >; AllocatorT = std::allocator<void>; uint32_t = unsigned int]’:
/opt/ros/galactic/include/rclcpp/publisher.hpp:233:52:   required from ‘void rclcpp::Publisher<MessageT, AllocatorT>::publish(const MessageT&, uint32_t*) [with MessageT = geometry_msgs::msg::Twist_<std::allocator<void> >; AllocatorT = std::allocator<void>; uint32_t = unsigned int]’
/opt/ros/galactic/include/rclcpp/publisher.hpp:228:3:   required from here
/opt/ros/galactic/include/rclcpp/publisher.hpp:328:38: error: ‘rcl_publish_with_id’ was not declared in this scope; did you mean ‘rmw_publish_with_id’?
  328 |     auto status = rcl_publish_with_id(publisher_handle_.get(), &msg, nullptr, id);
      |                   ~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      |                   rmw_publish_with_id
/opt/ros/galactic/include/rclcpp/publisher.hpp: In instantiation of ‘void rclcpp::Publisher<MessageT, AllocatorT>::do_inter_process_publish(const MessageT&, uint32_t*) [with MessageT = statistics_msgs::msg::MetricsMessage_<std::allocator<void> >; AllocatorT = std::allocator<void>; uint32_t = unsigned int]’:
/opt/ros/galactic/include/rclcpp/publisher.hpp:233:52:   required from ‘void rclcpp::Publisher<MessageT, AllocatorT>::publish(const MessageT&, uint32_t*) [with MessageT = statistics_msgs::msg::MetricsMessage_<std::allocator<void> >; AllocatorT = std::allocator<void>; uint32_t = unsigned int]’
/opt/ros/galactic/include/rclcpp/publisher.hpp:228:3:   required from here
/opt/ros/galactic/include/rclcpp/publisher.hpp:328:38: error: ‘rcl_publish_with_id’ was not declared in this scope; did you mean ‘rmw_publish_with_id’?
  328 |     auto status = rcl_publish_with_id(publisher_handle_.get(), &msg, nullptr, id);
      |                   ~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      |                   rmw_publish_with_id
In file included from /opt/ros/galactic/include/rclcpp/topic_statistics/subscription_topic_statistics.hpp:31,
                 from /opt/ros/galactic/include/rclcpp/subscription.hpp:50,
                 from /opt/ros/galactic/include/rclcpp/any_executable.hpp:25,
                 from /opt/ros/galactic/include/rclcpp/memory_strategy.hpp:25,
                 from /opt/ros/galactic/include/rclcpp/memory_strategies.hpp:18,
                 from /opt/ros/galactic/include/rclcpp/executor_options.hpp:20,
                 from /opt/ros/galactic/include/rclcpp/executor.hpp:36,
                 from /opt/ros/galactic/include/rclcpp/executors/multi_threaded_executor.hpp:26,
                 from /opt/ros/galactic/include/rclcpp/executors.hpp:21,
                 from /opt/ros/galactic/include/rclcpp/rclcpp.hpp:156,
                 from /home/alexander/dev_ws/src/ros_tutorials/turtlesim/tutorials/draw_square.cpp:1:
/opt/ros/galactic/include/rclcpp/publisher.hpp: In instantiation of ‘void rclcpp::Publisher<MessageT, AllocatorT>::do_inter_process_publish(const MessageT&, uint32_t*) [with MessageT = geometry_msgs::msg::Twist_<std::allocator<void> >; AllocatorT = std::allocator<void>; uint32_t = unsigned int]’:
/opt/ros/galactic/include/rclcpp/publisher.hpp:233:52:   required from ‘void rclcpp::Publisher<MessageT, AllocatorT>::publish(const MessageT&, uint32_t*) [with MessageT = geometry_msgs::msg::Twist_<std::allocator<void> >; AllocatorT = std::allocator<void>; uint32_t = unsigned int]’
/opt/ros/galactic/include/rclcpp/publisher.hpp:228:3:   required from here
/opt/ros/galactic/include/rclcpp/publisher.hpp:328:38: error: ‘rcl_publish_with_id’ was not declared in this scope; did you mean ‘rmw_publish_with_id’?
  328 |     auto status = rcl_publish_with_id(publisher_handle_.get(), &msg, nullptr, id);
      |                   ~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      |                   rmw_publish_with_id
/opt/ros/galactic/include/rclcpp/publisher.hpp: In instantiation of ‘void rclcpp::Publisher<MessageT, AllocatorT>::do_inter_process_publish(const MessageT&, uint32_t*) [with MessageT = statistics_msgs::msg::MetricsMessage_<std::allocator<void> >; AllocatorT = std::allocator<void>; uint32_t = unsigned int]’:
/opt/ros/galactic/include/rclcpp/publisher.hpp:233:52:   required from ‘void rclcpp::Publisher<MessageT, AllocatorT>::publish(const MessageT&, uint32_t*) [with MessageT = statistics_msgs::msg::MetricsMessage_<std::allocator<void> >; AllocatorT = std::allocator<void>; uint32_t = unsigned int]’
/opt/ros/galactic/include/rclcpp/publisher.hpp:228:3:   required from here
/opt/ros/galactic/include/rclcpp/publisher.hpp:328:38: error: ‘rcl_publish_with_id’ was not declared in this scope; did you mean ‘rmw_publish_with_id’?
  328 |     auto status = rcl_publish_with_id(publisher_handle_.get(), &msg, nullptr, id);
      |                   ~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      |                   rmw_publish_with_id
make[2]: *** [CMakeFiles/mimic.dir/build.make:63: CMakeFiles/mimic.dir/tutorials/mimic.cpp.o] Error 1
make[1]: *** [CMakeFiles/Makefile2:130: CMakeFiles/mimic.dir/all] Error 2
make[2]: *** [CMakeFiles/draw_square.dir/build.make:63: CMakeFiles/draw_square.dir/tutorials/draw_square.cpp.o] Error 1
make[1]: *** [CMakeFiles/Makefile2:158: CMakeFiles/draw_square.dir/all] Error 2
In file included from /opt/ros/galactic/include/rclcpp/topic_statistics/subscription_topic_statistics.hpp:31,
                 from /opt/ros/galactic/include/rclcpp/subscription.hpp:50,
                 from /opt/ros/galactic/include/rclcpp/any_executable.hpp:25,
                 from /opt/ros/galactic/include/rclcpp/memory_strategy.hpp:25,
                 from /opt/ros/galactic/include/rclcpp/memory_strategies.hpp:18,
                 from /opt/ros/galactic/include/rclcpp/executor_options.hpp:20,
                 from /opt/ros/galactic/include/rclcpp/executor.hpp:36,
                 from /opt/ros/galactic/include/rclcpp/executors/multi_threaded_executor.hpp:26,
                 from /opt/ros/galactic/include/rclcpp/executors.hpp:21,
                 from /opt/ros/galactic/include/rclcpp/rclcpp.hpp:156,
                 from /home/alexander/dev_ws/src/ros_tutorials/turtlesim/include/turtlesim/turtle.h:35,
                 from /home/alexander/dev_ws/src/ros_tutorials/turtlesim/src/turtle.cpp:30:
/opt/ros/galactic/include/rclcpp/publisher.hpp: In instantiation of ‘void rclcpp::Publisher<MessageT, AllocatorT>::do_inter_process_publish(const MessageT&, uint32_t*) [with MessageT = turtlesim::msg::Color_<std::allocator<void> >; AllocatorT = std::allocator<void>; uint32_t = unsigned int]’:
/opt/ros/galactic/include/rclcpp/publisher.hpp:233:52:   required from ‘void rclcpp::Publisher<MessageT, AllocatorT>::publish(const MessageT&, uint32_t*) [with MessageT = turtlesim::msg::Color_<std::allocator<void> >; AllocatorT = std::allocator<void>; uint32_t = unsigned int]’
/opt/ros/galactic/include/rclcpp/publisher.hpp:228:3:   required from here
/opt/ros/galactic/include/rclcpp/publisher.hpp:328:38: error: ‘rcl_publish_with_id’ was not declared in this scope; did you mean ‘rmw_publish_with_id’?
  328 |     auto status = rcl_publish_with_id(publisher_handle_.get(), &msg, nullptr, id);
      |                   ~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      |                   rmw_publish_with_id
/opt/ros/galactic/include/rclcpp/publisher.hpp: In instantiation of ‘void rclcpp::Publisher<MessageT, AllocatorT>::do_inter_process_publish(const MessageT&, uint32_t*) [with MessageT = turtlesim::msg::Pose_<std::allocator<void> >; AllocatorT = std::allocator<void>; uint32_t = unsigned int]’:
/opt/ros/galactic/include/rclcpp/publisher.hpp:233:52:   required from ‘void rclcpp::Publisher<MessageT, AllocatorT>::publish(const MessageT&, uint32_t*) [with MessageT = turtlesim::msg::Pose_<std::allocator<void> >; AllocatorT = std::allocator<void>; uint32_t = unsigned int]’
/opt/ros/galactic/include/rclcpp/publisher.hpp:228:3:   required from here
/opt/ros/galactic/include/rclcpp/publisher.hpp:328:38: error: ‘rcl_publish_with_id’ was not declared in this scope; did you mean ‘rmw_publish_with_id’?
  328 |     auto status = rcl_publish_with_id(publisher_handle_.get(), &msg, nullptr, id);
      |                   ~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      |                   rmw_publish_with_id
In file included from /opt/ros/galactic/include/rclcpp/topic_statistics/subscription_topic_statistics.hpp:31,
                 from /opt/ros/galactic/include/rclcpp/subscription.hpp:50,
                 from /opt/ros/galactic/include/rclcpp/any_executable.hpp:25,
                 from /opt/ros/galactic/include/rclcpp/memory_strategy.hpp:25,
                 from /opt/ros/galactic/include/rclcpp/memory_strategies.hpp:18,
                 from /opt/ros/galactic/include/rclcpp/executor_options.hpp:20,
                 from /opt/ros/galactic/include/rclcpp/executor.hpp:36,
                 from /opt/ros/galactic/include/rclcpp/executors/multi_threaded_executor.hpp:26,
                 from /opt/ros/galactic/include/rclcpp/executors.hpp:21,
                 from /opt/ros/galactic/include/rclcpp/rclcpp.hpp:156,
                 from /home/alexander/dev_ws/src/ros_tutorials/turtlesim/include/turtlesim/turtle_frame.h:39,
                 from /home/alexander/dev_ws/src/ros_tutorials/turtlesim/src/turtle_frame.cpp:30:
/opt/ros/galactic/include/rclcpp/publisher.hpp: In instantiation of ‘void rclcpp::Publisher<MessageT, AllocatorT>::do_inter_process_publish(const MessageT&, uint32_t*) [with MessageT = statistics_msgs::msg::MetricsMessage_<std::allocator<void> >; AllocatorT = std::allocator<void>; uint32_t = unsigned int]’:
/opt/ros/galactic/include/rclcpp/publisher.hpp:233:52:   required from ‘void rclcpp::Publisher<MessageT, AllocatorT>::publish(const MessageT&, uint32_t*) [with MessageT = statistics_msgs::msg::MetricsMessage_<std::allocator<void> >; AllocatorT = std::allocator<void>; uint32_t = unsigned int]’
/opt/ros/galactic/include/rclcpp/publisher.hpp:228:3:   required from here
/opt/ros/galactic/include/rclcpp/publisher.hpp:328:38: error: ‘rcl_publish_with_id’ was not declared in this scope; did you mean ‘rmw_publish_with_id’?
  328 |     auto status = rcl_publish_with_id(publisher_handle_.get(), &msg, nullptr, id);
      |                   ~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      |                   rmw_publish_with_id
/opt/ros/galactic/include/rclcpp/publisher.hpp: In instantiation of ‘void rclcpp::Publisher<MessageT, AllocatorT>::do_inter_process_publish(const MessageT&, uint32_t*) [with MessageT = statistics_msgs::msg::MetricsMessage_<std::allocator<void> >; AllocatorT = std::allocator<void>; uint32_t = unsigned int]’:
/opt/ros/galactic/include/rclcpp/publisher.hpp:233:52:   required from ‘void rclcpp::Publisher<MessageT, AllocatorT>::publish(const MessageT&, uint32_t*) [with MessageT = statistics_msgs::msg::MetricsMessage_<std::allocator<void> >; AllocatorT = std::allocator<void>; uint32_t = unsigned int]’
/opt/ros/galactic/include/rclcpp/publisher.hpp:228:3:   required from here
/opt/ros/galactic/include/rclcpp/publisher.hpp:328:38: error: ‘rcl_publish_with_id’ was not declared in this scope; did you mean ‘rmw_publish_with_id’?
  328 |     auto status = rcl_publish_with_id(publisher_handle_.get(), &msg, nullptr, id);
      |                   ~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      |                   rmw_publish_with_id
make[2]: *** [CMakeFiles/turtlesim_node.dir/build.make:93: CMakeFiles/turtlesim_node.dir/src/turtle_frame.cpp.o] Error 1
make[2]: *** Waiting for unfinished jobs....
make[2]: *** [CMakeFiles/turtlesim_node.dir/build.make:80: CMakeFiles/turtlesim_node.dir/src/turtle.cpp.o] Error 1
make[1]: *** [CMakeFiles/Makefile2:367: CMakeFiles/turtlesim_node.dir/all] Error 2
make: *** [Makefile:141: all] Error 2
---
Failed   <<< turtlesim [6.14s, exited with code 2]

Summary: 0 packages finished [6.31s]
  1 package failed: turtlesim
  1 package had stderr output: turtlesim

Using --allow-overriding turtlesim doesn't help: the warning is gone but the error is still there

Originally posted by adroit.levees.0r on ROS Answers with karma: 38 on 2022-06-26
Post score: 0

A:

I uninstalled ROS: sudo apt remove ros-galactic* and installed it again sudo apt install ros-galactic-desktop. It seems to work

Originally posted by adroit.levees.0r with karma: 38 on 2022-06-26
This answer was ACCEPTED on the original site
Post score: 0

