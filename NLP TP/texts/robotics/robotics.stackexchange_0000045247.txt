Q:

pass additional arguments into advertiseService

Hi,
is there a way to pass additional arguments into advertiseService ?
When i use a Subscriber i can use boost::bind to pass arguments to the callback function. Like this:
ros::Subscriber sub = nh.subscribe<cob_people_detection::Commands> ("/tuw_acin_eva/voice_commands", 1, boost::bind(commandCallback, _1, &sensor_message_gateway_open_client));

Can i adapt this approach to make it work with advertiseService ?
I tried it with this
ros::ServiceServer service = nh.advertiseService<tuw_acin_eva::VoiceCommands> ("process_voice_commands", boost::bind(processVoiceCommands, _1, &sensor_message_gateway_open_client));

but it does not work.

Edit: 1
Sorry for not including the complete error message. Here it is now.
[ rosmake ] Last 40 linesw_acin_eva: 4.6 sec ]                    [ 1 Active 50/51 Complete ]
{-------------------------------------------------------------------------------
  [ 57%] [ 57%] Built target rospack_gensrv_all
  Built target rosbuild_precompile
  make[3]: Entering directory `/home/bajo/workspace/tuw_acin_eva/build'
  make[3]: Entering directory `/home/bajo/workspace/tuw_acin_eva/build'
  make[3]: Entering directory `/home/bajo/workspace/tuw_acin_eva/build'
  make[3]: Leaving directory `/home/bajo/workspace/tuw_acin_eva/build'
  make[3]: Leaving directory `/home/bajo/workspace/tuw_acin_eva/build'
  [ 85%] [ 85%] Built target tuw_acin_eva_main
  Built target tuw_acin_eva_facefollower
  Scanning dependencies of target tuw_acin_eva_cob_control
  make[3]: Leaving directory `/home/bajo/workspace/tuw_acin_eva/build'
  make[3]: Entering directory `/home/bajo/workspace/tuw_acin_eva/build'
  [100%] Building CXX object CMakeFiles/tuw_acin_eva_cob_control.dir/nodes/tuw_acin_eva_people/src/tuw_acin_eva_cob_control.o
  In file included from /opt/ros/fuerte/include/ros/ros.h:45:0,
               from /home/bajo/workspace/tuw_acin_eva/nodes/tuw_acin_eva_people/src/tuw_acin_eva_cob_control.cpp:13:
  /opt/ros/fuerte/include/ros/node_handle.h: In member function ‘ros::ServiceServer ros::NodeHandle::advertiseService(const string&, const boost::function<bool(S&)>&, const VoidConstPtr&) [with S = tuw_acin_eva::VoiceCommands, std::string = std::basic_string<char>, ros::VoidConstPtr = boost::shared_ptr<const void>]’:
  /home/bajo/workspace/tuw_acin_eva/nodes/tuw_acin_eva_people/src/tuw_acin_eva_cob_control.cpp:288:181:   instantiated from here
  /opt/ros/fuerte/include/ros/node_handle.h:1087:5: error: no matching function for call to ‘ros::AdvertiseServiceOptions::initBySpecType(const string&, const boost::function<bool(tuw_acin_eva::VoiceCommands&)>&)’
  /opt/ros/fuerte/include/ros/node_handle.h:1087:5: note: candidate is:
  /opt/ros/fuerte/include/ros/advertise_service_options.h:104:8: note: template<class Spec> void ros::AdvertiseServiceOptions::initBySpecType(const string&, const typename Spec::CallbackType&)
  In file included from /usr/include/boost/bind.hpp:22:0,
               from /opt/ros/fuerte/include/ros/publisher.h:35,
               from /opt/ros/fuerte/include/ros/node_handle.h:32,
               from /opt/ros/fuerte/include/ros/ros.h:45,
               from /home/bajo/workspace/tuw_acin_eva/nodes/tuw_acin_eva_people/src/tuw_acin_eva_cob_control.cpp:13:
  /usr/include/boost/bind/bind.hpp: In member function ‘R boost::_bi::list2<A1, A2>::operator()(boost::_bi::type<R>, F&, A&, long int) [with R = bool, F = bool (*)(tuw_acin_eva::VoiceCommandsRequest_<std::allocator<void> >&, tuw_acin_eva::VoiceCommandsResponse_<std::allocator<void> >&), A = boost::_bi::list1<tuw_acin_eva::VoiceCommands&>, A1 = boost::arg<1>, A2 = boost::_bi::value<ros::ServiceClient*>]’:
  /usr/include/boost/bind/bind_template.hpp:32:59:   instantiated from ‘boost::_bi::bind_t<R, F, L>::result_type boost::_bi::bind_t<R, F, L>::operator()(A1&) [with A1 = tuw_acin_eva::VoiceCommands, R = bool, F = bool (*)(tuw_acin_eva::VoiceCommandsRequest_<std::allocator<void> >&, tuw_acin_eva::VoiceCommandsResponse_<std::allocator<void> >&), L = boost::_bi::list2<boost::arg<1>, boost::_bi::value<ros::ServiceClient*> >, boost::_bi::bind_t<R, F, L>::result_type = bool]’
  /usr/include/boost/function/function_template.hpp:132:42:   instantiated from ‘static R boost::detail::function::function_obj_invoker1<FunctionObj, R, T0>::invoke(boost::detail::function::function_buffer&, T0) [with FunctionObj = boost::_bi::bind_t<bool, bool (*)(tuw_acin_eva::VoiceCommandsRequest_<std::allocator<void> >&, tuw_acin_eva::VoiceCommandsResponse_<std::allocator<void> >&), boost::_bi::list2<boost::arg<1>, boost::_bi::value<ros::ServiceClient*> > >, R = bool, T0 = tuw_acin_eva::VoiceCommands&]’
  /usr/include/boost/function/function_template.hpp:913:60:   instantiated from ‘void boost::function1<R, T1>::assign_to(Functor) [with Functor = boost::_bi::bind_t<bool, bool (*)(tuw_acin_eva::VoiceCommandsRequest_<std::allocator<void> >&, tuw_acin_eva::VoiceCommandsResponse_<std::allocator<void> >&), boost::_bi::list2<boost::arg<1>, boost::_bi::value<ros::ServiceClient*> > >, R = bool, T0 = tuw_acin_eva::VoiceCommands&]’
  /usr/include/boost/function/function_template.hpp:722:7:   instantiated from ‘boost::function1<R, T1>::function1(Functor, typename boost::enable_if_c<boost::type_traits::ice_not<boost::is_integral<Functor>::value>::value, int>::type) [with Functor = boost::_bi::bind_t<bool, bool (*)(tuw_acin_eva::VoiceCommandsRequest_<std::allocator<void> >&, tuw_acin_eva::VoiceCommandsResponse_<std::allocator<void> >&), boost::_bi::list2<boost::arg<1>, boost::_bi::value<ros::ServiceClient*> > >, R = bool, T0 = tuw_acin_eva::VoiceCommands&, typename boost::enable_if_c<boost::type_traits::ice_not<boost::is_integral<Functor>::value>::value, int>::type = int]’
  /usr/include/boost/function/function_template.hpp:1064:16:   instantiated from ‘boost::function<R(T0)>::function(Functor, typename boost::enable_if_c<boost::type_traits::ice_not<boost::is_integral<Functor>::value>::value, int>::type) [with Functor = boost::_bi::bind_t<bool, bool (*)(tuw_acin_eva::VoiceCommandsRequest_<std::allocator<void> >&, tuw_acin_eva::VoiceCommandsResponse_<std::allocator<void> >&), boost::_bi::list2<boost::arg<1>, boost::_bi::value<ros::ServiceClient*> > >, R = bool, T0 = tuw_acin_eva::VoiceCommands&, typename boost::enable_if_c<boost::type_traits::ice_not<boost::is_integral<Functor>::value>::value, int>::type = int]’
  /home/bajo/workspace/tuw_acin_eva/nodes/tuw_acin_eva_people/src/tuw_acin_eva_cob_control.cpp:288:181:   instantiated from here
  /usr/include/boost/bind/bind.hpp:303:79: error: invalid initialization of reference of type ‘tuw_acin_eva::VoiceCommandsRequest_<std::allocator<void> >&’ from expression of type ‘tuw_acin_eva::VoiceCommands’
  make[3]: *** [CMakeFiles/tuw_acin_eva_cob_control.dir/nodes/tuw_acin_eva_people/src/tuw_acin_eva_cob_control.o] Error 1
  make[3]: Leaving directory `/home/bajo/workspace/tuw_acin_eva/build'
  make[2]: *** [CMakeFiles/tuw_acin_eva_cob_control.dir/all] Error 2
  make[2]: Leaving directory `/home/bajo/workspace/tuw_acin_eva/build'
  make[1]: *** [all] Error 2
  make[1]: Leaving directory `/home/bajo/workspace/tuw_acin_eva/build'
-------------------------------------------------------------------------------}
[ rosmake ] Output from build of package tuw_acin_eva written to:
[ rosmake ]    /home/bajo/.ros/rosmake/rosmake_output-20121029-105754/tuw_acin_eva/build_output.log
[rosmake-4] Finished <<< tuw_acin_eva [FAIL] [ 4.70 seconds]
[ rosmake ] Waiting for other threads to complete.
[ rosmake ] Results:                     
[ rosmake ] Built 51 packages with 1 failures.
[ rosmake ] Summary output to directory  
[ rosmake ] /home/bajo/.ros/rosmake/rosmake_output-20121029-105754
rosmake tuw_acin_eva  19.06s user 6.39s system 95% cpu 26.599 total

As I can cleary see my function call did not match the candidate for
void ros::AdvertiseServiceOptions::initBySpecType(const string&, const typename Spec::CallbackType&

, but how would i have to change my function to match it?
Any hint or help is much appreciated.
Thank you.

Originally posted by bajo on ROS Answers with karma: 206 on 2012-10-25
Post score: 2

Original comments
Comment by Lorenz on 2012-10-26:
It should work. Please be more specific. Can you show us the complete error message? Make sure you have a look at http://ros.org/wiki/Support
Comment by bajo on 2012-10-29:
Thank you for your comment. I posted the complete error down below.

A:

I think i found my problems. I had a few of them. :)
First i had to add the Request and Response to my Service.
So i changed it from
ros::ServiceServer service = nh.advertiseService<tuw_acin_eva::VoiceCommands> ("process_voice_commands", boost::bind(processVoiceCommands, _1, &sensor_message_gateway_open_client));

to
ros::ServiceServer service = nh.advertiseService<tuw_acin_eva::VoiceCommands::Request, tuw_acin_eva::VoiceCommands::Response>("process_voice_commands", boost::bind(processVoiceCommands, _1, _2, &sensor_message_gateway_open_client));

Then i had a typo in another line, which may have been a problem too.
Now it compiles, i still have to write the rest so i can test it. But for now thanks for the help.

Originally posted by bajo with karma: 206 on 2012-10-29
This answer was ACCEPTED on the original site
Post score: 1

