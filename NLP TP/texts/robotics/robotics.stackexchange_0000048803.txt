Q:

image_transport republish theora core dump on startup

I am running Ubuntu 12.04 with Groovy. I am trying to republish a theora stream as decompressed images using:
rosrun image_transport republish theora in:=camera/image raw out:=camera/image_decompressed

The node core dumps on startup with the error:
terminate called after throwing an instance of 'image_transport::TransportLoadException'
  what():  Unable to load plugin for transport 'theora', error string:
Failed to load library /opt/ros/groovy/lib//libtheora_image_transport.so. Make sure that you are calling the PLUGINLIB_EXPORT_CLASS macro in the library code, and that names are consistent between this macro and your XML. Error string: Could not load library (Poco exception = /opt/ros/groovy/lib//libtheora_image_transport.so: undefined symbol: th_comment_clear)
Aborted (core dumped)

If I run the node republishing compressed or raw streams, the node starts and functions normally.
I see theora as a valid image transport using rosrun image_transport list_transports. I get this same error on 3 different machines all running Groovy, and the error does not happen using Fuerte. Could this be an issue with how image_transport_plugins is compiled?

Originally posted by bgoldfai on ROS Answers with karma: 93 on 2013-02-27
Post score: 2

A:

Hi,
this bug should be fixed in:
https://github.com/ros-perception/image_transport_plugins/commit/cec427bcd93ba941bd622389b10934811b2da70c
In future, please create an issue directly on github for bugs like this:
https://github.com/ros-perception/image_transport_plugins
Cheers,
Julius

Originally posted by jkammerl with karma: 146 on 2013-03-18
This answer was ACCEPTED on the original site
Post score: 2

Original comments
Comment by AdrianPeng on 2013-03-19:
Hi jkammerl, I installed 1.8.20 theora_image_transport on my laptop, but when I run "rosrun image_view image_view image:=/camera/image_raw theora", I got the new warning "[theora] Packet was not a Theora header" and it seems theora doesn't work at all because the video streaming is very laggy.
Comment by AdrianPeng on 2013-03-19:
After I installed the total image_transport_plugin stack instead of only theora_image_transport package, image_view can accept theora image. But there is another problem, when I try to republish theora image to raw image, "[theora] Packet was not a Theora header" appears again.
Comment by jkammerl on 2013-03-19:
There is a general flaw here. The libtheora encoder uses the OGG container format which is not designed to be used for streaming at all. The stream starts with the first ROS subscriber and it starts streaming the header followed by the video data.Accordingly,a second subscriber will miss the header!
Comment by jkammerl on 2013-03-19:
see: https://github.com/ros-perception/image_transport_plugins/issues/4
Comment by AdrianPeng on 2013-03-22:
Hi jkammerl, do you have plan to develop new fashionable encoder like vp8?

