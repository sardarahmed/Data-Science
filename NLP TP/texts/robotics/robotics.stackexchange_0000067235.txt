Q:

robot_upstart: could not open port /dev/ttyUSB0

Hi all,
I use turtlebot roomba with indigo version.
I try to use robot_upstart package to run turtlebot_bringup minimal.launch from an upstrat:
rosrun robot_upstart install --job turtlebot --interface wlan0 --user myuser --setup /home/myuser/turtlebot/devel/setup.bash --rosdistro indigo --master http://192.168.1.2:11311 --logdir /home/myuser/.ros/log turtlebot_bringup/launch/minimal.launch

All work properly except serial connection:
Failed to open port /dev/ttyUSB0. Error: could not open port /dev/ttyUSB0: [Errno 13] Permission denied: '/dev/ttyUSB0' Please make sure the Create cable is plugged into the computer.

'myuser' is in the 'dialout' group. If I start roslaunch turtlebot_bringup minimal.launch in a terminal it works.
If I start  sudo service turtlebot start it doesn't work.
If I manually change port permission sudo chmod 777 /dev/ttyUSB0 service start without errors.
Anyone having an idea what could be wrong?
Thanks in advance.

Originally posted by dennn66 on ROS Answers with karma: 11 on 2015-04-25
Post score: 1

Original comments
Comment by crazymumu on 2015-11-03:
hi dennn666, did you figure this issue out? Also do you know how to determine the Network interface to bring ROS up with, which is wlan0 in your case. Thanks so much

A:

This is some additional clarification for what @Rasoul wrote.

'myuser' is in the 'dialout' group.

That is normally all that is required, but robot_upstart works a bit different. From the robot_upstart 0.2.0 documentation » The install script - permissions:

It’s important to understand how permissions work robot_upstart:

The upstart job invokes its jobname-start bash script as root.

The script sets up environment variables, and then uses setuidgid to execute roslaunch as an unprivileged user. This is by default the user who ran the install script, but it can also be specified explicitly via a flag.

The roslaunch which executes does not have its user’s group memberships. This means that it will not have access to serial ports with the dialout group, or locations in /var/log owned by root, etc. Any filesystem resources needed by your ROS nodes should be chowned to the same unprivileged user which will run ROS, or should set to world readable/writeable, for example using udev.

So jobname-start starts out as user root, but then quickly drops all privileges and continues as a regular user (that is not a member of the dialout group). That is why some more configuration is required.

Originally posted by gvdhoorn with karma: 86574 on 2015-09-01
This answer was ACCEPTED on the original site
Post score: 1

Original comments
Comment by borgcons on 2017-12-06:
Hi What user would that be? the script uses setuidgid and sets to the user myuser, which is in the dialout group. When I do the same thing in my case and look at the processes run in htop the user is myuser. So how can the process run as myuser but not have the permissions of myuser?

