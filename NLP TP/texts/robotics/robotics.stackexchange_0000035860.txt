Q:

registered depth only works sometimes with openni_launch

I've noticed that when I use openni_launch, I can examine the depth_registered/image_raw, the rgb image, and even the IR image (if the rgb image topic is not also subscribed to).  But, the depth_registered/points topic often reports nothing.  Sometimes, I have to retry openni_launch up to 10 times before I finally get out a point cloud.  I looked through this, and I can't see where any nodelet would have a race condition, but it seems that that might be the case.  At first, I thought unplugging the Kinect helped -- but that doesn't seem to be a consistent fix.  I also can run the openni_viewer that is installed with openni, and I get out the correct pointcloud, so I'm not sure why openni_launch doesn't always publish on depth_registered/points.

Originally posted by pbeeson on ROS Answers with karma: 276 on 2011-11-21
Post score: 0

A:

There actually are various race conditions in the nodelets and in the OpenNI ROS driver, which I've been trying to stamp out lately. You can try the latest version with this rosinstall:
- other: {local-name: /opt/ros/electric/ros}
- other: {local-name: /opt/ros/electric/stacks}
- hg: {local-name: nodelet_core, uri: 'https://kforge.ros.org/common/nodeletcore'}
- svn: {local-name: image_pipeline, uri: 'https://code.ros.org/svn/ros-pkg/stacks/image_pipeline/trunk'}
- hg: {local-name: openni_kinect, uri: 'https://kforge.ros.org/openni/openni_ros'}

I'm working to release the affected stacks this week, but it would be helpful if you tried this out and reported whether there's any improvement.

Originally posted by Patrick Mihelich with karma: 4336 on 2011-11-21
This answer was ACCEPTED on the original site
Post score: 4

Original comments
Comment by Patrick Mihelich on 2011-12-05:
I finally released all the stacks today, however it will take some time for the new debs to build.
Comment by pbeeson on 2011-11-28:
Patrick, can you let us know when these changes make the electric .deb packages?
Comment by Alaina on 2011-11-24:
Patrick, I'm having a similar problem while using a Turtlebot. If I install the updated code as described above, the problem goes away. Thanks for the work on this!
Comment by pbeeson on 2011-11-22:
Works MUCH better. The only problem I have is that I still get tons of annoying warnings that /camera/depth_registered/image_raw and /camera/depth_registered/camera_info do not appear to be synchronized.  But I can live with that for now.  Thanks

