Q:

Variable namespaces in classes (Python3)

I am having difficulties using variable namespaces with python3 classes
Here's a snippet of code that I would think would work, but doesn't.
In the BasicNavigator class:
    self.namespace = ''

    self.localization_pose_sub = self.create_subscription(PoseWithCovarianceStamped,
                                                          self.namespace + '/amcl_pose',
                                                          self._amclPoseCallback,
                                                          amcl_pose_qos)

In main:
navigator = BasicNavigator()

navigator.namespace = "robot1"

This does not work, it does not recognize the "robot1" in the class.
Instead, if I remove the self.namespace and just write the topic name as such: 'robot1/amcl_pose' it works, but I need to be able to have a variable amount of robots...
What am I doing wrong?

Originally posted by WarTurtle on ROS Answers with karma: 170 on 2022-04-11
Post score: 0

Original comments
Comment by abhishek47 on 2022-04-11:
Very likely the subscription is getting created before self.namespace is being set to robot1. What if you made the constructor of BasicNavigator take in a namespace, so that you can do something like self.namespace = namespace?
Comment by aprotyas on 2022-04-11:
As the previous comment said, you need to rearrange when you're setting the namespace and when the subscription is created.

A:

Thanks, abhishek47 and aprotyas for your comments.
It worked by creating a method with the namespace argument.
In BasicNavigor class:
def createSubscriptions(self, namespace):
    self.localization_pose_sub = self.create_subscription(PoseWithCovarianceStamped,
                                                          namespace + 'amcl_pose',
                                                          self._amclPoseCallback,
                                                          amcl_pose_qos)

And then I call this in main:
navigator = BasicNavigator()

namespace = "robot1"
navigator.createSubscriptions(namespace)

Not sure if this is exactly what you wanted me to try, but it works, so I'm happy :)

Originally posted by WarTurtle with karma: 170 on 2022-04-12
This answer was ACCEPTED on the original site
Post score: 1

Original comments
Comment by aprotyas on 2022-04-13:
Something along these lines, yes. Good to know that it worked!

