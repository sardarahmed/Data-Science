Q:

RTAB-map 2d occupancy grid

I'm trying to get /rtabmap/grid_map working. I'm using the kinect + fake 2d laserscan method in the tutorial, and there is data being published to /scan
When I rostopic echo /rtabmap/grid_map, nothing is displayed.
I expected that if the subscribe_laserScan argument is on, rtabmap will output a 2d occupancy grid map under /rtabmap/grid_map. Is that incorrect? What other settings could affect grid_map?

Originally posted by Jack000 on ROS Answers with karma: 40 on 2016-03-22
Post score: 0

A:

Hi,
If inputs of rtabmap node are correctly connected, you should see a log info printed each second (and the grid_map topic should be published each second, empty or not). If not, it is because there is one of the input topic which is not published. You can know to which topics rtabmap is connected when rtabmap is launched or looking in your launch file, example:
[...]
/rtabmap/rtabmap subscribed to:
   /camera/rgb/image_rect_color,
   /camera/depth_registered/image_raw,
   /camera/rgb/camera_info,
   /odom,
   /scan
[...]

In that case you can verify if they are published like this:
$ rostopic hz /camera/rgb/image_rect_color
$ rostopic hz /camera/depth_registered/image_raw
$ rostopic hz /camera/rgb/camera_info
$ rostopic hz /odom
$ rostopic hz /scan

cheers

Originally posted by matlabbe with karma: 6409 on 2016-03-23
This answer was ACCEPTED on the original site
Post score: 1

Original comments
Comment by Jack000 on 2016-03-23:
how do I know which topics are necessary for grid_map? I thought only /scan is required for the grid map
Comment by matlabbe on 2016-03-23:
rtabmap node requires at least RGB-D images + odom. If you add /scan, then a 2D map can be also created. If you have only a laser scanner, you may better use packages like hector_mapping.
Comment by Jack000 on 2016-03-24:
I have RGB-D images and /scan working, but my expectation was that RGB-D + /scan = grid_map. rtabmap node creates the topic /rtabmap/grid_map but nothing is published to it.
I guess it's a bit confusing because there's no tutorial or demo showing how grid_map works, or even how to enable it.
Comment by Jack000 on 2016-03-24:
I'm running this launch file for the kinect2_bridge: https://github.com/introlab/rtabmap_ros/blob/master/launch/rgbd_mapping_kinect2.launch
but I don't see any configs that should conflict with generating a 2d map
Comment by matlabbe on 2016-03-24:
This launch file doesn't have subscribe_scan argument like rgbd_mapping.launch. The robot mapping with RVIZ demo generates a grid_map.
Comment by matlabbe on 2016-03-24:
Is /rtabmap/mapData published? If not, add the rqt_graph to your question. If yes, can you visualize the scan on RVIZ (to make sure the scan is not empty)?
Comment by Jack000 on 2016-04-01:
ah, did not know about rqt_graph. I had put the kinect bridge and rtabmap stuff in one launch file, which apparently produced some kind of conflict. I've got grid_map working now. thanks for the help

