Q:

How to obtain the msg format of a topic on runtime?

Hi,
I need to implement a dynamic subscription mechanism, that monitors the available topics. Firstly it takes a view to the msg format of new topics and subscribes to this one depending on a special data format. The first step, to know the current available topics works fine with the following code:
available_topics_old=[]
def monitor():
   while not rospy.is_shutdown():
      master = rosgraph.masterapi.Master('/rostopic')
      available_topics = master.getPublishedTopics('/') 
      new_topics=[]
      for topic in available_topics:
         if not topic in available_topics_old:
            new_topics.append(topic)
      if new_topics:
          # here I need to know the format(file) of the assigned msg
   rospy.sleep(1.0)

How can I get the msg format of the topic?
Best wishes from Germany
Poseidonius

Originally posted by Poseidonius on ROS Answers with karma: 427 on 2011-04-28
Post score: 3

A:

These are unofficial/volatile APIs, but you can look at how they introspect on the graph to pull the data out (most of this can be done with the masterapi or filesystem operations):
import roslib.message
import rostopic
import rosmsg

type_name = rostopic.get_topic_type('/rosout', blocking=False)[0]
if type_name:
    message_class = roslib.message.get_message_class(type_name)
    message_text = rosmsg.get_msg_text(type_name)
    full_message_text = message_class._full_text

Originally posted by kwc with karma: 12244 on 2011-04-28
This answer was ACCEPTED on the original site
Post score: 5

