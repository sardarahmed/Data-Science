Q:

Phidget IMU Magnetic Heading?

Hello! I am new to ROS so please forgive the simplicity of this question. I am trying to get a Phidget IMU to output a magnetic heading (0-360 deg). I currently have the phidgets_imu package installed which reads linear acceleration, angular velocity, and magnetic field. I am also using imu_filter_madgwick which fuses the data to get the orientation. However, I am not sure how to calculate the magnetic heading from this. The literature on the filter says it outputs a quaternion but then the screen displays the orientation in x, y, z, w. Anyone have some experience with this? Thank you!

Originally posted by nabatta on ROS Answers with karma: 13 on 2020-10-23
Post score: 0

A:

The Madgwick filter fuses raw magnetometer data (by subscribing to /imu/mag) to compute orientation. This orientation happens to be a quaternion instead of roll/pitch/yaw. The easiest way for you to obtain magnetic heading from this, without having to write your own node to do trigonometric calculations, would be to transform the orientation vector from quaternion to Euler angles. In the resulting Euler pose, yaw angle will be the magnetic heading of your robot.
The tf2 ROS package can do the conversion from quaternion to Euler (Roll/Pitch/Yaw).
See below for implementation examples:
https://answers.ros.org/question/69754/quaternion-transformations-in-python/?answer=69799#post-id-69799
https://answers.ros.org/question/11545/plotprint-rpy-from-quaternion/#17106

Originally posted by pratman with karma: 16 on 2020-10-27
This answer was ACCEPTED on the original site
Post score: 0

Original comments
Comment by nabatta on 2020-10-30:
Thank you!

