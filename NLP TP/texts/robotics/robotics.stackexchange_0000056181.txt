Q:

Using gmapping with amcl

I am using gmapping to send a map to the amcl via the map topic. This all works as long as I remap the tf topic in the amcl node to some other topic. If not then the base_foot print and the lazer scans jump between the map origin and the current goal location.
Can anyone shed light on this behavior?
In amcl is says it publishes the transform from odom (which can be remapped via the ~odom_frame_id parameter) to map.
In gmapping it says it publishes:
map â†’ odom the current estimate of the robot's pose within the map frame

Originally posted by rnunziata on ROS Answers with karma: 713 on 2013-12-18
Post score: 0

A:

Both usually provide localization by publishing the map -> odom tf transform. This is exactly your problem: You have two different sources that provide the same kind of, but different, information.
You should not need amcl at all when running gmapping as amcl only provides localization for a given map. Gmapping already does give you localization (+ mapping).

Originally posted by dornhege with karma: 31395 on 2013-12-18
This answer was ACCEPTED on the original site
Post score: 0

Original comments
Comment by rnunziata on 2013-12-18:
So  you saying, that I can not use gmapping to provide the map service and amcl for the localization? In what sense does amcl use the map topic ...what was its intent? When would it use this feature?
Comment by dornhege on 2013-12-18:
If you already have a map from the environment and only want to localize on that.
Comment by Tim Sweet on 2013-12-18:
You might consider using map_server instead of gmapping. Typically you use gmapping to build a map of the environment, save the map (by running: rosrun map_server map_saver) and then broadcast it at run time using map_server.
Comment by rnunziata on 2013-12-18:
Ok...I wanted to be able to send updated maps as I go along...but I guess I can not do that. I will close this question.
Comment by Tim Sweet on 2014-01-06:
Just to clarify in case anyone Googles this topic: you can update the map as you go, in which case you only need gmapping and not AMCL since gmapping already provides localization.
Comment by Harsh2308 on 2017-09-06:
So typically, is it expected to use AMCL after you have made the map? Or do I even need amcl? I still don't understand when would I specifically need it. Is amcl way better than gmapping's localisation technique that I wouldn't use gmapping for localisation (after creating the map)?

