Q:

add diagnostics at runtime not working (tutorial)

Hi everyone,
When adding diagnostics at runtime using either the script manual_diag.py given here http://wiki.ros.org/diagnostics/Tutorials/Adding%20Analyzers%20at%20Runtime or add_analyzers, the aggregator fails to properly update the group and leaves the added diagnostics under /Other/ even after wating for some time. The add_analyzers reports that the service call succeeded.
Looking at the logs, the aggregator gives:
[ WARN] [1519235533.166823508]: Bond for namespace /startup_analyzers was broken

[ WARN] [1519235533.171578828]: Broken bond tried to remove an analyzer which didn't exist.

I don't see any reasons why as the node adding diags (/startup_analyzers) is still running and I can see /diagnostics_agg/bond pub and sub when rostopic info. I'm running all of this on localhost.
The problem can be reproduced when following the tutorial Adding Analyzers at Runtime at least on Kinetic@Ubuntu 16.04 Kernel 4.13.0.
There is only one node adding diags. Any idea or is that directly a Bond issue ?

Originally posted by Axel13fr on ROS Answers with karma: 36 on 2018-02-22
Post score: 1

A:

So after digging into the https://github.com/ros/diagnostics/tree/indigo-devel/diagnostic_aggregator repository, I found the bug.
Some changes have been made on the diagnostic aggregator, specifically on the topic used to form the bond which is now "/diagnostics_agg/bond" + "add_diags node namespace".
This change has been made on the aggregator itself but only 2 months later on the add_diags script (so bond topic was not matching) and never in the tutorial.
I believe the kinetic release to this date has the changes made in the aggregator but not in the add_diags script, hence this bug.
I solved it by using the latest add_diags script on the github until it gets into kinetic.

Originally posted by Axel13fr with karma: 36 on 2018-02-22
This answer was ACCEPTED on the original site
Post score: 1

