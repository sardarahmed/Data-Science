Q:

[autoware.auto] How to run the 3D perception stack in ADE?

I am trying to run the perception stack in Autoware.Auto by going through this documentation:
https://autowarefoundation.gitlab.io/autoware.auto/AutowareAuto/perception-stack.html
However, I am running into problems. The docs say to set the LD_LIBRARY_PATH for nvidia cards as follows:
ade$ export LD_LIBRARY_PATH=${LD_LIBRARY_PATH}:/usr/local/nvidia/lib64/

But I don't have the /usr/local/nvidia directory in ADE. Then, when I try to run the following command:
ade$ ros2 run velodyne_node velodyne_cloud_node_exe __params:=/home/"${USER}"/AutowareAuto/src/drivers/velodyne_node/param/vlp16_test.param.yaml

I get the following error:
ade$ expected [string] got [not set]

Can anyone help me get the stack up and running?

Originally posted by Jeffrey Kane Johnson on ROS Answers with karma: 452 on 2020-03-16
Post score: 1

A:

Hi Jeffrey,
I discovered the same as you two days ago because I had this setup working in the past but had to set it up again on a different machine. I think I found at least a temporal solution to the problem:
I think the git commit "f569ee9a924a757286e6017dd68bd4ec581d5e51" broke(fixed?) something in the velodyne functionality which seems to cause troubles in the handling of the YAML file. My solution for now is to
checkout the previous commit "f8c2ffbaa6223351ea5fa778e8b5e6127c5fa716"
git checkout f8c2ffbaa6223351ea5fa778e8b5e6127c5fa716
$ade colcon build --packages-select
$ade velodyne_driver velodyne_node source
$ade install/setup.bash 
$ade ros2 run velodyne_node velodyne_cloud_node_exe __params:=/home/"${USER}"/AutowareAuto/src/drivers/velodyne_node/param/vlp16_test.param.yaml
And this works for me. Maybe I try to investigate what causes the problem and write a ticket to contribute.
Best regards,
Andreas

Originally posted by Andreas Lebherz with karma: 36 on 2020-03-19
This answer was ACCEPTED on the original site
Post score: 0

Original comments
Comment by Jeffrey Kane Johnson on 2020-03-19:
Thanks, that was helpful. There seems to be a mismatch in the node namespace. I've submitted a ticket and attached a merge request with a proposed fix: https://gitlab.com/autowarefoundation/autoware.auto/AutowareAuto/-/issues/352
Comment by Andreas Lebherz on 2020-03-19:
Thanks for sending out the ticket!
( Line 2 and 3 should be a single line )
$ade colcon build --packages-select velodyne_driver velodyne_node source
Comment by Jeffrey Kane Johnson on 2020-03-19:
Okay, I think we figured out a simple way to fix this: just add __ns:=/lidar_front to the velodyne node launch command. I put in a merge request to update the documentation: https://gitlab.com/autowarefoundation/autoware.auto/AutowareAuto/-/merge_requests/235/diffs
Thanks for your help, Andreas!

