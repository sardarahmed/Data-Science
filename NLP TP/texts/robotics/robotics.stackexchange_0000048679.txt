Q:

How to quit/exit from a subscriber

Hey all,
I have two publishers with two topics using rospy. I have a third node that subscribe to each of both topics in sequence. I want to use one subscriber for a specified times (may be 10 or 20) and after that exit from this subscriber. Then I subscribe to second and want it to be automatically stopped after given number of times as above. I scanned the google I came to know subscriber.unregister() but it gives error that "'tuple' has no attribute 'unregister'". Any solution to exit from rospy subscriber automatically with out pressing Crl+C.
sb = None 
sb=rospy.Subscriber(topic1,type1,self.callback,(self,sb))
rospy.spin()
sb=rospy.Subscriber(topic2,type2,self.callback,(self,sb))
rospy.spin()

def callback(self,sb):
 self.c = self.c + 1
 if self.c == 10:
    sb.unregister()

Thanks

Originally posted by safzam on ROS Answers with karma: 111 on 2013-02-25
Post score: 1

Original comments
Comment by dornhege on 2013-02-25:
According to the API that should work. Can you come up with a minimal example to reproduce this.
Comment by safzam on 2013-02-25:
sb = None;
sb=rospy.Subscriber(topic1,type1,self.callback,(sb));
rospy.spin();
sb=rospy.Subscriber(topic2,type2,self.callback,(sb);
rospy.spin()
def callback(self,sb):
self.c = self.c + 1;
if self.c == 10:
sb.unregister();
Comment by dornhege on 2013-02-26:
Please update your original post with the code. It's not readable in the comment. As far as I can see, something with the parentheses seems wrong.
Comment by safzam on 2013-02-26:
I have included code up, but its mixed with message. Infact code creates a subscriber and call a callback, I want that callback should be closed after few iteration and then next comes. Both subscriber use the same call back function with differe messagetype. I wanna know how to quit callback.thnx

A:

Looks like you're passing the tuple (self, sb) as the callback args and this tuple now is passed to the callback function under the name sb.

Originally posted by dornhege with karma: 31395 on 2013-02-26
This answer was ACCEPTED on the original site
Post score: 0

Original comments
Comment by safzam on 2013-02-27:
but my question is different. I wanna know how to exit from a callback. unregister does not work in this case, It giver error no attribute as "unregister". Is there any way to exit from a call back after letting it execute for some specified times???? thanks
Comment by dornhege on 2013-02-27:
unregister does, what it is supposed to do. The problem is that you are not calling unregister on the subscriber, but on the tuple that you pass in.
Comment by safzam on 2013-02-27:
ok then can you please write to me how can I call it on the subscriber? just simple example would be nice. thnx
Comment by dornhege on 2013-02-27:
I think the problem that you are not passing a subscriber, but a tuple with (self, subscriber) to your function.
Comment by safzam on 2013-02-28:
Infact in tuple 'self' I need to keep the data in the callback. But I have checked it by removing the tuple then I get error there is no attribute 'unregister'. I would aks you to just write to me the definiton and call of the callback how can I pass only subscriber please? Thanks
Comment by dornhege on 2013-02-28:
Given that you are within a class, I'd suggest to use self.sb = rospy.Subscriber... not passing any other values and within the callback call self.sb.unregister().
Comment by safzam on 2013-03-05:
thank you!

