Q:

Makefile to CMakeLists.txt (ROS, Eclipse)

Hello there,
I'm using a developement board that has its own libraries. I have installed ROS on it and now I need to use publish/subscribe by including its libraries to the CMakeLists.txt of the package. I have to also note that I use Eclipse for compilation, so the CMakeLists.txt is in that form.
Here is the Makefile of hardware library that I want to use in CMakeLists.txt:
DIR=$(shell pwd)/../

INCS = -I.\
        -I$(DIR) \
        -I$(DIR)/hardware \
        -I$(DIR)/hardware/environment \
        -I$(DIR)/hardware/environment/cores \
        -I$(DIR)/hardware/environment/cores/environment \
        -I$(DIR)/hardware/environment/variants \
        -I$(DIR)/hardware/environment/variants/sunxi \
        -I$(DIR)/libraries \
        -I$(DIR)/libraries/Serial \
        -I$(DIR)/libraries/SPI \
    -I$(DIR)/libraries/Wire \
    -I$(DIR)/libraries/LiquidCrystal \
    -I$(DIR)/Basibos/include
LIBS=../libenvironment.a
TARGET=../output/test

OBJS = BasibosAnaProgram

all: 
    @mkdir -p $(TARGET)
    for i in $(OBJS); do echo "$(CXX) $(INCS) $$i.cpp -o $(TARGET)/$$i $(LIBS)"; done
    @for i in $(OBJS); do $(CXX) $(INCS) $$i.cpp -o $(TARGET)/$$i $(LIBS); done

clean:
    @for i in $(OBJS); do rm -f $(TARGET)/$$i; done

And here is the example CMakeLists.txt that Makefile should be included:
cmake_minimum_required(VERSION 2.4.6)
include($ENV{ROS_ROOT}/core/rosbuild/rosbuild.cmake)

rosbuild_init()

set(EXECUTABLE_OUTPUT_PATH ${PROJECT_SOURCE_DIR}/bin)
set(LIBRARY_OUTPUT_PATH ${PROJECT_SOURCE_DIR}/lib)

rosbuild_add_library(${PROJECT_NAME} src/Basibos.cpp)
rosbuild_add_library(${PROJECT_NAME} src/HedefeGitme.cpp)
rosbuild_add_library(${PROJECT_NAME} src/Konum.cpp)
rosbuild_add_library(${PROJECT_NAME} src/Robot.cpp)
rosbuild_add_library(${PROJECT_NAME} src/Sonar.cpp)
rosbuild_add_library(${PROJECT_NAME} src/Zaman.cpp)
rosbuild_add_library(${PROJECT_NAME} src/XMLAyiklayici.cpp)

rosbuild_add_executable(srctest RobotKontrol.cpp)

target_link_libraries(srctest ${PROJECT_NAME}) 

I'm stuck and can't go forward without help. Any help will be greately appreciated. Thanks in advance

Originally posted by mozcelikors on ROS Answers with karma: 181 on 2013-08-04
Post score: 0

Original comments
Comment by vonovak on 2013-08-04:\

remove the duplicate question here http://answers.ros.org/question/70966/makefile-to-cmakeliststxt-ros-and-eclipse/

2)see answer

A:

the CMakeLists.txt is not influenced by eclipse
you should be able to build the library (libenvironment.a if I see correctly) with the makefile that you have, and then use find_package(YOUR_LIB) in your CMakeLists.txt (there is no need to build the library every time you build your project)
see cmake help on how to include libraries

Originally posted by vonovak with karma: 88 on 2013-08-04
This answer was ACCEPTED on the original site
Post score: 0

Original comments
Comment by mozcelikors on 2013-08-04:
I will try that and get back to you. Thanks
Comment by mozcelikors on 2013-08-04:
How can I use libenvironment.a file in find_package function?
Comment by vonovak on 2013-08-04:
you probably need to write your own find module. don't worry, it's not a big deal. everything is described in the help page i linked to. to sketch the outline:
create FindLIBENVIRONMENT.cmake and put it in a dir in ur package
inside of the file use FIND_PATH to find the dir with the library's header file
add the dir path to CMAKE_MODULE_PATH
Comment by mozcelikors on 2013-08-04:
that describes finding a library from header files, but I have .a extensioned file. I presume it is like .so
Comment by vonovak on 2013-08-04:
it works for either. check this paragraph http://www.cmake.org/Wiki/CMake:How_To_Find_Libraries#Writing_find_modules
Comment by mozcelikors on 2013-08-04:
There is too many arguments that will probably not be useful. Can you help me writing this module and attach to your answer. for example the lib is located at ~/libenvironment.a
Comment by vonovak on 2013-08-04:
sorry, u have the figure that one by yourself... I've got work of my own, you see.
Comment by mozcelikors on 2013-08-04:
okay I've written a FindEnvironment.cmake and moved it to /usr/share/cmake-2.8/Modules/ and now that file cannot be found and it suggests me to make a config.cmake file. (which indicates that Find<>.cmake is not found) What should I do?
Comment by vonovak on 2013-08-04:
Never seen that message. Google. Note that in the find module, the NAMES should contain "environment", not "libenvironment" also pay attention to case sensitivity

