Q:

Extract frame time from historic Velodyne PCAP

Hello,
Is there a method to extract the collected POSIX time from each frame in a PCAP file (collected on VLP-16) and not the current wall time? Using rospy to examine the nodes' headers provides the current wall time in POSIX and not the time which the frame was recorded.
Thank you

Originally posted by shaky on ROS Answers with karma: 26 on 2019-08-27
Post score: 0

A:

I found a solution to extracting the acquisition time from a PCAP file acquired by a Velodyne VLP-16 LIDAR in an older question by changing the packet stamp time in the input.cc file within the velodyne_driver package. The follow steps were borrowed from the older question, but I will place here as well.
To accomplish this, git clone velodyne package into the catkin_workspace/src
/home/user/catkin_ws/src
and navigated to
/home/user/catkin_ws/src/velodyne/velodyne_driver/src/lib
and changed the following line in the input.cc file (line 320 on mine)

FROM:   pkt->stamp = ros::Time::now();
TO:  pkt->stamp = ros::Time(header->ts.tv_sec, header->ts.tv_usec * 1000);

Then run catkin_make in /home/user/catkin_ws (and, don't forget to source the /home/user/catkin_ws/devel/setup.bash) and I printed the timestamps for each packet, which matched the acquired time.
Thanks.

Originally posted by shaky with karma: 26 on 2019-08-30
This answer was ACCEPTED on the original site
Post score: 0

