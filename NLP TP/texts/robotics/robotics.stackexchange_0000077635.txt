Q:

neato does not respond to keyboard commands

Hi,
I use ros/kinetic under ubuntu 16.04 and try to get a vorwerk VR100 (XV11) to work.
Issue:
I am at the very beginning to start something really great ... I want to move the VR100 with my keyboard around, but nothing happens when I hit I,U, etc ...
I followed this guide:
https://bbot.org/blog/archives/2016/06/09/using_ros_with_the_neato_xv-11_in_the_year_2016/
According to this guide, I should run first "roslaunch neato_node bringup.launch"
Checking log directory for disk usage. This may take awhile.
Press Ctrl-C to interrupt
Done checking log file disk usage. Usage is <1GB.

started roslaunch server http://mifcom:39688/

SUMMARY
========

PARAMETERS
 * /neato/port: /dev/ttyACM0
 * /rosdistro: kinetic
 * /rosversion: 1.12.6

NODES
  /
    laser_to_base (tf/static_transform_publisher)
    neato (neato_node/neato.py)

auto-starting new master
process[master]: started with pid [22065]
ROS_MASTER_URI=http://localhost:11311

setting /run_id to 50c279a2-ba47-11e6-ba27-d43d7ef32be2
process[rosout-1]: started with pid [22078]
started core service [/rosout]
process[laser_to_base-2]: started with pid [22082]
process[neato-3]: started with pid [22094]
[INFO] [1480872614.927360]: Using port: /dev/ttyACM0

then, roslaunch neato_2dnav move_base.launch
Checking log directory for disk usage. This may take awhile.
Press Ctrl-C to interrupt
Done checking log file disk usage. Usage is <1GB.

started roslaunch server http://mifcom:35750/

SUMMARY
========

PARAMETERS
 * /move_base/TrajectoryPlannerROS/acc_lim_th: 0.5
 * /move_base/TrajectoryPlannerROS/acc_lim_x: 0.5
 * /move_base/TrajectoryPlannerROS/acc_lim_y: 0.0
 * /move_base/TrajectoryPlannerROS/dwa: False
 * /move_base/TrajectoryPlannerROS/goal_distance_bias: 0.8
 * /move_base/TrajectoryPlannerROS/heading_lookahead: 0.325
 * /move_base/TrajectoryPlannerROS/holonomic_robot: False
 * /move_base/TrajectoryPlannerROS/max_rotational_vel: 0.4
 * /move_base/TrajectoryPlannerROS/max_vel_x: 0.15
 * /move_base/TrajectoryPlannerROS/min_in_place_rotational_vel: 0.3
 * /move_base/TrajectoryPlannerROS/min_vel_x: 0.01
 * /move_base/TrajectoryPlannerROS/path_distance_bias: 0.6
 * /move_base/TrajectoryPlannerROS/sim_time: 1.5
 * /move_base/TrajectoryPlannerROS/vtheta_samples: 20
 * /move_base/TrajectoryPlannerROS/vx_samples: 6
 * /move_base/TrajectoryPlannerROS/xy_goal_tolerance: 0.1
 * /move_base/TrajectoryPlannerROS/yaw_goal_tolerance: 0.05
 * /move_base/controller_frequency: 5.0
 * /move_base/global_costmap/base_scan/clearing: True
 * /move_base/global_costmap/base_scan/data_type: LaserScan
 * /move_base/global_costmap/base_scan/marking: True
 * /move_base/global_costmap/base_scan/sensor_frame: base_laser_link
 * /move_base/global_costmap/base_scan/topic: base_scan
 * /move_base/global_costmap/footprint: [[0.1, 0.1], [0.1...
 * /move_base/global_costmap/global_frame: /map
 * /move_base/global_costmap/inflation_radius: 0.42
 * /move_base/global_costmap/observation_sources: base_scan
 * /move_base/global_costmap/obstacle_range: 2.5
 * /move_base/global_costmap/publish_frequency: 0.0
 * /move_base/global_costmap/raytrace_range: 5.0
 * /move_base/global_costmap/robot_base_frame: base_link
 * /move_base/global_costmap/robot_radius: 0.3
 * /move_base/global_costmap/static_map: True
 * /move_base/global_costmap/transform_tolerance: 1.0
 * /move_base/global_costmap/update_frequency: 1.0
 * /move_base/local_costmap/base_scan/clearing: True
 * /move_base/local_costmap/base_scan/data_type: LaserScan
 * /move_base/local_costmap/base_scan/marking: True
 * /move_base/local_costmap/base_scan/sensor_frame: base_laser_link
 * /move_base/local_costmap/base_scan/topic: base_scan
 * /move_base/local_costmap/footprint: [[0.1, 0.1], [0.1...
 * /move_base/local_costmap/global_frame: odom
 * /move_base/local_costmap/height: 2.5
 * /move_base/local_costmap/inflation_radius: 0.42
 * /move_base/local_costmap/observation_sources: base_scan
 * /move_base/local_costmap/obstacle_range: 2.5
 * /move_base/local_costmap/publish_frequency: 1.0
 * /move_base/local_costmap/raytrace_range: 5.0
 * /move_base/local_costmap/resolution: 0.025
 * /move_base/local_costmap/robot_base_frame: base_link
 * /move_base/local_costmap/robot_radius: 0.3
 * /move_base/local_costmap/rolling_window: True
 * /move_base/local_costmap/static_map: False
 * /move_base/local_costmap/transform_tolerance: 1.0
 * /move_base/local_costmap/update_frequency: 2.0
 * /move_base/local_costmap/width: 2.5
 * /rosdistro: kinetic
 * /rosversion: 1.12.6
 * /use_sim_time: False

NODES
  /
    amcl (amcl/amcl)
    map_server (map_server/map_server)
    move_base (move_base/move_base)

ROS_MASTER_URI=http://localhost:11311

core service [/rosout] found
process[map_server-1]: started with pid [22148]
process[amcl-2]: started with pid [22149]
process[move_base-3]: started with pid [22150]
[ INFO] [1480872619.513780877]: Loading from pre-hydro parameter style
[ INFO] [1480872619.527024667]: Using plugin "static_layer"
[ INFO] [1480872619.548839227]: Requesting the map...
[ INFO] [1480872619.751959749]: Resizing costmap to 500 X 500 at 0.050000 m/pix
[ INFO] [1480872619.851844549]: Received a 500 X 500 map at 0.050000 m/pix
[ INFO] [1480872619.855010253]: Using plugin "obstacle_layer"
[ INFO] [1480872619.856506680]:     Subscribed to Topics: base_scan
[ INFO] [1480872619.871332261]: Using plugin "inflation_layer"
[ INFO] [1480872619.921745359]: Loading from pre-hydro parameter style
[ INFO] [1480872619.932123872]: Using plugin "obstacle_layer"
[ INFO] [1480872619.950653666]:     Subscribed to Topics: base_scan
[ INFO] [1480872619.964906688]: Using plugin "inflation_layer"
[ INFO] [1480872620.011788032]: Created local_planner base_local_planner/TrajectoryPlannerROS
[ INFO] [1480872620.019281390]: Sim period is set to 0.20
[ WARN] [1480872620.024521233]: Trajectory Rollout planner initialized with param meter_scoring not set. Set it to true to make your settins robust against changes of costmap resolution.
[ INFO] [1480872621.011056599]: Recovery behavior will clear layer obstacles
[ INFO] [1480872621.032792760]: Recovery behavior will clear layer obstacles
[ INFO] [1480872621.057995019]: odom received!

and finally I start the rosrun teleop_twist_keyboard teleop_twist_keyboard.py:
Reading from the keyboard  and Publishing to Twist!
---------------------------
Moving around:
   u    i    o
   j    k    l
   m    ,    .

For Holonomic mode (strafing), hold down the shift key:
---------------------------
   U    I    O
   J    K    L
   M    <    >

t : up (+z)
b : down (-z)

anything else : stop

q/z : increase/decrease max speeds by 10%
w/x : increase/decrease only linear speed by 10%
e/c : increase/decrease only angular speed by 10%

Now, I would expect, when I hit "i" that the VR100 should move, but ... nothing. Any ideas?
Regards,
tuxiano

Originally posted by tuxiano on ROS Answers with karma: 26 on 2016-12-04
Post score: 0

Original comments
Comment by gvdhoorn on 2016-12-04:
Run rosrun rqt_graph rqt_graph and make sure teleop_twist_keyboard is properly connected to the appropriate topics. If not, that is something to fix.
Comment by tuxiano on 2016-12-04:
Hi gvdhoorn,
thank you for your quick response.
From what looks relevant to me rpt_graph shows an arrow from "teleop_twist_keyboard/teleop_twist_keyboard" to "move_base/cmd_vel" to "neato/neato.
I assume that means, that teleop an neato should communicate with each other.
Kind regard

A:

Hi,
found the solution

Add "blacklist cdc_acm" to /etc/modprobe.d/blacklist.conf
add user to dialout group: "sudo adduser $USER dialout"
add "usbserial vendor=0x2108 product=0x780B" to "/etc/modules"
reboot your system
connect your neato to your PC
Check if the neato appears as /dev/ttyUSB0 in dmesg (if not ...)
Compile neat_driver as explained here: https://github.com/mikeferguson/neato_robot
enable the environment: source /devel/setup.bash
start the launch file "roslaunch neato_node bringup.launch"

If you get an "IOError: [Errno 22] Invalid argument":

Edit "/catkin_ws/src/neato_robot/neato_driver/src/neato_driver/neato_driver.py"
In line 118 change self.port = serial.Serial(port, 115200) to
self.port = serial.Serial(port, 115200, rtscts=True, dsrdtr=True)
delete the build and devel folder
recompile the neato drive
start again "roslaunch neato_node bringup.launch"

Regards,
tuxiano

Originally posted by tuxiano with karma: 26 on 2016-12-05
This answer was ACCEPTED on the original site
Post score: 0

