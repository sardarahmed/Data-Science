Q:

How to pass arguments to/from subscriber callback functions

I'm currently subscribing to the depth image of a Kinect with the following code:
ros::Subscriber sub = nh.subscribe("/camera/depth/image", 3, myDepthViewer);

The callback function, myDepthViewer receives a sensor_msgs image:
void myDepthViewer( const sensor_msgs::ImageConstPtr& image )

So, my question is:  how is myDepthViewer being passed the message if it does not appear in the call, and, how would I pass other arguments to it.  I'd like to do some processing on the image and pass a result back to main.
Thanks for any advice.
Paul.

Originally posted by Paul0nc on ROS Answers with karma: 271 on 2011-11-05
Post score: 9

A:

A boost shared pointer to the message does appear in the call. That is how you access the message. You can't pass other parameters, because this callback is invoked by ROS whenever a message arrives.
The best way to pass information back to main() is defining a C++ class in your program with the callback as a member function. It can then update class data as messages arrive.
Alternatively, you could update some global data structure. That is not generally a good practice unless your node is small and simple.

Originally posted by joq with karma: 25443 on 2011-11-05
This answer was ACCEPTED on the original site
Post score: 10

Original comments
Comment by joq on 2011-11-07:
To repeat, I recommend using class variables rather than global variables.
Comment by joq on 2011-11-07:
That is a basic C++ language question, not appropriate for this forum. There are good C++ resources on-line: http://www.cplusplus.com/doc/tutorial/variables/
Comment by Paul0nc on 2011-11-06:
joq or anyone:  (pardon the basic nature of this question):  is it possible to update a global variable in a callback function.  When I try this, I get compilation errors that the variable is not defined in the scope of the function.  Thanks.
Comment by Paul0nc on 2011-11-06:
Thanks joq.  This was helpful.
Comment by End-Effector on 2015-03-23:
Nice question. I'm having the same problems/questions. There should be some tutorial for this.

