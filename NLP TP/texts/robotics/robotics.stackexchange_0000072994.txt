Q:

Scan matching failed, using odometry

Whenever I'm trying to navigate while using gmapping with my turtlebot2, I get the error "scan matching failed, using odometry" and as a result my local and global costmaps do not get published.  In fact, the map and odom topics never get published to the move_base local and global costmaps and as a result the robot relies on odometry for navigation which is really inaccurate.
Thinking this was a problem with my parameters, I tried gmapping on gazebo on a separate pc and got the same error.  Still convinced that I messed with the parameters somehow, I completely reinstalled ros and tried the gazebo gmapping tutorial found here but got the same error.
Is anyone else experiencing this issue?  On my rqt_graph when using gazebo gmapping, the move_base node doesn't show up at all.

Originally posted by pgigioli on ROS Answers with karma: 354 on 2016-03-22
Post score: 0

A:

You should use the rosrun tf view_frames to display the structure of your tf tree. I think you may lose your tf from /odom to /base_link. I had this problem before, but I didn't use the move_base, instead, I used the robot_pose_ekf to provide the tf from /odom to /base_link.

Originally posted by lightbulb with karma: 63 on 2016-03-23
This answer was ACCEPTED on the original site
Post score: 1

Original comments
Comment by pgigioli on 2016-03-23:
You're absolutely right.  My transform link goes map -> odom X base_footprint -> baselink where X represents the missing transform between odom and base_footprint.  How did you solve this?  Did you simply run the robot_pose_ekf node in parallel with your other nodes?
Comment by pgigioli on 2016-03-23:
Or did you replace move_base with robot_pose_ekf?
Comment by lightbulb on 2016-03-23:
I think using the word "replace" is not correct. When I use gmapping, I just thought that I only can use one of move_base and ekf. But I realize that they serve different purposes when I use amcl. Because I think move_base is a tool which can provides a simple way to make path plan.
Comment by lightbulb on 2016-03-23:
And ekf is a tool to provide tf and more accurate pose information. So, for your concern, I say yes. I think they can run in parallel. Maybe you can try it.
Comment by lightbulb on 2016-03-23:
In addition, I didn't use move_base before, because I didn't know how to alter it to fit my robot at that time and I used my Xbox 360 wireless controller to control my robot.
Comment by pgigioli on 2016-03-24:
robot_pose_ekf did not help.  Do you think this has something to do with a common error I get when I try to do any autonomous navigation "you must specify at least three points for the robot footprint, reverting to previous footprint" ?
Comment by lightbulb on 2016-03-24:
You mean that you have tried robot_pose_ekf, but the tf tree is still wrong? From my experience, I don't have the error you say. If you are trying to use amcl, I suggest you to use move_base and robot_pose_ekf at same time. Because I can make run autonomous navigation with this configuration.
Comment by pgigioli on 2016-03-24:
The tf tree is fine now.  I think the broken tree was a glitch because now it is consistently connected.  Also, I did an odometry test and when I spin the robot in place using teleop keyboard, I get the scan matching failed error.  It seems this error has to do with the mapping process.
Comment by pgigioli on 2016-03-24:
Either the scans aren't matching each other or the scans aren't matching the odometry.  Either way I don't know what to do
Comment by lightbulb on 2016-03-25:
Maybe talking about this problem here is not a good choice, my e-mail is wcy940427@gmail.com. You can send me your nodes graph and let us see what happens.
Comment by jaiswalharsh on 2020-08-13:
@pgigioli I have the same problem the map and odom tf is moving very fast and randomly. The scans arent matching and the map is totally overlapping mess.

