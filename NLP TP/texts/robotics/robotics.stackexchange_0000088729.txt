Q:

Hector_mapping not generate the map

Hello guys,
I'm novice in ROS.
I'm trying a new laser scanner for generating a map, I receive the points of the laser scanner but hector_mapping not generate the map, I don't know why...
P.S. I'm running Ubuntu 17.10 on Virtualbox, ROS melodic.
Unfortunately I can't post a screenshot.
my code on shell:
roslaunch xxxxxxxx_lidar ls.launch scan_mode:=104

file ls.launch
<?xml version="1.0"?>

<launch>
  <!-- .launch XML config files for xxxxxxxx_lidar -->

  <param name="pub_map_odom_transform" value="true"/> 
  <param name="map_frame" value="map"/> 
  <param name="base_frame" value="base_frame"/> 
  <param name="odom_frame" value="base_frame"/>

  <arg name="ip" default="192.168.0.200" />
  <arg name="port" default="10940" />
  <arg name="frame_id" default="lidar" />
  <arg name="point_unit" default="frame" />      <!-- frame/line -->
  <arg name="scan_mode" default="999" />         <!-- 0/1/2/3/4 -->
  <arg name="line_start" default="999" />        <!-- 0~50 -->
  <arg name="line_end" default="999" />          <!-- 0~50 -->
  <arg name="intensity" default="true" />        <!-- true/false -->
  <arg name="multi_echo" default="true" />       <!-- true/false -->
  <arg name="multi_line" default="2" />          <!-- 0/1/2 -->
  <arg name="multi_frame" default="false" />     <!-- true/false -->
  <arg name="up_side" default="true" />          <!-- true/false -->
  <arg name="distance_min" default="0.01" />     <!-- 0.01/0.0~50.0 -->
  <arg name="distance_max" default="50.0" />     <!-- 50.0/0.0~50.0 -->
  <arg name="height_min" default="-50.0" />      <!-- -50.0~-50.0 -->
  <arg name="height_max" default="50.0" />       <!-- 50.0~-50.0 -->
  <arg name="width_min" default="-50.0" />       <!-- -50.0~-50.0 -->
  <arg name="width_max" default="50.0" />        <!-- 50.0~-50.0 -->
  <arg name="pan_min" default="-180" />          <!-- -180~0 -->
  <arg name="pan_max" default="180" />           <!-- 180~0 -->
  <arg name="tilt_min" default="-90" />          <!-- -90~0 -->
  <arg name="tilt_max" default="90" />           <!-- 90~0 -->

  <node pkg="xxxxxxxx_lidar" name="xxxxxxxx_lidar" type="xxxxxxxx_lidar">
    <!-- Attributes: name="namespace/name" value="value" type="str|int|bool" -->
    <param name="ip" value="$(arg ip)" type="str"/>
    <param name="port" value="$(arg port)" type="int"/>
    <param name="frame_id" value="$(arg frame_id)" type="str"/>
    <param name="point_unit" value="$(arg point_unit)" type="str"/>
    <param name="scan_mode" value="$(arg scan_mode)" type="int"/>
    <param name="line_start" value="$(arg line_start)" type="int"/>
    <param name="line_end" value="$(arg line_end)" type="int"/>
    <param name="intensity" value="$(arg intensity)" type="bool"/>
    <param name="multi_echo" value="$(arg multi_echo)" type="bool"/>
    <param name="multi_line" value="$(arg multi_line)" type="int"/>
    <param name="multi_frame" value="$(arg multi_frame)" type="bool"/>
    <param name="up_side" value="$(arg up_side)" type="bool"/>
    <param name="distance_min" value="$(arg distance_min)" type="str"/>
    <param name="distance_max" value="$(arg distance_max)" type="str"/>
    <param name="height_min" value="$(arg height_min)" type="str"/>
    <param name="height_max" value="$(arg height_max)" type="str"/>
    <param name="width_min" value="$(arg width_min)" type="str"/>
    <param name="width_max" value="$(arg width_max)" type="str"/>
    <param name="pan_min" value="$(arg pan_min)" type="str"/>
    <param name="pan_max" value="$(arg pan_max)" type="str"/>
    <param name="tilt_min" value="$(arg tilt_min)" type="str"/>
    <param name="tilt_max" value="$(arg tilt_max)" type="str"/>
  </node>
 
  <node name="rviz" pkg="rviz" type="rviz" args="-d $(find xxxxxxxx_lidar)/tool/ls.rviz" />

  <include file="$(find hector_mapping)/launch/mapping_xxxxxxxx.launch"/> 

</launch>

file mapping_xxxxxxxx.launch:
    <?xml version="1.0"?>
<launch>
    <arg name="tf_map_scanmatch_transform_frame_name" default="scanmatcher_frame"/>
    <arg name="base_frame" default="base_link"/>
    <arg name="odom_frame" default="base_link"/>
    <arg name="pub_map_odom_transform" default="true"/>
    <arg name="scan_subscriber_queue_size" default="5"/>
    <arg name="scan_topic" default="scan"/>
    <arg name="map_size" default="2048"/>

    <node pkg="hector_mapping" type="hector_mapping" name="hector_mapping" output="screen">    

    <!-- Frame names -->
    <param name="map_frame" value="map" />
    <param name="base_frame" value="$(arg base_frame)" />
    <param name="odom_frame" value="$(arg odom_frame)" />

    <!-- Tf use -->
    <param name="use_tf_scan_transformation" value="true"/>
    <param name="use_tf_pose_start_estimate" value="false"/>
    <param name="pub_map_odom_transform" value="$(arg pub_map_odom_transform)"/>
    
    <!-- Map size / start point -->
    <param name="map_resolution" value="0.050"/>
    <param name="map_size" value="$(arg map_size)"/>
    <param name="map_start_x" value="0.5"/>
    <param name="map_start_y" value="0.5"/>
    <param name="map_multi_res_levels" value="2" />
    
    <!-- Map update parameters -->
    <param name="update_factor_free" value="0.4"/>
    <param name="update_factor_occupied" value="0.9" />    
    <param name="map_update_distance_thresh" value="0.4"/>
    <param name="map_update_angle_thresh" value="0.06" />
    <param name="laser_z_min_value" value = "-1.0" />
    <param name="laser_z_max_value" value = "1.0" />
    
    <!-- Advertising config --> 
    <param name="advertise_map_service" value="true"/>
    
    <param name="scan_subscriber_queue_size" value="$(arg scan_subscriber_queue_size)"/>
    <param name="scan_topic" value="$(arg scan_topic)"/>
    
    <!-- Debug parameters -->
    <!--
      <param name="output_timing" value="false"/>
      <param name="pub_drawings" value="true"/>
      <param name="pub_debug_output" value="true"/>
    -->
    <param name="tf_map_scanmatch_transform_frame_name" value="$(arg tf_map_scanmatch_transform_frame_name)" />
    </node>

    <node pkg="tf" type="static_transform_publisher" name="map_2_lidar" args="0 0 0 0 0 0 /map /lidar 100"/>

</launch>

Originally posted by frasar on ROS Answers with karma: 1 on 2018-08-27
Post score: 0

A:

First off, it makes this alot more challenging for volunteers to try to help you if your obscure your setup with xxxxxxx as the unit name.
Secondly, I'd ensure you have things coming through the topic SLAM expects the scan through and there is a TF tree. Any errors from Hector?

Originally posted by stevemacenski with karma: 8272 on 2018-08-27
This answer was ACCEPTED on the original site
Post score: 0

