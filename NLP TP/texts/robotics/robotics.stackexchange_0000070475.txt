Q:

Python ApproximateTimeSynchronizer not working

Dear all,
I want to subscribe to synchronized depth and rgb images using message_filters and ApproximateTImeSynchoronizer.
def rgb_callback(image):
     rospy.loginfo("got RGB image")

def depth_callback(image):
    rospy.loginfo("got DEPTH image")

def scan_callback(image,depth):
    rospy.loginfo("got synched images")

def hand_tracker():

    rospy.init_node('hand_tracker')
    image_sub=message_filters.Subscriber('/kinect2/hd/image_color_rect',Image)
    depth_sub=message_filters.Subscriber('/kinect2/hd/image_dept_rect',Image)        

    rospy.Subscriber('/kinect2/hd/image_color_rect',Image,rgb_callback)    
    rospy.Subscriber('/kinect2/hd/image_depth_rect',Image,depth_callback)    
            
    ts=message_filters.ApproximateTimeSynchronizer([image_sub,depth_sub],10,1)    
    ts.registerCallback(scan_callback)
    try:
        rospy.spin()
    except KeyboardInterrupt:        
        print "Shutting down"        

The problem is that rgb callback and depth callback are called, but the scan_callback using ApproximateTimeSynchronizer not. Is it a bug or is there something I am doing wrong?

Originally posted by Markus Eich on ROS Answers with karma: 202 on 2015-11-19
Post score: 0

A:

This is something I recently discovered as well, you cannot subscribe to the same topic twice from within the same node. The second subscribers is just ignored and the callback will never be called. Try removing the
rospy.Subscriber('/kinect2/hd/image_color_rect',Image,rgb_callback)    
rospy.Subscriber('/kinect2/hd/image_depth_rect',Image,depth_callback) 

and see if your scan callback is now called.

Originally posted by Chrissi with karma: 1642 on 2015-11-20
This answer was ACCEPTED on the original site
Post score: 0

Original comments
Comment by zkytony on 2022-09-05:
This is in conflict with this post here that says you can subscribe to the same topic multiple times within one node: https://answers.ros.org/question/289237/is-it-safe-to-subscribe-multiple-times-to-the-same-topic/?answer=289243#post-id-289243

