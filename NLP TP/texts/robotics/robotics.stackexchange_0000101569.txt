Q:

Why the basic example of service in ROS2 doesnt use rosidl?

In the migrating article from ROS to ROS2, it says that for messages and services we have to add on CMakeLists.txt and on package.xml some rosidl lines. So why on "Writing a simple service and client (C++)" it doesnt use it and in which cases we should use it?
Thanks in advance

Originally posted by Peanpepu on ROS Answers with karma: 17 on 2022-04-25
Post score: 0

Original comments
Comment by ljaniec on 2022-04-25:
Can you link us these articles? Especially the first one about migrating

A:

I am not sure if this is it, but in the ROS2 tutorials the package example_interfaces is used - there in CMakeLists.txt you have these lines:
find_package(ament_cmake REQUIRED)
find_package(rosidl_default_generators REQUIRED)

rosidl_generate_interfaces(${PROJECT_NAME}
  "action/Fibonacci.action"
  ...
  "srv/Trigger.srv"
)
install(FILES mapping_rules.yaml DESTINATION share/${PROJECT_NAME})

ament_export_dependencies(rosidl_default_runtime)
ament_package()

and in package.xml:
<package format="3">
  <name>example_interfaces</name>
  <version>0.9.3</version>
  <description>Contains message and service definitions used by the examples.</description>
  <maintainer email="mabel@openrobotics.org">Mabel Zhang</maintainer>
  <license>Apache License 2.0</license>
  <author email="dthomas@openrobotics.org">Dirk Thomas</author>
  <author email="jacob@openrobotics.org">Jacob Perron</author>
  <buildtool_depend>ament_cmake</buildtool_depend>
  <buildtool_depend>rosidl_default_generators</buildtool_depend>
  <depend>action_msgs</depend>
  <exec_depend>rosidl_default_runtime</exec_depend>
  <member_of_group>rosidl_interface_packages</member_of_group>

A note about package_name_interfaces from https://docs.ros.org/en/foxy/Tutorials/Single-Package-Define-And-Use-Interface.html :

While best practice is to declare
interfaces in dedicated interface
packages, sometimes it can be
convenient to declare, create and use
an interface all in one package.

The dependencies in the basic service examples are fulfilled with ament_target_dependencies(service_main rclcpp example_interfaces) in their CMakeLists.txt (e.g. https://github.com/ros2/examples/blob/master/rclcpp/services/minimal_service/CMakeLists.txt).

Originally posted by ljaniec with karma: 3064 on 2022-04-25
This answer was ACCEPTED on the original site
Post score: 1

Original comments
Comment by Peanpepu on 2022-04-25:
Ok thank you. However, if i want to use a srv from my own folder i have to include all these rosidl stuff, isnt it?
The migrating article is this one: "https://docs.ros.org/en/foxy/Contributing/Migration-Guide.html"
And the service basic example is the one you have seen: "https://docs.ros.org/en/foxy/Tutorials/Writing-A-Simple-Cpp-Service-And-Client.html"
Comment by ljaniec on 2022-04-25:
Overall, yes - you can use ament macro ament_target_dependencies in your package too (https://docs.ros.org/en/foxy/How-To-Guides/Ament-CMake-Documentation.html#adding-dependencies)
Comment by ljaniec on 2022-04-25:
If this is the correct answer, please upvote and accept it so others can see that it has been answered

