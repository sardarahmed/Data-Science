Q:

"ImportError no module named" error when package with msg also has setup.py and installed

I have a package with a foo.msg and a python module my_package/src/my_package/bar.py that works fine in the devel space- I can import the msg or alternatively import the python module just fine.  But after running catkin_make install the I get an import error:
catkin_make install
source devel/setup.bash
python
>>>> from mypackage.msg import Foo
>>>>
>>>>  # (no error output, worked fine)
source install/setup.bash
>>>> from mypackage.msg import Foo
Traceback (most recent call last):
    File "<stdin>", line 1, in <module>
Import Error: No module named my_package.msg

I commented out the catkin_python_setup from the CMakeLists.txt and rebuilt (rm -rf build devel install followed by source /opt/ros/jade/setup.bash seems safest which maybe ought to become the topic of another question...), then the import works fine.
One thing I notice is that the module bar.py is installed into install/lib/python2.7/dist-packages/my_package, and there are no init.py files in that directory, only one directory lower in msg (it contains init.py and _Foo.py and pyc versions).
This is jade with Ubuntu 14.04.

Originally posted by lucasw on ROS Answers with karma: 8729 on 2017-05-01
Post score: 0

Original comments
Comment by lucasw on 2017-05-01:
Actually now that I try it the importing of bar isn't working in the devel space either, so that being configured wrong may be a component of the problem.
Comment by lucasw on 2017-05-01:
my_package/src/my_package/ was missing init.py, added it and now this works:
from my_package.bar import bar

A:

The answer is to make sure that my_package/src/my_package/init.py exists, otherwise it can't import that module but also screws up msg modules from the same package when installed.

Originally posted by lucasw with karma: 8729 on 2017-05-01
This answer was ACCEPTED on the original site
Post score: 1

