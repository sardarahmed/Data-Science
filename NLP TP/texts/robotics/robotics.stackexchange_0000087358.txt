Q:

Shutdown a node from another node in ROS CPP

I am looking for a way to shut down a node from another node.
from subprocess import call
call(["rosnode", "kill", "my_node"], shell=True)

The code above works fine with ROS Python. I am looking for the same in ROS CPP.

Originally posted by ravijoshi on ROS Answers with karma: 1744 on 2018-06-14
Post score: 0

A:

Instead of doing a System call, I'd rather use a ROS Service which then Triggers a shutdown of the node in question.
This is way more portable than hard-coding a node Name that can easily be changed using a roslaunch tag.

EDIT
Create a ServiceServer in the node you want to shut down that triggers ros::shutdown and stops the node. Ideally, you wouldn't do the shutdown in the Service "callback" itself, but rather set some flag that shuts down the node after some short time. This will allow the Service to return a Response.
Thus, your calling node requires a ServiceClient with whatever Service type you see fit. I'd suggest std_srvs/Trigger. But std_srvs/Empty would do as well.

Originally posted by mgruhler with karma: 12390 on 2018-06-14
This answer was ACCEPTED on the original site
Post score: 2

Original comments
Comment by ravijoshi on 2018-06-14:
I like this suggestion. Just want to know, what do you mean by use a ROS Service? Do you want me to create a ROS service with empty request data? Can you please elaborate a bit more?
Comment by mgruhler on 2018-06-14:
see edit above
Comment by ravijoshi on 2018-06-14:
Interesting. set some flag that shuts down the node after some short time This seems tricky. How much is the short time?
Comment by srinskit on 2018-06-14:
Do you have a while in the main?. Make the exit condition ros::ok() && shutdown_flag. Then just flip shutdown_flag in the callback.
Comment by ravijoshi on 2018-06-14:
Since my service server node is in Python and service client is in C++. I created a sample code in Python. Here is the link.
Comment by srinskit on 2018-06-14:
So solved?
Comment by ravijoshi on 2018-06-14:
I think so. I haven't checked the code yet since I am out of the town. thanks again for the help.

