Q:

[SOLVED] ros_canopen: "Did not receive a response message"

Hello!
I have established a working package that drives a servo motor through ros_canopen. The earlier problems with solutions is given in the question: here.
Even though i am able to both control the servo motor with a position_controllers/JointPositionController in   required_drive_mode: 1 and read the actual position through the /joint_states topic,
it bothers me, that i get often (for example after 1 minute of testing the position controller) the following error messages in the terminal:
Did not receive a response message
abort1001#0, reason: Client/server command specifier not valid or unknown.
Could not process message
discarded message 
Did not receive a response message
abort606c#0, reason: Client/server command specifier not valid or unknown.
Could not process message
discarded message 
Did not receive a response message
abort606c#0, reason: Client/server command specifier not valid or unknown.
Could not process message
discarded message 
Did not receive a response message
abort606c#0, reason: Client/server command specifier not valid or unknown.
Could not process message
discarded message 
discarded message 
discarded message 
discarded message 
discarded message 
discarded message

Nothing crashes, i am still able to control the motor continuously, but the aforementioned error messages pop quite often, and it bothers me a bit.
Can you help me what could be the problem that causes these issues?
Regarding the CANopen setup, i have:
sync: interval_ms: 100

I use only one TPDO and one RPDO:
RPDO1: 0x60400010, 0x607a0020

TPDO1: 0x60410010, 0x60610008, 0x60640020

I tried both with transmission type=255 and transmission type=1 (in 1400sub2, 1800sub2). In both cases the motor control works, and the aforementioned error messages pop frequently.
Thank you for the help in advance.
Best regards,
Akos

Originally posted by akosodry on ROS Answers with karma: 121 on 2018-07-02
Post score: 0

A:

As @Mathias Lüdtke wrote, the situation was that

606C is read via SDO and not PDO.

This was confirmed once i check the candump. Therefore i tried different ways to modify/update the PDO mapping, but no working PDO mapping combination was found for days beside the one that i posted originally in the question.
This was wrote by me earlier in the comment section:

I tried to map 606C two different
ways: 1) if i put it in 1A00sub4 then
the driver/init crashes. If i put it
in TPDO1 (1A01sub1), i dont get joint
velocity values in joint_states

Indeed, the 1) first option was not possible to be performed, cause that way the 8 byte limit is exceeded. (later i realized..)
The 2) second option should have worked from the begining, but unfortunately for days it did not work and i could not understand what makes the problem..
Finally, after spending lots of hours analyzing the candump, taking observations it was concluded that still something is wrong with the EDS file, namely the mapping we set is not received in ROS.
The errors were the following:
[1401sub1]
ParameterName=COB-ID used by PDO
DefaultValue=$NodeID+0x80000300   ----> THIS SHOULD HAVE BEEN: +0x300

[1402sub1]
ParameterName=COB-ID used by PDO
DefaultValue=$NodeID+0x80000400   ----> THIS SHOULD HAVE BEEN: +0x400

[1403sub1]
ParameterName=COB-ID used by PDO
DefaultValue=$NodeID+0x80000500   ----> THIS SHOULD HAVE BEEN: +0x500

[1801sub1]
ParameterName=COB-ID used by PDO
DefaultValue=$NodeID+0x80000280   ----> THIS SHOULD HAVE BEEN: +0x280

[1802sub1]
ParameterName=COB-ID used by PDO
DefaultValue=$NodeID+0x80000380   ----> THIS SHOULD HAVE BEEN: +0x380

[1803sub1]
ParameterName=COB-ID used by PDO
DefaultValue=$NodeID+0x80000480   ----> THIS SHOULD HAVE BEEN: +0x480

This was also confirmed by Mathias.
The realization of these errors were so so frustrating, since the CANopen manual provided by the manufacturer listed the right defaultValues, and we assumed from the begging (wrongly) that the EDS file is in harmony with the manual. It took us weeks to realize that the root of every question i posted here (
#q294210,
#q294570,
#q294869,
#q295935)
was related to a wrongly written (or not checked, or idk) EDS file. Nevertheless, the lesson was learnt.
I want to thank again @Mathias Lüdtke the constant help, support, hints and answers.
Best regards,
Ákos

Originally posted by akosodry with karma: 121 on 2018-07-11
This answer was ACCEPTED on the original site
Post score: 1

