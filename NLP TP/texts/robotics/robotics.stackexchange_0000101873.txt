Q:

ROS2 nav2 global costmap disappearing

Hello, I am using ros2 foxy on Ubuntu 20.04 with rviz2 and gazebo 11.
I'm running a robot in a simulation and will soon test my program on a real robot.
Everything launch and work as intended :

I can drive the robot with teleop
I can use nav2 to tell it to go from point A to point B

Now I want to save a map of where the robot has been when driving.
I set up it's footprint so when I move it around, the global_costmap gets "populated" with white cells (if I understand correctly, it means they go from unknown to free).
However, after 3/4 minutes of driving the global costmap disappear with this message :
[bt_navigator-11] [INFO] [1654067456.988313971] [bt_navigator]: Begin navigating from current location to (3.10, 1.08)
[controller_server-8] [INFO] [1654067457.016923884] [local_costmap.local_costmap]: Received request to clear entirely the local_costmap
[bt_navigator-11] [WARN] [1654067457.017791003] [bt_navigator_rclcpp_node]: Node timed out while executing service call to local_costmap/clear_entirely_local_costmap.
[controller_server-8] [INFO] [1654067457.018207010] [local_costmap.local_costmap]: Received request to clear entirely the local_costmap
[planner_server-9] [INFO] [1654067457.019795388] [global_costmap.global_costmap]: Received request to clear entirely the global_costmap
[recoveries_server-10] [INFO] [1654067457.023361510] [recoveries_server]: Attempting spin

I think it is a normal behavior but is there a way to stop that from happening so I can move around my entire area and then save it as a map for future uses ?
Thank you for taking the time to read my question, feel free to correct anything you think is wrong/inaccurate.
Edit (1) : After more testing, it appear that this happens when the robot get's "stuck" or have difficulties to follow the path it was given.

Originally posted by Bastian2909 on ROS Answers with karma: 68 on 2022-06-01
Post score: 0

A:

I think you should check your Behavior Tree for this Behaviors plugin Clear Costmap call:

https://navigation.ros.org/plugins/index.html#behaviors

A service to clear the given costmap
in case of incorrect perception or
robot is stuck

https://github.com/ros-planning/navigation2/blob/main/nav2_costmap_2d/src/clear_costmap_service.cpp

If you want to not use it, modifying a BT is the way to go. I recommend Groot for this, it's easier.
https://navigation.ros.org/tutorials/docs/using_groot.html
For the ROS2 Galactic installation:
   cd ~/dev_ws/src
   git clone https://github.com/BehaviorTree/Groot.git
   cd ..
   rosdep install --from-paths src --ignore-src
   colcon build --symlink-install --packages-select groot

I have sudo apt install ros-galactic-behaviortree-cpp-v3 before too.
You have to source install/setup.bash and ./build/groot/Groot.
You can load BT XMLs from the Nav2 repository/your package and modify it.

Originally posted by ljaniec with karma: 3064 on 2022-06-01
This answer was ACCEPTED on the original site
Post score: 1

