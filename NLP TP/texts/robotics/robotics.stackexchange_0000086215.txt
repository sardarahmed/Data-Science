Q:

freenect_launch vs openni_launch recommendations for kinect

Hi everyone,
I'm struggling with those nodes for connecting to my kinect. The thing is, I tried several ways to have the most stable data transmission between rgb and depth sensors through ros without sucess. I mean, I got good results when I mapped a close indoor room, but always getting some kind of error for openni and freenect I never understood and which sometimes get solved by restarting my laptop. For example, when I was using freenect_launch everything seemed work fine most of time, but I noticed every time I used that group of nodes, more common I got camera/camera_nodelet_manager errors, or such as [camera/driver-2] escalating to SIGTERM | [camera/camera_nodelet_manager] escalating to SIGTERM or a Sorry, the application nodelet has stopped unexpectedly (which turns out on a log file error at startup every time I turn on my laptop, fortunately I managed to erase those logging errors). Or the kinect device is not connected and turns out that I have to restart the laptop in order it recognizes kinect.
I don't know what could be wrong with freenect_launch or if it's on my kinect or something I missed, but everything should work fine.

I'm using kinect V1 model 1414, under ros-kinetic and obviously freenect-camera and openni-camera.
on port USB 2.0 cause I know it has some tricky behavior with transfer rates.
And supplied by the following ros document kinect supply

I'm working with depth sensor so I'm also using depthimage-to-laserscan package, with the following parameters I think should be fine:
          <!-- depth image to laser scan -->

<node pkg="depthimage_to_laserscan" type="depthimage_to_laserscan" name="depthimage_to_laserscan">

  <param name="scan_height" value="1"/>  
  <param name="output_frame_id" value="/$(arg camera)_depth_frame"/>
  <param name="range_min" value="0.45"/> 
  <!-- <param name="range_max" value="5.0"/> -->
  <param name="scan_time" value="0.1"/> 
  <remap from="image" to="$(arg camera)/$(arg depth)/image_raw"/>
  <remap from="scan" to="$(arg scan_topic)"/>

  <remap from="$(arg camera)/image" to="$(arg camera)/$(arg depth)/image_raw"/>
  <remap from="$(arg camera)/scan" to="$(arg scan_topic)"/>

</node>

Another common error I got like these. By the way everytime I started freenect_launch this message appeared at the end Stopping device RGB and Depth stream flush (after the typical calibrations warns, the ones that tell you haven't calibrate your camera), what does that mean? is it irrelevant?
Because of that, I started using openni_launch and I had the same issues that freenect_launch, but rarely. At first I started using that without OpenNi unstable nor SensorKinect, cause I didn't noticed that at the end from openni_camera documentation it was needed to have the kinect working properly. So I followed the steps from here and here which are practically the same, and managed installing those but unfortunately as a super user. I couldn't do that as a normal user cause it didn't let me.
After that, openni and freenect started getting worse and now I'm unable to launch correctly both of them. When I launch openni_launch I got this error as normal user second picture. I searched for a solution to USB events thread - failed to set priority. This might cause loss of data... and I found I needed to execute that as super user, so I source ros environment solving that issue, but I got same error as picture 1, some kind of deal with nodelet_manager.
After that. I also tried to launch freenect_launch and I got stuck on an infinite loop of

[ INFO] [1522214806.272386022]:
Stopping device RGB and Depth stream
flush.
[ INFO] [1522214839.596183464]: Device
timed out. Flushing device.
[ INFO] [1522214839.596544078]:
Starting a 3s RGB and Depth stream
flush.
[ INFO] [1522214842.600783849]:
Stopping device RGB and Depth stream
flush.
[ INFO] [1522214844.596282148]: Device
timed out. Flushing device . [ INFO]
[1522214844.596517753]: Starting a 3s
RGB and Depth stream flush.
[ INFO] [1522214847.598011494]:
Stopping device RGB and Depth stream
flush.
[ INFO] [1522214849.596411085]: Device
timed out. Flushing device.
[ INFO] [1522214849.596705996]:
Starting a 3s RGB and Depth stream
flush.
[ INFO] [1522214852.600839436]:
Stopping device RGB and Depth stream
flush.
[ INFO] [1522214854.596835174]: Device
timed out. Flushing device.
[ INFO] [1522214854.597068507]:
Starting a 3s RGB and Depth stream
flush.
[ INFO] [1522214857.605973709]:
Stopping device RGB and Depth stream
flush.
[ INFO] [1522214859.596852188]: Device
timed out. Flushing device.
[ INFO] [1522214859.597159147]:
Starting a 3s RGB and Depth stream
flush.
[ INFO] [1522214862.606207970]:
Stopping device RGB and Depth stream
flush

So now I can't use none of them, and I only want to use one of them in a stable way. I tried reinstalling OpenNi and PrimeSense without success, openni_launch and freenect_launch, but I got same errors. So I think I should reinstall ROS completely and deleting all kinect programs involved. But what I'm missing? what is the best way to have the kinect sensor working properly for some of these packages. I'm sure that is not necessary to calibrate my kinect sensor with a chessboard and that something is the reason of all of this.
So please could you suggest me some steps or what could be the problem, I've been investing so much time looking for the problem. By the way, I noticed that freenect and openni weren't using a defined frame rate and that used to figure a frame rate on camera_link of 10000[Hz]. So I set inside that a frame rate of 10[hz] in order my tf_tree had default frame rate.
You know what? I noticed that after I got almost every kind of error and try to launch those nodes, it behaves better, I mean most of errors disappear, like if the system supplied by socket improved the data transmission over depth and rgb sensors.
Please, someone enlighten me
Thank you
------------EDIT 1----------------
Hey guys, I noticed the usb 2.0 and 3.0 data transfer is veeeeery slow. I've got used to that, but that must be the problem! My laptop have an uefi mode, not like most of BIOS systems, so if I managed to set it correctly for a normal or better usb data transmission, maybe this problem is solved.

Originally posted by Jean_jierrre on ROS Answers with karma: 11 on 2018-03-28
Post score: 1

A:

I solved it partially by reinstalling ubuntu with dualboot again and making new supply circuit according to kinect powering. So I had a huge kinect compatibility and drivers interface problem after installing openni_camera. After that I noticed that like 5% of time, data transmission from kinect doesn't recognize Microsoft Corp. Xbox NUI Camera by typing lsusb on terminal repeatedly. I mean, it recognizes the three sources Microsoft Corp. Xbox NUI Camera, Microsoft Corp. Xbox NUI Audio and Microsoft Corp. Xbox NUI Motor, but not always the three of them, even after formating.
I think it's goona work fine most of time since now, but I want it to work properly and without concerning about how much time I have left before it starts behaving wrong and having every time more conflicts with camera/nodelet_camera.
Another symptom I've always had just after killing freenect_launch or openni_launch is this one from imgur. A crashing report that probably will make a new one pops up next time I restart ubuntu.
This time I haven't installed OpenNI, nor SensorKinect, and similar things related to interfacing with kinect. Just ROS, freenect_camera, launch and openni_camera and launch, and obviously another packages I'm working with like rosserial, navigation, nav2d, teleoptwistkeyboard, etc.
Sorry, I forgot to mention laptop and some specs:
-Asus Intel Core i7-7500U, up to GHz, 12 Gb RAM, HDD 1 Tb, Nvidia Geforce 940MX, OS as Free DOS and under UEFI.
-It has installed dualtboot with Windows 10 at first and ubuntu 16.04.4 LTS.
-ROS Kinetic version.
-Two kinects, model 1414 which are in perfect conditions supposedly.
-In order to installing ubuntu I had to use usb2.0 and enable security mode and change some starting parameters which I don't remember at this moment, but I guess that doesn't matter, right?
Is there any clue to resolve this problem?
Thanks
------------EDIT 1----------------
Hey guys, I noticed the usb 2.0 and 3.0 data transfer is veeeeery slow. I've got used to that, but that must be the problem! My laptop have an uefi mode, not like most of BIOS systems, so if I managed to set it correctly for a normal or better usb data transmission, maybe this problem is solved.
------------EDIT 2----------------
I managed to improve usb transmission data through windows, and ubuntu inside BIOS, but that wasn't the problem. it has to be nodelet the problem. After installing all libfreenect dependencies, seems there is no longer any problems with usb transmission and lsusb always shows up three kinect components.
The problem definitely resides on camera/camera_nodelet_manager. Most of times I kill freenect camera nodes it shows this error .
I hope you can help me with that

Originally posted by Jean_jierrre with karma: 11 on 2018-04-03
This answer was ACCEPTED on the original site
Post score: 0

Original comments
Comment by Jean_jierrre on 2018-04-25:
I've definitely solved this issue by reinstalling ROS and updating the system. I also had to delete and manually installing freenect_camera and set my video card driver (cause I forgot set that since the system used the default X.Org.Server one). So it was solved like two weeks ago

