Q:

Mounting Robot Arm From Ceiling

I'm toying with the idea of a ceiling mounted robot arm, and I'm curious what the best way is to change the link to the world frame to represent this most accurately in RViz? I've read something about a top-level xacro file, so I can make changes to a robot model without changing the underlying URDF in the fanuc package I'm using. Any info on best practices for this, or how to get the robot to appear upside down, with its mount somewhere other than the origin of the world frame would be helpful,
Thanks,
Josh

Originally posted by jbeck28 on ROS Answers with karma: 101 on 2019-04-25
Post score: 1

A:

This would be no different from mounting your robot model as you would do it normally "on the floor".
Create a new .xacro file, import the robot macro .xacro as you'd normally do.
Then create the fixed joint that you'd normally create to place the robot in your scene, but instead of using an identity transform (ie: xyz="0 0 0" rpy="0 0 0") specify a Z-offset (to translate it "into the air"), then rotate it over either the Y or the X axis by 180 degrees and make the robot's base_link the child frame.
Example:
<?xml version="1.0" ?>
<robot name="upside_down_m10ia" xmlns:xacro="http://wiki.ros.org/xacro">
  <xacro:include filename="$(find fanuc_m10ia_support)/urdf/m10ia_macro.xacro"/>
  <xacro:fanuc_m10ia prefix="robot_"/>

  <link name="world" />
  <joint name="ceiling_joint" type="fixed">
    <origin xyz="0 0 2" rpy="0 ${radians(180)} 0" />
    <parent link="world" />
    <child link="robot_base_link" />
  </joint>
</robot>

In RViz, this would look like this (after setting the Fixed Frame setting to world):

Note how world has positive X pointing "away" from the robot. That is because I rotated 180 degrees over Y. If you don't like that, you could add an additional intermediate frame or an add an additional rotation.

Any info on best practices for this, or how to get the robot to appear upside down, with its mount somewhere other than the origin of the world frame would be helpful,

Note btw that if you've been using the provided top-level .xacro files in the Fanuc support packages then those robots are not "mounted", but the kinematic chain just starts at the base_link of the robot. And as there is nothing else, that automatically becomes the root of your world.

Edit: you might want to add an additional tool frame that is rotated such that Z+ is again "up", instead of down (as it would be because of the ceiling mount).
It's not required, but might be nice.

Originally posted by gvdhoorn with karma: 86574 on 2019-04-25
This answer was ACCEPTED on the original site
Post score: 5

Original comments
Comment by jbeck28 on 2019-04-26:
Thank you very much for your thorough response, much appreciated. However, implementing the changes you mentioned does not impact the robot model, and when I convert the .xacro to a URDF as a simple check, the link and joint added after the include line does not appear in the generated URDF file. I must be doing something wrong, any idea?
Comment by gvdhoorn on 2019-04-26:\

I must be doing something wrong, any idea?

It sounds like you don't have your Fixed Frame set to the world frame.
Comment by jbeck28 on 2019-04-26:
How would I modify that? I just realized the robot appears correctly (upside down) in setup assistant.
Comment by gvdhoorn on 2019-04-26:\

How would I modify that?

It's an RViz configuration option. In the Displays panel, under Global Options.
Comment by gvdhoorn on 2019-05-02:
Did this work for you in the end?
Comment by jbeck28 on 2019-05-22:
Sorry I never replied, this worked perfectly, Thank you very much for your assistance!

