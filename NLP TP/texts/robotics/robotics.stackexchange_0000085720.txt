Q:

Keyboard Teleop settings

I write a program in arduino.
i  want to do the same with ros-keyboard_teleop.
can sombody guide me ?any tutorial link.
void setup() 
{
  pinMode(24, OUTPUT);
  pinMode(25, OUTPUT);
  Serial.begin(9600);
}

void loop() 
{ 
  if (Serial.available())
  {
    char data = Serial.read();
    
    if(data == 'i')
    {
      digitalWrite(24, LOW);
      digitalWrite(25, HIGH);
     Serial.println("reverse");
    }
    else if(data == 'j')
    {
      digitalWrite(24, HIGH);
      digitalWrite(25, LOW);
      Serial.println("forward");
      
    }
   else
    {
      digitalWrite(24,LOW);
      digitalWrite(25,LOW);
     Serial.println("stop"); 
    }}}

i did a program. but i think there is a problem with

else if (y = vel.linear.y - 1.0)
can you check my code and tell me where is the problem?

   #include <ros.h>
    #include <geometry_msgs/Twist.h>
    float x;
    float y; 
    ros::NodeHandle nh;
    
    void velCallback(  const geometry_msgs::Twist& vel)
    {
       if (x = vel.linear.x - 1.0) //Forward move.
          {
          digitalWrite(24, LOW);
          digitalWrite(23, HIGH);
          }
    else if (y = vel.linear.y - 1.0)   //Backward move
    {
          digitalWrite(24, HIGH);
          digitalWrite(23, LOW);
    }
    else 
    {
        digitalWrite(24, LOW);     //STOP
          digitalWrite(23, LOW);
    }
        }

ros::Subscriber<geometry_msgs::Twist> sub("cmd_vel" , velCallback);

void setup() 
{
     nh.initNode();
     nh.subscribe(sub);
}

void loop() 
{
     nh.spinOnce();
     delay(10);
}

Originally posted by sudo_melvinyesudas on ROS Answers with karma: 54 on 2018-03-08
Post score: 0

Original comments
Comment by ahendrix on 2018-03-08:
teleop_twist_keyboard publishes a geometry_msgs/Twist message type on the /cmd_vel topic. You should make your arduino subscribe to this. A few other projects that do this are https://sungjik.wordpress.com/tag/ros/ and https://answers.ros.org/question/258563/subscribe-cmd_vel-with-arduino/
Comment by sudo_melvinyesudas on 2018-03-08:
can you please write how the code should be ? i checked the links.but still dont have idea how to do so.
Comment by ahendrix on 2018-03-08:
The code in https://answers.ros.org/question/258563/subscribe-cmd_vel-with-arduino/ is how most of the code should be. The only thing you need to add is the digitalWrite commands for your motors in velCallback.
Comment by sudo_melvinyesudas on 2018-03-09:
i just updated my program.can you check the code ?i face the problem with y axis.
rosrun teleop_twist_keyboard teleop_twist_keyboard.py

is this the twist_keboard command
Comment by simchanu on 2018-03-09:
Why do you use Y axis for a backward move ? Y axis is usually for lateral moves, and Z axis of vel.angular for turning.
Can you explain in the question how your robot moves ? (2 motorized wheels maybe) I think it would help people to understand your needs.
Comment by sudo_melvinyesudas on 2018-03-10:
sorry im new to this.i dont know how the code supposed to be.what i want is if i press "i" it should execute first IF condition which is forward move.and if i press any other key whether it is j or k any, it goes backward.

A:

The conditionals in your velocity callback aren't meaningful c++:
if (x = vel.linear.x - 1.0) //Forward move.
{
      digitalWrite(24, LOW);
      digitalWrite(23, HIGH);
}
else if (y = vel.linear.y - 1.0)   //Backward move
{
      digitalWrite(24, HIGH);
      digitalWrite(23, LOW);
}
else 
{
      digitalWrite(24, LOW);     //STOP
      digitalWrite(23, LOW);
}

Since you use the single equals sign you're changing the value of x and y instead of checking it. Instead you should use the less-than and greater-than operators (and a little bit of wiggle room so you don't need to send exactly 0 to stop):
if (vel.linear.x > 0.1) //Forward move.
{
      digitalWrite(24, LOW);
      digitalWrite(23, HIGH);
}
else if (vel.linear.x < -0.1)   //Backward move
{
      digitalWrite(24, HIGH);
      digitalWrite(23, LOW);
}
else 
{
      digitalWrite(24, LOW);     //STOP
      digitalWrite(23, LOW);
}

Originally posted by ahendrix with karma: 47576 on 2018-03-10
This answer was ACCEPTED on the original site
Post score: 1

Original comments
Comment by sudo_melvinyesudas on 2018-03-10:
is there any other function than this vel.linear.x  what if i want to change the y or z axis ? keyword for that ?
Comment by ahendrix on 2018-03-10:
Yes, the twist message also has y and z components, as well as x, y and z angular components. The full documentation is on the geometry_msgs page on the ROS wiki.
Comment by ahendrix on 2018-03-10:
teleop_twist_keyboard is able to send x, y and z velocities and yaw (rotation about Z), but from your code it seems like your robot can only move forwards and backwards (+/- X) so I'm not sure that the other axes will be useful for you.

