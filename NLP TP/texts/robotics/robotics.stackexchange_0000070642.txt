Q:

Custom Message on Arduino

I am using ROS Indigo and an Arduino Uno. I am having issues using a custom message that is part of my firmware. The firmware compiles and uploads fine, but I receive the following error when trying to connect to the node.
$ rosrun rosserial_python serial_node.py /dev/ttyACM1
[INFO] [WallTime: 1448735717.440960] ROS Serial Python Node
[INFO] [WallTime: 1448735717.454322] Connecting to /dev/ttyACM1 at 57600 baud
[ERROR] [WallTime: 1448735720.172786] Creation of publisher failed: ros_arduino_wiichuck
ROS path [0]=/opt/ros/indigo/share/ros
ROS path [1]=/opt/ros/indigo/share
ROS path [2]=/opt/ros/indigo/stacks
[ERROR] [WallTime: 1448735721.135189] Tried to publish before configured, topic id 125
[ERROR] [WallTime: 1448735722.154916] Tried to publish before configured, topic id 125

Here is my custom message
Header header
uint8 joyX
uint8 joyY
bool buttonZ
bool buttonC
float32 accelX
float32 accelY
float32 accelZ

Here is my firmware code
#include <Arduino.h>
#include <ros.h>
#include <ros_arduino_wiichuck/WiiChuck.h>

#include "WiiChuck.h"

WiiChuck chuck = WiiChuck();

ros::NodeHandle nh;

ros_arduino_wiichuck::WiiChuck chuck_msg;
ros::Publisher chuckPub("chuck", &chuck_msg);

char hello[13] = "hello world!";

void setup() {
    nh.initNode();
    nh.advertise(chuckPub);

    chuck.begin();
    chuck.update();
}

void loop() {
    delay(20);
    chuck.update();

    chuck_msg.joyX = chuck.readJoyX();
    chuck_msg.joyY = chuck.readJoyY();
    chuck_msg.buttonZ = chuck.buttonZ;
    chuck_msg.buttonC = chuck.buttonC;
    chuck_msg.accelX = chuck.readAccelX();
    chuck_msg.accelY = chuck.readAccelY();
    chuck_msg.accelZ = chuck.readAccelZ();
    chuckPub.publish(&chuck_msg);
    nh.spinOnce();
    delay(1000);
}

Originally posted by Noldona on ROS Answers with karma: 3 on 2015-11-28
Post score: 0

A:

EDITED to be correct answer.
You ROS path only includes directories in /opt ; have you sourced the workspace that contains your custom message before starting the rosserial_python node?

Originally posted by ahendrix with karma: 47576 on 2015-11-28
This answer was ACCEPTED on the original site
Post score: 1

Original comments
Comment by Noldona on 2015-11-28:
I thought the advertise line was the one that registered the publisher. Also, I started with the code used in http://wiki.ros.org/rosserial_arduino/Tutorials/Hello%20World and it works perfectly fine. The issue seems to be related to the fact that it's a custom message.
Comment by ahendrix on 2015-11-28:
You ROS path only includes directories in /opt ; have you sourced the workspace that contains your custom message before starting the rosserial_python node?
Comment by Noldona on 2015-11-28:
Yeah, that was it. I didn't source the workspace.
Comment by Copk on 2015-12-12:
Can you guys also help me with this problem? I described it in an answer below (I am new at the forum, and don't know whether I whould ask it as a new question)
Comment by ahendrix on 2015-12-12:
You have a new, different question. Please ask a new question instead of posting an answer.

