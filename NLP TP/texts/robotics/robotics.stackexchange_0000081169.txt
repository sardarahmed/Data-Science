Q:

Difference in CPU% between static_transform_publisher and tf::TransformBroadcaster?

Hi everyone! When broadcasting tfs, is there a difference between running static_transform_publisher or broadcasting via tf::TransformBroadcaster in terms of computational resources? When directly running the static_transform_publisher, the period parameter defines how often the transform is sent, but I donâ€™t think something similar is possible when using the sendTransform() method in code.
I have certain launch file that uses three static_transform_publishers. I have tried broadcasting them via code instead, but when doing this, my CPU usage spikes quite notoriously.
For some practical reasons I would like to do this in code rather than in the launch file. Though if the same behaviour is not achievable, I would of course settle for the latter.
PS. I am using rospy.
Thank you very much in advance!
Diego

Originally posted by dieg0- on ROS Answers with karma: 33 on 2017-06-06
Post score: 0

Original comments
Comment by lucasw on 2017-06-06:
Can you show the code doing the tf broadcasting?

A:

sendTransform does not have a parameter for the period because it only sends once immediately. If you want to publish a constant frame you need to do so inside a loop. However even if you're doing that it should not cause CPU usage spikes. It's just sending a relatively small message. And if as your question implies it's only being sent once. It definitely isn't the cause of your CPU spikes.
Quite possibly your problem is actually that the transform becomes unavailable and some code is trying to buffer or try to transform when the tf information is unavailable.
There's also a tf::StaticTransformBroadcaster. However, I'd strongly recommend moving to the tf2 static transform publisher. In tf2 static transforms are sent in a separate channel and designed to send only once using a latched publisher. So they incur as little CPU as possible. This is exactly what they were designed for.

Originally posted by tfoote with karma: 58457 on 2017-06-06
This answer was ACCEPTED on the original site
Post score: 2

Original comments
Comment by dieg0- on 2017-06-07:
Thank you! You made me realize the incredibly silly problem with my code. My Broadcasters were running in a 'while not rospy.is_shutdown()' loop without a fixed rate, and were therefore being sent very, very often.. Now it works fine. And I am now reading about tf2_ros::StaticTransformBroadcaster.

