Q:

catkin optional build dependency

I'm trying to compile hector_quadrotor using catkin_make, but I'm running into this issue :
http://github.com/tu-darmstadt-ros-pkg/hector_quadrotor/issues/3
The main problem is that hector_pose_estimation uses the hector_uav_msgs package only if it is available at build time (by find_package).
But hector_pose_estimation is usable without hector_uav_msgs, so it can't be a build dependency.
And because hector_uav_msgs is not a build dep of hector_pose_estimation, catkin_make will try to build hector_pose_estimation before hector_uav_msgs.
Is there a trick to declare optional build dependencies, or to force the dependency to build hector_uav_msgs prior to hector_pose_estimation ?

Originally posted by mtourne on ROS Answers with karma: 36 on 2013-09-26
Post score: 1

A:

There is no way to affect build order in a single workspace other than a build_depend tag. There is no notion of optional dependencies.
I imagine that hector_pose_estimation will publish data in messages defined in hector_uav_msgs, but the code to do so will only be built iff hector_uav_msgs is found? A different way to do this (without optional dependencies) is to have a third package which builds a plugin for hector_pose_estimation and directly depends on both hector_pose_estimation and hector_uav_msgs. At runtime a node in hector_pose_estimation could discover, load, and execute the plugin from the third package OR you could produce a node in the third package which is a drop-in replacement of the node(s) in hector_pose_estimation but which also publishes the messages. This way hector_pose_estimation is simplified and does not require an optional dependency on hector_uav_msgs, and to add this new functionality you just add hector_uav_msgs and the new third package to the workspace.
A workaround is to build hector_uav_msgs in a separate workspace before building hector_pose_estimation. This ensures that hector_uav_msgs is built first.

Originally posted by William with karma: 17335 on 2013-09-26
This answer was ACCEPTED on the original site
Post score: 1

Original comments
Comment by Johannes Meyer on 2013-10-12:
In the meantime, I did exactly this. All optional dependencies on hector_uav_msgs have been removed from hector_pose_estimation and I added a separate package hector_quadrotor_pose_estimation. Anyway, having something like optional build dependencies in package.xml would be a nice feature for catkin.

