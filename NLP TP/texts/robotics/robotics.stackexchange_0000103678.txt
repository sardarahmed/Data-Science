Q:

Rosdep installing python dependencies as root seems to break the installation

I started with ROS2 for robotic development. As far as I understand one must specify the dependencies of the code in package.xml (for example all python imports) and rosdep will install these dependencies for you using sudo. Pip warns against this type of install saying that the installation may break.
I use modules from Adafruit-Blinka (board). Blinka is specified in the <exec-depend> tag and it is recognized (it is in python.yaml). Rosdep install Adafruit-Blinka as root. Next I run the code and as soon as board is imported the code crashes with the following error: Module not found: 'hid' (full error message at the end).
I can reproduce this problem with a simple python program containing one line: import board. It crashes in the same way as the ros program (Module not found: 'hid'). When I first sudo pip uninstall Adafruit-Blinka and next pip install Adafruit_Blinka (without sudo), I can import board without problems.
Is it correct to assume that a sudo pip install causes module 'hid' not to be found? If so, is there a workaround so that rosdep does not install the modules as root?
Full error message:
$ ros2 run sensor_vl53l1x talker
Traceback (most recent call last):
  File "/media/i-files/home/arnold/development/ros2/bottie/install/sensor_vl53l1x/lib/sensor_vl53l1x/talker", line 33, in <module>
    sys.exit(load_entry_point('sensor-vl53l1x==0.0.0', 'console_scripts', 'talker')())
  File "/media/i-files/home/arnold/development/ros2/bottie/install/sensor_vl53l1x/lib/sensor_vl53l1x/talker", line 25, in importlib_load_entry_point
    return next(matches).load()
  File "/usr/lib/python3.10/importlib/metadata/__init__.py", line 171, in load
    module = import_module(match.group('module'))
  File "/usr/lib/python3.10/importlib/__init__.py", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1050, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1027, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1006, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 688, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 883, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "/media/i-files/home/arnold/development/ros2/bottie/install/sensor_vl53l1x/lib/python3.10/site-packages/sensor_vl53l1x/vl53l1x_publisher.py", line 5, in <module>
    import board
  File "/usr/local/lib/python3.10/dist-packages/board.py", line 22, in <module>
    from adafruit_blinka.agnostic import board_id, detector
  File "/usr/local/lib/python3.10/dist-packages/adafruit_blinka/agnostic/__init__.py", line 21, in <module>
    chip_id = detector.chip.id
  File "/usr/local/lib/python3.10/dist-packages/adafruit_platformdetect/chip.py", line 90, in id
    import hid
ModuleNotFoundError: No module named 'hid'
[ros2run]: Process exited with failure 1

A:

I should have added --as-root pip:false as an extra argument to rosdep. This is described at github.

