Q:

Using rosmake offline

Hi
I am on electric in a Debian squeeze linux. everything is working perfectly for now when I am online (I mean with an internet connection).
But as soos as I loose the web connection, rosmake don't want to work anymore with this :
ard@ard-host(9.2):~$ rosmake arp_master
[ rosmake ] Packages requested are: ['arp_master']                              
[ rosmake ] Logging to directory/opt/ros/rosmake/rosmake_output-20120416-223036 
[ rosmake ] Expanded args ['arp_master'] to:
['arp_master']                     
[ rosmake ] Checking rosdeps compliance for packages arp_master.  This may take a few seconds.
Traceback (most recent call last):
  File "/opt/ros/ros/bin/rosmake", line 65, in <module>
    if rma.main():
  File "/opt/ros/ros/tools/rosmake/src/rosmake/engine.py", line 865, in main
    self.rosdep_check_result = self.check_rosdep(buildable_packages)
  File "/opt/ros/ros/tools/rosmake/src/rosmake/engine.py", line 296, in check_rosdep
    failed_rosdeps = r.check()
  File "/opt/ros/ros/tools/rosdep/src/rosdep/core.py", line 449, in check
    if not self.install_rosdep(r, rdlp, default_yes=False, execute=False, display=display):
  File "/opt/ros/ros/tools/rosdep/src/rosdep/core.py", line 527, in install_rosdep
    my_installer = installer(rosdep_dict[mode])
  File "/opt/ros/ros/tools/rosdep/src/rosdep/installers.py", line 130, in __init__
    raise rosdep.core.RosdepException("Failed to load a rdmanifest from %s, and no alternate URI given"%(self.url))
RosdepException: Failed to load a rdmanifest from https://kforge.ros.org/rosrelease/viewvc/sourcedeps/eigen/eigen-3.0.1-1.rdmanifest, and no alternate URI given
Traceback (most recent call last):
  File "/opt/ros/ros/bin/rosmake", line 65, in <module>
    if rma.main():
  File "/opt/ros/ros/tools/rosmake/src/rosmake/engine.py", line 865, in main
    self.rosdep_check_result = self.check_rosdep(buildable_packages)
  File "/opt/ros/ros/tools/rosmake/src/rosmake/engine.py", line 296, in check_rosdep
    failed_rosdeps = r.check()
  File "/opt/ros/ros/tools/rosdep/src/rosdep/core.py", line 449, in check
    if not self.install_rosdep(r, rdlp, default_yes=False, execute=False, display=display):
  File "/opt/ros/ros/tools/rosdep/src/rosdep/core.py", line 527, in install_rosdep
    my_installer = installer(rosdep_dict[mode])
  File "/opt/ros/ros/tools/rosdep/src/rosdep/installers.py", line 130, in __init__
    raise rosdep.core.RosdepException("Failed to load a rdmanifest from %s, and no alternate URI given"%(self.url))
rosdep.core.RosdepException: Failed to load a rdmanifest from https://kforge.ros.org/rosrelease/viewvc/sourcedeps/eigen/eigen-3.0.1-1.rdmanifest, and no alternate URI given

I think this may be due to packages that are trying to getting dependencies online.
Does anyone has the same behavior ?
Does anyone now how to go over this ?
UPDATE :
After correcting Cmake logic and manifests, the problem is still here.
What allows me to overcome this problem is not to define the  line in my manifest. This is because eigen3 is already installed, but rosdep is always trying to connect to the net to get the last version. Is this a bug of rosdep ?
I can isolate the problem just doing "rosdep install" (so the problem seems to be in rosdep instead of rosmake). It is not working offline.
Here is what rosdep says :
rosdep where_defined eigen
eigen defined in set(['/opt/ros/common_rosdeps/rosdep.yaml', ">>/opt/ros/common_rosdeps/rosdep.yaml<<Unused due to package 'common_rosdeps' being in a stack.]]"])
Here is the debian rosdep.yaml extract :
eigen:
debian:
source:
uri: 'https://kforge.ros.org/rosrelease/viewvc/sourcedeps/eigen/eigen-3.0.1-1.rdmanifest'
md5sum: 941db2fbb09d80c28426d335022fad95
and the installed version is already ok :
ard@ard-host(9.2):/usr/include/eig
f932cebad87302d8ea0ec1fd39b24d99
Should I do anything to prevent rosdep for looking on the web when the local version is ok ?
BTW I still have a ros/eigen stack, which seems more or less empty. It is in the electric rosinstall so maybe it is done on purpose ? (http://packages.ros.org/cgi-bin/gen_rosinstall.py?rosdistro=electric&variant=desktop-full&overlay=no)
UPDATE 2 :
resuslts of resdep check eigen :
online :
ard@ard-host(9.2):~$ rosdep check eigen
Executing script below with cwd=/tmp
{{{
#!/bin/bash
export PREFIX=/usr/
[ f932cebad87302d8ea0ec1fd39b24d99 = `cat $PREFIX/include/eigen3/eigen-version.installed` ]

}}}

All required rosdeps are installed

offline
ard@ard-host(9.2):~$ rosdep check eigen
Failed to load a rdmanifest from https://kforge.ros.org/rosrelease/viewvc/sourcedeps/eigen/eigen-3.0.1-1.rdmanifest, and no alternate URI given

Originally posted by Willy Lambert on ROS Answers with karma: 352 on 2012-04-16
Post score: 1

A:

It looks like you may be trying to use the old Diamondback eigen package, which downloads and builds the library from source.
Starting with Electric, you should replace <depend eigen> with <rosdep eigen> in your manifest.xml, and make some updates to your CMakeLists.txt. That will use the system version of the eigen library (after the rosdep is installed).
UPDATE: The Debian entry for the eigen rosdep may be broken. Rosdep should detect that eigen is already installed and not try to download it again. What does this say?
rosdep check eigen

UPDATE2: Clearly, the Debian rosdep for eigen is broken. I am opening a Trac ticket to get it fixed. On Fuerte rosdep works differently, but the same problem appears to be present there, too.

Originally posted by joq with karma: 25443 on 2012-04-16
This answer was ACCEPTED on the original site
Post score: 1

Original comments
Comment by Willy Lambert on 2012-04-17:
question edited
Comment by joq on 2012-04-17:
Thanks for the update, it helped us find the problem. Commenting out the <rosdep name="eigen"> seems reasonable for a temporary workaround.
Comment by Willy Lambert on 2012-04-17:
my pleasure, thanks for your time. I'll do this

