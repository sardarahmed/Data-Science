Q:

Verify if world point is in camera's field of view

Hi, I'm trying to verify if a point in the world is in the field of view of the Kinect that I'm using.
I have the coordinates of that point in the world (x,y,z), afterwards I can transform that point to the camera_depth_optical_frame using something like:

transform = self.tf_buffer.lookup_transform('camera_depth_optical_frame', 'map', rospy.Time(0), rospy.Duratio(1.0))
object_on_camera = tf2_geometry_msgs.do_transform_pose(object_on_world, transform) #point on camera_depth_optical_frame

Notice that "object_on_world" and "object_on_camera" are PointStamped structures.
Given that point, how can I know if the camera should be seeing it or not? I think I need to get the horizontal angle and the vertical angle that this point is doing with the camera using the depth 'z', right? Then i need to verify if that lays in the accepted angles for the fov.
But how do i get these angles using the camera_depth_optical_frame?
I'm using openni for the kinect v1 drivers.
Another thing, anyone knows the kinect v1 field of view exactly?
Thanks for your patience, SancheZ

Originally posted by SancheZ on ROS Answers with karma: 28 on 2018-06-04
Post score: 0

A:

Do you have a (valid) camera_info along with the images from the Kinect?
If so then answer.ros: "project pointcloud to image".
I don't know if there is a complete end to end example anywhere but looking up project3dToPixel produces a lot of results.  If I get around to it I'll update this answer with one or link to another answer that does (or anyone else is welcome to do that...)
If the projected point output is within the resolution of the camera (between 0,0 and image width/height in pixels) then it should be visible, probably an additional check is required to make sure the object is in front of the camera and not behind if- if the z value from the transformed point is positive or not.
If you still are interesting in kinect angles-of-view you can calculate them from the fx/fy parameters in the camera_info.  https://stackoverflow.com/questions/39992968/how-to-calculate-field-of-view-of-the-camera-from-camera-intrinsic-matrix

Originally posted by lucasw with karma: 8729 on 2018-06-04
This answer was ACCEPTED on the original site
Post score: 2

