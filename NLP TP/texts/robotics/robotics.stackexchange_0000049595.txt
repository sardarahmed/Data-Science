Q:

ROSARIA running on a PeopleBot

I've succesfully downloaded and rosmaked RosAria package. Now, I'm going to use it, to remotely control PeopleBot from my personal computer.
The problem is, when I start rosrun ROSARIA RosAria on PeopleBot it says:

using port: [/dev/ttyS0]

ArLog::init:  File(aria.log)   Verbose     Logging Time    Not also printing

setup failed...

Info from the logfile :

Thu Mar 21 10:35:49 Could not connect to simulator, connecting to robot through serial port /dev/ttyS0.

Thu Mar 21 10:35:49 ArSerialConnection::open: Connecting to serial port '/dev/ttyS0'

Thu Mar 21 10:35:49 ArSerialConnection::open: Successfully opened and configured serial port '/dev/ttyS0'.

Thu Mar 21 10:35:49 Syncing 0

Thu Mar 21 10:35:50 No packet.

Thu Mar 21 10:35:50 Syncing 0

Thu Mar 21 10:35:51 No packet.

Thu Mar 21 10:35:51 Trying to close possible old connection

Thu Mar 21 10:35:51 Sent: comInt(2, 1)

Thu Mar 21 10:35:51 Sent: comInt(2, 1)

Thu Mar 21 10:35:51 Sent: comInt(2, 1)

Thu Mar 21 10:35:51 Sent: comInt(2, 1)

Thu Mar 21 10:35:51 Sent: comInt(2, 1)

Thu Mar 21 10:35:51 Syncing 0

Thu Mar 21 10:35:52 No packet.

Thu Mar 21 10:35:52 Syncing 0

Thu Mar 21 10:35:54 No packet.

Thu Mar 21 10:35:54  Robot may be connected but not open, trying to dislodge.

Thu Mar 21 10:35:54 Syncing 0

Thu Mar 21 10:35:55 No packet.

Thu Mar 21 10:35:55  Robot may be connected but not open, trying to dislodge.

Thu Mar 21 10:35:55 Syncing 0

Thu Mar 21 10:35:56 No packet.

Thu Mar 21 10:35:56 Could not connect, no robot responding.

Thu Mar 21 10:35:56 Failed to connect to robot.

Thu Mar 21 10:35:56 ArSerialConnection::close: Successfully closed serial port.

Thu Mar 21 10:35:56 rotate: Could not connect to robot! Exiting.

What can I do to connect to the robot? And what does it mean
Robot may be connected but not open?
UP: I checked accordingly to http _ ://robots.mobilerobots.com/wiki/Computer_Serial_Port_Configuration#Configuring_Computer_BIOS settings of IRQs for each serial, but still I cannot use Aria, to move the robot.
UP again: It turns out there's a big RED button, that has to be released in order to move robot around :)
So now the robot is moving (I used ./demo in usr/local/share/Aria/ to check everything is okay). But not with the rosrun ROSARIA RosAria - this command doesn't move the robot.
Any help will be appreciated,
Thank you in advance!
da-na

Originally posted by da-na on ROS Answers with karma: 306 on 2013-03-20
Post score: 0

Original comments
Comment by Victor_ocv2 on 2013-03-21:
Are you using the correct port? Make sure you are not using /dev/ttyUSB0 for example instead of /dev/ttyS0
Comment by da-na on 2013-03-21:
What is a correct port? if /dev/ttyS0 then yes, I'm using it.
Comment by Victor_ocv2 on 2013-03-21:
If you connect your robot using a USB cable the port is /dev/ttyUSB0, but if you connect using a serial wire then you must use the serial port /dev/ttyS0. Moreover, the ports should have permissions for reading and writing
Comment by da-na on 2013-03-21:
Ports have the permissions. I don't connect anything to PeopleBot - I'm using it's onboard computer. I installed new Ubuntu (from scratch) on PeopleBot's hard disk - is it possible that there's a problem with some serial configs in Ubuntu?
Comment by Victor_ocv2 on 2013-03-21:
Then, you should know which port does peoplebot use to connect to its onboard computer. Answering your question, the only problem I can think of is permissions, but you have already said they are writable.

A:

After some strugling now I can move PeopleBot around with ROSARIA on fuerte! :)
I've noticed, that there were problems with understanding type of message that cmdvel_cb (in RosAria.cpp) needed, so I rewrote this function. It was using boost, now it doesn't. And also to move PoepleBot around I removed the comments on locking and unlocking the robot, so it's possible now to move it around :)
And my cmdvel_cb looks now like this:
void RosAriaNode::cmdvel_cb( const geometry_msgs::Twist &msg)
{
  veltime = ros::Time::now();
  ROS_INFO( "new speed: [%0.2f,%0.2f](%0.3f)", msg.linear.x*1e3, msg.angular.z, veltime.toSec() );

  robot->lock();
  robot->setVel(msg.linear.x*1e3);
  robot->setRotVel(msg.angular.z*180/M_PI);
  robot->unlock();
}

Hope this helps anyone, that would like to make use of RosAria with PeopleBot :)

Originally posted by da-na with karma: 306 on 2013-04-16
This answer was ACCEPTED on the original site
Post score: 0

