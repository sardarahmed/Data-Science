Q:

Recursively get message field names in ROS2

We have the handy rosidl_runtime_py.message_to_csv() method for converting a message to CSV, but is there a similar function that will recursively get the field names so I can print out a CSV header as well?

Originally posted by KenYN on ROS Answers with karma: 541 on 2021-09-16
Post score: 0

A:

Solved it!
def recursive_items(ordered_dict):
    for key, value in ordered_dict.items():
        if type(value) is collections.OrderedDict:
            yield from recursive_items(value)
        else:
            yield (key, value)

def print_headers(record):
    print(','.join([key for key, _ in recursive_items(rosidl_runtime_py.message_to_ordereddict(record))]))

I'd missed the API rosidl_runtime_py.message_to_ordereddict() which gives me the message with names and values in a nested OrderedDict, so I iterate over that to pull out the keys from the leaf nodes.

Originally posted by KenYN with karma: 541 on 2021-09-16
This answer was ACCEPTED on the original site
Post score: 0

