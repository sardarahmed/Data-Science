Q:

Configuration or best practices wrt. automatic chaining of `setup.bash` prefix paths from `colcon build`

I recently found (to my great surprise) that upon issuing 'source install/setup.bash' for my ROS 2 install (built from source), that both Gazebo Sim and ros_gz_bridge were also sourced automatically.
So I had a look at the ROS 2 install/setup.bash script, and indeed it mentions:
# This script extends the environment with the environment of other prefix
# paths which were sourced when this file was generated as well as all packages
# contained in this prefix path.

So probably I did the following:

Compile and source ROS 2,
Compile and source Gazebo Sim,
Compile and source ros_gz_bridge,
Compile ROS 2 again.

I wonder if many people are aware of that behavior. In any case I did not know of this automatic chaining, nor was expecting it, as:

In above case, it is obviously undesirable that the ROS 2 setup.bash script would chain the Gazebo and ros_gz_bridge scripts,

But even in other cases this can be undesired. E.g. the ros_gz_bridge obviously depends on ROS 2 and Gazebo Sim, but even then I might want to source a different ROS 2 install (e.g. with some local changes, irrelevant to ros_gz_bridge). So I don't necessarily want the ros_gz_bridge to automatically source the ROS 2 install that was sourced at build time.

Is there some documentation / configuration options / known best practices wrt. this behavior?
Or is it just mandatory to actively consider the sourced prefixes before each invocation of colcon build?

A:

The answer is in the colcon documentation:

local_setup.bash adds only that workspace to COLCON_PREFIX_PATH,
setup.bash adds all workspaces to COLCON_PREFIX_PATH that were in the COLCON_PREFIX_PATH at the time of build.

So my best practice is to:

Open a separate terminal to compile,
Source only those workspaces that are strictly needed,
Use that terminal only to compile.

This avoids that I recompiled in a terminal where I had sourced other workspaces (e.g. PlotJuggler) and then all of these other workspaces unnecessarily end up in the setup.bash.

