Q:

C++ Equivalent of ROSBag Code

What is the C++ equivalent of "rewriting bag", given in the cookbook?
I want to process a particular topic from a rosbag file and write the others unchanged to a new bagfile. Any help would be appreciated.

Originally posted by Ankush on ROS Answers with karma: 75 on 2012-07-20
Post score: 2

A:

This code should work:
rosbag::Bag input("input.bag");
rosbag::Bag output("output.bag", rosbag::bagmode::Write);
rosbag::View topic_view(input, rosbag::TopicQuery("topic_to_reqrite"));

BOOST_FOREACH(rosbag::MessageInstance const message, topic_view) {
  output.write(message.getTopic(), message.getTime(), message, message.getConnectionHeader()); 
}

For more information on the API functions, have a look at the API docs.

Originally posted by Lorenz with karma: 22731 on 2012-07-20
This answer was ACCEPTED on the original site
Post score: 4

Original comments
Comment by Ankush on 2012-07-21:
Thank you, again! It is not very clear from the APIs that rosbag::write takes a MessageInstance as an argument.
Comment by Lorenz on 2012-07-21:
Well, I didn't try it out but I expect it to work because the MessageInstance has all the required traits defined to be serializable.
Comment by Ankush on 2012-07-22:
Just tried it out, it works. Thanks.

