Q:

Calculating velocity from tf

When listening to transforms on tf, is there a way to ask specifically for the one before the latest one? And when you have received a transform, how do you query it for its timestamp?
I have position information being intermittently broadcast onto tf. Because I don't know exactly when this is going to happen I can't ask for a transform with a specific time delay. I would like to ask for the latest two transforms, find the time delay between them and divide by this to give an estimate of velocity.
Any help would be much appreciated!
James

Originally posted by jwrobbo on ROS Answers with karma: 258 on 2012-02-05
Post score: 5

A:

As @dlaz mentioned you want to use Transformer::lookupTwist()
If you use a target_time of zero it will give you the latest reading. And if you set a very small averaging_interval to a very small value(less than the minimum time between your tf updates) it will effectively do what you want.  This will cause the target time to be the last update.  And it will use linear interpolation between the last two updates to compute the other endpoint of the interval.
Note: This will be very noisy data! You are doing discreet differentiation over small time samples, the result will be very biased by noise in the tf positions.

Originally posted by tfoote with karma: 58457 on 2012-02-06
This answer was ACCEPTED on the original site
Post score: 7

