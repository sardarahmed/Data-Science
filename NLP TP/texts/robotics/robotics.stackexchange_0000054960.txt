Q:

Using SMACH to monitor robot battery level

I'm wondering if anyone knows how to program the following simple scenario using SMACH.
The robot monitors its battery level on a topic called /battery_level using a SMACH MonitorState which is part of the state machine SM_MONITOR_BATTERY.  In the meantime, the robot navigates around a series of waypoints in succession using a state machine SM_NAV_WAYPOINTS.
I want the overall state machine to behave as follows:  If the battery level falls below a threshold (SM_MONITOR_BATTERY returns 'invalid'), SM_MONITOR_BATTERY transitions to another state called RECHARGE that moves the robot to the docking station (NAV_DOCKING_STATION) and recharges the robot.  In the meantime, the SM_NAV_WAYPOINT machine is paused or terminated until the battery is recharged (SM_MONITOR_BATTERY returns 'valid').
I can make both the recharging behavior and the waypoint navigation behavior work on their own but I have only a vague idea how they can be combined using the Concurrence container.  I've tried for days to get the right syntax and I have failed.
Any help would be greatly appreciated.
--patrick

Originally posted by Pi Robot on ROS Answers with karma: 4046 on 2013-10-21
Post score: 1

A:

This sounds similar to something I had to do last year - I posted a simplified version of my final state machine here.
However, I assume that you already found that, and it hasn't helped. You might get better answers if you post what you've tried so far about and ask what's wrong with it.

Originally posted by lindzey with karma: 1780 on 2013-10-22
This answer was ACCEPTED on the original site
Post score: 0

Original comments
Comment by Pi Robot on 2013-10-22:
Hi Linzey--I think this is exactly what I need so many thanks!  You're right--I did read your Wiki page some time ago but forgot where it was until now.

