Q:

Update "old positions" when gmapping updates its map

Hi everybody,
I want to generate a map which also contains the positions of some found objects. In a first step I want to store the positions where the robot took an image. This is quiet straightforward (only take the camera position in the map frame). The only problem is that the map might change (e.g. on loop closure) and then the stored camera positions are inaccurate, probably even in a wrong room.
Is there a way to update the camera positions correctly when gmapping does the map update? Or is there a way that the camera positions are updated automatically?
Thanks for any help in advance!

Originally posted by senfti on ROS Answers with karma: 1 on 2017-10-03
Post score: 0

A:

AFAIK there is no provisioning for this in standard Gmapping. Doing this correctly would require to keep track of the robot's trajectory along with every particle. This change would require quite some changes to the code. Not sure somebody has done it, but it might be worth to skim the gmapping forks to see if you find something. There also is a somewhat related ticket sitting around for 3 years :)
The better and future proof way to do things would perhaps be to switch to cartographer_ros. It uses submaps and a constraint graph between them, which lends itself more naturally for doing what you want. For instance, one could localize objects in submaps and thus have them positioned correctly even after loop closure. I'm not sure about how this would work API-wise, but that could be discussed on the cartographer mailing list or issue tracker.

Originally posted by Stefan Kohlbrecher with karma: 24361 on 2017-10-05
This answer was ACCEPTED on the original site
Post score: 1

Original comments
Comment by senfti on 2017-10-06:
Thanks, I will give cartographer_ros a try

