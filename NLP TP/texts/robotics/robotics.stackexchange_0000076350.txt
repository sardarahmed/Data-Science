Q:

Connecting Bebop drone with ROS

Hey,
i want to control my Bebop2 with ROS messages. I downloaded bebop_autonomy and catkin it. When I want to run the launch file, the driver is getting killed
There is no log file and I actually dont know, why I cant compile it.
I have:

ROS Indigo
Ubuntu 14.04
Drone Firmware 3.9

Someone else had this problem? Is there another solution to use the drone with ROS?
PARAMETERS
/bebop/robot_description: <?xml version="1....
/rosdistro: indigo
/rosversion: 1.11.20

NODES
/bebop/
bebop_driver (bebop_driver/bebop_driver_node)
robot_state_publisher (robot_state_publisher/robot_state_publisher)
auto-starting new master
process[master]: started with pid [16121]
ROS_MASTER_URI=http://localhost:11311
setting /run_id to 829426e2-7cda-11e6-8573-0024e8cfd983
process[rosout-1]: started with pid [16134]
started core service [/rosout]
process[bebop/bebop_driver-2]: started with pid [16141]
process[bebop/robot_state_publisher-3]: started with pid [16152]
INFO  [1474118862.405218917]: Initializing nodelet with 2 worker threads.
INFO  [1474118862.468457685]: [BebopSDK] 15:27:42:468 | Bebop:230 - Bebop Cnstr()
INFO  [1474118862.468590244]: Nodelet Cstr
INFO [1474118862.472868092]: Connecting to Bebop ...
INFO [1474118862.713580127]: [BebopSDK] 15:27:42:713 | CommandReceivedCallback:113 - Command
Received Callback LWP id is: 16268
ERROR [1474118862.867989008]: [ARCONTROLLER_Network] 15:27:42:867 |
ARCONTROLLER_Network_ReaderRun:940 - ARCOMMANDS_Decoder_DecodeBuffer () failed : 2
ARDrone3.PictureSettingsState.UNKNOWN -> Unknown co
ERROR [1474118862.871437212]: [ARCONTROLLER_Network] 15:27:42:871 | ARCONTROLLER_Network_ReaderRun:940 - ARCOMMANDS_Decoder_DecodeBuffer () failed : 2 ARDrone3.PictureSettingsState.UNKNOWN -> Unknown co
ERROR [1474118862.874543473]: [ARCONTROLLER_Network] 15:27:42:874 | ARCONTROLLER_Network_ReaderRun:940 - ARCOMMANDS_Decoder_DecodeBuffer () failed : 2 ARDrone3.PictureSettingsState.UNKNOWN -> Unknown co
ERROR [1474118862.940212578]: [ARCONTROLLER_Network] 15:27:42:940 | ARCONTROLLER_Network_ReaderRun:940 - ARCOMMANDS_Decoder_DecodeBuffer () failed : 2 common.CommonState.UNKNOWN -> Unknown command
INFO [1474118862.953768631]: [BebopSDK] 15:27:42:953 | Connect:326 - BebopSDK inited, lwp_id: 16141
INFO [1474118862.953857749]: Fetching all settings from the Drone ..
.
INFO [1474118863.071386661]: Value for GPSSettingsHomeTypeType recved: 0
INFO [1474118863.071473543]: [CB] 15:27:43:071 | Update:1703 - Checking if GPSSettingsHomeTypeType exists in params ...
INFO [1474118863.073020388]: [CB] 15:27:43:072 | Update:1706 - No
ERROR [1474118863.092875287]: [ARCONTROLLER_Network] 15:27:43:092 | ARCONTROLLER_Network_ReaderRun:940 - ARCOMMANDS_Decoder_DecodeBuffer () failed : 2 ARDrone3.PictureSettingsState.UNKNOWN -> Unknown co
ERROR [1474118863.100761206]: [ARCONTROLLER_Network] 15:27:43:100 | ARCONTROLLER_Network_ReaderRun:940 - ARCOMMANDS_Decoder_DecodeBuffer () failed : 2 ARDrone3.PictureSettingsState.UNKNOWN -> Unknown co
ERROR [1474118863.104702699]: [ARCONTROLLER_Network] 15:27:43:104 | ARCONTROLLER_Network_ReaderRun:940 - ARCOMMANDS_Decoder_DecodeBuffer () failed : 2 ARDrone3.PictureSettingsState.UNKNOWN -> Unknown co
INFO [1474118863.189877636]: Value for PilotingSettingsMaxAltitudeCurrent recved: 30
INFO [1474118863.189995598]: [CB] 15:27:43:189 | Update:111 - Checking if
PilotingSettingsMaxAltitudeCurrent exists in params ...
INFO [1474118863.191580856]: [CB] 15:27:43:191 | Update:114 - No
INFO [1474118863.193173377]: Value for PilotingSettingsMaxDistanceValue recved: 160
INFO [1474118863.193235326]: [CB] 15:27:43:193 | Update:352 - Checking if PilotingSettingsMaxDistanceValue exists in params ...
INFO [1474118863.194297682]: [CB] 15:27:43:194 | Update:355 - No
INFO [1474118863.200952648]: Value for PilotingSettingsNoFlyOverMaxDistanceShouldnotflyover recved: 0
INFO [1474118863.201026121]: [CB] 15:27:43:201 | Update:432 - Checking if PilotingSettingsNoFlyOverMaxDistanceShouldnotflyover exists in params ...
INFO] [1474118863.202526521]: [CB] 15:27:43:202 | Update:435 - No
INFO [1474118863.204033976]: Value for PilotingSettingsMaxTiltCurrent recved: 20
INFO [1474118863.204078953]: [CB] 15:27:43:204 | Update:191 - Checking if PilotingSettingsMaxTiltCurrent exists in params ...
INFO [1474118863.204989544]: [CB] 15:27:43:204 | Update:194 - No
INFO [1474118863.206983024]: Value for PilotingSettingsAbsolutControlOn recved: 0
INFO [1474118863.207043856]: [CB] 15:27:43:207 | Update:271 - Checking if PilotingSettingsAbsolutControlOn exists in params ...
INFO [1474118863.207771113]: [CB] 15:27:43:207 | Update:274 - No
INFO [1474118863.219866157]: Value for PilotingSettingsBankedTurnValue recved: 0
INFO [1474118863.219941096]: [CB] 15:27:43:219 | Update:513 - Checking if PilotingSettingsBankedTurnValue exists in params ...
INFO [1474118863.221278557]: [CB] 15:27:43:221 | Update:516 - No
INFO [1474118863.222701014]: Value for SpeedSettingsMaxVerticalSpeedCurrent recved: 1
INFO [1474118863.222754303]: [CB] 15:27:43:222 | Update:1075 - Checking if SpeedSettingsMaxVerticalSpeedCurrent exists in params ...
INFO [1474118863.223785230]: [CB] 15:27:43:223 | Update:1078 - No
INFO [1474118863.225613466]: Value for SpeedSettingsMaxRotationSpeedCurrent recved: 100
INFO [1474118863.225654602]: [CB] 15:27:43:225 | Update:1155 - Checking if SpeedSettingsMaxRotationSpeedCurrent exists in params ...
INFO [1474118863.226362234]: [CB] 15:27:43:226 | Update:1158 - No
INFO [1474118863.234484077]: Value for SpeedSettingsHullProtectionPresent recved: 0
INFO [1474118863.234542464]: [CB] 15:27:43:234 | Update:1235 - Checking if
SpeedSettingsHullProtectionPresent exists in params ...
INFO [1474118863.235710071]: [CB] 15:27:43:235 | Update:1238 - No
INFO [1474118863.237468674]: Value for SpeedSettingsOutdoorOutdoor recved: 1
INFO [1474118863.237520497]: [CB] 15:27:43:237 | Update:1315 - Checking if SpeedSettingsOutdoorOutdoor exists in params ...
INFO [1474118863.238472852]: [CB] 15:27:43:238 | Update:1318 - No
INFO [1474118863.251575217]: Value for SpeedSettingsMaxPitchRollRotationSpeedCurrent recved: 300
INFO [1474118863.251644220]: [CB] 15:27:43:251 | Update:1395 - Checking if SpeedSettingsMaxPitchRollRotationSpeedCurrent exists in params ...
INFO 1474118863.252927833]: [CB] 15:27:43:252 | Update:1398 - No
INFO [1474118863.254569382]: Value for NetworkSettingsWifiSelectionType recved: 1
INFO [1474118863.254622043]: [CB] 15:27:43:254 | Update:1501 - Checking if
NetworkSettingsWifiSelectionType exists in params ...
INFO [1474118863.255588437]: [CB] 15:27:43:255 | Update:1504 - No
INFO [1474118863.258823625]: Value for NetworkSettingsWifiSelectionBand recved: 0
INFO [1474118863.259016945]: [CB] 15:27:43:258 | Update:1522 - Checking if NetworkSettingsWifiSelectionBand exists in params ...
INFO [1474118863.259923764]: [CB] 15:27:43:259 | Update:1525 - No
INFO [1474118863.260750476]: Value for NetworkSettingsWifiSelectionChannel recved: 6
INFO [1474118863.260784000]: [CB] 15:27:43:260 | Update:1543 - Checking if NetworkSettingsWifiSelectionChannel exists in params ...
INFO [1474118863.261342241]: [CB] 15:27:43:261 | Update:1546 - No
INFO [1474118863.290460818]: Value for PictureSettingsVideoStabilizationModeMode recved: 0
INFO [1474118863.290513059]: [CB] 15:27:43:290 | Update:1623 - Checking if PictureSettingsVideoStabilizationModeMode exists in params ...
INFO [1474118863.291447187]: [CB] 15:27:43:291 | Update:1626 - No
ERROR [1474118863.293378298]: [ARCONTROLLER_Network] 15:27:43:293 | ARCONTROLLER_Network_ReaderRun:940 - ARCOMMANDS_Decoder_DecodeBuffer () failed : 2
ARDrone3.PictureSettingsState.UNKNOWN -> Unknown co
[ERROR] [1474118863.296448102]: [ARCONTROLLER_Network] 15:27:43:296 | ARCONTROLLER_Network_ReaderRun:940 - ARCOMMANDS_Decoder_DecodeBuffer () failed : 2
ARDrone3.PictureSettingsState.UNKNOWN -> Unknown co
[ERROR] [1474118863.315566944]: [ARCONTROLLER_Network] 15:27:43:315 | ARCONTROLLER_Network_ReaderRun:940 - ARCOMMANDS_Decoder_DecodeBuffer () failed : 2 ARDrone3.PictureSettingsState.UNKNOWN -> Unknown co
INFO] [1474118863.330631988]: Value for GPSSettingsReturnHomeDelayDelay recved: 60
[ INFO] [1474118863.330693518]: [CB] 15:27:43:330 | Update:1783 - Checking if
GPSSettingsReturnHomeDelayDelay exists in params ...
INFO] [1474118863.333176795]: [CB] 15:27:43:333 | Update:1786 - No
INFO] [1474118863.336192262]: Value for GPSSettingsHomeTypeType recved: 0
INFO] [1474118863.336302541]: [CB] 15:27:43:336 | Update:1703 - Checking if GPSSettingsHomeTypeType exists in params ...
INFO] [1474118863.338623088]: [CB] 15:27:43:338 | Update:1711 - Yes
INFO] [1474118866.113073247]: Dynamic reconfigure callback with level: -1
INFO] [1474118866.136688121]: Enabling video stream ...
WARN] [1474118866.136829969]: [BebopSDK] 15:27:46:136 | StartStreaming:364 - Video streaming started ...
INFO] [1474118866.136956032]: Nodelet lwp_id: 16141
INFO] [1474118866.137009601]: bebop_driver nodelet loaded.
INFO] [1474118866.137100045]: [CameraThread] thread lwp_id: 16463
INFO] [1474118866.137190559]: [AuxThread] thread lwp_id: 16464
WARN] [1474118866.158027497]: [ARSTREAM2_H264Filter] 15:27:46:157 | ARSTREAM2_H264Filter_RtpReceiverNaluCallback:1201 - ARSTREAM2_RtpReceiver NALU buffer is too small, truncated AU (or maybe it's the fi
WARN] [1474118866.167337480]: [ARSTREAM2_H264Filter] 15:27:46:167 | ARSTREAM2_H264Filter_enqueueCurrentAu:481 - AU output cancelled (waitForSync)
WARN] [1474118866.201722369]: [ARSTREAM2_H264Filter] 15:27:46:201 | ARSTREAM2_H264Filter_enqueueCurrentAu:481 - AU output cancelled (waitForSync)
WARN] [1474118866.231175626]: [ARSTREAM2_H264Filter] 15:27:46:231 | ARSTREAM2_H264Filter_enqueueCurrentAu:481 - AU output cancelled (waitForSync)
WARN] [1474118866.266660026]: [ARSTREAM2_H264Filter] 15:27:46:266 | ARSTREAM2_H264Filter_enqueueCurrentAu:481 - AU output cancelled (waitForSync)
WARN] [1474118866.292939904]: [ARSTREAM2_H264Filter] 15:27:46:292 | ARSTREAM2_H264Filter_sync:161 - SPS/PPS sync OK
INFO] [1474118866.292996196]: [BebopSDK] 15:27:46:292 | DecoderConfigCallback:147 - H264 configuration packet received: #SPS: 27 #PPS: 9 (MP4? 0)
WARN] [1474118866.293077003]: [ARSTREAM2_H264Filter] 15:27:46:293 | ARSTREAM2_H264Filter_generateGrayIFrame:568 - Waiting for a slice to generate gray I-frame
WARN] [1474118866.293136577]: [ARSTREAM2_H264Filter] 15:27:46:293 | ARSTREAM2_H264Filter_generateGrayIFrame:568 - Waiting for a slice to generate gray I-frame
WARN] [1474118866.293288622]: [ARSTREAM2_H264Filter] 15:27:46:293 | ARSTREAM2_H264Filter_generateGrayIFrame:618 - Gray I slice NALU output size: 1629
INFO] [1474118866.293336323]: [BebopSDK] 15:27:46:293 | FrameReceivedCallback:174 - Frame Recv & Decode LWP id: 16466
INFO] [1474118866.295966127]: [Decoder] 15:27:46:295 | InitCodec:133 - H264 Codec is initialized!
INFO [1474118866.296011175]: [Decoder] 15:27:46:295 | Decode:235 - Updating H264 codec parameters (Buffer Size: 36) ...
[bebop/bebop_driver-2] process has died [pid 16141, exit code -11, cmd /home/dennis/bebop_ws/devel/lib/bebop_driver/bebop_driver_node __name:=bebop_driver __log:=/home/dennis/.ros/log/829426e2-7cda-11e6-8573-0024e8cfd983/bebop-bebop_driver-2.log].
log file: /home/dennis/.ros/log/829426e2-7cda-11e6-8573-0024e8cfd983/bebop-bebop_driver-2*.log

Originally posted by Trinto on ROS Answers with karma: 16 on 2016-09-17
Post score: 0

Original comments
Comment by Trinto on 2016-09-19:
Its about the ARSTREAM2_H264 . Its sending do driver and he is killing the driver..
Comment by jacobperron on 2016-09-19:
Have you tried using this catkinized version of ARSDK? Try building that from source and then checkout and build the dev branch 2-parrot-sdk in bebop_autonomy

A:

I solved the problem by myself.
Upgrading the SDK ( in bebop_autonomy under the hood are the steps for it ). Its difficult, because there is no new revision key. You have change the hash in generate.py to master/xml + chance the xml-tags at the end ( ardrone3.xml and Command.xml ) and in url-mustache its not libARCommands , its arsdk-xml and chance Xml to xml. Then delete ALL .xml in all filenames and in the files !
After chance in ardrone3_setting_callbacks.h pilotingsettingsstate_maxdistance_value to .._current, the both circling_xx_values with current to and something like bankedterm value to STATE.
After you can catkin the workspace.
the next prob is, that the driver is dying, cause the new frames are to big. So give the frames more space in bebop_decode.cpp
Now you can communicate with the drone.

Originally posted by Trinto with karma: 16 on 2016-09-19
This answer was ACCEPTED on the original site
Post score: 0

