Q:

ROS unable to find opencv libraries

I am trying to build image_view from source on Gumstix Overo which has ros groovy running on linaro.
However, one of dependencies of image_view -- opencv2 cannot be resolved in system dependency. So I cannot use rosdep to install opencv2.
Then I went to http://opencv.org/downloads.html and downloaded version 2.4.3 and followed instruction to install OpenCV.
However, when I make image_view, I got the following error.
[rosmake-0] Starting >>> image_view [ make ]                                    
[ rosmake ] Last 40 linesage_view: 346.6 sec ]       [ 1 Active 17/18 Complete ]
{-------------------------------------------------------------------------------
  CMakeFiles/stereo_view.dir/src/nodes/stereo_view.cpp.o: In function `~Mat':
  /usr/local/include/opencv2/core/mat.hpp:278: undefined reference to `cv::fastFree(void*)'
  CMakeFiles/stereo_view.dir/src/nodes/stereo_view.cpp.o: In function `~CvBridge':
  /root/catkin_ws/src/vision_opencv-fuerte-devel/cv_bridge/include/cv_bridge/CvBridge.h:72: undefined reference to `cvReleaseImageHeader'
  /root/catkin_ws/src/vision_opencv-fuerte-devel/cv_bridge/include/cv_bridge/CvBridge.h:77: undefined reference to `cvReleaseImage'
  /root/catkin_ws/src/vision_opencv-fuerte-devel/cv_bridge/include/cv_bridge/CvBridge.h:72: undefined reference to `cvReleaseImageHeader'
  /root/catkin_ws/src/vision_opencv-fuerte-devel/cv_bridge/include/cv_bridge/CvBridge.h:77: undefined reference to `cvReleaseImage'
  CMakeFiles/stereo_view.dir/src/nodes/stereo_view.cpp.o: In function `~Mat':
  /usr/local/include/opencv2/core/mat.hpp:278: undefined reference to `cv::fastFree(void*)'
  /usr/local/include/opencv2/core/mat.hpp:278: undefined reference to `cv::fastFree(void*)'
  CMakeFiles/stereo_view.dir/src/nodes/stereo_view.cpp.o: In function `~Mat_':
  /usr/local/include/opencv2/core/mat.hpp:367: undefined reference to `cv::Mat::deallocate()'
  CMakeFiles/stereo_view.dir/src/nodes/stereo_view.cpp.o: In function `~Mat':
  /usr/local/include/opencv2/core/mat.hpp:367: undefined reference to `cv::Mat::deallocate()'
  /usr/local/include/opencv2/core/mat.hpp:367: undefined reference to `cv::Mat::deallocate()'
  CMakeFiles/stereo_view.dir/src/nodes/stereo_view.cpp.o: In function `StereoView::saveImage(char const*, cv::Mat const&)':
  /root/catkin_ws/src/image_pipeline-electric/image_view/src/nodes/stereo_view.cpp:499: undefined reference to `cv::_InputArray::_InputArray(cv::Mat const&)'
  /root/catkin_ws/src/image_pipeline-electric/image_view/src/nodes/stereo_view.cpp:499: undefined reference to `cv::imwrite(std::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, cv::_InputArray const&, std::vector<int, std::allocator<int> > const&)'
  CMakeFiles/stereo_view.dir/src/nodes/stereo_view.cpp.o: In function `CvBridge':
  /root/catkin_ws/src/vision_opencv-fuerte-devel/cv_bridge/include/cv_bridge/CvBridge.h:66: undefined reference to `cvCreateImageHeader'
  /root/catkin_ws/src/vision_opencv-fuerte-devel/cv_bridge/include/cv_bridge/CvBridge.h:66: undefined reference to `cvCreateImageHeader'
  CMakeFiles/stereo_view.dir/src/nodes/stereo_view.cpp.o: In function `StereoView':
  /root/catkin_ws/src/image_pipeline-electric/image_view/src/nodes/stereo_view.cpp:377: undefined reference to `cv::namedWindow(std::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int)'
  /root/catkin_ws/src/image_pipeline-electric/image_view/src/nodes/stereo_view.cpp:378: undefined reference to `cv::namedWindow(std::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int)'
  /root/catkin_ws/src/image_pipeline-electric/image_view/src/nodes/stereo_view.cpp:379: undefined reference to `cv::namedWindow(std::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int)'
  /root/catkin_ws/src/image_pipeline-electric/image_view/src/nodes/stereo_view.cpp:380: undefined reference to `cvSetMouseCallback'
  /root/catkin_ws/src/image_pipeline-electric/image_view/src/nodes/stereo_view.cpp:381: undefined reference to `cvSetMouseCallback'
  /root/catkin_ws/src/image_pipeline-electric/image_view/src/nodes/stereo_view.cpp:382: undefined reference to `cvSetMouseCallback'
  /root/catkin_ws/src/image_pipeline-electric/image_view/src/nodes/stereo_view.cpp:384: undefined reference to `cvGetWindowHandle'
  /root/catkin_ws/src/image_pipeline-electric/image_view/src/nodes/stereo_view.cpp:386: undefined reference to `cvGetWindowHandle'
  /root/catkin_ws/src/image_pipeline-electric/image_view/src/nodes/stereo_view.cpp:388: undefined reference to `cvGetWindowHandle'
  /root/catkin_ws/src/image_pipeline-electric/image_view/src/nodes/stereo_view.cpp:391: undefined reference to `cvStartWindowThread'
  collect2: ld returned 1 exit status
  make[3]: *** [../bin/stereo_view] Error 1
  make[3]: Leaving directory `/root/catkin_ws/src/image_pipeline-electric/image_view/build'
  make[2]: *** [CMakeFiles/stereo_view.dir/all] Error 2
  make[2]: Leaving directory `/root/catkin_ws/src/image_pipeline-electric/image_view/build'
  make[1]: *** [all] Error 2
  make[1]: Leaving directory `/root/catkin_ws/src/image_pipeline-electric/image_view/build'
-------------------------------------------------------------------------------}
[ rosmake ] Output from build of package image_view written to:
[ rosmake ]    /root/.ros/rosmake/rosmake_output-20130303-153508/image_view/build_output.log
[rosmake-0] Finished <<< image_view [FAIL] [ 346.67 seconds ]                   
[ rosmake ] Halting due to failure in package image_view. 
[ rosmake ] Waiting for other threads to complete.
[ rosmake ] Results:                                                            
[ rosmake ] Built 18 packages with 1 failures.                                  
[ rosmake ] Summary output to directory                                         
[ rosmake ] /root/.ros/rosmake/rosmake_output-20130303-153508 

After add "FIND_PACKAGE(OpenCV REQUIRED)" and "target_link_libraries(my_target ${OpenCV_LIBS})" to CMakeList.txt, I got following rosmake massage:
 /root/catkin_ws/src/vision_opencv-fuerte-devel/cv_bridge/include/cv_bridge/CvBridge.h:198: undefined reference to `cvInitMatHeader'
 /root/catkin_ws/src/vision_opencv-fuerte-devel/cv_bridge/include/cv_bridge/CvBridge.h:199: undefined reference to `cvGetImage'
 CMakeFiles/image_saver.dir/src/nodes/image_saver.cpp.o: In function `sensor_msgs::CvBridge::reallocIfNeeded(_IplImage**, int, int)':
 /root/catkin_ws/src/vision_opencv-fuerte-devel/cv_bridge/include/cv_bridge/CvBridge.h:108: undefined reference to `cvGetSize'
 CMakeFiles/image_saver.dir/src/nodes/image_saver.cpp.o: In function `sensor_msgs::CvBridge::reallocIfNeeded_(_IplImage**, CvSize, int, int)':
 /root/catkin_ws/src/vision_opencv-fuerte-devel/cv_bridge/include/cv_bridge/CvBridge.h:90: undefined reference to `cvReleaseImage'
 /root/catkin_ws/src/vision_opencv-fuerte-devel/cv_bridge/include/cv_bridge/CvBridge.h:96: undefined reference to `cvCreateImage'
 CMakeFiles/image_saver.dir/src/nodes/image_saver.cpp.o: In function `sensor_msgs::CvBridge::fromImage(sensor_msgs::Image_<std::allocator<void> > const&, std::basic_string<char, std::char_traits<char>, std::allocator<char> >)':
 /root/catkin_ws/src/vision_opencv-fuerte-devel/cv_bridge/include/cv_bridge/CvBridge.h:242: undefined reference to `cvCvtColor'
 /root/catkin_ws/src/vision_opencv-fuerte-devel/cv_bridge/include/cv_bridge/CvBridge.h:244: undefined reference to `cvCvtColor'
 /root/catkin_ws/src/vision_opencv-fuerte-devel/cv_bridge/include/cv_bridge/CvBridge.h:246: undefined reference to `cvCvtColor'
 /root/catkin_ws/src/vision_opencv-fuerte-devel/cv_bridge/include/cv_bridge/CvBridge.h:252: undefined reference to `cvCvtColor'
 /root/catkin_ws/src/vision_opencv-fuerte-devel/cv_bridge/include/cv_bridge/CvBridge.h:254: undefined reference to `cvCvtColor'
  CMakeFiles/image_saver.dir/src/nodes/image_saver.cpp.o:/root/catkin_ws/src/vision_opencv-fuerte-devel/cv_bridge/include/cv_bridge/CvBridge.h:256: more undefined references to `cvCvtColor' follow
 CMakeFiles/image_saver.dir/src/nodes/image_saver.cpp.o: In function `sensor_msgs::CvBridge::fromImage(sensor_msgs::Image_<std::allocator<void> > const&, std::basic_string<char, std::char_traits<char>, std::allocator<char> >)':
 /root/catkin_ws/src/vision_opencv-fuerte-devel/cv_bridge/include/cv_bridge/CvBridge.h:292: undefined reference to `cvReleaseMat'
 CMakeFiles/image_saver.dir/src/nodes/image_saver.cpp.o: In function `sensor_msgs::CvBridge::reallocIfNeeded(_IplImage**, int, int)':
 /root/catkin_ws/src/vision_opencv-fuerte-devel/cv_bridge/include/cv_bridge/CvBridge.h:108: undefined reference to `cvGetSize'
 CMakeFiles/image_saver.dir/src/nodes/image_saver.cpp.o: In function `sensor_msgs::CvBridge::reallocIfNeeded_(_IplImage**, CvSize, int, int)':
 /root/catkin_ws/src/vision_opencv-fuerte-devel/cv_bridge/include/cv_bridge/CvBridge.h:90: undefined reference to `cvReleaseImage'
 CMakeFiles/image_saver.dir/src/nodes/image_saver.cpp.o: In function `sensor_msgs::CvBridge::fromImage(sensor_msgs::Image_<std::allocator<void> > const&, std::basic_string<char, std::char_traits<char>, std::allocator<char> >)':
 /root/catkin_ws/src/vision_opencv-fuerte-devel/cv_bridge/include/cv_bridge/CvBridge.h:228: undefined reference to `cvCreateMat'
 /root/catkin_ws/src/vision_opencv-fuerte-devel/cv_bridge/include/cv_bridge/CvBridge.h:229: undefined reference to `cvConvertScale'
 /root/catkin_ws/src/vision_opencv-fuerte-devel/cv_bridge/include/cv_bridge/CvBridge.h:235: undefined reference to `cvConvertScale'
 /root/catkin_ws/src/vision_opencv-fuerte-devel/cv_bridge/include/cv_bridge/CvBridge.h:282: undefined reference to `cvCvtColor'
 /root/catkin_ws/src/vision_opencv-fuerte-devel/cv_bridge/include/cv_bridge/CvBridge.h:284: undefined reference to `cvCvtColor'
 /root/catkin_ws/src/vision_opencv-fuerte-devel/cv_bridge/include/cv_bridge/CvBridge.h:286: undefined reference to `cvCvtColor'
 /root/catkin_ws/src/vision_opencv-fuerte-devel/cv_bridge/include/cv_bridge/CvBridge.h:288: undefined reference to `cvCvtColor'
 /root/catkin_ws/src/vision_opencv-fuerte-devel/cv_bridge/include/cv_bridge/CvBridge.h:248: undefined reference to `cvCvtColor'
  CMakeFiles/image_saver.dir/src/nodes/image_saver.cpp.o:/root/catkin_ws/src/vision_opencv-fuerte-devel/cv_bridge/include/cv_bridge/CvBridge.h:258: more undefined references to `cvCvtColor' follow
 CMakeFiles/image_saver.dir/src/nodes/image_saver.cpp.o: In function `CvBridge':
 /root/catkin_ws/src/vision_opencv-fuerte-devel/cv_bridge/include/cv_bridge/CvBridge.h:66: undefined reference to `cvCreateImageHeader'
 collect2: ld returned 1 exit status
 make[3]: *** [../bin/image_saver] Error 1
 make[3]: Leaving directory `/root/catkin_ws/src/image_pipeline-electric/image_view/build'
 make[2]: *** [CMakeFiles/image_saver.dir/all] Error 2
 make[2]: Leaving directory `/root/catkin_ws/src/image_pipeline-electric/image_view/build'
  make[1]: *** [all] Error 2
 make[1]: Leaving directory `/root/catkin_ws/src/image_pipeline-electric/image_view/build'

I guess ROS cannot find opencv libraries. Anyone know how to solve this problem?
Thanks in advance!

Originally posted by AdrianPeng on ROS Answers with karma: 441 on 2013-03-03
Post score: 1

Original comments
Comment by Miquel Massot on 2013-03-05:
I don't understand why if you are in groovy the compilation process is made in electric/fuerte (see the file path in each error e.g. "vision_opencv-FUERTE-devel"). Have you checked out the git branch to groovy?
Comment by AdrianPeng on 2013-03-05:
Because I have problem using catkin_make, catkin_make cannot find groovy package in source folder. I asked a question about that before, this is the link http://answers.ros.org/question/54539/help-with-catkin_make-on-an-arm/. However, the problem haven't solved. That's why I use rosmake instead.

A:

Try adding the line FIND_PACKAGE(OpenCV REQUIRED) to your CmakeList.txt.

Originally posted by K_Yousif with karma: 735 on 2013-03-03
This answer was ACCEPTED on the original site
Post score: 1

Original comments
Comment by AdrianPeng on 2013-03-04:
I updated the output after adding "FIND_PACKAGE(OpenCV REQUIRED)" to CMakeList.txt of image_view. I guess there are some problem in cv_bridge package.
Comment by tobinfinity on 2018-02-24:
This solved it for me

