Q:

How can I store the AR.Drone's height in order to control it?

I am trying to get the int32 message published in /ardrone/navdata/altd in order to control the ARDrone's height. Here is the code I have:
#include <ros/ros.h>
#include "std_msgs/Int32.h"

using namespace std;

void heightControl(const std_msgs::Int32::ConstPtr& height)
{
  cout << height << endl;
}

from ardrone_autonomy.msg import Navdata

int main(int argc, char **argv)
{
  ros::init(argc,argv,"Height_Control");
  ros::NodeHandle n;
  ros::Subscriber sub = n.subscribe("ardrone/navdata/altd", 1, heightControl);
  ros::spin();
  return 0;
}

When I run this, the altitude value is not shown in the terminal screen. However, if I do rostopic echo /ardrone/navdata/altd I do get the height shown in the terminal window. Using rosmsg show ardrone_autonomy/Navdata I can see that altd is type int32.

Originally posted by Pedro_85 on ROS Answers with karma: 182 on 2013-07-20
Post score: 0

A:

I was able to do it following these steps:

Added to the manifest file the dependency:
 <depend package="ardrone_autonomy" />

Fixed the code in the following way:
#include <ros/ros.h>
#include "std_msgs/Int32.h"
#include "std_msgs/Float32.h"
#include "ardrone_autonomy/Navdata.h"
using namespace std;
ardrone_autonomy::Navdata msg_in;
float drone_altd;
void heightControl(const ardrone_autonomy::Navdata& msg_in)
{
drone_altd=msg_in.altd;
cout << drone_altd << endl;
}
int main(int argc, char **argv)
{
ros::init(argc,argv,"Altitude_Control");
ros::NodeHandle n;
ros::Subscriber sub = n.subscribe("/ardrone/navdata", 1, heightControl);
ros::spin();
return 0;
}

I hope this helps.

Originally posted by Pedro_85 with karma: 182 on 2013-09-25
This answer was ACCEPTED on the original site
Post score: 0

Original comments
Comment by saikishor on 2015-04-08:
ok thanks its fine, but what shall i do when i am not getting any value when subscribing to that topic and looking for "altd" i.e., i am just getting as zero.
please help me in this
Comment by Pedro_85 on 2015-04-08:
Was the drone flying when you looked at altd? The AR.Drone won't publish the altd value unless its flying.
Comment by saikishor on 2015-04-08:
the value of altd is zero even in air and landed and in both i am getting the value as zero
so what should i do now
i had another drone i tried it with too but i ended up with value zero in that drone also...
in case if it publishes when flying, how to access that (i will check whether i did same)
Comment by Pedro_85 on 2015-04-08:
Odd. It seems like you will need to rebuild your package. I've been using ardrone_autonomy in fuerte, groovy, and hydro with no problems. How did you install it?
Comment by saikishor on 2015-04-09:
I have installed it in ROS Indigo and it also working well i mean rest of the things.
so what should i do now @Pedro_85 Is there any way to do that??
please help me sir....
Comment by Pedro_85 on 2015-04-09:
Are you using the coe above to get this measurements or rostopic echo /ardrone/navdata? I strongly recommend performing an update to your ardrone_autonomy package with git pull and recompiling it.
Comment by saikishor on 2015-04-09:
I am using rostopic echo /ardrone/navdata to get the altd value @Pedro_85
Comment by saikishor on 2015-04-21:
It worked for me and i am getting altitude value @Pedro_85
Thank you...
Comment by Ameer Hamza Khan on 2015-11-01:
My navdata subscriber is not calling the calling the callBack function. When i use rostopic echo /ardrone/navdata it is showing accurate values but when i write a node, the callBack function is not being called at all. What should i do?
Comment by Pedro_85 on 2015-12-11:
rostopic echo will not call any function, it only works as display of the topic's traffic
Comment by hpurohit on 2017-02-28:
I have similar issue, i can see the value in rostopic echo /ardrone/navdata but when i try to subscribe it and print ; it shows nothing.

