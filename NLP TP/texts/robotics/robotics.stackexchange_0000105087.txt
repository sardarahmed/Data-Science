Q:

Why is ROS_DISTRO not set for rolling?

After sourcing a rolling install, the environment variable ROS_DISTRO is not set. Is this intentional?
tyler@fractal:~$ source /opt/ros/rolling/setup.bash
tyler@fractal:~$ echo $ROS_DISTRO

tyler@fractal:~$

A:

It must be something on your side, as it works for me both with a non-recently updated source tree, as well as with a fresh vcs import:
$ echo $ROS_DISTRO

$ source install/setup.bash 
$ echo $ROS_DISTRO
rolling

It also works using packages:

Pull 22.04 Docker image
Install ROS2 Rolling per the official instructions (package ros-rolling-ros-base),

root@664088dbb40c:/# echo $ROS_DISTRO

root@664088dbb40c:/# source /opt/ros/rolling/setup.bash 
root@664088dbb40c:/# echo $ROS_DISTRO
rolling
root@664088dbb40c:/#

EDIT: added following grep output:
/opt/ros2_rolling/install$ grep -rI ROS_DISTRO
lib/python3.10/site-packages/rpyutils/import_c_library.py:        distro = os.environ.get('ROS_DISTRO', 'rolling')
lib/python3.10/site-packages/ros2doctor/api/package.py:    distro_name = os.environ.get('ROS_DISTRO')
lib/python3.10/site-packages/ros2doctor/api/package.py:        doctor_error('ROS_DISTRO is not set.')
lib/python3.10/site-packages/ros2doctor/api/platform.py:    Check ROS_DISTRO environment variables and distribution installed.
lib/python3.10/site-packages/ros2doctor/api/platform.py:    distro_name = os.environ.get('ROS_DISTRO')
lib/python3.10/site-packages/ros2doctor/api/platform.py:        doctor_error('ROS_DISTRO is not set.')
share/ros_environment/package.xml:  <description>The package provides the environment variables `ROS_VERSION` and `ROS_DISTRO`.</description>
share/ros_environment/environment/1.ros_distro.dsv:set;ROS_DISTRO;rolling
share/ros_environment/environment/0.ros_distro_check.sh:if [ -n "$ROS_DISTRO" -a "$ROS_DISTRO" != "rolling" ]; then
share/ros_environment/environment/0.ros_distro_check.sh:  echo "ROS_DISTRO was set to '$ROS_DISTRO' before. Please make sure that the environment does not mix paths from different distributions." >&2
share/ros_environment/environment/1.ros_distro.sh:export ROS_DISTRO=rolling

