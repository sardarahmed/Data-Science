Q:

How to use msgs in ros

Hi dear
I want to write a program that is tell me how many msgs that one node has published
How can I write this program
I wrot this program but it's not worked
#include "ros/ros.h"
#include "std_msgs/String.h"
int i=0;
  void chatterCallback(const std_msgs::String::ConstPtr& msg)
 {
  //ROS_INFO("I heard: [%s]", msg->data.c_str());
      i++;
 }

  int main(int argc, char **argv)
  {
      ros::init(argc, argv, "lisiner");
      ros::NodeHandle n;
      ros::Subscriber sub = n.subscribe("chater", 1000, chatterCallback);
      ros::Rate timeloop(5);
      while(ros::ok())
      {
          ROS_INFO("%d",i);
          timeloop.sleep();

      }

      return 0;
  }

Originally posted by Hamid Didari on ROS Answers with karma: 1769 on 2013-10-31
Post score: 0

A:

Try to add ros::spinOnce() into your while loop.

Originally posted by ZdenekM with karma: 704 on 2013-10-31
This answer was ACCEPTED on the original site
Post score: 1

Original comments
Comment by Hamid Didari on 2013-10-31:
I test this but the node that published, publish 30 msgs but this node count 29 msgs
how can I fix this?
Comment by Thomas on 2013-10-31:
Are you sure that you really send 30 messages, which one is left out? (hint: use the seq field in the header and rostopic to track what is going on, display the same data in your program and compare).
Comment by Hamid Didari on 2013-11-02:
I have one node that published msgs and in this node in terminal count how many msgs has been published
when 30 msgs published I press ctr+c to shut down the node but my Subscriber node count 29 and when after 50 msgs i press ctr+c the Subscriber node has count 47
Comment by ZdenekM on 2013-11-03:
Did you try to use suggested "seq" field? It's good idea to use it.
Comment by Hamid Didari on 2013-11-05:
tnx man :)

