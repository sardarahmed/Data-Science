Q:

Why rosmake will skip when I set locale?

I have a language.sh:
  export LANG=en_US
  export LC_MESSAGE=en_US.UTF8

I have one package which rosmake will show error msg in chinese:
  sam@sam:~/code/ros/perception/recognition/rein$ rosmake
  [ rosmake ] rosmake starting...                                                                                                             
  [ rosmake ] No package specified.  Building ['rein']                                                                                        
  [ rosmake ] Packages requested are: ['rein']                                                                                                
  [ rosmake ] Logging to directory /home/sam/.ros/rosmake/rosmake_output-20120903-205804                                                      
  [ rosmake ] Expanded args ['rein'] to:
  ['rein']                                                                                             
  [rosmake-0] Starting >>> geometry_msgs [ make ]                                                                                             
  [rosmake-0] Finished <<< geometry_msgs  No Makefile in package geometry_msgs                                                                
  [rosmake-0] Starting >>> sensor_msgs [ make ]                                                                                               
  [rosmake-0] Finished <<< sensor_msgs  No Makefile in package sensor_msgs                                                                    
  [rosmake-0] Starting >>> roslang [ make ]                                                                                                   
  [rosmake-0] Finished <<< roslang  No Makefile in package roslang                                                                            
  [rosmake-0] Starting >>> roscpp [ make ]                                                                                                    
  [rosmake-0] Finished <<< roscpp  No Makefile in package roscpp                                                                              
  [rosmake-0] Starting >>> rosbuild [ make ]                                                                                                  
  [rosmake-0] Finished <<< rosbuild  No Makefile in package rosbuild                                                                          
  [rosmake-0] Starting >>> roslib [ make ]                                                                                                    
  [rosmake-0] Finished <<< roslib  No Makefile in package roslib                                                                              
  [rosmake-0] Starting >>> rosconsole [ make ]                                                                                                
  [rosmake-0] Finished <<< rosconsole  No Makefile in package rosconsole                                                                      
  [rosmake-0] Starting >>> pluginlib [ make ]                                                                                                 
  [rosmake-0] Finished <<< pluginlib ROS_NOBUILD in package pluginlib                                                                         
  [rosmake-0] Starting >>> rospy [ make ]                                                                                                     
  [rosmake-0] Finished <<< rospy  No Makefile in package rospy                                                                                
  [rosmake-0] Starting >>> bond [ make ]                                                                                                      
  [rosmake-0] Finished <<< bond ROS_NOBUILD in package bond                                                                                   
  [rosmake-0] Starting >>> smclib [ make ]                                                                                                    
  [rosmake-0] Finished <<< smclib ROS_NOBUILD in package smclib                                                                               
  [rosmake-0] Starting >>> bondcpp [ make ]                                                                                                   
  [rosmake-0] Finished <<< bondcpp ROS_NOBUILD in package bondcpp                                                                             
  [rosmake-0] Starting >>> nodelet [ make ]                                                                                                   
  [rosmake-0] Finished <<< nodelet ROS_NOBUILD in package nodelet                                                                             
  [rosmake-0] Starting >>> rosservice [ make ]                                                                                                
  [rosmake-0] Finished <<< rosservice  No Makefile in package rosservice                                                                      
  [rosmake-0] Starting >>> dynamic_reconfigure [ make ]                                                                                       
  [rosmake-0] Finished <<< dynamic_reconfigure ROS_NOBUILD in package dynamic_reconfigure                                                     
  [rosmake-0] Starting >>> bullet [ make ]                                                                                                    
  [rosmake-0] Finished <<< bullet ROS_NOBUILD in package bullet                                                                               
  [rosmake-0] Starting >>> angles [ make ]                                                                                                    
  [rosmake-0] Finished <<< angles ROS_NOBUILD in package angles                                                                               
  [rosmake-0] Starting >>> rostest [ make ]                                                                                                   
  [rosmake-0] Finished <<< rostest  No Makefile in package rostest                                                                            
  [rosmake-0] Starting >>> roswtf [ make ]                                                                                                    
  [rosmake-0] Finished <<< roswtf  No Makefile in package roswtf                                                                              
  [rosmake-0] Starting >>> message_filters [ make ]                                                                                           
  [rosmake-0] Finished <<< message_filters  No Makefile in package message_filters                                                            
  [rosmake-0] Starting >>> tf [ make ]                                                                                                        
  [rosmake-0] Finished <<< tf ROS_NOBUILD in package tf                                                                                       
  [rosmake-0] Starting >>> rosbag [ make ]                                                                                                    
  [rosmake-0] Finished <<< rosbag  No Makefile in package rosbag                                                                              
  [rosmake-0] Starting >>> std_msgs [ make ]                                                                                                  
  [rosmake-0] Finished <<< std_msgs  No Makefile in package std_msgs                                                                          
  [rosmake-0] Starting >>> nodelet_topic_tools [ make ]                                                                                       
  [rosmake-0] Finished <<< nodelet_topic_tools ROS_NOBUILD in package nodelet_topic_tools                                                     
  [rosmake-0] Starting >>> common_rosdeps [ make ]                                                                                            
  [rosmake-0] Finished <<< common_rosdeps ROS_NOBUILD in package common_rosdeps                                                               
  [rosmake-0] Starting >>> pcl_ros [ make ]                                                                                                   
  [rosmake-0] Finished <<< pcl_ros ROS_NOBUILD in package pcl_ros                                                                             
  [rosmake-0] Starting >>> opencv2 [ make ]                                                                                                   
  [rosmake-0] Finished <<< opencv2 ROS_NOBUILD in package opencv2                                                                             
  [rosmake-0] Starting >>> image_geometry [ make ]                                                                                            
  [rosmake-0] Finished <<< image_geometry ROS_NOBUILD in package image_geometry                                                               
  [rosmake-0] Starting >>> cv_bridge [ make ]                                                                                                 
  [rosmake-0] Finished <<< cv_bridge ROS_NOBUILD in package cv_bridge                                                                         
  [rosmake-0] Starting >>> image_transport [ make ]                                                                                           
  [rosmake-0] Finished <<< image_transport ROS_NOBUILD in package image_transport                                                             
  [rosmake-0] Starting >>> pcl [ make ]                                                                                                       
  [rosmake-0] Finished <<< pcl  No Makefile in package pcl                                                                                    
  [rosmake-0] Starting >>> rein [ make ]                                                                                                      
  [ rosmake ] Last 40 linesin: 4.9 sec ]                                                                           [ 1 Active 31/32 Complete ]
  {-------------------------------------------------------------------------------
    make[3]: Entering directory `/home/sam/code/ros/perception/recognition/rein/build'
    make[3]: Leaving directory `/home/sam/code/ros/perception/recognition/rein/build'
    [ 13%] Built target ROSBUILD_gensrv_cpp
    make[3]: Entering directory `/home/sam/code/ros/perception/recognition/rein/build'
    make[3]: Leaving directory `/home/sam/code/ros/perception/recognition/rein/build'
    [ 23%] Built target ROSBUILD_gensrv_py
    make[3]: Entering directory `/home/sam/code/ros/perception/recognition/rein/build'
    make[3]: Leaving directory `/home/sam/code/ros/perception/recognition/rein/build'
    [ 23%] Built target rospack_gensrv
    make[3]: Entering directory `/home/sam/code/ros/perception/recognition/rein/build'
    make[3]: Leaving directory `/home/sam/code/ros/perception/recognition/rein/build'
    [ 37%] Built target ROSBUILD_genmsg_lisp
    make[3]: Entering directory `/home/sam/code/ros/perception/recognition/rein/build'
    make[3]: Leaving directory `/home/sam/code/ros/perception/recognition/rein/build'
    [ 51%] Built target ROSBUILD_genmsg_cpp
    make[3]: Entering directory `/home/sam/code/ros/perception/recognition/rein/build'
    make[3]: Leaving directory `/home/sam/code/ros/perception/recognition/rein/build'
    [ 67%] Built target ROSBUILD_genmsg_py
    make[3]: Entering directory `/home/sam/code/ros/perception/recognition/rein/build'
    make[3]: Leaving directory `/home/sam/code/ros/perception/recognition/rein/build'
    [ 67%] Built target rospack_genmsg
    make[3]: Entering directory `/home/sam/code/ros/perception/recognition/rein/build'
    make[3]: Leaving directory `/home/sam/code/ros/perception/recognition/rein/build'
    [ 67%] Built target rosbuild_precompile
    make[3]: Entering directory `/home/sam/code/ros/perception/recognition/rein/build'
    make[3]: Leaving directory `/home/sam/code/ros/perception/recognition/rein/build'
    [ 69%] Built target detection_displayer
    make[3]: Entering directory `/home/sam/code/ros/perception/recognition/rein/build'
    make[3]: Leaving directory `/home/sam/code/ros/perception/recognition/rein/build'
    make[3]: Entering directory `/home/sam/code/ros/perception/recognition/rein/build'
    [ 72%] Building CXX object CMakeFiles/rein.dir/src/io/fs_model_storage.o
    /home/sam/code/ros/perception/recognition/rein/src/io/fs_model_storage.cpp: In member function 「virtual bool rein::FilesystemModelStorage::getModelList(const string&, std::vector<std::basic_string<char> >&)」:
    /home/sam/code/ros/perception/recognition/rein/src/io/fs_model_storage.cpp:102:30: 錯誤： 「class boost::filesystem3::directory_entry」 沒具名為 「leaf」 的成員
    make[3]: *** [CMakeFiles/rein.dir/src/io/fs_model_storage.o] Error 1
    make[3]: Leaving directory `/home/sam/code/ros/perception/recognition/rein/build'
    make[2]: *** [CMakeFiles/rein.dir/all] Error 2
    make[2]: Leaving directory `/home/sam/code/ros/perception/recognition/rein/build'
    make[1]: *** [all] Error 2
    make[1]: Leaving directory `/home/sam/code/ros/perception/recognition/rein/build'
  -------------------------------------------------------------------------------}
  [ rosmake ] Output from build of package rein written to:
  [ rosmake ]    /home/sam/.ros/rosmake/rosmake_output-20120903-205804/rein/build_output.log
  [rosmake-0] Finished <<< rein [FAIL] [ 4.93 seconds ]                                                                                       
  [ rosmake ] Halting due to failure in package rein. 
  [ rosmake ] Waiting for other threads to complete.                                     
  [ rosmake ] Results:                                                                                                                        
  [ rosmake ] Built 32 packages with 1 failures.                                                                                              
  [ rosmake ] Summary output to directory                                                                                                     
  [ rosmake ] /home/sam/.ros/rosmake/rosmake_output-20120903-205804                                                                           
  sam@sam:~/code/ros/perception/recognition/rein$                                                                              

But when I try to run language.sh to change error msg to english version, it will cause rosmake to skip make process:
  sam@sam:~/code/ros/perception/recognition/rein$ chmod +x ~/language.sh 
  sam@sam:~/code/ros/perception/recognition/rein$ . ~/language.sh 
  sam@sam:~/code/ros/perception/recognition/rein$ rosmake
  [ rosmake ] rosmake starting...                                                                                                             
  [ rosmake ] No package specified.  Building ['rein']                                                                                        
  [ rosmake ] Packages requested are: ['rein']                                                                                                
  [ rosmake ] Logging to directory /home/sam/.ros/rosmake/rosmake_output-20120903-205614                                                      
  [ rosmake ] Expanded args ['rein'] to:
  ['rein']                                                                                             
  [rosmake-0] Starting >>> geometry_msgs [ make ]                                                                                             
  [rosmake-0] Finished <<< geometry_msgs  No Makefile in package geometry_msgs                                                                
  [rosmake-0] Starting >>> sensor_msgs [ make ]                                                                                               
  [rosmake-0] Finished <<< sensor_msgs  No Makefile in package sensor_msgs                                                                    
  [rosmake-0] Starting >>> roslang [ make ]                                                                                                   
  [rosmake-0] Finished <<< roslang  No Makefile in package roslang                                                                            
  [rosmake-0] Starting >>> roscpp [ make ]                                                                                                    
  [rosmake-0] Finished <<< roscpp  No Makefile in package roscpp                                                                              
  [rosmake-0] Starting >>> rosbuild [ make ]                                                                                                  
  [rosmake-0] Finished <<< rosbuild  No Makefile in package rosbuild                                                                          
  [rosmake-0] Starting >>> roslib [ make ]                                                                                                    
  [rosmake-0] Finished <<< roslib  No Makefile in package roslib                                                                              
  [rosmake-0] Starting >>> rosconsole [ make ]                                                                                                
  [rosmake-0] Finished <<< rosconsole  No Makefile in package rosconsole                                                                      
  [rosmake-0] Starting >>> pluginlib [ make ]                                                                                                 
  [rosmake-0] Finished <<< pluginlib ROS_NOBUILD in package pluginlib                                                                         
  [rosmake-0] Starting >>> rospy [ make ]                                                                                                     
  [rosmake-0] Finished <<< rospy  No Makefile in package rospy                                                                                
  [rosmake-0] Starting >>> bond [ make ]                                                                                                      
  [rosmake-0] Finished <<< bond ROS_NOBUILD in package bond                                                                                   
  [rosmake-0] Starting >>> smclib [ make ]                                                                                                    
  [rosmake-0] Finished <<< smclib ROS_NOBUILD in package smclib                                                                               
  [rosmake-0] Starting >>> bondcpp [ make ]                                                                                                   
  [rosmake-0] Finished <<< bondcpp ROS_NOBUILD in package bondcpp                                                                             
  [rosmake-0] Starting >>> nodelet [ make ]                                                                                                   
  [rosmake-0] Finished <<< nodelet ROS_NOBUILD in package nodelet                                                                             
  [rosmake-0] Starting >>> rosservice [ make ]                                                                                                
  [rosmake-0] Finished <<< rosservice  No Makefile in package rosservice                                                                      
  [rosmake-0] Starting >>> dynamic_reconfigure [ make ]                                                                                       
  [rosmake-0] Finished <<< dynamic_reconfigure ROS_NOBUILD in package dynamic_reconfigure                                                     
  [rosmake-0] Starting >>> bullet [ make ]                                                                                                    
  [rosmake-0] Finished <<< bullet ROS_NOBUILD in package bullet                                                                               
  [rosmake-0] Starting >>> angles [ make ]                                                                                                    
  [rosmake-0] Finished <<< angles ROS_NOBUILD in package angles                                                                               
  [rosmake-0] Starting >>> rostest [ make ]                                                                                                   
  [rosmake-0] Finished <<< rostest  No Makefile in package rostest                                                                            
  [rosmake-0] Starting >>> roswtf [ make ]                                                                                                    
  [rosmake-0] Finished <<< roswtf  No Makefile in package roswtf                                                                              
  [rosmake-0] Starting >>> message_filters [ make ]                                                                                           
  [rosmake-0] Finished <<< message_filters  No Makefile in package message_filters                                                            
  [rosmake-0] Starting >>> tf [ make ]                                                                                                        
  [rosmake-0] Finished <<< tf ROS_NOBUILD in package tf                                                                                       
  [rosmake-0] Starting >>> rosbag [ make ]                                                                                                    
  [rosmake-0] Finished <<< rosbag  No Makefile in package rosbag                                                                              
  [rosmake-0] Starting >>> std_msgs [ make ]                                                                                                  
  [rosmake-0] Finished <<< std_msgs  No Makefile in package std_msgs                                                                          
  [rosmake-0] Starting >>> nodelet_topic_tools [ make ]                                                                                       
  [rosmake-0] Finished <<< nodelet_topic_tools ROS_NOBUILD in package nodelet_topic_tools                                                     
  [rosmake-0] Starting >>> common_rosdeps [ make ]                                                                                            
  [rosmake-0] Finished <<< common_rosdeps ROS_NOBUILD in package common_rosdeps                                                               
  [rosmake-0] Starting >>> pcl_ros [ make ]                                                                                                   
  [rosmake-0] Finished <<< pcl_ros ROS_NOBUILD in package pcl_ros                                                                             
  [rosmake-0] Starting >>> opencv2 [ make ]                                                                                                   
  [rosmake-0] Finished <<< opencv2 ROS_NOBUILD in package opencv2                                                                             
  [rosmake-0] Starting >>> image_geometry [ make ]                                                                                            
  [rosmake-0] Finished <<< image_geometry ROS_NOBUILD in package image_geometry                                                               
  [rosmake-0] Starting >>> cv_bridge [ make ]                                                                                                 
  [rosmake-0] Finished <<< cv_bridge ROS_NOBUILD in package cv_bridge                                                                         
  [rosmake-0] Starting >>> image_transport [ make ]                                                                                           
  [rosmake-0] Finished <<< image_transport ROS_NOBUILD in package image_transport                                                             
  [rosmake-0] Starting >>> pcl [ make ]                                                                                                       
  [rosmake-0] Finished <<< pcl  No Makefile in package pcl                                                                                    
  [rosmake-0] Starting >>> rein [ make ]                                                                                                      
  [rosmake-0] Finished <<< rein [SKIP] No rule to make target None                                                                            
  [ rosmake ] Results:                                                                                                                        
  [ rosmake ] Built 32 packages with 0 failures.                                                                                              
  [ rosmake ] Summary output to directory                                                                                                     
  [ rosmake ] /home/sam/.ros/rosmake/rosmake_output-20120903-205614                                                                           
  sam@sam:~/code/ros/perception/recognition/rein$        

How did that happened?
It made me failed to put English version of error msg.
And it also can't generate any useable binary file.
How to fix it?
Thank you~
===========================
I try just make:
  sam@sam:~/code/ros/perception/recognition/rein$ make
  terminate called after throwing an instance of 'std::runtime_error'
    what():  locale::facet::_S_create_c_locale name not valid
  Makefile:1: /cmake.mk: No such file or directory
  make: *** No rule to make target `/cmake.mk'.  Stop.
  sam@sam:~/code/ros/perception/recognition/rein$

====================================
  sam@sam:~/code/ros/perception/recognition/rein$ locale -a
  locale: Cannot set LC_CTYPE to default locale: No such file or directory
  locale: Cannot set LC_MESSAGES to default locale: No such file or directory
  locale: Cannot set LC_COLLATE to default locale: No such file or directory
  C
  C.UTF-8
  POSIX
  en_AG
  en_AG.utf8
  en_AU.utf8
  en_BW.utf8
  en_CA.utf8
  en_DK.utf8
  en_GB.utf8
  en_HK.utf8
  en_IE.utf8
  en_IN
  en_IN.utf8
  en_NG
  en_NG.utf8
  en_NZ.utf8
  en_PH.utf8
  en_SG.utf8
  en_US.utf8
  en_ZA.utf8
  en_ZM
  en_ZM.utf8
  en_ZW.utf8
  zh_CN.utf8
  zh_HK.utf8
  zh_SG.utf8
  zh_TW.utf8
  sam@sam:~/code/ros/perception/recognition/rein$      

Originally posted by sam on ROS Answers with karma: 2570 on 2012-09-03
Post score: 0

Original comments
Comment by dornhege on 2012-09-03:
Interesting.. What does a "make" in the directory result in?
Comment by sam on 2012-09-03:
I have edited my original post to add `make` result.
Comment by dornhege on 2012-09-03:
OK, maybe it's just that you have the locale not installed?
Comment by sam on 2012-09-03:
What's that means? How to fix it? Thank you~
Comment by dornhege on 2012-09-04:
Can you check the output of locale -a?
Comment by sam on 2012-09-05:
I have edited my original post to add locale -a result.
Comment by dornhege on 2012-09-05:
The good thing is, the locale is there...

A:

rosmake does some parsing of the stdout to detect if there was no rule to make target.  The string matching is likely screwed up by the different locale.

Originally posted by tfoote with karma: 58457 on 2012-09-06
This answer was ACCEPTED on the original site
Post score: 0

Original comments
Comment by sam on 2012-09-12:
How to fix it? I also couldn't understand what happened.
Comment by tfoote on 2012-09-18:
Set your locale to en_US.UTF-8 when running rosmake.
Comment by sam on 2012-09-19:
I set export LANG=en_US
export LC_MESSAGE=en_US.UTF-8
But still pass the rosmake.process.

