Q:

How to add filter to pointcloud_to_laserscan package and depthimage_to_laserscan package

I need to add filters to my pointcloud and depthimage data before converting them to laserscan data due to noise. Seeing as there are  weel knwon packages (pointcloud-to-laserscan, depthimage-to-laserscan) that do these conversions, I was thinking to modify the source code of these packages by adding a median filter for instance,in the case of depthimage. Looking at the source code of the pointcloud-to-laserscan package for instance, it's unclear where in the code I can implement the filter, if that's possible. Does anyone have experience with this? or is there an easier way about this?

Originally posted by distro on ROS Answers with karma: 167 on 2022-11-04
Post score: 0

A:

What exactly do you mean by filtering here?
The whole transformation seems to happen in this callback:

https://github.com/ros-perception/pointcloud_to_laserscan/blob/1f4e90539e4d2c3d05b8dfe022d03008f322d37b/src/pointcloud_to_laserscan_nodelet.cpp#L139

So it is the place you should look into - IF it is needed. Perhaps you can achieve what you want with e.g.
message_filters package (e.g. cache last N messages and publish it every second as a median etc.)?

http://wiki.ros.org/message_filters

Originally posted by ljaniec with karma: 3064 on 2022-11-05
This answer was ACCEPTED on the original site
Post score: 1

Original comments
Comment by distro on 2022-11-06:
@ljaniec I want to remove outliers that dont make sense basically. What I'm getting from message filter is it gets a bunch of different messages(stores each type of message in cache) and realeses the data for use if some conditions are met. THis isn't quite what I want. For instance a median filter in the case of depth image simply simply targets anomaly pixels and replaces them with the average value of the pixels around them.
Comment by ljaniec on 2022-11-06:
So it should be a node that transforms a pointcloud (remove outliers) and feeds these transformed pointclouds to the pointcloud-to-laserscan package. Perhaps these transformations also can be done with the laserscan (so after the pointcloud-to-laserscan transformation). Modyfing the code is not necessary here, just a new nodelet.
Comment by distro on 2022-11-06:
@ljaniec you mean using packages like this?
Comment by ljaniec on 2022-11-06:
Yes, pretty much. If this answer helped you, please mark & upvote it!

