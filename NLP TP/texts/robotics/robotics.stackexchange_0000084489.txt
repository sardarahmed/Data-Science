Q:

How to create a Publisher about trajectory path, then show it in rviz?

Hi, thank you for your attention.
I am running gmapping_demo with turtlebot.
I want to know how to create a Publisher of the (robot) trajectory path in rviz.
And then I could show it in rviz.
It is not path planning. It's just wnat a line will show after the robot walk through.
Is there any tutorial can teach me?
I actually want to know robot's trajectory (create a Publisher nav_msg/Path topic <--- I'm not sure).
There is a video (Just like the red trajectory path).
I want to do is to show  Every time robots walk past

Originally posted by Liuche on ROS Answers with karma: 44 on 2018-01-03
Post score: 1

A:

Check out the wiki. It shows you how to add topics to visualize with rviz and much more.
In short, in rviz:

Click "Add"  towards the bottom of the "Displays" window.
A new window will pop up with two tabs, click on the tab labeled "By topic".
You will see all the topics that rviz can visualize. Find the topic that you want to visualize, click on it
Click "OK".

Update:
So, if I understand your question correctly you want to display the path that your robot is taking. A way to do this is by subscribing to the robot's odometry topic (/odom?) and then take the robot's pose and republish them as a path. Here's a simple script that should be a decent starting point for you.
#!/usr/bin/env python
import rospy

from nav_msgs.msg import Path
from nav_msgs.msg import Odometry
from geometry_msgs.msg import PoseStamped

path = Path()

def odom_cb(data):
    global path
    path.header = data.header
    pose = PoseStamped()
    pose.header = data.header
    pose.pose = data.pose.pose
    path.poses.append(pose)
    path_pub.publish(path)

rospy.init_node('path_node')

odom_sub = rospy.Subscriber('/odom', Odometry, odom_cb)
path_pub = rospy.Publisher('/path', Path, queue_size=10)

if __name__ == '__main__':
    rospy.spin()

Originally posted by jayess with karma: 6155 on 2018-01-03
This answer was ACCEPTED on the original site
Post score: 5

Original comments
Comment by Liuche on 2018-01-03:
Thank you for answering!
But I actually want to know how to draw the robot's trajectory (create a topic).
I have not created a topic about trajectory(Path), so I can't subscribe and show it.
Comment by jayess on 2018-01-03:
Well, this did answer your original question.
Comment by Liuche on 2018-01-03:
Yes, but still i don't even have a publisher, so i can't "add" "By topic".
I have been looking for a long time.
I haven't seen this tutorial yet (sad)
Comment by jayess on 2018-01-03:
What are you trying to? Create an actual path for the robot to navigate a map or just create some arbitrary path to visualize in rviz? We can only give answers that address the information given in a question.
Comment by Liuche on 2018-01-03:
Is such that.
Now I using the gmapping_demo package.
I can let the robot move around.
But I want to record the robot's trajectory.
And displayed on Rviz.
This is what I want to achieve.
Comment by Liuche on 2018-01-03:
In other words, I want to create a topic can record Path message.
Then I can subscribe and display it on Rviz.
Comment by Liuche on 2018-01-03:
Just like this video show.
Or not to use Nav_msg / Path ??
I'm sorry to bother you, Beginners always have problems
Comment by jayess on 2018-01-03:
So, this not path planning related? You want to visualize where your robot has been using rviz?
Comment by Liuche on 2018-01-03:
Actually, No.
I only want to show robot's route.
I already  visualize my robot, now I try to  visualize its Walking route
There is no way to add pictures here.
No way to express the problem well. (Sad)
Comment by Liuche on 2018-01-03:
I want to do is to show Every time robots walk past
Comment by Liuche on 2018-01-04:
@jayess YES!!!!!
That's what I want.
But  rospy.init_node('path_node')  should put a little in front,or it's will show ERROR message
Just the line is too thin.
it's thank you so much. !!!
This made me learn more.
Comment by gvdhoorn on 2018-01-04:
@Liuche: it's good to know how things work. You might also be interested in the answer(s) to #q209224, especially hector_trajectory_server.
Comment by Liuche on 2018-01-04:
@gvdhoom I did see this article.
But because I'm not using Hector.
So I did not quite understand how it worked.
jayess's method helped me a lot.
Comment by gvdhoorn on 2018-01-04:
The pkg can be used completely stand-alone.
As I wrote: it's good to first know how things work, but in the end you might want to use an already existing solution (for the obvious reasons).
Comment by jayess on 2018-01-04:
This is, at best, a toy example just to learn how it works and not something that you'd want to use for anything serious. But, as @gvdhoorn stated, there are preexisting packages that you can use.
Comment by Liuche on 2018-01-04:
It has helped me a lot, though it looks simple, thank you all!!!!
Comment by CHIN on 2019-01-30:
Sorry to bring it up again.
I saw your youtube video tutorial. It's helpful.But is there any way to set the path on once I startup the rviz,
(just like the /odom or /map, are already there once I startup, no need to add extra topic)
Comment by jayess on 2019-01-31:
I didn't make a video, but to save a configuration in RViz click on "File" then "Save Config" or just press Ctrl+s. See the RViz user guide for more information.
Comment by CHIN on 2019-02-01:
Opps ,sorry about that,(embarassed)
But thank you very much for answering it!
Comment by jayess on 2019-02-01:
Nothing to be embarrassed about
Comment by lochlomond on 2019-08-20:
Thanks, this really helps.

