Q:

ROS2 parameters file and launch argument override

I am using ROS2 foxy. I would like to launch a node with a set of default parameters in a .yaml file and add support for launch argument to override such parameters.
Default parameters:
/imu:
    ros__parameters:
        
        spi_dev: "/dev/spidev0.0"
        output_rate: 200.0 # Hz
        # more params here

I tried the following but does not work, what am I missing?
I fear that the parameters passed from launch arguments are not in the node namespace but global, thus are not picked up.
import os
from ament_index_python.packages import get_package_share_directory
from launch import LaunchDescription
from launch_ros.actions import Node
from launch.actions import DeclareLaunchArgument
from launch.substitutions import LaunchConfiguration

package_name = 'my_sensors'
param_name =  'my_default_params.yaml'

def generate_launch_description():

    rate_arg = DeclareLaunchArgument(
        name='rate',
        default_value="100",
        description="the sensor output data rate")

    device_arg = DeclareLaunchArgument(
        name='device',
        default_value="/dev/spidev0.0",
        description="the imu spi device")

    arguments = [
        rate_arg,
        device_arg,
    ]

    default_parameters = os.path.join(
        get_package_share_directory(package_name),
        'config',
        param_name
        )
    
    override_parameters = {
        'output_rate': LaunchConfiguration('rate'),
        'spi_dev': LaunchConfiguration('device'),
    }
    
    imu = Node(
            package=package_name,
            executable='imu_node',
            name='imu',
            parameters=[default_parameters, override_parameters],
            output='screen',
            emulate_tty=True
        )

    return LaunchDescription([
       *arguments,
       imu
    ])

Thank you so much for any help.

A:

I solved the issue by declaring the node in the global namespace /:
imu = Node(
            package=package_name,
            executable='imu_node',
            name='imu',
            namespace='/', # <<<<<<<<<<<<<<<<
            parameters=[default_parameters, override_parameters],
            output='screen',
            emulate_tty=True
        )

In this way, ros parameters are resolved correctly without any modification or namespace prefix on parameters declaration.

