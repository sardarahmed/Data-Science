Q:

Catkin_make requires root

I recently switched to groovy and am having troubles with a metapackage...
When I run catkin_make as root, it works fine. When I try to run it as my user, it fails with a big stack trace of:

import roslib;roslib.load_manifest(PACKAGE)

File "/opt/ros/groovy/lib/python2.7/dist-packages/roslib/launcher.py", line 62, in load_manifest
sys.path = _generate_python_path(package_name, _rospack) + sys.path
File "/opt/ros/groovy/lib/python2.7/dist-packages/roslib/launcher.py", line 93, in _generate_python_path
m = rospack.get_manifest(pkg)
File "/usr/lib/pymodules/python2.7/rospkg/rospack.py", line 136, in get_manifest
return self._load_manifest(name)
File "/usr/lib/pymodules/python2.7/rospkg/rospack.py", line 175, in _load_manifest
retval = self._manifests[name] = parse_manifest_file(self.get_path(name), self._manifest_name)
File "/usr/lib/pymodules/python2.7/rospkg/manifest.py", line 392, in parse_manifest_file
_static_rosdep_view = init_rospack_interface()
File "/usr/lib/pymodules/python2.7/rosdep2/rospack.py", line 58, in init_rospack_interface
lookup = _get_default_RosdepLookup(Options())
File "/usr/lib/pymodules/python2.7/rosdep2/main.py", line 109, in _get_default_RosdepLookup
verbose=options.verbose)
File "/usr/lib/pymodules/python2.7/rosdep2/sources_list.py", line 552, in create_default
sources = load_cached_sources_list(sources_cache_dir=sources_cache_dir, verbose=verbose)
File "/usr/lib/pymodules/python2.7/rosdep2/sources_list.py", line 459, in load_cached_sources_list
with open(cache_index, 'r') as f:
IOError: [Errno 13] Permission denied: '/home/myusername/.ros/rosdep/sources.cache/index'
make[2]: *** [/home/myusername/ros_packages/devel/include/corobot_camera/parametersConfig.h] Error 1
make[1]: *** [corobot/corobot_camera/CMakeFiles/corobot_camera_gencfg.dir/all]    Error 2
Traceback (most recent call last):
File "/home/myusername/ros_packages/src/corobot/corobot_state_tf/cfg/parameters.cfg", line 4, in <module>
import roslib;roslib.load_manifest(PACKAGE)
File "/opt/ros/groovy/lib/python2.7/dist-packages/roslib/launcher.py", line 62, in load_manifest
sys.path = _generate_python_path(package_name, _rospack) + sys.path
File "/opt/ros/groovy/lib/python2.7/dist-packages/roslib/launcher.py", line 93, in _generate_python_path
m = rospack.get_manifest(pkg)
File "/usr/lib/pymodules/python2.7/rospkg/rospack.py", line 136, in get_manifest
return self._load_manifest(name)
File "/usr/lib/pymodules/python2.7/rospkg/rospack.py", line 175, in _load_manifest
retval = self._manifests[name] = parse_manifest_file(self.get_path(name), self._manifest_name)
File "/usr/lib/pymodules/python2.7/rospkg/manifest.py", line 392, in parse_manifest_file
_static_rosdep_view = init_rospack_interface()
File "/usr/lib/pymodules/python2.7/rosdep2/rospack.py", line 58, in init_rospack_interface
lookup = _get_default_RosdepLookup(Options())
File "/usr/lib/pymodules/python2.7/rosdep2/main.py", line 109, in _get_default_RosdepLookup
verbose=options.verbose)
File "/usr/lib/pymodules/python2.7/rosdep2/sources_list.py", line 552, in create_default
sources = load_cached_sources_list(sources_cache_dir=sources_cache_dir, verbose=verbose)
File "/usr/lib/pymodules/python2.7/rosdep2/sources_list.py", line 459, in load_cached_sources_list
with open(cache_index, 'r') as f:
IOError: [Errno 13] Permission denied: '/home/myusername/.ros/rosdep/sources.cache/index'
make[2]: *** [/home/myusername/ros_packages/devel/include/corobot_state_tf/parametersConfig.h] Error 1
make[1]: *** [corobot/corobot_state_tf/CMakeFiles/corobot_state_tf_gencfg.dir/all] Error 2
make: *** [all] Error 2

The permissions on the root of the catkin workspace, its src directory, and all packages are drwxrwxr-x and my username is listed as the owner and group for all of them. I cloned this code from a Github repo - would that have anything to do with this?
Also, when I try to run a launch file, I get lots of errors saying "cannot launch node of type [nodetype]: can't locate node [the node] in package [package]". This happens with or without root. However, when I try to tab-complete with root, I get errors saying permission denied: "~/.gvfs". Are these issues related?
I have my environment variables:
ROS_PACKAGE_PATH=/opt/ros/groovy/stacks:/opt/ros/groovy/share:~/ros_packages/src
ROS_ROOT=/opt/ros/groovy/share/ros
ROS_IP=192.168.1.101 (my static ip)
ROS_MASTER_URI=http://192.168.1.101:11311
ROS_DISTRO=groovy
ROS_ETC_DIR=/opt/ros/groovy/etc/ros
The ~/ros_packages directory is my catkin workspace.
Any help is appreciated.

Originally posted by sterlingm on ROS Answers with karma: 380 on 2013-07-02
Post score: 0

Original comments
Comment by lindzey on 2013-07-02:
What are the permissions on /home/myusername/.ros? That seems to be where the errors are coming from ...

A:

This might origin from some old/wrong setup instructions. Can you say how you setup/installed ROS, especially rosdep. Maybe there are still leftovers to be corrected somewhere.
To fix it, hard delete the .ros/rosdep directory (as root). If .ros also has root permissions, you should also delete that and then re-initialize rosdep as:
sudo rosdep init
rosdep update

Note: No sudo for the second call.

Originally posted by dornhege with karma: 31395 on 2013-07-03
This answer was ACCEPTED on the original site
Post score: 3

Original comments
Comment by Martin Günther on 2013-07-03:
Yup, I've also seen this error when people mistakenly added a sudo to the second call. It's a common mistake; maybe rosdep should print a warning when called as root for rosdep update.
Comment by Martin Günther on 2013-07-03:
Added to wishlist: https://github.com/ros-infrastructure/rosdep/issues/258
Comment by sterlingm on 2013-07-03:
Thanks, this fixed the catkin_make problem! I just did 1)sudo rm -r ~/.ros/rosdep 2) sudo rosdep init 3) rosdep update

