Q:

How to change ImageConstPtr data?

Hi all!
Please explain me how could I change raw data in ImageConstPtr& object?
I have a function like:
void filterImage (const sensor_msgs::ImageConstPtr& rgb_msg)
{
  // something like rgb_msg->data[100] = 0;
}

So, I should change image data, and then pass rgb_msg to other functions.
I see deprecated functions get_data_vec and set_data_vec in Image.h file, but looks like I could not use them cause I have const modifier on object, and set_data_vec is non-const function.
Thank you.

Originally posted by Konstantin Cherenkov on ROS Answers with karma: 1 on 2012-02-21
Post score: 0

A:

You might want to try something like below:
void filterImage (const sensor_msgs::ImageConstPtr& rgb_msg)
{
    sensor_msgs::Image current_rgb_msg;
    current_rgb_msg = *rgb_msg;   
}

You can further manipulate the value from current_rgb_msg variable.

Originally posted by alfa_80 with karma: 1053 on 2012-02-21
This answer was ACCEPTED on the original site
Post score: 1

Original comments
Comment by alfa_80 on 2012-02-21:
It's better to put the declaration of "current_rgb_msg" in class scope.
Comment by Konstantin Cherenkov on 2012-02-22:
As I understood, "current_rgb_msg" is a copy of object, referenced by "rgb_msg". Ok, that means, that all changes would be actually for "current_rgb_msg" object. Could you please explain, how to convert "current_rgb_msg" to "const sensor_msgs::ImageConstPtr&" after all changes? Thanks.
Comment by alfa_80 on 2012-02-22:
You cannot convert/overwrite the incoming "rgb_msg", because it is a constant value(it's read-only variable). I'm not so into openCV, I think, you can try what dlaz and Eddit suggested, that's by using straightaway cv_bridge for further processing.

