Q:

Error with catkin build - Ros melodic

I have an error while catkin build I never had before, can someone out there can give me some advice?
 fabrice@fabrice-xmg-neo-15:~/catkin_tuw_ws$ atkin build
 Profile:                     default
 Extending:             [env]/opt/ros/melodic 
 Workspace:  /home/fabrice/catkin_tuw_ws
Build Space:        [exists] /home/fabrice/catkin_tuw_ws/build
Devel Space:        [exists] /home/fabrice/catkin_tuw_ws/devel
Install Space:      [unused] /home/fabrice/catkin_tuw_ws/install
Log Space:         [missing] /home/fabrice/catkin_tuw_ws/logs
Source Space:       [exists] /home/fabrice/catkin_tuw_ws/src
DESTDIR:            [unused] None
----------------------------------------------------------------
Devel Space Layout:          linked
Install Space Layout:        None
----------------------------------------------------------------
Additional CMake Args:       None
Additional Make Args:        None
Additional catkin Make Args: None
Internal Make Job Server:    True
Cache Job Environments:      False
----------------------------------------------------------------

Whitelisted Packages:        None
Blacklisted Packages:        None
----------------------------------------------------------------
Workspace configuration appears valid.
----------------------------------------------------------------

[build] Found '20' packages in 0.0 seconds.
[build] Package table is up to date.

[build] An internal error occurred!
Traceback (most recent call last):
File "/usr/lib/python2.7/dist-packages/catkin_tools/verbs/catkin_build/build.py",
line 549, in build_isolated_workspace continue_without_deps=False))
File "/usr/lib/python2.7/dist-packages/catkin_tools/execution/executor.py",
line 374, in run_until_complete return loop.run_until_complete(coroutine)
File "/usr/local/lib/python2.7/dist-packages/trollius/base_events.py",
line 350, in run_until_complete return future.result()
File "/usr/local/lib/python2.7/dist-packages/trollius/futures.py", line 285, in result
compat.reraise(type(self._exception),self._exception, exc_tb)
File "/usr/local/lib/python2.7/dist-packages/trollius/tasks.py",
line 259, in _step result = coro.send(value)
File "/usr/lib/python2.7/dist-packages/catkin_tools/execution/executor.py",
line 247, in execute_jobs  (job_server.try_acquire() is not None)):
File "/usr/lib/python2.7/dist-packages/catkin_tools/execution/job_server.py",
line 421, in try_acquire  if JobServer._check_conditions() and running_jobs() < max_jobs():
File "/usr/lib/python2.7/dist-packages/catkin_tools/execution/job_server.py",
line 249, in _check_conditions
return (cls._check_load() and cls._check_mem()) or
cls._running_jobs() == 0   File
"/usr/lib/python2.7/dist-packages/catkin_tools/execution/job_server.py",
line 226, in _check_load
if load[1] < cls._max_load: NameError: global name 'load' is not
defined

Originally posted by fabriceN on ROS Answers with karma: 59 on 2021-11-16
Post score: 0

Original comments
Comment by osilva on 2021-11-16:
After a some digging, as I haven't seen this error before either, I found this thread: https://github.com/catkin/catkin_tools/issues/379
You can find an interesting discussion of what may be the cause for this issue: The catkin internal make job-server runs out of job-tokens. Anyways at the very end of the thread, there is a suggestion is to reinstall to fresher version of catkin_tools so perhaps try that.
I am assuming you are not mixing Python 3 and Python 2 because that will also lead to unexpected behaviours.
Last resource, you can always add global load in that server.py file but I wouldn't recommend it.

A:

thanks a lot, i reinstalled catkin_tools and it works
Actually I noticed that now I have catkin_tools for python3 and it was  not installed with python2.7 (/usr/lib/python2.7/dist-packages)

Originally posted by fabriceN with karma: 59 on 2021-11-16
This answer was ACCEPTED on the original site
Post score: 0

Original comments
Comment by osilva on 2021-11-16:
Glad it works.

