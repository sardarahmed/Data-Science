Q:

Going crazy - can't find global waypoint node in map

Hi,
I am running Autoware 1.14. I have made numerous vector map/lanelet2 maps using the TierIV tool, unity MapToolbox tool and ASSURE Mapper tool. No matter what I do I get the error message GlobalH: Can't find Global Waypoint Node in map ...
So I assume it is user error.
When i use the TierIV tool I realized that it is missing the dtlanes.csv and vector.csv - maybe that is an issue.
Please let me know if you have any tips. If i need to downgrade to a different Autoware version let me know or if you have a step-by-step guide or can tell me exactly which nodes i need to run to get basic waypoint following without a vector map to work
EDIT: I made the vector/lanelet maps based on a pointcloud that was created through NDT_Mapping node

Originally posted by JoloGermanAg on ROS Answers with karma: 123 on 2020-07-15
Post score: 1

Original comments
Comment by Hatem on 2020-07-15:
can you share your map.
that error means, global planner can't find any close lane to your select start/goal points.
if you can visualize the map correctly using the mapping tools. then I guess this is a tf problem.
you need to setup your tf.launch properly.
Comment by JoloGermanAg on 2020-07-15:
Thanks,
Vector map visualization works fine for everything except for lane. Stop line, white line and others show up. Lanelet does not show up anything. There is no errors for this.
If tf between map and vector_map was wrong they would also not align in RVIZ? because they align correct. The only thing not showing up is the lane as described above. Not sure why.
I will try to get the map later as it is on a different computer.
"Edit: I realize there is no marker for lane in rviz and does not show up in the moryiama sample data either"
Comment by Hatem on 2020-07-15:
lane center line does not visualize when using vector map, however if you start op_global_planner you will see white or orange lines representing the map center lines.
Comment by JoloGermanAg on 2020-07-15:
I guess that is the problem. Lanes do not show up with op_global_planner, but when I launch op_global_planner it says: Received Lanes68 which is correct
Comment by JoloGermanAg on 2020-07-15:
In the TierIV vector map builder (for up to V1.12) can you use it outside of japan since the reference is specific to japans GSI?
Comment by Hatem on 2020-07-15:
yes you can, if you are building a local map point_cloud & vector map have the same local origin
Comment by JoloGermanAg on 2020-07-15:
Ok thank you. I am not sure what the issue is then. When I export the waypoints and upload them via waypoint_loader they show up properly (still does not compute route) but the Lane does not show up through op_global_planner from the vectormap.
Comment by Hatem on 2020-07-15:
Just share the map, so I can give you final answer.
Comment by JoloGermanAg on 2020-07-15:
Does this work?
link text
Comment by JoloGermanAg on 2020-07-16:
i've tried to make some new vector maps using other pcds but i am still having the same issue

A:

I checked the map, you shared in the comments.
OpenPlanner expects dtlane to be included, even if it is empty.
I get your map to work by Just adding empty dtlane.csv (only file header included)

Originally posted by Hatem with karma: 443 on 2020-07-17
This answer was ACCEPTED on the original site
Post score: 1

Original comments
Comment by JoloGermanAg on 2020-07-17:
Thank you! I figured it had something to do with the missing files. I am still confused why the unity ToolBox one didn't work because it has dtlane.csv but it was missing some other files that are probably required (such as idx.csv). Either way, thank you so much for your help! I was able to run a simulation and use other vector maps that I had made previously!
Comment by Hatem on 2020-07-17:
Great, enjoy planning :)
can you mark the answer as correct ?
Comment by JoloGermanAg on 2020-07-18:
I have one more question: When i added dtlane.csv and reload the vector map using the GUI the vector map disappears in RVIZ (when i reload /vector_map in RVIZ). what is the fix for this? I did not realize this as I didn't reload /vector_map in rviz before
Comment by Hatem on 2020-07-18:
I think it is related to the TF when the TF changes you need to refresh the drawing of the objects. it is RVIZ problem.
Comment by JoloGermanAg on 2020-07-20:
that's exactly the problem - when i refresh the vectormap dissappears. I take out the dtlane.csv it's fine. If it's just visualization i don't mind but it seems to not stop for stop lines or anything. I will try a few different things and let you know if i find anything! Thanks!

