Q:

gazebo client no icons

My second problem for today is that gazebo client doesn't show any icons for play, pause, position object, etc.
In the terminal I see error, which I have seen many times before but always ignored:
irobot@irobot-desktop:~$ gzclient
Gazebo multi-robot simulator, version 1.0.0
Copyright (C) 2011 Nate Koenig, John Hsu, Andrew Howard, and contributors.
Released under the Apache 2 License.
http://gazebosim.org

Msg Waiting for master
Msg Connected to gazebo master @ http://localhost:11345
libpng warning: Application built with libpng-1.2.46 but running with 1.5.4
libpng warning: Application built with libpng-1.2.46 but running with 1.5.4
libpng warning: Application built with libpng-1.2.46 but running with 1.5.4
libpng warning: Application built with libpng-1.2.46 but running with 1.5.4
libpng warning: Application built with libpng-1.2.46 but running with 1.5.4
libpng warning: Application built with libpng-1.2.46 but running with 1.5.4
libpng warning: Application built with libpng-1.2.46 but running with 1.5.4
libpng warning: Application built with libpng-1.2.46 but running with 1.5.4
libpng warning: Application built with libpng-1.2.46 but running with 1.5.4
libpng warning: Application built with libpng-1.2.46 but running with 1.5.4
libpng warning: Application built with libpng-1.2.46 but running with 1.5.4

Does libpng warning related to the fact the icons doesn't appear? If so should I remove libpng and install older version? Would it conflict with other ROS packages which are using this library?
// I tried to remove libpng but it looks like it was installed with my OS, because many other things depends on it and I can't remove libpng12-0 package without messing up whole system (Packages like xorg, gnome, and many others will be removed with bad results)...Not sure how then should I fix this problem...Icons doesn't appear when I tried to move object as well...Just big red, blue and green boxes instead of icons. Any help will be highly appreciated.

Originally posted by Roman Burdakov on ROS Answers with karma: 131 on 2012-05-16
Post score: 0

A:

I am not sure why this happens sometimes, I have recently seen it even when I built gazebo from scratch.
The reason is that the version of libpng used by either gzclient it self or one of the dependencies are not correctly compiled and linked, so the version linked is not the one used when compiling....
I don't intend to spend more time investigating how this happened, but it could relate to openCV shipping with libpng 1.2.46 and referring to it directly in headers, while the default installed in ubuntu 11 and upwards is libpng 1.5.4
try:
ldd /usr/...../gzclient

and see if it attempts to use libpng.so or libpng.12.so,
you want it to use the older version "libpng.so", and it can be installed by:
sudo apt-get install libpng3

however that will not solve you'r problem as the program still attempts to load the library it was linked to.
This can be circumvented after installing the extra libpng in ubuntu by running the client like this:
LD_PRELOAD=/usr/lib/i386-linux-gnu/libpng.so gzclient

that loads the libpng from the version required, before resolving the dynamically linked libraries. In principle when the stuff in a library is loaded once, it is not necessesary to load it again, and most programs will then use the library pre-loaded.
This trick will not work for all programs, as a security risk is introduced when allowing the user to manually choose libraries (and perhaps reimplement them), but it will work for gzclient on ubuntu.

Originally posted by zcuba with karma: 31 on 2012-07-08
This answer was ACCEPTED on the original site
Post score: 0

