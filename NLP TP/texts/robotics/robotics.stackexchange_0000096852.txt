Q:

fanuc roboguide with ROS MoveIt (cont)

Dear all,
My question concerns about specific details needed so that we can see movements that occur inside ROS/MoveIt/Rviz also in the simulated robot inside Roboguide.
Briefly, I use Ubuntu 18.04.2 LTS bionic and  ros-melodic.  I have ROS/Moveit respositories for fanuc. I downloaded, installed and built these repositories from this link under my catkin_ws.
On Windows side, I have installed Roboguide. I have followed  this link and  this link  to make necessary configurations inside Roboguide on the virtual controller. When creating the work-cell, I chose R-1000iA/80F robot model.
On the TP, I have started the ROS TPE program. The following message appears:
25456     RSTA Waiting for ROS state prox

then I run the following on a terminal in ROS pc.
roslaunch fanuc_r1000ia80f_moveit_config moveit_planning_execution.launch robot_ip:=192.168.0.4 use_bswap:=false

Immediately, the following message appears on TP.
25460      RSTA Connected. 

Within rviz, using the motion planning plugin, I can plan a very simple movement specifying an end state. Last time, I was able to see the movements carried out in rviz being done in Roboguide. However, recently, when I try to execute, it fails without a successful execution on the virtual controller.
I was getting the following errors on the terminal in my ROS PC.
[ERROR] [1234567890.123456789]: Controller is taking too long to execute trajectory (the expected upper bound for the trajectory execution was X.Y seconds). Stopping trajectory.
[ INFO] [1234567890.123456789]: MoveitSimpleControllerManager: Cancelling execution for
[ INFO] [1234567890.123456789]: Execution completed: TIMED_OUT

I followed the suggestion given here. Specifically, I added the following lines to the trajectory_execution.launch.xml file.
<param name="trajectory_execution/allowed_execution_duration_scaling" value="4.0"/> <!-- default 1.2 -->
  <param name="trajectory_execution/execution_duration_monitoring" value="false" />

Now, rviz does not report a failed status when pressed execute or plan & execute. However, the movements do not appear on the virtual robot.
thanks,
Zahid

Originally posted by zahid990170 on ROS Answers with karma: 135 on 2020-08-17
Post score: 0

A:

Disabling the trajectory execution monitor does not influence the execution of the motion (or: it does, but not in the way you describe, ie: not starting at all).

On the TP, I have started the ROS TPE program

How exactly do you do this?
I ask because you only report messages on the TP from the robot state program. If only that program is running, you will not be able to command motion. For that, the trajectory relay must also be running.
Please open http://192.168.0.4/MD/PRGSTATE.DG and verify the following programs have a running status: ROS_STATE, ROS_RELAY and ROS_MOVESM.

Originally posted by gvdhoorn with karma: 86574 on 2020-08-17
This answer was ACCEPTED on the original site
Post score: 0

Original comments
Comment by zahid990170 on 2020-08-17:
thanks @gvdhoorn, answering your question.
I did SELECT->TYPE->TP Programs->ROS and then SHIFT followed by FWD. yes,  the trajectory relay must also be running. I was unable to figure out, on some occasions, I got the following on TP terminal output
RSTA waiting for ROS state prox
PREL waiting for ROS traj relay

and sometimes it was only
RSTA waiting for ROS state prox

When it was the two, I was able to command motion from ROS side. Otherwise not.
On the last try, I double click ROS such that it shows its contents
RUN ROS_STATE
RUN ROS_RELAY
CALL ROS_MOVESM

So, this runs the needed program.
then I go back and follow the aforementioned procedure to start the program ROS. This time, it runs both, and motion commands are passing  the virtual controller. thanks
Comment by gvdhoorn on 2020-08-17:
Could you please mark the question as answered by ticking the checkmark (âœ“) to the left of the answer if you feel it has been answered? Thanks.

