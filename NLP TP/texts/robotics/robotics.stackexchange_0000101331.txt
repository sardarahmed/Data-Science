Q:

Gazebo services call [/shadow_caster_material_name] and [/shadow_caster_render_back_faces] time-out, making Gazebo and ROS launchers unusable

Setup: Ubuntu 20.04, ROS 2 Galactic, Gazebo (11.10.1-1~focal)
With the update to the gazebo11 (ver 11.10.1) in the last ROS 2 Galactic sync my launch files and Gazebo overall stopped working correctly (services are timed out).
After starting gazebo --verbose I got:
~$ gazebo --verbose
Gazebo multi-robot simulator, version 11.10.1
Copyright (C) 2012 Open Source Robotics Foundation.
Released under the Apache 2 License.
http://gazebosim.org

[Msg] Waiting for master.
Gazebo multi-robot simulator, version 11.10.1
Copyright (C) 2012 Open Source Robotics Foundation.
Released under the Apache 2 License.
http://gazebosim.org

[Msg] Waiting for master.
[Msg] Connected to gazebo master @ http://127.0.0.1:11345
[Msg] Publicized address: 192.168.10.103
[Msg] Loading world file [/usr/share/gazebo-11/worlds/empty.world]
[Msg] Connected to gazebo master @ http://127.0.0.1:11345
[Msg] Publicized address: 192.168.10.103
[Err] [Scene.cc:227] Service call[/shadow_caster_material_name] timed out
[Err] [Scene.cc:249] Service call[/shadow_caster_render_back_faces] timed out
[Wrn] [Scene.cc:462] Ignition transport [/scene_info] service call failed, falling back to gazebo transport [scene_info] request.

Reverting to the old version of Gazebo packages didn't help, but I am not sure if I did it correctly too (maybe I have missed some dependent ROS packages). I have used:
sudo apt-get install gazebo11=11.9.0-1~focal gazebo11-common=11.9.0-1~focal gazebo11-plugin-base=11.9.0-1~focal libgazebo11=11.9.0-1~focal libgazebo11-dev=11.9.0-1~focal 

Gazebo and launcher still won't work even after that. I tried to reinstall everything, Gazebo, ROS2, my GPU drivers (latest recommended nvidia-driver-510, then switched to last working nvidia-driver-470 - still no luck).
It starts with empty.world scene, but any launcher (mine or from Nav2 repository and nav2_bringup package, branch" galactic, commit: 4bfedb8) cannot call any services.  In the second terminal I have everything sourced and ros2 topic list doesn't show me any of the topics of Turtlebot3 robot placed in the Gazebo.
When starting gzserver --verbose I am getting standard output, gzclient --verbose gives me every time the same timed-out error.
I put this issue there already + I haven't found anything more than some  issues of the problems with Ogre3d about this kind of services timing out...

https://github.com/osrf/gazebo/issues/2700
https://githubmemory.com/index.php/repo/lopsided98/nix-ros-overlay/issues/161
https://github.com/conda-forge/libignition-gazebo-feedstock/issues/6

There is my ogre.log too: https://controlc.com/9061c918 and my question on Gazebo answers.
ljaniec@ljaniec-PC:~/ros2_ws$ ros2 doctor --include-warnings --report | grep gaz
ros2_xacro_gazebo_spawner                 : latest=, local=0.0.0
ros_ign_gazebo_demos                      : latest=0.233.4, local=0.233.4
gazebo_dev                                : latest=3.5.2, local=3.5.2
gazebo_msgs                               : latest=3.5.2, local=3.5.2
gazebo_ros2_control_demos                 : latest=0.0.7, local=0.0.7
ros_ign_gazebo                            : latest=0.233.4, local=0.233.4
gazebo_ros2_control                       : latest=0.0.7, local=0.0.7
gazebo_ros                                : latest=3.5.2, local=3.5.2
gazebo_ros_pkgs                           : latest=3.5.2, local=3.5.2
turtlebot3_gazebo                         : latest=2.2.4, local=2.2.4
gazebo_plugins                            : latest=3.5.2, local=3.5.2

What is exactly happening? Does anybody have encountered this problem before? How can I solve it? Everything was working before...
I have found something unusual and weird too, which maybe could help a bit there - I can use a VirtualBox machine with Ubuntu 20.04 and ROS2 Galactic (binaries from Debian packages) with Gazebo without these errors of timed out services...
What is the source of this really weird situation? What do I have to change in my setup for everything to work?
I have built Gazebo from source too and  it and it didn't help - I still got the same service calls timed out.

Originally posted by ljaniec on ROS Answers with karma: 3064 on 2022-03-09
Post score: 0

A:

There was an update to the Gazebo 11 and luckily I found out what is a solution - I had to reset the Firewall settings in Ubuntu 20.04 because even ros2 topic list started to not working correctly.
Then I tried to run gazebo --verbose and it didn't hanged, I could add TB3 to the empty world and see it's topics etc. I think the firewall was disabling the ign-services in the background and they timed-out every time..? Or something similar.

Originally posted by ljaniec with karma: 3064 on 2022-03-20
This answer was ACCEPTED on the original site
Post score: 1

