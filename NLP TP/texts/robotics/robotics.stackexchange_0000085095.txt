Q:

Load a urdf/xml file as rosparm from a c++ ros node

I have followed the rosparam tutorial. But it dosent show how to load a xml/urdf file as a rosparam.
Specifically, I want to set "robot_description" parameter from a c++ ros node not from a launch file.

Originally posted by vacky11 on ROS Answers with karma: 272 on 2018-02-01
Post score: 0

Original comments
Comment by jayess on 2018-02-01:
How about using a launch file?
Comment by vacky11 on 2018-02-01:
I have mentioned it clearly in the question that I am not looking to set the parameter from a launch file. It is not suitable for my purpose.
Comment by jayess on 2018-02-01:
Yeah, guess I missed that. Why not?
Comment by vacky11 on 2018-02-01:
The reason is that I get the 'robot_name' from a rostopic inside the ros node and then I need to load the appropriate urdf file as parameter:"robot_description", depending on the robot_name

A:

Update:
Finally, this is how im doing it. You just need to read urdf file as a text file and store its content in a string and then set the string as a parameter
// Parse the urdf/xml file
std::string urdf_file_name = "/home/.../urdf_file_name.urdf"
std::ifstream f(urdf_file_name); 
std::stringstream ss;
ss << f.rdbuf();

// Set param
nh.setParam("robot_description", ss.str());

Originally posted by vacky11 with karma: 272 on 2018-02-01
This answer was ACCEPTED on the original site
Post score: 1

Original comments
Comment by gvdhoorn on 2018-02-02:
If you're not actually using the parsed urdf, why use tinyxml? A urdf is just a text file.
Comment by vacky11 on 2018-02-05:
@gvdhoorn I didnt realize this. I'll try to read urdf file as a simple text file and will update my answer if that works
Comment by vacky11 on 2018-02-12:
@gvdhoorn you were absolutely correct. Thanks for your input.
Comment by NiranjanDeshpande on 2018-04-01:
@vacky11 Could you please mention what is asset_urdf? Thanks.
Comment by vacky11 on 2018-05-22:
@NiranjanDeshpande it is the urdf file name  that needs to be set as a ros parameter. I will update my answer so that its intuitive
Comment by JonasG on 2018-06-04:
Can you please update your full code.
I code it like you, but there comes an error that 'youbot_arm' was not declared in this scope.
youbot_arm is the name of my urdf file.
Comment by JonasG on 2018-06-04:
If I code it this way:
std::ifstream u ("/home/.../youbot_arm.urdf");
It cannot open the file.
Comment by vacky11 on 2018-06-04:
@JonasG I have updated my answer. Hope that helps!
Comment by JonasG on 2018-06-04:
@vacky11 I code it like that. Then I use the rdf_loader for initalization of my robot_model object and it give me an error.
Error document empty.
Unable to parse URDF.
The class
http://docs.ros.org/jade/api/moveit_ros_planning/html/classrdf__loader_1_1RDFLoader.html#ace79b92f5a219c0b52b28cdf309f701
Comment by JonasG on 2018-06-04:
With which function do you use the urdf from the parameter server?
Comment by vacky11 on 2018-06-04:
@JonasG Do you mean which function I use to get a parameter from parameter server? I think something else might be wrong in your code. It will be easier for me understand the problem if you can share your code if that's possible
Comment by JonasG on 2018-06-04:
https://answers.ros.org/question/293155/cmakelisttxt/
There is a part of my code.
Comment by vacky11 on 2018-06-04:
@JonasG I just changed the third-last line in your code to rdf_loader::RDFLoader robot_model(su.str(), ss.str()); and edited the path of urdf and srdf file. And the code works well. Make sure there arent any typos in the path of your urdf and srdf file. I think thats where the problem is.
Comment by JonasG on 2018-06-04:
@vacky11
thank you very much, that was the point. Now it works.
I am so glad that you helped me out. ;)
Comment by JonasG on 2018-06-07:
@vacky11 do you have any experience of using a kdl plugin with moveit, for solving inverse kinematics with the setFromIK function?
Comment by gvdhoorn on 2018-06-07:
@JonasG: can I please ask you to keep things on-topic? Your comment has no bearing on the topic in this Q&A. Soliciting support from 'random' ROS Answers users is also not very nice.
Comment by JonasG on 2018-06-07:
@gvdhoorn sure. Sorry for that

