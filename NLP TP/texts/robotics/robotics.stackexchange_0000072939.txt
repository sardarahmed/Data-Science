Q:

How to stop gazebo publishing tf

Hi, all!
Now I'm testing the node /robot_pose_ekf with gazebo simulator. And I have already let /gazebo publish IMU and odometry data to /robot_pose_ekf. Also, /robot_pose_ekf is connected to tf.
However, when I checked the tf tree I found that the transform from odom -> base_footprint was provided by /gazebo but I want it to be /robot_pose_ekf.
I guess it is because both /gazebo and /robot_pose_ekf are publishing /tf. Hence, I think stopping /gazebo publishing /tf can be a possible solution. FYI, I'm using GMapping which subscribes to /tf to provide SLAM functions.
Can anyone tell me how to stop gazebo publishing tf? Or any other solutions to my problem?
Thank you in advance!

Originally posted by Clack on ROS Answers with karma: 75 on 2016-03-21
Post score: 2

Original comments
Comment by Mehdi. on 2016-03-21:
An alternative approach is to keep the odom->base_footprint as it is and compensate the odometry drift by adjusting the transform world->odom or map->odom then you just consider the transform world->base_footprint as robot pose. AFAIK this is what happens when you perform localization using i.e AMCL
Comment by Clack on 2016-03-21:
Thanks to your advice, Mehdi. But actually I have a laser scanner used to provide map -> odom. And my goal is to let robot_pose_ekf provide odom -> base_footprint instead of /gazebo itself. The reason why I stick to this is because I have to check if robot_pose_ekf can be used with GMapping.

A:

Use remapping method to map from tf to something like gazebo_tf, just add the remapping tags:
<remap from="tf" to="gazebo_tf"/> in the launch file of the empty world.
For example:
<node name="gazebo" pkg="gazebo_ros" type="gzserver" respawn="false" output="screen" args="-e ode worlds/empty.world" > <remap from="tf" to="gazebo_tf"/>  </node> 

Originally posted by DavidN with karma: 544 on 2016-03-21
This answer was ACCEPTED on the original site
Post score: 3

Original comments
Comment by Clack on 2016-03-21:
Thanks a lot! I'll have a try tomorrow as soon as I get back to my lab :)
Comment by Clack on 2016-03-22:
It works! Thank you so much!
Comment by lifuguan on 2020-08-03:
What confused me is that although I add <remap from="tf" to="gazebo_tf"/> as you mentioned, tf odom still exist.
<include file="$(find gazebo_ros)/launch/empty_world.launch">
    <arg name="world_name" value="$(find autonomus_transport_industrial_system)/worlds/obstacle_map.world"/>
    <arg name="paused" value="false"/>
    <arg name="use_sim_time" value="true"/>
    <arg name="gui" value="true"/>
    <arg name="headless" value="false"/>
    <arg name="debug" value="false"/>
    <remap from="tf" to="gazebo_tf"/>
</include>

rostopic info tf display:
    Type: tf2_msgs/TFMessage

Publishers: 
 * /robot_state_publisher (http://localhost:46447/)
 * /camera_front (http://localhost:35855/)
 * /camera_right (http://localhost:43249/)
 * /camera_left (http://localhost:33375/)
 * /gazebo (http://localhost:37939/)

Subscribers: 
 * /rviz (http://localhost:33813/)

Comment by shrini96 on 2023-02-07:
@lifuguan remap does not work inside the include tags. Either put it inside the node like @DavidN shows, or before the includes.

