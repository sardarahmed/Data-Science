Q:

Setting environment variable in local_setup.bash from ament_cmake package

Hello,
I'd like to set/modify an environment variable when the user sources the local_setup.bash from compiling my packages with colcon. I haven't succeeded at finding how to do this.
My packages use the ament_cmake build method.
Reading https://colcon.readthedocs.io/en/released/developer/environment.html it seems there are some automated detections done by colcon, and ament_cmake generates its own local_setup.bash. But I do not find how to explicitly say 'set this variable' or if I should generate another script to be sourced, and how I should instruct colcon or ament_cmake to pick it up.
Thanks for any guidance.
Update 2021-05-08
It seems that adding contents to the install/pkg/share/pkg/package.dsv file should do it. Still not clear how to do this. I've read through https://colcon.readthedocs.io/en/released/developer/environment.html and https://docs.ros.org/en/foxy/Guides/Ament-CMake-Documentation.html and I feel I am near the intended solution. Basically I need to make colcon aware of the existence of a new .dsv file.

Originally posted by amosteo on ROS Answers with karma: 43 on 2021-06-03
Post score: 0

A:

After some more digging I finally found that what I need is ament_environment_hooks. This is also answered here: https://discourse.ros.org/t/execute-something-as-part-of-local-setup-bash-call/2790
Given that the first google hit is the source code itself and the second one is that question, and the rest are increasingly obscure souces in foreign script, I consider myself satisfied that as simple as it may be it wasn't obviously documented.

Originally posted by amosteo with karma: 43 on 2021-06-08
This answer was ACCEPTED on the original site
Post score: 1

