Q:

local costmap tuning and shadow

When i rotate the robot. The local costmap remains somekind of shadow behind like shown below:

i'm using ros noetic ubuntu server 20.
Also how to tune the amcl for rplidar a1 for more accurate localizaton, i followed this guide but no success.
i.e the costmap also moves along with robot when is rotated leaving a shadow like shown in image above.
This are my amcl parameters:
<launch>
  <!-- Arguments -->
  <arg name="scan_topic"     default="scan"/>
  <arg name="initial_pose_x" default="0.0"/>
  <arg name="initial_pose_y" default="0.0"/>
  <arg name="initial_pose_a" default="0.0"/>

  <!-- AMCL -->
  <node pkg="amcl" type="amcl" name="amcl">

    <param name="min_particles"             value="50"/>
    <param name="max_particles"             value="2000"/>
    <param name="kld_err"                   value="0.02"/>
    <param name="update_min_d"              value="0.20"/>
    <param name="update_min_a"              value="0.20"/>
    <param name="resample_interval"         value="1"/>
    <param name="transform_tolerance"       value="0.5"/>
    <param name="recovery_alpha_slow"       value="0.00"/>
    <param name="recovery_alpha_fast"       value="0.00"/>
    <param name="initial_pose_x"            value="$(arg initial_pose_x)"/>
    <param name="initial_pose_y"            value="$(arg initial_pose_y)"/>
    <param name="initial_pose_a"            value="$(arg initial_pose_a)"/>
    <param name="gui_publish_rate"          value="50.0"/>

    <remap from="scan"                      to="$(arg scan_topic)"/>
    <param name="laser_max_range"           value="12"/>
    <param name="laser_max_beams"           value="359"/>
    <param name="laser_z_hit"               value="0.5"/>
    <param name="laser_z_short"             value="0.05"/>
    <param name="laser_z_max"               value="0.05"/>
    <param name="laser_z_rand"              value="0.5"/>
    <param name="laser_sigma_hit"           value="0.2"/>
    <param name="laser_lambda_short"        value="0.1"/>
    <param name="laser_likelihood_max_dist" value="2.0"/>
    <param name="laser_model_type"          value="likelihood_field"/>

    <param name="odom_model_type"           value="diff"/>
    <param name="odom_alpha1"               value="0.2"/>
    <param name="odom_alpha2"               value="0.2"/>
    <param name="odom_alpha3"               value="0.2"/>
    <param name="odom_alpha4"               value="0.2"/>
    <param name="odom_frame_id"             value="odom"/>
    <param name="base_frame_id"             value="base_footprint"/>

  </node>
</launch>

I'm using rplidar a1.
Here is the video demo showing this issue. Here i'm controling the robot from joystick.
If someone has used the same lidar i.e rplidar a1 for their autonomous robot please can you post your amcl parameters after tuning?

Originally posted by dinesh on ROS Answers with karma: 932 on 2020-11-20
Post score: 0

Original comments
Comment by miura on 2020-11-20:
When you look at the TF tree, are the base_footprint and the frame of /scan connected?
Comment by dinesh on 2020-11-20:
yes they are.
Comment by dinesh on 2020-11-20:
is this happeneing cas of map quality?
Comment by miura on 2020-11-20:
I don't think it's the quality of the map.
Comment by dinesh on 2020-11-22:
Now the localization issue is solved but still the shadow costmaps are remaining.

A:

I've run amcl on S1 ( not a1 ).
I'll give you some ideas from my experience. I hope there is something that will improve it.

Change the direction in which the lidar is mounted. What you think of as the front may be on the back.
Make laser_z_hit bigger and laser_z_rand smaller.
Set use_map_topic to true.

Originally posted by miura with karma: 1908 on 2020-11-20
This answer was ACCEPTED on the original site
Post score: 1

Original comments
Comment by dinesh on 2020-11-23:
Now the localization issue is solved but still the shadow costmaps are remaining.
Comment by miura on 2020-11-23:
I have an idea, so I commented on https://answers.ros.org/question/366137/useless-costmap-comming/

