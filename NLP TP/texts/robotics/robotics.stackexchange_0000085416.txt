Q:

Merging odometry with imu data

I have a node monitoring dual motor encoders and publishing odometry to the standard /odom. I also have an IMU with a compass providing true orientation about the z axis.
I'm currently calculating the effective z orientation just from the wheel velocities, as explained in this answer. Should I instead use the z orientation provided by the IMU, since that's absolute? Or should wheel odometry and IMU data be kept separate and merged later into a new topic?

Originally posted by Cerin on ROS Answers with karma: 940 on 2018-02-19
Post score: 0

Original comments
Comment by stevemartin on 2019-01-12:
May I ask, did you fuse IMU directly to odom? Would you mind sharing your odom code?

A:

Here's a simple example using robot_localization: launch file, yaml config file.
We've been using this setup for fusing data from wheel/track odometry with IMU data from a UM7 IMU (and thus getting full 3D odometry). It has to be noted that for both IMU and wheel odometry, sensible covariances have to be published, as those directly get used by the EKF to fuse estimates.

Originally posted by Stefan Kohlbrecher with karma: 24361 on 2018-02-20
This answer was ACCEPTED on the original site
Post score: 1

Original comments
Comment by Cerin on 2018-02-20:
Thank you for those links, although I wasn't really asking how to do this. I was asking should I do this? That example doesn't really seem to use EKF. It masks the odom and imu inputs so they're almost mutually exclusive, which doesn't require an EKF module. I can easily do that myself without EKF
Comment by Stefan Kohlbrecher on 2018-02-20:
Yes, this certainly isn't the most sophisticated utilization of a EKF, but it allows for easy integration of other modalities too. My guess would be you want to use the already proven and extensible available option instead of opting for doing it yourself (unless you have some special requirements)
Comment by parzival on 2020-03-20:
@Stefan-Kohlbrecher what do you think is a good way to measure and publish accurate enough covariances? I have motors with encoders and MPU6050.

