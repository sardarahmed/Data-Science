Q:

Problem following trajectories using "Katana_driver" with Katana 300 6m180

Hello all,
I've installed katana_driver (http://wiki.ros.org/katana_driver) to use with a Katana 300 6m180.
I managed to control the Katana arm using katana_teleop package, but when running katana_tutorials (roslaunch katana_tutorials follow_joint_trajectory_client.launch) the katana driver node fails with:
core service [/rosout] found
process[robot_state_publisher-1]: started with pid [18110]
process[katana-2]: started with pid [18127]
[ INFO] [1389893296.700950640]: trying to connect to katana (serial port: /dev/ttyS0) ...
[ INFO] [1389893296.701484379]: success: serial connection to Katana opened
[ INFO] [1389893296.701531683]: success: protocol class instantiated
[ INFO] [1389893296.701566842]: success: communication with Katana initialized
[ INFO] [1389893296.789326405]: success: katana initialized
[ INFO] [1389893296.975445650]: no calibration required
[ INFO] [1389893296.975594807]: success: katana calibrated
[ INFO] [1389893297.175685246]: katana gripper grasp query service started on topic /gripper_grasp_status
[ INFO] [1389893297.181666223]: katana gripper grasp hand posture action server started on topic /gripper_grasp_posture_controller
[ INFO] [1389893309.250900985]: Sending trajectory to Katana arm...
[ERROR] [1389893310.946135966]: ReadNotCompleteException: Another program accessed the KNI. Please stop it and restart the Katana node. (exception in executeTrajectory(): Cannot read all data from '')
[ERROR] [1389893310.946395937]: Problem while transferring trajectory to Katana arm, aborting

Any ideas of what the problem might be? Does this happen to others? It fails in kni->setAndStartPolyMovement call, at joint_trajectory_action_controller.cpp.
It seems for me that it cannot read actions of type "joint_trajectory_action" at all.
PS: I tried with both fuerte version in a fuerte distribution and hydro version in a hydro distribution.
Thank you,
Filipe Jesus

Originally posted by Filipe Jesus on ROS Answers with karma: 23 on 2014-01-16
Post score: 1

Original comments
Comment by Nanorax on 2014-01-20:
Hi, just to let you know, it happens to me also. Same Katana. Running groovy.
Comment by Nanorax on 2014-01-21:
I traced the error to: protocol->comm(&sendBuf.front(), &recvBuf.front(), &readBytes) called from kmlBase.cpp.
I guess there is a problem with the protocol. Could be some sort of problem with using ttyUSB instead of ttyS, although I linked my ttyS3 -> ttyUSB0 and the problem remains.

A:

The problem is that the Katana 300 doesn't support sending poly movements (a.k.a., spline trajectories). @fivef and his colleagues have done a lot of work on this, and I've finally taken the opportunity of your questions to start merging their code into my upstream katana_driver repo. So please help debugging here: https://github.com/uos/katana_driver/issues/6

Originally posted by Martin GÃ¼nther with karma: 11816 on 2014-01-24
This answer was ACCEPTED on the original site
Post score: 1

