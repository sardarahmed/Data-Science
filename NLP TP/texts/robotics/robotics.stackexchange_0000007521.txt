Q:

Calculate required motor torque through Harmonic Drive

I have a term project which is controlling a two-link manipulator with harmonic drive installed at each joint.
To control, i used Computed control method to determine the torque needed for each joints based on the formula: 
 $$\tau_i =M(\theta)(\ddot{\theta_i}+K_d\dot{e}+K_pe)+V+G  $$
To calculate the torque that each motor needs to produce through harmonic drive, i use: 
$$\tau_{motor} =(J_m+J_g)\rho\ddot{\theta_i}+\frac{\tau_i}{\rho\eta_g}$$
where:
 $\rho$ and $\eta_g$ are gear ratio and efficiency of the harmonic drive. $J_m$ and $J_g$ are the motor and gear inertia, respectively. 
after these calculation, i can see the effect of harmonic drive in the system by comparing input torque from motor in the model with harmonic drive ($\tau_{motor}$) to that torque in the model without harmonic drive ($\tau_i$) 
But my professor doesn't agree the formula $\tau_{motor}$ i used. He want me to include the stiffness $k$ of the harmonic drive.
This is what i have done
P/S: This model which consists of two-link manipulator+harmonic drive at each joint is built in MATLAB.  
Can anyone suggest me the formula about it? 
Thank you so much.

A:

Page 50 of Hamid D Taghirad's 1997 PhD dissertation from McGill University gives a series of equations for harmonic drive torques, and the top of page 51 gives the following fantastic model for the harmonic drive:

WG is the wave generator (input); fs is the flexispline (output); N is the gear ratio, then the springs and dampers are deflection and friction losses at various stages in the harmonic drive. If you neglect the input/output frictional losses ($T_{f1}$, $T_{f2}$, and $T_{f3}$), then you're left with what I believe your professor was looking for,
$$
I_{drive} \tau_{drive} = -k_{fs}*(\frac{1}{N} \theta_{input} - \theta_{output}) - b_{fs}(\frac{1}{N} \dot{\theta}_{input} - \dot{\theta}_{output})
$$
where again, fs is the flexispline. Essentially the major components of the drive forces are due to structural damping and springiness of the flexispline deforming while the input rotates. Note that here I'm using the gear ratio as input : output, as harmonic drives are reducers. If $N = \frac{50}{1}$, then the input divided by the gear ratio gives the reduced input angular position or speed. If you define gear ratio as the inverse of how I've used it then you would multiply by N instead of divide by it. 
Here are some great design tips for selecting harmonic drives, too, if anyone's interested. 

