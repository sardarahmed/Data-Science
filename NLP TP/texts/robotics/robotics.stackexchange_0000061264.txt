Q:

Failing to create catkin workspace

Hey,
I tried to go through this tutorial Tutorial: Using a URDF in Gazebo but I failed in the first steps. I gitcloned the RRbot stuff and tried catkin_make. But no success.
After this i tried to set up a complete new catkin workspace, just to make sure there is no error in my catkin workspace. But also with a new and plain catkin workspace it didnt work.
The error i get is here:
schultza@Andreas:~/catkin_ws$ catkin_make
Base path: /home/schultza/catkin_ws
Source space: /home/schultza/catkin_ws/src
Build space: /home/schultza/catkin_ws/build
Devel space: /home/schultza/catkin_ws/devel
Install space: /home/schultza/catkin_ws/install
####
#### Running command: "make cmake_check_build_system" in "/home/schultza/catkin_ws/build"
####
-- Using CATKIN_DEVEL_PREFIX: /home/schultza/catkin_ws/devel
-- Using CMAKE_PREFIX_PATH: /opt/ros/indigo
-- This workspace overlays: /opt/ros/indigo
-- Using PYTHON_EXECUTABLE: /usr/bin/python
-- Using Debian Python package layout
-- Using empy: /usr/bin/empy
-- Using CATKIN_ENABLE_TESTING: ON
-- Call enable_testing()
-- Using CATKIN_TEST_RESULTS_DIR: /home/schultza/catkin_ws/build/test_results
-- Found gtest sources under '/usr/src/gtest': gtests will be built
-- Using Python nosetests: /usr/bin/nosetests-2.7
-- catkin 0.6.9    
-- Using these message generators: gencpp;genlisp;genpy
-- Boost version: 1.54.0
You have called ADD_LIBRARY for library ... without any source files. This typically indicates a problem with your                CMakeLists.txt file
CMake Error: File /home/schultza/catkin_ws/src/package.xml does not exist.
CMake Error at /opt/ros/indigo/share/catkin/cmake/stamp.cmake:10 (configure_file):
  configure_file Problem configuring file
Call Stack (most recent call first):
  /opt/ros/indigo/share/catkin/cmake/catkin_package_xml.cmake:61 (stamp)
  /opt/ros/indigo/share/catkin/cmake/catkin_package_xml.cmake:39 (_catkin_package_xml)
  /opt/ros/indigo/share/catkin/cmake/catkin_package.cmake:95 (catkin_package_xml)
  CMakeLists.txt:77 (catkin_package)

CMake Error at /opt/ros/indigo/share/catkin/cmake/catkin_package.cmake:112 (message):
  catkin_package() 'catkin' must be listed as a buildtool dependency in the
  package.xml
Call Stack (most recent call first):
  /opt/ros/indigo/share/catkin/cmake/catkin_package.cmake:98 (_catkin_package)
  CMakeLists.txt:77 (catkin_package)

-- Configuring incomplete, errors occurred!
See also "/home/schultza/catkin_ws/build/CMakeFiles/CMakeOutput.log".
See also "/home/schultza/catkin_ws/build/CMakeFiles/CMakeError.log".
make: *** [cmake_check_build_system] Error 1
Invoking "make cmake_check_build_system" failed

Maybe someone of you can help me.
Im using ROS-indigo and Gazebo 2.2

Edit#1: Workspace structure
my workspace looks something like this:
catkin_ws
  build
  devel
  install
  src
    Package A
      (In almost every Package)
      include
      launch
      src
      worlds
      CMakeLists.txt
      package.xml
    Package B
    Package ....
    CMakeLists.txt
  RemoteSystemTempFiles

Sry for the bad formatting

Edit#2: Creating an empty workspace
schultza@Andreas:~$ source /opt/ros/indigo/setup.bash
schultza@Andreas:~$ mkdir -p ~/catkin_ws2/src
schultza@Andreas:~$ cd ~/catkin_ws2/src/
schultza@Andreas:~/catkin_ws2/src$ catkin_init_workspace
Creating symlink "/home/schultza/catkin_ws2/src/CMakeLists.txt" pointing to                     "/opt/ros/indigo/share/catkin/cmake/toplevel.cmake"
schultza@Andreas:~/catkin_ws2/src$ cd ~/catkin_ws2
schultza@Andreas:~/catkin_ws2$ catkin_make
Base path: /home/schultza/catkin_ws2
Source space: /home/schultza/catkin_ws2/src
Build space: /home/schultza/catkin_ws2/build
Devel space: /home/schultza/catkin_ws2/devel
Install space: /home/schultza/catkin_ws2/install
####
#### Running command: "cmake /home/schultza/catkin_ws2/src -    DCATKIN_DEVEL_PREFIX=/home/schultza/catkin_ws2/devel -    DCMAKE_INSTALL_PREFIX=/home/schultza/catkin_ws2/install" in "/home/schultza/catkin_ws2/build"
####
-- Using CATKIN_DEVEL_PREFIX: /home/schultza/catkin_ws2/devel
-- Using CMAKE_PREFIX_PATH: /opt/ros/indigo
-- This workspace overlays: /opt/ros/indigo
-- The C compiler identification is GNU 4.8.2
-- The CXX compiler identification is GNU 4.8.2
-- Check for working C compiler: /usr/bin/cc
-- Check for working C compiler: /usr/bin/cc -- works
-- Detecting C compiler ABI info
-- Detecting C compiler ABI info - done
-- Check for working CXX compiler: /usr/bin/c++
-- Check for working CXX compiler: /usr/bin/c++ -- works
-- Detecting CXX compiler ABI info
-- Detecting CXX compiler ABI info - done
-- Found PythonInterp: /usr/bin/python (found version "2.7.6") 
-- Using PYTHON_EXECUTABLE: /usr/bin/python
-- Using Debian Python package layout
-- Using empy: /usr/bin/empy
-- Using CATKIN_ENABLE_TESTING: ON
-- Call enable_testing()
-- Using CATKIN_TEST_RESULTS_DIR: /home/schultza/catkin_ws2/build/test_results
-- Looking for include file pthread.h
-- Looking for include file pthread.h - found
-- Looking for pthread_create
-- Looking for pthread_create - not found
-- Looking for pthread_create in pthreads
-- Looking for pthread_create in pthreads - not found
-- Looking for pthread_create in pthread
-- Looking for pthread_create in pthread - found
-- Found Threads: TRUE  
-- Found gtest sources under '/usr/src/gtest': gtests will be built
-- Using Python nosetests: /usr/bin/nosetests-2.7
-- catkin 0.6.9
-- Using these message generators: gencpp;genlisp;genpy
-- Boost version: 1.54.0
-- Found PROTOBUF: /usr/lib/i386-linux-gnu/libprotobuf.so  
CMake Error: File /home/schultza/catkin_ws2/src/package.xml does not exist.
CMake Error at /opt/ros/indigo/share/catkin/cmake/stamp.cmake:10 (configure_file):
  configure_file Problem configuring file
Call Stack (most recent call first):
  /opt/ros/indigo/share/catkin/cmake/catkin_package_xml.cmake:61 (stamp)
  /opt/ros/indigo/share/catkin/cmake/catkin_package_xml.cmake:39 (_catkin_package_xml)
  /opt/ros/indigo/share/catkin/cmake/catkin_package.cmake:95 (catkin_package_xml)
  CMakeLists.txt:77 (catkin_package)    
  CMake Error at /opt/ros/indigo/share/catkin/cmake/catkin_package.cmake:112 (message):
 catkin_package() 'catkin' must be listed as a buildtool dependency in the
 package.xml
 Call Stack (most recent call first):
 /opt/ros/indigo/share/catkin/cmake/catkin_package.cmake:98 (_catkin_package)
 CMakeLists.txt:77 (catkin_package)
 -- Configuring incomplete, errors occurred!
 See also "/home/schultza/catkin_ws2/build/CMakeFiles/CMakeOutput.log".
 See also "/home/schultza/catkin_ws2/build/CMakeFiles/CMakeError.log".
 Invoking "cmake" failed

Edit#3 CMakeLists.txt, maybe this could be also intresting
# toplevel CMakeLists.txt for a catkin workspace
# catkin/cmake/toplevel.cmake

cmake_minimum_required(VERSION 2.8.3)

set(CATKIN_TOPLEVEL TRUE)

# search for catkin within the workspace
set(_cmd "catkin_find_pkg" "catkin" "${CMAKE_SOURCE_DIR}")
execute_process(COMMAND ${_cmd}
  RESULT_VARIABLE _res
  OUTPUT_VARIABLE _out
  ERROR_VARIABLE _err
  OUTPUT_STRIP_TRAILING_WHITESPACE
  ERROR_STRIP_TRAILING_WHITESPACE
)
if(NOT _res EQUAL 0 AND NOT _res EQUAL 2)
  # searching fot catkin resulted in an error
  string(REPLACE ";" " " _cmd_str "${_cmd}")
  message(FATAL_ERROR "Search for 'catkin' in workspace failed (${_cmd_str}): ${_err}")
endif()

# include catkin from workspace or via find_package()
if(_res EQUAL 0)
  set(catkin_EXTRAS_DIR "${CMAKE_SOURCE_DIR}/${_out}/cmake")
  # include all.cmake without add_subdirectory to let it operate in same scope
  include(${catkin_EXTRAS_DIR}/all.cmake NO_POLICY_SCOPE)
  add_subdirectory("${_out}")

else()
  # use either CMAKE_PREFIX_PATH explicitly passed to CMake as a command line argument
  # or CMAKE_PREFIX_PATH from the environment
  if(NOT DEFINED CMAKE_PREFIX_PATH)
    if(NOT "$ENV{CMAKE_PREFIX_PATH}" STREQUAL "")
      string(REPLACE ":" ";" CMAKE_PREFIX_PATH $ENV{CMAKE_PREFIX_PATH})
    endif()
  endif()

  # list of catkin workspaces
  set(catkin_search_path "")
  foreach(path ${CMAKE_PREFIX_PATH})
    if(EXISTS "${path}/.catkin")
      list(FIND catkin_search_path ${path} _index)
      if(_index EQUAL -1)
        list(APPEND catkin_search_path ${path})
      endif()
    endif()
  endforeach()

  # search for catkin in all workspaces
  set(CATKIN_TOPLEVEL_FIND_PACKAGE TRUE)
  find_package(catkin QUIET
    NO_POLICY_SCOPE
    PATHS ${catkin_search_path}
    NO_DEFAULT_PATH NO_CMAKE_FIND_ROOT_PATH)
  unset(CATKIN_TOPLEVEL_FIND_PACKAGE)

  if(NOT catkin_FOUND)
    message(FATAL_ERROR "find_package(catkin) failed. catkin was neither found in the workspace nor in the CMAKE_PREFIX_PATH. One reason may be that no ROS setup.sh was sourced before.")
  endif()
endif()

project(YOURROBOT_gazebo_plugins)

find_package(catkin REQUIRED COMPONENTS
  gazebo_ros
)

# Depend on system install of Gazebo
find_package(gazebo REQUIRED)

include_directories(include ${catkin_INCLUDE_DIRS} ${GAZEBO_INCLUDE_DIRS} ${SDFormat_INCLUDE_DIRS})

# Build whatever you need here
#add_library(...) # TODO

catkin_package(
    DEPENDS
      gazebo_ros
    CATKIN_DEPENDS
    INCLUDE_DIRS
    LIBRARIES
)

catkin_workspace()

Edit#4 After change my toplevel.cmake i got this output after trying catkin_make
schultza@Andreas:~$ cd ~/catkin_ws
schultza@Andreas:~/catkin_ws$ catkin_make
Base path: /home/schultza/catkin_ws
Source space: /home/schultza/catkin_ws/src
Build space: /home/schultza/catkin_ws/build
Devel space: /home/schultza/catkin_ws/devel
Install space: /home/schultza/catkin_ws/install
####
#### Running command: "make cmake_check_build_system" in "/home/schultza/catkin_ws/build"
####
####
#### Running command: "make -j4 -l4" in "/home/schultza/catkin_ws/build"
####
[  0%] [  0%] Built target _baxter_maintenance_msgs_generate_messages_check_deps_TareEnable
Built target _baxter_maintenance_msgs_generate_messages_check_deps_CalibrateArmData
[  0%] Built target _baxter_maintenance_msgs_generate_messages_check_deps_TareData
[  0%] Built target _baxter_maintenance_msgs_generate_messages_check_deps_UpdateSource
[  0%] Built target std_msgs_generate_messages_py
[  0%] Built target std_msgs_generate_messages_lisp
[  0%] Built target _baxter_maintenance_msgs_generate_messages_check_deps_UpdateStatus
[  0%] Built target std_msgs_generate_messages_cpp
[  0%] Built target _baxter_maintenance_msgs_generate_messages_check_deps_CalibrateArmEnable
[  0%] Built target _baxter_maintenance_msgs_generate_messages_check_deps_UpdateSources
[  0%] Built target geometry_msgs_generate_messages_py
[  0%] Built target _pr2_msgs_generate_messages_check_deps_BatteryState
[  0%] Built target _pr2_msgs_generate_messages_check_deps_PowerBoardState
[  0%] Built target _pr2_msgs_generate_messages_check_deps_AccelerometerState
[  0%] Built target _pr2_msgs_generate_messages_check_deps_AccessPoint
[  0%] Built target _pr2_msgs_generate_messages_check_deps_PeriodicCmd
[  0%] Built target _pr2_msgs_generate_messages_check_deps_BatteryServer
[  0%] Built target _pr2_msgs_generate_messages_check_deps_SetLaserTrajCmd
[  0%] Built target _pr2_msgs_generate_messages_check_deps_BatteryServer2
[  0%] Built target _pr2_msgs_generate_messages_check_deps_BatteryState2
[  0%] Built target _pr2_msgs_generate_messages_check_deps_DashboardState
[  0%] Built target _pr2_msgs_generate_messages_check_deps_PressureState
[  0%] Built target _pr2_msgs_generate_messages_check_deps_PowerState
[  0%] Built target _pr2_msgs_generate_messages_check_deps_GPUStatus
[  0%] Built target _pr2_msgs_generate_messages_check_deps_SetPeriodicCmd
[  0%] Built target geometry_msgs_generate_messages_lisp
[  0%] [  0%] [  0%] Built target _pr2_msgs_generate_messages_check_deps_LaserTrajCmd
Built target _pr2_msgs_generate_messages_check_deps_LaserScannerSignal
Built target geometry_msgs_generate_messages_cpp
[  0%] Built target sensor_msgs_generate_messages_py
[  0%] Built target _baxter_core_msgs_generate_messages_check_deps_AnalogIOState
[  0%] [  0%] Built target _baxter_core_msgs_generate_messages_check_deps_CloseCamera
Built target _baxter_core_msgs_generate_messages_check_deps_EndEffectorCommand
[  0%] Built target _baxter_core_msgs_generate_messages_check_deps_CollisionDetectionState
[  0%] Built target _baxter_core_msgs_generate_messages_check_deps_DigitalIOStates
[  0%] Built target _baxter_core_msgs_generate_messages_check_deps_EndEffectorProperties
[  0%] Built target _baxter_core_msgs_generate_messages_check_deps_CameraControl
[  0%] Built target _baxter_core_msgs_generate_messages_check_deps_RobustControllerStatus
[  0%] Built target _baxter_core_msgs_generate_messages_check_deps_AssemblyStates
[  0%] Built target _baxter_core_msgs_generate_messages_check_deps_SolvePositionIK
[  0%] Built target _baxter_core_msgs_generate_messages_check_deps_EndpointState
[  0%] Built target _baxter_core_msgs_generate_messages_check_deps_ITBState
[  0%] Built target _baxter_core_msgs_generate_messages_check_deps_AnalogOutputCommand
[  0%] Built target _baxter_core_msgs_generate_messages_check_deps_EndpointStates
[  0%] Built target _baxter_core_msgs_generate_messages_check_deps_DigitalOutputCommand
[  0%] Built target _baxter_core_msgs_generate_messages_check_deps_NavigatorStates
[  0%] Built target _baxter_core_msgs_generate_messages_check_deps_ListCameras
[  0%] Built target _baxter_core_msgs_generate_messages_check_deps_AssemblyState
[  0%] Built target _baxter_core_msgs_generate_messages_check_deps_HeadPanCommand
[  0%] Built target _baxter_core_msgs_generate_messages_check_deps_SEAJointState
[  0%] Built target _baxter_core_msgs_generate_messages_check_deps_NavigatorState
[  0%] Built target _baxter_core_msgs_generate_messages_check_deps_HeadState
[  0%] [  0%] Built target _baxter_core_msgs_generate_messages_check_deps_CollisionAvoidanceState
Built target _baxter_core_msgs_generate_messages_check_deps_CameraSettings
[  0%] Built target _baxter_core_msgs_generate_messages_check_deps_OpenCamera
[  0%] Built target _baxter_core_msgs_generate_messages_check_deps_ITBStates
[  0%] [  0%] Built target _baxter_core_msgs_generate_messages_check_deps_EndEffectorState
Built target _baxter_core_msgs_generate_messages_check_deps_JointCommand
[  0%] [  0%] Built target _baxter_core_msgs_generate_messages_check_deps_AnalogIOStates
Built target sensor_msgs_generate_messages_cpp
[  0%] [  0%] Built target _baxter_core_msgs_generate_messages_check_deps_DigitalIOState
Built target sensor_msgs_generate_messages_lisp
[  0%] Built target add_two_ints_client
[  0%] Generating /home/schultza/catkin_ws/src/pr2_common-hydro-devel/pr2_description/meshes/gripper_v0/convex/l_finger.obj
/bin/sh: 1: ivcon: not found
make[2]: *** [/home/schultza/catkin_ws/src/pr2_common-hydro-devel/pr2_description/meshes/gripper_v0/convex/l_finger.obj] Error 127
make[1]: *** [pr2_common-hydro-devel/pr2_description/CMakeFiles/media_files.dir/all] Error 2
make[1]: *** Waiting for unfinished jobs....
[  0%] Built target gazebo_tutorials
[  0%] Built target _beginner_tutorials_generate_messages_check_deps_Num
[  0%] Built target _beginner_tutorials_generate_messages_check_deps_AddTwoInts
make: *** [all] Error 2
Invoking "make" failed

Originally posted by schultza on ROS Answers with karma: 232 on 2014-07-29
Post score: 1

Original comments
Comment by gvdhoorn on 2014-07-29:\

CMake Error: File /home/schultza/catkin_ws/src/package.xml does not exist.

This is strange: can you show us the layout of your workspace?
Comment by schultza on 2014-07-29:
sry this didnt work see my main post
Comment by BennyRe on 2014-07-29:
Did you follow these steps? http://wiki.ros.org/catkin/Tutorials/create_a_workspace
Comment by schultza on 2014-07-29:
Yes, as I said i tried to create a complete new workspace (with this tutorial you posted) and the same error occured
Comment by gvdhoorn on 2014-07-29:
So just creating (in a fresh shell) a directory structure like catkin_ws/src, then cd catkin_ws and catkin_make also doesn't work? So basically building an empty ws?
Comment by gvdhoorn on 2014-07-29:
Are you building from within eclipse? The RemoteSystemTempFiles seems to suggest you do.
Comment by schultza on 2014-07-29:
I exactly tried to build an empty ws as you described above and it failed with same error. I tried once to use eclipse but didnt go further with it and stopped to use it, but it wasnt a problem times before
Comment by BennyRe on 2014-07-29:
Ok that's strange. Please again create a fresh and empty workspace and post the output of the initial catkin_make.
Comment by schultza on 2014-07-29:
Please see the edited post Edit#2
Comment by gvdhoorn on 2014-07-31:
Has this been solved? Please mark the correct answer (@Williams) in that case.
Comment by schultza on 2014-07-31:
Actually not really still having troubles as you can see in Edit#4
Comment by BennyRe on 2014-07-31:
I remember that I had a similar problem with ivcon. Make sure it's installed AND added to your path.
Comment by gvdhoorn on 2014-07-31:
This has nothing to do with creating a catkin ws: ivcon is simply a dependency of the package that you're trying to build. Have you made sure you've installed all its dependencies (ie: used rosdep)?
Comment by schultza on 2014-07-31:
Maybe a little comprehension question, if I want to use this robot from here https://github.com/ros-simulation/gazebo_ros_demos.git. I clone it in my workspace src folder and do a catkin_make. Or did i missunderstand smth? Do I need to call rosdep for dependencies?
Comment by gvdhoorn on 2014-07-31:
Yes, you have to make sure you have all dependencies installed. One way to do that would be to run rosdep. By hand is also possible, but is obviously more involved.
Comment by schultza on 2014-07-31:
And how can I do this on the downloaded package? Can't find a tutorial for this situation.
Comment by BennyRe on 2014-07-31:
This can be found on nthe ROS cheat sheet: rosdep install --from-paths src --ignore-src       from your workspace root.
Comment by schultza on 2014-07-31:
Oh god, i got it was a mistake in my workspace hierarchy -.- thanks for your help!!!

A:

You should never edit the boilerplate toplevel.cmake file. This code should be removed:
project(YOURROBOT_gazebo_plugins)

find_package(catkin REQUIRED COMPONENTS
  gazebo_ros
)

# Depend on system install of Gazebo
find_package(gazebo REQUIRED)

include_directories(include ${catkin_INCLUDE_DIRS} ${GAZEBO_INCLUDE_DIRS} ${SDFormat_INCLUDE_DIRS})

# Build whatever you need here
#add_library(...) # TODO

catkin_package(
    DEPENDS
      gazebo_ros
    CATKIN_DEPENDS
    INCLUDE_DIRS
    LIBRARIES
)

If I am following your example correctly then that means you have actually edited the toplevel.cmake template file located at /opt/ros/indigo/share/catkin/cmake/toplevel.cmake and you should make sure you fix that one too.

Originally posted by William with karma: 17335 on 2014-07-29
This answer was ACCEPTED on the original site
Post score: 3

Original comments
Comment by schultza on 2014-07-30:
Hey thank you, it is still not working for my original workspace but if I create a new plain workspace it is! Please see my Edit#4 for the output while catkin_make of my original workspace
Comment by schultza on 2014-07-30:
But i dont get it or I do something wrong... In here http://gazebosim.org/tutorials/?tut=ros_overview they say i need to reconfigure my CMakeLists.txt, so I go to my current workspace in src and do it, but after this also my toplevel.cmake is reconfiguerd, where is the link between those?
Comment by schultza on 2014-07-30:
So if I change the CMakeLists.txt in current workspace src folder also the toplevel.cmake changes
Comment by ahendrix on 2014-07-30:
Yes - you should edit the CMakeLists.txt in your package - not the top-level CMakeLists.txt in your workspace. The top-level CMakeLists.txt is a symlink to toplevel.cmake, which is created by catkin the first time you run catkin_make.
Comment by BennyRe on 2014-07-30:
As a rule of thumb never edit anything under /opt/ros
Comment by schultza on 2014-07-30:
Ok so it is menat to be that the toplevel.cmake changes within changing the CMakeLists.txt of my package?
Comment by gvdhoorn on 2014-07-30:
No: the catkin_ws/src/CMakeLists.txt points to /opt/ros/indigo/share/catkin/cmake/toplevel.cmake, they are the same file. You should edit the files in your own package, ie: catkin_ws/src/my_package/CMakeLists.txt. Perhaps http://www.nixtutor.com/freebsd/understanding-symbolic-links/ would help.
Comment by schultza on 2014-07-31:
Actually that answer worked, there were just followed errors by an error in my workspace folders

