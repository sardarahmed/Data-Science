Q:

How to decrease (openni_)kinect cpu usage in turtlebot pkg

Hi!
I've been experimenting with the turtlebot-pkg on a fitpc2 with icreate and kinect but am running into the limits of the cpu now. I noticed that the openni_camera nodelet combined with the throttler uses quite a lot of cpu power. My guess is that this is caused by the fact that the driver publishes data at 30hz, and only after the throttler i get the advantage of the lower framerate (i only need about 5hz). The combination of driver/throttler thus still uses quite some cpu power as it works with the full 30hz datastream.
Is it possible to lower the framerate in the driver itself, as the cpu-power it uses to publish pointclouds at 30hz is wasted..?

Originally posted by Marco on ROS Answers with karma: 77 on 2011-08-23
Post score: 0

A:

I believe dynamic_reconfigure can adjust kinect driver parameters (or at least downsamples pre-publication, avoiding CPU overhead).

Use the GUI: rosrun dynamic_reconfigure reconfigure_gui
Change params in a launch script: e.g., <node pkg="dynamic_reconfigure" type="dynparam" name="resetter" args="set /openni_node image_mode 8" />

Note that you can't re-set params for openni_node if it has an subscriber...

Originally posted by Nick Armstrong-Crews with karma: 481 on 2011-08-23
This answer was ACCEPTED on the original site
Post score: 1

Original comments
Comment by tfoote on 2011-12-08:
Feel free to file a feature request for the driver, especially with a patch.  That feature does not exist at the moment.
Comment by Marco on 2011-08-29:
I saw that indead and am already using the nodelet implementation. My problem is the same as stated in the comments there: the nodelet still computes the 30Hz pointcloud before the throttler throttles it to 5Hz. This is still quite a waste of cpu power.
Comment by Nick Armstrong-Crews on 2011-08-25:
Looks like there's a similar question with a better answer: http://answers.ros.org/question/686/openni_node-internal-throttle-to-limit-cpu-usage
Comment by Marco on 2011-08-24:
Yes it indeed specifies both, however for the depth image only 30Hz modes are available. One 15Hz mode is possible for the cam, but not for depth mode. I might take a look at openni_camera.. or maybe someone already did something like this some time?
Comment by Nick Armstrong-Crews on 2011-08-24:
In the reconfigure_gui, I recall that each image mode specifies a framerate and a resolution; however, I don't recall the lowest framerate...maybe 15 Hz?  Your best bet may be to modify the openni_camera node source code and downsample frames in memory, before publishing on a ROS topic.
Comment by Marco on 2011-08-23:
Setting the image_mode to qvga(5) or qqvga(8) indeed decreases cpu usage, and also disabling the rgb depth registration here lowers cpu usage. However, I am looking for a way to reduce framerate (Hz) instead of resolution to lower cpu usage.. any ideas?

