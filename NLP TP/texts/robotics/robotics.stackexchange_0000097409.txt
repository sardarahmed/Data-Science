Q:

How to create a ROS snap correctly?

I am following the tutorial at https://snapcraft.io/#ros to create a Ubuntu Snap from a ROS package on Github. This all goes well until running the snapcraft command, from https://snapcraft.io/first-snap/ros/linux/build-and-test, which results in the following error:
ERROR: no rosdep rule for 'roscpp_serialization'
Package 'roscpp_serialization' isn't a valid system dependency. Did you forget to add it to catkin-packages? If not, add the Ubuntu package containing it to stage-packages until you can get it into the rosdep database.

I'm assuming this means I should change something in the .yaml file but I am unsure exactly how this should look. Could anyone offer an example or any guidance?
Here's the .yaml file from the tutorial:
name: test-ros-talker-listener-test
 version: '0.1'
 summary: ROS Talker/Listener Example
 description: |
  This example launches a ROS talker and listener.
 confinement: devmode
 base: core18
 parts:
  ros-tutorials:
    plugin: catkin
    source: https://github.com/ros/ros_tutorials.git
    source-branch: melodic-devel
    source-space: roscpp_tutorials/

 apps:
  test-ros-talker-listener-test:
    command: roslaunch roscpp_tutorials talker_listener.launch

Originally posted by Py on ROS Answers with karma: 501 on 2020-10-26
Post score: 0

Original comments
Comment by kyrofa on 2020-10-26:
It would be helpful to see the snapcraft.yaml you're using so we can duplicate your results. That tutorial seems to works fine, but it sounds like you're trying to snap something else, correct?
Comment by Py on 2020-10-26:
Just added this :)
Comment by kyrofa on 2020-10-26:
Wait, that IS the tutorial, no? I just built that and it worked fine. Can you add details regarding which OS/version you're using, as well as how you installed snapcraft and its version?
Comment by Py on 2020-10-27:
Yes that's right. See answer :)

A:

I'm running Ubuntu 18.04.5 and the Snapcraft was version is 2.43.1+18.4. To me this looked strange so I removed it, although Snapcraft version 4.3 remained on the system which did work. Problem solved!

Originally posted by Py with karma: 501 on 2020-10-27
This answer was ACCEPTED on the original site
Post score: 0

Original comments
Comment by kyrofa on 2020-10-27:
You must have had both the snapcraft snap as well as the snapcraft deb installed. The deb is old and not supported anymore, so removing it and using the snap was the right thing to do.

