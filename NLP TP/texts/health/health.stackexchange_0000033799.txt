Q:

How does a thymus transplantation work? Why doesn't it result in rejection of the recipient's... everything?

I read that DiGeorge syndrome can result in a baby being born completely lacking a thymus. That page also says that this can be treated through thymus transplantation.
My understanding of the thymus is that it's where T cells mature, and one of the important steps in this process is to make sure the T cells can differentiate "self" from "other". The thymus presents self-antigens from all parts of the body, and makes sure that a T cell doesn't interact too strongly with any of them.
As far as I understand, every person's set of self-antigens is unique to them, at least to some degree. So I don't see how a person could be given someone else's thymus; it should result in the transplant recipient creating T cells that target a wide array of tissues in their own body. But that appears not to be the case.
Question
Is the variation between any two individuals' self-antigens low enough that a thymus transplantation doesn't cause significant autoimmune rejections?
Or, are the cells that identify "self" (Medullary thymic epithelial cells) located outside of the thymus at birth, and then get incorporated into the thymus later, leaving a window of time when transplantation can be performed successfully?
Or possibly, are those "self" cells continually being produced based on the current tissues in the body, updating the thymus with a new map of the body's self-antigens and reducing rejection over time?

A:

In the original New England Journal of Medicine paper (Markert et al 1999. PMID 10523153), the authors demonstrate that following transplantation, the donor thymus contains recipient T-cells.

the use of HLA monoclonal antibodies revealed host thymopoiesis (T-cell development in the thymus) within donor-thymus epithelium

Thus, the recipient's T-cell population is reconstituted from a peripheral location. Lavini and colleagues (2008. PMCID 7120154) note:

Immune reconstitution occurs when recipient T-cells develop in the donor thymus tissue. These recipient T-cells are tolerant toward the donor thymus.

As you seem to have learned, immature T-cells undergo a process of both positive selection and negative selection. Positive selection ensures T-cells can recognize self-major histocompatibility complex. Meanwhile, negative selection eliminates T-cells that strongly recognize self-antigens, preventing autoimmunity.
The cells that present self antigens to induce negative selection are complex, as can be seen in this figure from Prof. Dr. Klein and colleagues:

Figure showing cells in the thymus from Klein et al 2014 (PMCID 4757912).
As can be seen in the figure, many self-antigens are presented by migratory cells that come from the periphery, including conventional dendritic cells and plasmacytoid dendritic cells. We should expect, therefore, that these cells would be recipient-derived and can induce tolerance of peripheral tissues.
However, as you have learned, medullary thymic epithelial cells (mTECs) are another important cell type. These cells are endodermal in origin, so we should expect that they will be donor-derived. These cells exhibit "promiscuous expression" of essentially all proteins in the genome at low levels. However, it is unclear how this actually induces tolerance:

Although the entire mTEC population collectively expresses almost all ‘peripheral’ transcripts, each [tissue-restricted antigen] is only expressed by a minor fraction (1–3%) of mTECs at any given time. How this mosaic expression pattern ultimately translates into faithful presentation of thousands of self-antigens in a way that ensures efficient tolerance remains puzzling.

Given that the mTECs are donor derived, there must be some small fraction of recipient antigens that are not presented by migratory cells. As far as I can find, there is no concrete explanation for why this does not result overt graft-versus-host. Perhaps the vast majority of all proteins are actually expressed in non-privileged sites and are imported by the dendritic cells.
Nonetheless, tolerance may not be perfect, as Lavini et al note, a number of patients develop autoimmune disease after transplant:

Autoimmune disease is a frequent complication
after thymus transplantation found in 42% of subjects over 1 year post transplantation. Of the 31 infants who are more than 1 year after transplantation, 8 (26%) have developed autoimmune thyroid disease and are on replacement therapy. One of these
infants developed alopecia totalis, which has not
been responsive to therapy. A second of these infants
with thyroid disease had previously developed
nephrotic syndrome which responded to a 2-month
course of steroids. (A renal biopsy was not performed.) Three additional subjects had transient
episodes of thrombocytopenia. Two subjects developed autoimmune hemolytic anemia associated with
viral infections. One of the subjects with anemia
subsequently developed autoimmune hepatitis.

This should of course be taken in the context of high rates of autoimmune disease among individuals with 22q11.2 deletion syndrome even in the absence of transplant who are often the recipients of donor thymuses.

