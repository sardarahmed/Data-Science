Q:

Did Ibn Al-Haytham believe that the Moon reflects sunlight or that it is self-luminous?

There are at least two articles about Ibn Al-Haytham in Encyclopedia First and Second
Both these articles have one major difference that is according to the First article:

The Light of the Stars (III 48). This argues that all stars and planets, with the sole exception of the moon, are self-luminous

The Light of the Moon (III 6). Ibn al-Haytham showed here that if the moon behaved like a mirror, the light it receives from the sun would be reflected at a given point on the earth from a smaller part of its surface than is actually observed. He accordingly argued that the moon sends out its borrowed light in the same manner as a self-luminous source, that is, from every point on its surface in all directions. This is confirmed through the use of an astronomical diopter having a slit of variable length through which various parts of the moon could be viewed from an opposite hole in a screen parallel to the slit. The treatise is a beautiful combination of mathematical deduction and experimental techniques. The experiments do not, however, lead to the discovery of a new property, but only serve to prove that the mode of emission from the moon is of the same kind as the already known mode of emission from self-luminous objects. Here, as in the Optics, the role of the experiment is in contrast to its role in the work of, say, Grimaldi or Newton.

So here we see that Ibn Al- Haytham view the moon as none Self-luminous Object same thing I found in this book and this article in the journal BUT
The second article says

This problem al-Hasan takes up again in On the Light of the Moon, in which he refutes the ancient theory that the moon reflects the sun's light like a mirror. Rather he believes that the moon is a self-illuminating body because each point on its surface broadcasts light rays in all directions, whereas each point on the surface of a mirror reflects a light ray from a single source (here the sun) in only one direction. However, he further believes that the eye receives two primary impressions in the act of vision: light and colour. Therefore he concludes that only some physical effect of the sun's light rays on the moon renders the latter's colour (and thereby it's light) visible

This article says Moon as a self-illuminating body
How can this be possible for a person to write in one book moonlight is from the sun and other self-illuminating? I try to find the On the Light of Moon book which I get and here it's the conclusion:
 caution it's translated from Arabic to Urdu to English if someone has Arabic to English please provide the link
Can someone puts some light like the sun puts on earth?

A:

English translations of Ibn Al-Haytham's optical treatises are available from Proceedings of the Celebrations of 1000th Anniversary by the Hamdard National Foundation of Pakistan. The mismatch in the OP quotes is not surprising as Ibn Al-Haytham's text is very confusing to a point of apparent inconsistency, and it is hard to understand what his ultimate conclusion is. In The Light of The Moon he starts by listing three possibilities, and then appears to reject each one of them in turn. Part of it might be translation issues, says the editor:"The translators had to wage an unflailing battle
against the understanding of the mathematical and technical sections of the text... They had also to spell out the text into the language and terminology of modern science".
The OP quotes try to make sense of it based on different portions of the text, and hence come to different conclusions. But, on my reading at least, they simply misinterpret some intermediate arguments as final. The discussion of color, for example, seems to offer it as a means of distinguishing between luminous and reflective bodies, not to suggest that light and color are separate "impressions". What Ibn Al-Haytham does insist upon is that the Moon  emits light in all directions, as if it was self-luminous, despite "deriving" it from the Sun, but the mechanism of that is very murky. My best guess is that he is trying to say that the Moon is something like a translucent body brightened by diffused reflection, which he, however, emphatically refuses to call "reflection", perhaps because this is usually associated with normal reflection by mirrors.
The three possibilities listed are: self-luminous body, "the light that falls on any portion of a body from some other source is reflected", and "the refracted light is visible on the surface of
the body. It happens in the case of all transparent
bodies". Later we read

"when the moon and the sun are opposite to each other at the time of lunar eclipse, the full moon should be visible as a luminous body. A portion of the moon becomes dark only because of the earth coming in between the sun and the moon. This event is the only reason to assert that the moon gets its light from the sun."

So the Moon is not self-luminous.

"From the above discussion, it is clear that the light of the moon reaches the earth from every point on its surface at which the light of the sun is falling. However, this light is not the result of reflection."

So the Moon does not reflect sunlight. Finally,

"in no case is the moon transparent
because if the moon is transparent, solar eclipse cannot occur when the moon comes into the middle of the earth and the sun."

So the Moon is not transparent either.
We get some positive clue from a different treatise, Light Of The Stars, where Ibn Al-Haytham says in passing that "with the exception of the Moon none derives its light from the sun". So the Moon, at least, "derives" its light from the sun even if it does not "reflect" it. Let us get back to the the last sentence of The Light of The Moon that gives Ibn Al-Haytham's cryptic conclusion:

"In fact, that part of the moon, on which the light of the sun falls becomes bright and due to the atomic property of the moon it looks bright from every point opposite to it".

This "atomic" property is mentioned in only one other place, in yet another treatise, Light:

"We come to the conclusion from the above that
every physical body accepts light. A transparent body
has the additional property of transmitting the light. This is the atomic aspect which lends a transparent body its brilliance and beauty."

But didn't we already rule out that the Moon is transparent? Well, not quite, "all transparent bodies possess a different degree of transparency which is due to the amount of density present in them. The greater the density of a
body, the smaller will be its transparency and vice versa". Moreover:

"Whenever those rays of light fall on any
transparent body except space, this secondary light is produced in the same way as the dense bodies give rise to this light when they are exposed to the sun. But the secondary light coming from transparent bodies is much weaker than that which issues from those bodies... It must be mentioned here that the secondary light issuing from transparent bodies is not due to the light passing through them; it may be due to those rays of light which enter into them from the opposite direction."

So perhaps the moon is only translucent, to a degree, and "atomic" refers to "fine holes" between "fibers" of such bodies that let some light through. This is the best sense I can make of Ibn Al-Haytham's repeated references to Moon "becoming bright", "deriving" the light from the Sun, but, emphatically, not reflecting it:

"So we conclude that the bright colour of
the moon which is visible on the earth is not due to
reflection but the real reason for that may be that
light of the sun bright as the moon [sic!] and because the surface of the moon is not glazed, the real colour of the moon is visible in this light... So it is wrong to think that the part of the moon on which the light of the sun falls does not become bright or the light falling at a place spreads to the other part of the sun [sic! probably should be "moon"]".

