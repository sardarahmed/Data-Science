Q:

What is the rationale of using Metformin in Pre-Diabetes and Type 2 Diabetes?

Mechanism of action of Metformin is

Ultimately, it decreases gluconeogenesis (glucose production) in the
liver

Gluconeogenesis results from breaking up of fat. Metformin also inhibits cellular lipolysis and increases glucagon storage.
But Insulin resistance, which is the cause for Pre-Diabetes and Type 2 Diabetes is itself caused by excess accumulation of fat in muscle cells and liver.
Reference

Insulin resistance occurs when your muscles and liver have an impaired
response to the action of insulin. This is caused by the accumulation
of excess fat in tissues that are not designed to store large
quantities of fat, resulting in a reduced ability of insulin to
promote glucose uptake in both muscle and liver cells.

If this is true, then even though, in short term, Metformin reduces blood glucose levels by reducing the hepatic contribution, it simply is working for the disease on long term by progressively making a person more and more insulin resistant by making sure the fat accumulated in the cells and liver is not broken down. This may explain why people on Metformin for Pre-diabetes will almost always progress into Type 2 Diabetes and need insulin secretagogues.
So, what is the rationale of using Metformin in Pre-Diabetes and Type 2 Diabetes?

A:

Metformin has effects on many body systems and its many effects are not completely understood, as explained in this 2019 review article discussing use of metformin to treat Type II diabetes mellitus.
Foretz, M., Guigas, B. & Viollet, B. Understanding the glucoregulatory mechanisms of metformin in type 2 diabetes mellitus. Nat Rev Endocrinol 15, 569–589 (2019). https://doi.org/10.1038/s41574-019-0242
This article can be accessed through Google Scholar at a site that is an open-access site and is not paywalled.
According to this article,

“…..several actions have been attributed to its ability to lower blood
glucose. For example, metformin acts primarily by the suppression of
enhanced basal endogenous glucose production in individuals with T2DM
through a 25–40% decrease in the hepatic gluconeogenesis rate…..”
“Moreover, in some euglycaemic-hyperinsulinaemic clamp studies, a
beneficial effect of metformin on insulin sensitivity has been
reported in skeletal muscle.”
“……the drug increases peripheral glucose utilization by the intestine,
primarily via non‐oxidative metabolism…..”

That is, according to this article, citing references, metformin does not increase insulin resistance.  It increases insulin sensitivity.  That is one reason it is given both in people with Type 2 diabetes and in people with pre-diabetes.
The question states that

“people on metformin for pre-diabetes will almost always progress into
Type 2 Diabetes and need insulin secretagogues.”

This is not a correct statement.  Metformin decreases the chances that a person with pre-diabetes will progress to Type 2 diabetes.   The most convincing evidence for this statement comes from a 2019 Cochrane Systematic Review of randomized trials of metformin compared with placebo or diet/exercise in people with pre-diabetes reported that the:

“incidence of T2DM was 324/1751 versus 529/1881 participants (RR 0.50,
95% CI 0.38 to 0.65; P < 0.001; 3632 participants, 12 trials;
moderate‐quality evidence.”

https://www.ncbi.nlm.nih.gov/pmc/articles/PMC6889926/
The detail of the trials that compared progression to Type 2 diabetes comparing metformin with placebo or diet/exercise can be found on page 102 of this publication—Analysis 1.2 and 1.3.
EDIT.  The Diabetes Prevention Program trial, which is the largest trial of metformin in people with pre-diabetes, showed an effect of metformin in decreasing the chances of progression from pre-diabetes to Type 2 diabetes at 3 years.  The percentages of people with pre-diabetes who had progressed to Type 2 diabetes were 28.9% in the placebo group, 21.7% in the metformin group, and 14.4% in the lifestyle group.
https://www.ncbi.nlm.nih.gov/pmc/articles/PMC1370926/
The authors estimated that metformin delayed onset of Type 2 diabetes by 3 years.

