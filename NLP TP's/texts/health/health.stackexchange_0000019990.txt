Q:

How efficient is the human metabolism at converting macronutrients to fat

My understanding is that carbohydrates and protein that are eaten but not immediately utilised are stored as body fat, provided that glycogen stores are already full. Also, I assume that any fat eaten but not immediately utilised either gets broken down and then stored by the same mechanisms, or else is stored directly.

How efficient are these processes, typically? What is the conversion rate for energy in macronutrients consumed to energy in fat stored?
Does the efficiency differ for the different macronutrients?
If the calorie values given for macronutrients already account for typical losses in digestion and utilisation, is there still an additional loss in the conversion to stored fat? 
Is there an additional conversion loss when stored body fat is used via ketosis? I.e. is the available energy in one gram of stored body fat typically equivalent to one gram of fat eaten?

A:

In short, 1,000 excessive calories from food does not translate into 1,000 calories of body fat. The conversion rate is highest for fats and lowest for proteins and may greatly depend on genetics.
1) What is the conversion rate for energy in macronutrients consumed to energy in fat stored?
It depends greatly on a person and foods eaten, because some energy will:

not be absorbed in the intestine, probably <5%
be lost due to increased metabolism associated with the thermic effect of food, in general: ~10%
be used to increase of lean body mass, which depends on the extent of physical activity
be used differently in different persons, which may be genetically determined:

In response to 84 days of 1000 kcal/day of overfeeding, 12 pairs of
  monozygotic twins gained on average 8.1 kg, but the range was from 4.3
  to 13.3 kg.
However, the similarity within each twin pair in response to
  overfeeding was significant with respect to body weight gain,
  percentage of fat and total fat mass with about three times more
  variance among pairs than within pairs.  (International Journal of Obesity, 2008).

2) Does the efficiency differ for the different macronutrients?
Different macronutrients have different thermic effects, that is the loss of consumed energy due to increased metabolism triggered by food: protein: 15-30% ; alcohol: 10-30% ; carbohydrates: 5-10% ; fat 0-3% (Nutrition and Metabolism, 2004), so calories from proteins and alcohol should be less fattening than those from fats and carbohydrates:

In conclusion, it is evident that overfeeding on carbohydrate and/or
  fat results in body composition alterations that are different than
  overfeeding on protein. It is commonly believed that 3,500 kcal is
  equivalent to 0.45 kg (1 pound) of fat and that changing energy
  balance in accordance with this will produce predictable changes in
  body weight. However, the overfeeding literature to date does not
  support this assertion. Dietary protein appears to have a protective
  effect against fat gain during times of energy surplus, especially
  when combined with resistance training (International Journal of Exercise Science, 2017).

3) If the calorie values given for macronutrients already account for typical losses in digestion and utilisation, is there still an additional loss in the conversion to stored fat?
I just want to repeat that, due to low thermic effect, dietary fat is more efficiently converted to body fat than dietary protein or carbohydrate.
4) Is there an additional conversion loss when stored body fat is used via ketosis? I.e. is the available energy in one gram of stored body fat typically equivalent to one gram of fat eaten?
In healthy individuals, significant amounts of ketones are created only in ketogenic (low-carb) diets (Harvard Medical School). Some ketones are lost with urine and breath, but not in the amounts meaningful for weight loss (Allinahealth). According to studies, ketogenic diets may not be more efficient for weight loss than other diets (Canadian Family Physician, 2018).
As explained above, 1 g of fat eaten does not result in 1 g of fat stored, but not much less, because of low thermic effect of fat.

