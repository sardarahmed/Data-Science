Q:

Are there diseases for which infection does not grant lasting immunity but a vaccine does?

There has been a lot of discussion about whether people who have COVID-19 and recover will have long-lasting immunity.  At the same time, work is underway to create a vaccine for this disease.  But if infection does not necessarily provide immunity, can a vaccine still do it?  Are there known diseases for which a vaccine provides durable immunity even when infection does not?
I did find one page that says in passing that "it is true that natural infection almost always causes better immunity than vaccines", but I wasn't able to find anything more detailed about the two types of immunity.

A:

Rabies is almost 100% fatal so there is no chance to develop immunity.  So, post-exposure vaccination is used if the person has not been vaccinated prior to exposure.

Rabies is a vaccine-preventable, zoonotic, viral disease. Once clinical symptoms appear, rabies is virtually 100% fatal. In up to 99% of cases, domestic dogs are responsible for rabies virus transmission to humans. Yet, rabies can affect both domestic and wild animals. It is spread to people and animals through bites or scratches, usually via saliva.

https://www.who.int/news-room/fact-sheets/detail/rabies

A:

Varicella zoster - you can get infected and then develop shingles recurrences which are preventable using vaccination eg Shingrix 
https://www.cdc.gov/vaccines/vpd/shingles/public/shingrix/index.html

