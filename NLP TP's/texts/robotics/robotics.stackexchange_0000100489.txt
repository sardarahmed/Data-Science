Q:

Autoware.Auto Release Branch 1.0.0 failed to build with colcon

Hi there,
I'm starting out with Autoware.Auto
I followed:

This [https://autowarefoundation.gitlab.io/autoware.auto/AutowareAuto/installation-ade.html#installation-and-development-install-ade] procedure to install Autoware.Auto with ADE, no errors

Checkout release 1.0.0 following this [https://autowarefoundation.gitlab.io/autoware.auto/AutowareAuto/installation-ade.html#installation-and-development-setup-ade-home-and-project-checkout], no errors

Entered the environment following [https://autowarefoundation.gitlab.io/autoware.auto/AutowareAuto/installation-ade.html#autotoc_md64], no errors

To make sure everything is alright I built Autoware and I got the following error

ade:~/AutowareAuto (release-1.0.0)$ cd
<font color="#4E9A06"><b>ade</b></font>:<font color="#3465A4"><b>~</b></font>$ cd AutowareAuto/
ade:~/AutowareAuto (release-1.0.0)$ colcon build
Starting >>> autoware_auto_cmake
Starting >>> mpark_variant_vendor
Starting >>> autoware_auto_integration_tests
Starting >>> lexus_rx_450h_description
Starting >>> ament_acado
Starting >>> motion_model_testing_simulator
Starting >>> autoware_auto_create_pkg
Starting >>> autoware_auto_examples
Finished <<< autoware_auto_integration_tests [0.36s]                       
Finished <<< autoware_auto_cmake [0.40s]                                   
Starting >>> autoware_auto_common
Starting >>> time_utils
Starting >>> reference_tracking_controller
Starting >>> autoware_auto_algorithm
Starting >>> recordreplay_planner_actions
Starting >>> avp_web_interface
Finished <<< mpark_variant_vendor [0.47s]
Finished <<< lexus_rx_450h_description [0.47s]
Finished <<< motion_model_testing_simulator [0.50s]                    
Starting >>> controller_testing
Finished <<< autoware_auto_examples [0.55s]                           
Finished <<< autoware_auto_create_pkg [0.57s]
Finished <<< avp_web_interface [0.37s]                               
Finished <<< time_utils [0.46s]
Starting >>> motion_testing
Finished <<< reference_tracking_controller [0.49s]                   
Finished <<< autoware_auto_algorithm [0.50s]
Finished <<< autoware_auto_common [0.54s]
Starting >>> autoware_auto_geometry
Starting >>> had_map_utils
Starting >>> motion_model
Starting >>> autoware_auto_tf2
Starting >>> optimization
Starting >>> signal_filters
Starting >>> velodyne_driver
Starting >>> lidar_integration                                         
Starting >>> off_map_obstacles_filter
Starting >>> trajectory_spoofer
Starting >>> covariance_insertion
Starting >>> joystick_vehicle_interface
Finished <<< controller_testing [0.52s]
Starting >>> spinnaker_camera_driver
--- stderr: motion_testing                                             
In file included from /home/micropolis/AutowareAuto/src/control/motion_testing/src/motion_testing/motion_testing.cpp:14:
/home/micropolis/AutowareAuto/src/control/motion_testing/include/motion_testing/motion_testing.hpp:18:10: fatal error: autoware_auto_msgs/msg/trajectory.hpp: No such file or directory
   18 | #include <autoware_auto_msgs/msg/trajectory.hpp>
      |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
compilation terminated.
make[2]: *** [CMakeFiles/motion_testing.dir/build.make:63: CMakeFiles/motion_testing.dir/src/motion_testing/motion_testing.cpp.o] Error 1
make[1]: *** [CMakeFiles/Makefile2:130: CMakeFiles/motion_testing.dir/all] Error 2
make: *** [Makefile:141: all] Error 2
---
Failed   <<< motion_testing [0.41s, exited with code 2]
Aborted  <<< optimization [0.34s]
Aborted  <<< covariance_insertion [0.29s]
Aborted  <<< signal_filters [0.34s]
Aborted  <<< spinnaker_camera_driver [0.26s]
Aborted  <<< joystick_vehicle_interface [0.30s]
Aborted  <<< velodyne_driver [0.36s]
Aborted  <<< motion_model [0.39s]
Aborted  <<< off_map_obstacles_filter [0.37s]
Aborted  <<< recordreplay_planner_actions [0.95s]
Aborted  <<< lidar_integration [0.55s]                                          
Aborted  <<< ament_acado [1.88s]                                                  
Aborted  <<< autoware_auto_geometry [1.09s]       
Aborted  <<< trajectory_spoofer [1.38s]                                            
Aborted  <<< autoware_auto_tf2 [1.79s]                                             
Aborted  <<< had_map_utils [2.08s]                                 

Summary: 13 packages finished [3.74s]
  1 package failed: motion_testing
  15 packages aborted: ament_acado autoware_auto_geometry autoware_auto_tf2 covariance_insertion had_map_utils joystick_vehicle_interface lidar_integration motion_model off_map_obstacles_filter optimization recordreplay_planner_actions signal_filters spinnaker_camera_driver trajectory_spoofer velodyne_driver
  8 packages had stderr output: autoware_auto_geometry autoware_auto_tf2 had_map_utils joystick_vehicle_interface lidar_integration motion_testing off_map_obstacles_filter trajectory_spoofer
  58 packages not processed
It can't find a file autoware_auto_msgs/msg/trajectory.hpp.
I looked up /opt/AutowareAuto/share/autoware_auto_msgs/msg/ where I found it but it has the extensions .idl instead of .hpp.
ade:~/AutowareAuto (release-1.0.0)$ ll /opt/AutowareAuto/share/autoware_auto_msgs/msg/
total 84
drwxr-xr-x 2 root root 4096 Nov  8 10:02 ./
drwxr-xr-x 8 root root 4096 Nov  8 10:02 ../
-rw-r--r-- 1 root root  450 Apr 28  2021 BoundingBoxArray.idl
-rw-r--r-- 1 root root 2052 Apr 28  2021 BoundingBox.idl
-rw-r--r-- 1 root root  581 Apr 28  2021 Complex32.idl
-rw-r--r-- 1 root root  808 Apr 28  2021 ControlDiagnostic.idl
-rw-r--r-- 1 root root  493 Apr 28  2021 DiagnosticHeader.idl
-rw-r--r-- 1 root root  911 Apr 28  2021 HADMapBin.idl
-rw-r--r-- 1 root root  427 Apr 28  2021 HighLevelControlCommand.idl
-rw-r--r-- 1 root root  379 Apr 28  2021 MapPrimitive.idl
-rw-r--r-- 1 root root  489 Apr 28  2021 PointClusters.idl
-rw-r--r-- 1 root root  389 Apr 28  2021 Quaternion32.idl
-rw-r--r-- 1 root root  593 Apr 28  2021 RawControlCommand.idl
-rw-r--r-- 1 root root  610 Apr 28  2021 Route.idl
-rw-r--r-- 1 root root  452 Apr 28  2021 Trajectory.idl
-rw-r--r-- 1 root root  855 Apr 28  2021 TrajectoryPoint.idl
-rw-r--r-- 1 root root  689 Apr 28  2021 VehicleControlCommand.idl
-rw-r--r-- 1 root root  523 Apr 28  2021 VehicleKinematicState.idl
-rw-r--r-- 1 root root  424 Apr 28  2021 VehicleOdometry.idl
-rw-r--r-- 1 root root 1479 Apr 28  2021 VehicleStateCommand.idl
-rw-r--r-- 1 root root 1249 Apr 28  2021 VehicleStateReport.idl
What am I doing wrong?
Thanks in advance.
Any help is really appreciated.

Originally posted by eslaaam3 on ROS Answers with karma: 3 on 2021-11-08
Post score: 0

A:

Hello,
Normally you don't need to rebuild the code if you are using ade unless you are doing development on it, you can just run the demos without it.
For the error you are getting, you can follow these from the Troubleshooting section: https://autowarefoundation.gitlab.io/autoware.auto/AutowareAuto/installation-no-ade.html#autotoc_md68

In case where ros-foxy-autoware-auto-msgs is installed on the system, colcon uses it instead of the one in the AutowareAuto/src/external/ folder. This may cause errors. To prevent this, please remove the package by:

sudo apt purge -y ros-foxy-autoware-auto-msgs

Originally posted by xmfcx with karma: 96 on 2021-11-09
This answer was ACCEPTED on the original site
Post score: 1

Original comments
Comment by eslaaam3 on 2021-11-11:
Thanks but this solution is for "installation without ADE", I'm using the ADE

Normally you don't need to rebuild the code if you are using ade

The build step exists in this tutorial https://gitlab.com/ApexAI/autowareclass2020/...
So if I don't build it now I will need to build it later either way, so I built it at first to know when I get errors if they were caused by any modification of this tutorial or it's just the source code doesn't compile
Comment by xmfcx on 2021-11-11:
I understand, the same solution should work for your case too. Could you try to run sudo apt purge -y ros-foxy-autoware-auto-msgs and rm bulid/ install/ log/ inside the Autoware.Auto folder and retry compiling?
Comment by eslaaam3 on 2021-11-11:
It worked when I installed the ros-foxy-autoware-auto-msgs after a cleaning

