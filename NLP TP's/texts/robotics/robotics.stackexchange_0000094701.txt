Q:

How can I build navigation2 from source?

I have installed "ROS 2 Eloquent Elusor - Patch Release 1" from https://github.com/ros2/ros2/releases.
It works well, in fact I can run the examples of publisher/listener.
I want now to build navigation2 from source, but when I do it:
lorenzoteo@lorenzoteo-HP-ZBook-15v-G5:~/navigation2$ colcon build --symlink-install
Starting >>> nav2_common
Starting >>> nav_2d_msgs
Starting >>> nav2_gazebo_spawner
--- stderr: nav2_common                                                                                              
CMake Error at CMakeLists.txt:5 (find_package):
  By not providing "Findament_cmake_core.cmake" in CMAKE_MODULE_PATH this
  project has asked CMake to find a package configuration file provided by
  "ament_cmake_core", but CMake did not find one.

  Could not find a package configuration file provided by "ament_cmake_core"
  with any of the following names:

    ament_cmake_coreConfig.cmake
    ament_cmake_core-config.cmake

  Add the installation prefix of "ament_cmake_core" to CMAKE_PREFIX_PATH or
  set "ament_cmake_core_DIR" to a directory containing one of the above
  files.  If "ament_cmake_core" provides a separate development package or
  SDK, be sure it has been installed.

---
Failed   <<< nav2_common    [ Exited with code 1 ]
Aborted  <<< nav2_gazebo_spawner                                                                     
--- stderr: nav_2d_msgs                                     
CMake Error at CMakeLists.txt:4 (find_package):
  By not providing "Findgeometry_msgs.cmake" in CMAKE_MODULE_PATH this
  project has asked CMake to find a package configuration file provided by
  "geometry_msgs", but CMake did not find one.

  Could not find a package configuration file provided by "geometry_msgs"
  with any of the following names:

    geometry_msgsConfig.cmake
    geometry_msgs-config.cmake

  Add the installation prefix of "geometry_msgs" to CMAKE_PREFIX_PATH or set
  "geometry_msgs_DIR" to a directory containing one of the above files.  If
  "geometry_msgs" provides a separate development package or SDK, be sure it
  has been installed.

---
Aborted  <<< nav_2d_msgs
                                 
Summary: 0 packages finished [1.04s]
  1 package failed: nav2_common
  2 packages aborted: nav2_gazebo_spawner nav_2d_msgs
  2 packages had stderr output: nav2_common nav_2d_msgs
  26 packages not processed

Why?

Originally posted by lorenzo on ROS Answers with karma: 88 on 2020-02-12
Post score: 1

Original comments
Comment by Sidd on 2020-02-12:
Have you followed instructions from here? It looks like it's not find certain ros2 packages. Have you sourced your ros2_ws?

A:

This is an answer to the follow-up question in the comments. As it doesn't fit in a comment I post it as an answer.
@lorenzo as your original issue (not finding the ROS packages in CMake) has been addressed by the original answer, it would be better in the future to accept the original answer and ask follow-up questions as separate questions so that users facing it can find the answer more easily when searching this site.
The issue you are facing is because some RViz components are not relocatable (the paths are hard-coded to the path it had on the build machine)
More details at:

https://github.com/osrf/docker_images/pull/274
https://github.com/ament/ament_cmake/issues/173
https://github.com/ros-planning/navigation2/pull/806

The work-arounds can be:

create the folder it expects and create a symbolic link to it
mkdir -p /home/jenkins-agent/workspace/ci_packaging_linux/ws/install/
ln -s ~/ros2_eloquent/ros2-linux /home/jenkins-agent/workspace/ci_packaging_linux/ws/install/

replace all the hard-coded paths to the one on your machine (search replace /home/jenkins-agent/workspace/ci_packaging_linux/ws/install/ with /home/lorenzoteo/ros2_eloquent/ros2-linux/

Ubuntu only: If you are on Ubuntu, I recommend this solution as it's less of a work around.
Install ROS 2 from debian packages and not from the release archive, this has multiple advantages including but not limited to:

RViz is compiled with the right destination path so this issue does not happen
The package manager handles the installation and will handle subsequent updates
Can easily install additional ROS packages without mixing install paths

Originally posted by marguedas with karma: 3606 on 2020-02-14
This answer was ACCEPTED on the original site
Post score: 0

