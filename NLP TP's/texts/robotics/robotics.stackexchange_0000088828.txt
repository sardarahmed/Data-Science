Q:

bag file is empty after rosbag reindexing and fixing .bag.active file

Hello everyone!
I'm trying to convert .bag.active file into .bag file so I can play it inside rqt_bag program. The thing is, I tried to follow this steps which is to:

rosbag reindex the .bag.active file, and then
rosbag fix .bag.active file into .bag file

I do get the message that Bag migration is successful. after running rosbag fix, but when trying rosbag play it says that there are 0 messages to play.
Someone else also asked this question, but there are no answers, so I'm trying again, maybe you can help me.
EDIT: To anybody else reading this question, to recap:

run rosbag record with --chunksize=<some_number> option. <some_number> should be a number which is appropriate for how much data in KB you are sending and/or receiving.
run rosbag reindex <your_bag_active_file>, e.g. rosbag reindex myfile.bag.active
run rosbag fix <your_bag_active_file> <new_bag_file_name>, e.g. rosbag fix myfile.bag.active mybagfile.bag

Originally posted by Lucas02 on ROS Answers with karma: 3 on 2018-09-03
Post score: 0

Original comments
Comment by Reamees on 2018-09-03:
What is the size of the bag before you fix it?
Comment by Lucas02 on 2018-09-03:
.bag.active file is 528,4 kB and .bag file after reindex and fix is 4,1 kB.

A:

There probably is no actual data in the bag file. I was able to reproduce the problem by terminating the bag in a "not polite way" before the bag had reached the "chunksize". (768kB according to the wiki).
From the wiki:
--chunksize=SIZE
Advanced. Record to chunks of SIZE KB (Default: 768). This is a buffer within the bag file object. Lowering this value will result in more writes to disk.

So I guess anything still in the buffer when the process dies unexpectedly is lost. If you need to work with such small amounts of data and the application is prone to cause recording to crash then you could lower the chunksize.

Originally posted by Reamees with karma: 591 on 2018-09-03
This answer was ACCEPTED on the original site
Post score: 1

Original comments
Comment by Lucas02 on 2018-09-03:
Ah okay, will try this if it works.
Comment by Reamees on 2018-09-03:
Try it and if it helps you sometimes recover some data then great. In the end it would be best to minimize the need to fix your bags afterward, shutting down the recording of the bag gently, e.g pressing ctrl+c.
Comment by Lucas02 on 2018-09-04:
I can confirm that this works beautifully. Thank you!
Comment by Reamees on 2018-09-04:
Good! Thanks for accepting the answer! It would also be good to keep in mind that reducing the chunksize has some implications. If you start getting more data at some point it might be too much overhead and might cause problems.

