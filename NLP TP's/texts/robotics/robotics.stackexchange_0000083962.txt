Q:

knowrob tutotial - TCP handshake error

I'm just trying the http://www.knowrob.org/doc/knowrob_basics tutorial.
The prolog inference tasks work good, but I have problem with the visualization of the objects.
At just the end of the visualization tutorial, I find problems with the connection of the visualization server to the rosbridge websocket server.
I have tried running both ROS Indigo and Kinetic on a Ubuntu 16.04 64 bit box, I am trying to understand how the MD5 message is being calculated on the publisher side (visualization server).
Could anyone help me understand where the "90da67007c26525f655c1c269094e39f" in the error log below comes from?
?- owl_individual_of(A,knowrob:'SemanticEnvironmentMap'),marker_update(object(A)).
Nov 18, 2017 4:31:34 PM org.ros.internal.node.client.Registrar <init>
INFO: MasterXmlRpcEndpoint URI: http://localhost:11311
Nov 18, 2017 4:31:34 PM org.ros.internal.node.client.Registrar onPublisherAdded
INFO: Registering publisher: Publisher<PublisherDefinition<PublisherIdentifier<NodeIdentifier</knowrob_marker, http://127.0.0.1:43602/>, TopicIdentifier</rosout>>, Topic<TopicIdentifier</rosout>, TopicDescription<rosgraph_msgs/Log, acffd30cd6b6de30f120938c17c593fb>>>>
Nov 18, 2017 4:31:34 PM org.ros.internal.node.client.Registrar callMaster
INFO: Response<Success, Registered [/knowrob_marker] as publisher of [/rosout], [http://luca-Dell-XPS420:33258/]>
Nov 18, 2017 4:31:34 PM org.ros.internal.node.topic.DefaultPublisher onMasterRegistrationSuccess
INFO: Publisher registered: Publisher<PublisherDefinition<PublisherIdentifier<NodeIdentifier</knowrob_marker, http://127.0.0.1:43602/>, TopicIdentifier</rosout>>, Topic<TopicIdentifier</rosout>, TopicDescription<rosgraph_msgs/Log, acffd30cd6b6de30f120938c17c593fb>>>>
Nov 18, 2017 4:31:34 PM org.ros.internal.node.client.Registrar onPublisherAdded
INFO: Registering publisher: Publisher<PublisherDefinition<PublisherIdentifier<NodeIdentifier</knowrob_marker, http://127.0.0.1:43602/>, TopicIdentifier</visualization_marker_array>>, Topic<TopicIdentifier</visualization_marker_array>, TopicDescription<visualization_msgs/MarkerArray, 90da67007c26525f655c1c269094e39f>>>>
Nov 18, 2017 4:31:34 PM org.ros.internal.node.client.Registrar callMaster
INFO: Response<Success, Registered [/knowrob_marker] as publisher of [/visualization_marker_array], []>
Nov 18, 2017 4:31:34 PM org.ros.internal.node.topic.DefaultPublisher onMasterRegistrationSuccess
INFO: Publisher registered: Publisher<PublisherDefinition<PublisherIdentifier<NodeIdentifier</knowrob_marker, http://127.0.0.1:43602/>, TopicIdentifier</visualization_marker_array>>, Topic<TopicIdentifier</visualization_marker_array>, TopicDescription<visualization_msgs/MarkerArray, 90da67007c26525f655c1c269094e39f>>>>
A = 'http://knowrob.org/kb/ias_semantic_map.owl#SemanticEnvironmentMap0' Nov 18, 2017 4:31:47 PM org.jboss.netty.channel.DefaultChannelPipeline
WARNING: An exception was thrown by a user handler while handling an exception event ([id: 0x4a49ce13, /127.0.0.1:44580 :> /127.0.0.1:38768] EXCEPTION: java.lang.IllegalStateException: Unexpected message MD5 d155b9ce5188fbaf89745847fd5882d7 != 90da67007c26525f655c1c269094e39f)
org.ros.exception.RosRuntimeException: java.lang.IllegalStateException: Unexpected message MD5 d155b9ce5188fbaf89745847fd5882d7 != 90da67007c26525f655c1c269094e39f
    at org.ros.internal.transport.ConnectionTrackingHandler.exceptionCaught(ConnectionTrackingHandler.java:81)
    at org.jboss.netty.channel.Channels.fireExceptionCaught(Channels.java:533)
    at org.jboss.netty.channel.AbstractChannelSink.exceptionCaught(AbstractChannelSink.java:49)
    at org.jboss.netty.channel.Channels.fireMessageReceived(Channels.java:296)
    at org.jboss.netty.handler.codec.frame.FrameDecoder.unfoldAndFireMessageReceived(FrameDecoder.java:458)
    at org.jboss.netty.handler.codec.frame.FrameDecoder.callDecode(FrameDecoder.java:439)
    at org.jboss.netty.handler.codec.frame.FrameDecoder.messageReceived(FrameDecoder.java:311)
    at org.jboss.netty.channel.Channels.fireMessageReceived(Channels.java:268)
    at org.jboss.netty.channel.Channels.fireMessageReceived(Channels.java:255)
    at org.jboss.netty.channel.socket.nio.NioWorker.read(NioWorker.java:91)
    at org.jboss.netty.channel.socket.nio.AbstractNioWorker.processSelectedKeys(AbstractNioWorker.java:373)
    at org.jboss.netty.channel.socket.nio.AbstractNioWorker.run(AbstractNioWorker.java:247)
    at org.jboss.netty.channel.socket.nio.NioWorker.run(NioWorker.java:35)
    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
    at java.lang.Thread.run(Thread.java:748)
Caused by: java.lang.IllegalStateException: Unexpected message MD5 d155b9ce5188fbaf89745847fd5882d7 != 90da67007c26525f655c1c269094e39f
    at com.google.common.base.Preconditions.checkState(Preconditions.java:149)
    at org.ros.internal.node.topic.DefaultPublisher.finishHandshake(DefaultPublisher.java:177)
    at org.ros.internal.transport.tcp.TcpServerHandshakeHandler.handleSubscriberHandshake(TcpServerHandshakeHandler.java:97)
    at org.ros.internal.transport.tcp.TcpServerHandshakeHandler.messageReceived(TcpServerHandshakeHandler.java:67)
    ... 13 more

Originally posted by lbertoz on ROS Answers with karma: 16 on 2017-11-18
Post score: 0

Original comments
Comment by gvdhoorn on 2017-11-19:
Most likely the java artefacts are using older/different msg definitions than your other ROS nodes. That will lead to MD5 mismatches.

A:

Solved.
added updated visualization_msgs artifacts in
/knowrob/knowrob_vis/knowrob_vis/build.gradle:
...
compile 'org.ros.rosjava_messages:visualization_msgs:1.12.+'
...

Originally posted by lbertoz with karma: 16 on 2017-11-19
This answer was ACCEPTED on the original site
Post score: 0

