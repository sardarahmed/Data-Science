Q:

ros navigation navfn make plan after re-set the initialpose of AMCL

Hi all,
I have an observation when I re-set the initialpose of amcl by publishing to the initialpose topic and then sent goal to the navigation stack. The plan made by the navfn was still starting from the old pose of the robot rather than the new one that I just set. The navfn got the robot pose by looking up the transform published by amcl. Is this because the amcl need to take some time to publish the new transform after re-setting initialpose and navfn doesn't get the new robot pose immediately?
Please correct me if I am wrong and appreciate any solution on this. Thanks all.

Originally posted by dalishi on ROS Answers with karma: 89 on 2014-06-09
Post score: 0

A:

From what I understand, the global planner doesn't re-plan unless the local planner fails to execute the current plan, so unless your pose update is large or makes it difficult for the local planner to run, I wouldn't expect navfn to re-plan. That said, if the correction to the pose is small, the local planner can probably handle it without needing to re-plan anyway.
As a side note, sending initial pose messages to AMCL frequently is probably a bad idea, because it will lose any confidence present in the particle filter, and is potentially quite expensive.
On the other hand, if you're only re-localizing infrequently (perhaps when the robot is docked?), then you may just need to wait for AMCL to finish updating its internal state before you publish a goal. Listening on the current_pose topic might be a useful way to get a callback when AMCL is done.

Originally posted by ahendrix with karma: 47576 on 2014-06-10
This answer was ACCEPTED on the original site
Post score: 1

Original comments
Comment by dalishi on 2014-06-11:
Hi ahemdrix, thanks for the detailed explanation. I dont re-initialize the robot frequently and only do it when the robot got stuck as you mentioned. Now after I re-initialize I just sleep for 1 sec to wait for amcl and it worked. I will try the current_pose topic as you suggested.

