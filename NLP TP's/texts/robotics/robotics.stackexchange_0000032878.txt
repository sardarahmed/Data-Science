Q:

Problem installing openni_camera (pcl) and openni_tracker (kdl) on Archlinux

$ uname -a
Linux samurai 2.6.39-ARCH #1 SMP PREEMPT Mon Jun 27 21:26:22 CEST 2011 x86_64 Intel(R) Core(TM)2 Quad CPU Q6600 @ 2.40GHz GenuineIntel GNU/Linux

$ gcc -v
Using built-in specs.
COLLECT_GCC=gcc
COLLECT_LTO_WRAPPER=/usr/lib/gcc/x86_64-unknown-linux-gnu/4.6.1/lto-wrapper
Target: x86_64-unknown-linux-gnu
Configured with: /build/src/gcc-4.6.1/configure --prefix=/usr --libdir=/usr/lib --libexecdir=/usr/lib --mandir=/usr/share/man --infodir=/usr/share/info --with-bugurl=https://bugs.archlinux.org/ --enable-languages=c,c++,ada,fortran,go,lto,objc,obj-c++ --enable-shared --enable-threads=posix --with-system-zlib --enable-__cxa_atexit --disable-libunwind-exceptions --enable-clocale=gnu --enable-gnu-unique-object --enable-linker-build-id --with-ppl --enable-cloog-backend=isl --enable-lto --enable-gold --enable-ld=default --enable-plugin --with-plugin-ld=ld.gold --disable-multilib --disable-libstdcxx-pch --enable-checking=release
Thread model: posix
gcc version 4.6.1 (GCC)

$ rosmake openni_camera

[ rosmake ] Last 40 linesl: 77.9 sec ]                                                    [ 1 Active 49/52 Complete ]
{-------------------------------------------------------------------------------
                   from /usr/local/opt/ros/perception_pcl/pcl/include/pcl/point_types.h:40,
                   from /usr/local/opt/ros/perception_pcl/pcl/src/pcl/sample_consensus/sac_model_circle.cpp:39:
  /usr/local/opt/ros/geometry/eigen/include/Eigen/src/Core/products/Parallelizer.h: In function ‘void Eigen::internal::manage_multi_threading(Eigen::Action, int*)’:
  /usr/local/opt/ros/geometry/eigen/include/Eigen/src/Core/products/Parallelizer.h:33:14: warning: variable ‘m_maxThreads’ set but not used [-Wunused-but-set-variable]
  In file included from /usr/local/opt/ros/geometry/eigen/include/Eigen/Core:328:0,
                   from /usr/local/opt/ros/geometry/eigen/include/Eigen/StdVector:29,
                   from /usr/local/opt/ros/perception_pcl/pcl/include/pcl/pcl_base.h:41,
                   from /usr/local/opt/ros/perception_pcl/pcl/include/pcl/sample_consensus/sac_model.h:45,
                   from /usr/local/opt/ros/perception_pcl/pcl/include/pcl/sample_consensus/sac_model_cylinder.h:41,
                   from /usr/local/opt/ros/perception_pcl/pcl/src/pcl/sample_consensus/sac_model_cylinder.cpp:38:
  /usr/local/opt/ros/geometry/eigen/include/Eigen/src/Core/products/Parallelizer.h: In function ‘void Eigen::internal::manage_multi_threading(Eigen::Action, int*)’:
  /usr/local/opt/ros/geometry/eigen/include/Eigen/src/Core/products/Parallelizer.h:33:14: warning: variable ‘m_maxThreads’ set but not used [-Wunused-but-set-variable]
  In file included from /usr/local/opt/ros/geometry/eigen/include/Eigen/src/StlSupport/StdVector.h:29:0,
                   from /usr/local/opt/ros/geometry/eigen/include/Eigen/StdVector:38,
                   from /usr/local/opt/ros/perception_pcl/pcl/include/pcl/pcl_base.h:41,
                   from /usr/local/opt/ros/perception_pcl/pcl/include/pcl/sample_consensus/sac_model.h:45,
                   from /usr/local/opt/ros/perception_pcl/pcl/include/pcl/sample_consensus/sac_model_cylinder.h:41,
                   from /usr/local/opt/ros/perception_pcl/pcl/src/pcl/sample_consensus/sac_model_cylinder.cpp:38:
  /usr/local/opt/ros/geometry/eigen/include/Eigen/src/StlSupport/details.h: At global scope:
  **/usr/local/opt/ros/geometry/eigen/include/Eigen/src/StlSupport/details.h:41:13: error: ‘ptrdiff_t’ does not name a type**
  [ 30%] Building CXX object CMakeFiles/pcl_sample_consensus.dir/src/pcl/sample_consensus/sac_model_normal_parallel_plane.o
  In file included from /usr/local/opt/ros/geometry/eigen/include/Eigen/Core:328:0,
                   from /usr/local/opt/ros/perception_pcl/pcl/include/pcl/point_types.h:40,
                   from /usr/local/opt/ros/perception_pcl/pcl/src/pcl/sample_consensus/sac_model_normal_parallel_plane.cpp:38:
  /usr/local/opt/ros/geometry/eigen/include/Eigen/src/Core/products/Parallelizer.h: In function ‘void Eigen::internal::manage_multi_threading(Eigen::Action, int*)’:
  /usr/local/opt/ros/geometry/eigen/include/Eigen/src/Core/products/Parallelizer.h:33:14: warning: variable ‘m_maxThreads’ set but not used [-Wunused-but-set-variable]
  [ 31%] Building CXX object CMakeFiles/pcl_sample_consensus.dir/src/pcl/sample_consensus/sac_model_normal_plane.o
  make[3]: *** [CMakeFiles/pcl_sample_consensus.dir/src/pcl/sample_consensus/sac_model_cylinder.o] Error 1
  make[3]: *** Waiting for unfinished jobs....
  In file included from /usr/local/opt/ros/geometry/eigen/include/Eigen/Core:328:0,
                   from /usr/local/opt/ros/perception_pcl/pcl/include/pcl/point_types.h:40,
                   from /usr/local/opt/ros/perception_pcl/pcl/src/pcl/sample_consensus/sac_model_normal_plane.cpp:38:
  /usr/local/opt/ros/geometry/eigen/include/Eigen/src/Core/products/Parallelizer.h: In function ‘void Eigen::internal::manage_multi_threading(Eigen::Action, int*)’:
  /usr/local/opt/ros/geometry/eigen/include/Eigen/src/Core/products/Parallelizer.h:33:14: warning: variable ‘m_maxThreads’ set but not used [-Wunused-but-set-variable]
  make[3]: Leaving directory `/usr/local/opt/ros/perception_pcl/pcl/build'
  make[2]: *** [CMakeFiles/pcl_sample_consensus.dir/all] Error 2
  make[2]: Leaving directory `/usr/local/opt/ros/perception_pcl/pcl/build'
  make[1]: *** [all] Error 2
  make[1]: Leaving directory `/usr/local/opt/ros/perception_pcl/pcl/build'
-------------------------------------------------------------------------------}
[ rosmake ] Output from build of package pcl written to:
[ rosmake ]    /home/katana/.ros/rosmake/rosmake_output-20110709-211534/pcl/build_output.log
[rosmake-1] Finished <<< pcl [FAIL] [ 77.99 seconds ]                                                                
[ rosmake ] Halting due to failure in package pcl.

$ rosmake openni_tracker

[ rosmake ] All 19 linesopic_tools: 0.6 sec ] [ kdl: 0.6 sec ] [ bullet: 0.6 sec ] [ m... [ 4 Active 26/40 Complete ]
{-------------------------------------------------------------------------------
  Makefile:61: warning: overriding recipe for target `clean'
  /usr/local/opt/ros/ros/core/mk/cmake.mk:24: warning: ignoring old recipe for target `clean'
  cd build/kdl-tar && patch -p0 < ../../total.patch
  patching file src/bindings/python/CMakeLists.txt
  Reversed (or previously applied) patch detected!  Assume -R? [n] 
  Apply anyway? [n] 
  Skipping patch.
  1 out of 1 hunk ignored -- saving rejects to file src/bindings/python/CMakeLists.txt.rej
  patching file src/tree.cpp
  Reversed (or previously applied) patch detected!  Assume -R? [n] 
  Apply anyway? [n] 
  Skipping patch.
  1 out of 1 hunk ignored -- saving rejects to file src/tree.cpp.rej
  patching file tests/kinfamtest.cpp
  Reversed (or previously applied) patch detected!  Assume -R? [n] 
  Apply anyway? [n] 
  Skipping patch.
  1 out of 1 hunk ignored -- saving rejects to file tests/kinfamtest.cpp.rej
-------------------------------------------------------------------------------}
[ rosmake ] Output from build of package kdl written to:
[ rosmake ]    /home/katana/.ros/rosmake/rosmake_output-20110709-213856/kdl/build_output.log
[rosmake-3] Finished <<< kdl [FAIL] [ 0.64 seconds ]                                                                 
[ rosmake ] Halting due to failure in package kdl.

Originally posted by DavidS on ROS Answers with karma: 66 on 2011-07-09
Post score: 0

A:

Regarding one of the compilation errors above:
pcl compilation error
Patch and ticket submitted to https://code.ros.org/trac/ros-pkg/ticket/5054
pcl_ros also had problems with gcc 4.6.
In the end, I had to specify the compiler as gcc-4.5 and g++-4.5, by adding
set (CMAKE_C_COMPILER gcc-4.5)
set (CMAKE_CXX_COMPILER g++4.5)

after the rosbuild directives in CMakeLists.txt for pcl_ros.
As for kdl, the patches are already applied, but the Makefile is trying to apply the patch again. The fix is to remove the patching line in the Makefile of the kdl package.

Originally posted by DavidS with karma: 66 on 2011-07-10
This answer was ACCEPTED on the original site
Post score: 0

