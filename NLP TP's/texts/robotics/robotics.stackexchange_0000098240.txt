Q:

[ROS2] Communication across multiple local users

Is there a way of communicating between 2 ROS2 processes/nodes on the same machine but being run as 2 different users?
My specific use case is one process/node run as root (for interfacing with a piece of hardware) and one as a regular user.
However, the two nodes cannot seem to communicate with each other or even 'see' each other, as in: the node nor its topics are not visible via ros2 node list/ros2 topic list.
I've narrowed it down to two nodes running as different users on the same machine - I've spun up a fresh Ubuntu 20.04 Server VM (linux 5.4.0, x86_64), installed ROS2 Foxy, added 2 users and confirmed that ros2 run demo_nodes_cpp talker does not communicate with ros2 run demo_nodes_cpp listener (across different users - running as one user works as expected).
The same test on a Ubuntu 18.04 & ROS2 Eloquent box works as expected, ie the listener receives messages from the talker...
What's peculiar, the /rosout topic on one user shows the logs printed by the node run as the other one (or at least some, I wasn't able to replicate this with the demo/example nodes - perhaps due to log severity being too low).
I've verified that the multicast test (ros2 multicast send/receive) between the users passes successfully.

Originally posted by mjbogusz on ROS Answers with karma: 25 on 2021-02-08
Post score: 2

Original comments
Comment by Carsten on 2021-02-10:
I don't have a solution but can confirm the problem. But first investigation shows, that the behaviour depends on the existence of a network connection. Without any connected network topics can be seen.

A:

Changing the DDS to e.g. Cyclone solved the issue for me

Originally posted by Carsten with karma: 36 on 2021-02-10
This answer was ACCEPTED on the original site
Post score: 2

Original comments
Comment by gvdhoorn on 2021-02-10:
That seems more like a work-around?
Have you reported this on the Fast-DDS / Fast-RTPS issue tracker?
Comment by Carsten on 2021-02-10:
yes, issue was reported here.
Comment by phillipov on 2021-02-10:
In the next ROS2 release, Cyclone will be the default RMW for reasons like these. https://index.ros.org/doc/ros2/Releases/Release-Galactic-Geochelone/#default-rmw-vendor-changed-to-cyclone-dds
Comment by Carsten on 2021-02-12:
As posted here the behaviour results from shared memory usage on local machine that is limited by user permissions. As stated in the link above local communication is possible by using UDP communication also on the local machine.
Comment by mjbogusz on 2021-02-16:
I've chosen this answer as the solution as, IMO, it's the least workaround-ish one we have at this time and because this will be the default from Galactic onward.
The other answer, while being a workaround (and potentially having a performance penalty), deserves upvotes too as it presents the real reason behind the problem.
For me, however, the best workaround will probably be to just run the processes as the same user...

