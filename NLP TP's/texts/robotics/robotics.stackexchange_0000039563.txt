Q:

Add ps3joy_node.py to upstart

Hey,
I was trying to get the ps3joy_node.py node to automatically run when my pandaboard boots, but I'm having some problems. I made a launch script that launches ps3joy_node.py and joy_node, but this needs to be run in sudo for the ps3 controller connection. I would normally run this by doing sudo bash and then roslaunch it.
The upstart script does not recognize roslaunch though, I assume it's for the same reason why "sudo roslaunch xxx" won't work.
I noticed Turtlebot also uses upstart scripts, actually it's where I got the idea from, but they avoid this issue by directly running the (old) ps3joy.py script outside ROS.
I plan to use the extra set_feedback and diagnostics features of ps3joy_node.py, so I prefer using that one. That requires ROS though, and I can't get ROS + root rights + upstart to work together.
Any help is appreciated, thanks.

Originally posted by Hansg91 on ROS Answers with karma: 1909 on 2012-04-15
Post score: 0

A:

TurtleBot also runs roslaunch from an upstart script using setuidgid. Check out turtlebot-start here. The one caveat with setuidgid is that it doesn't pass in the user's groups, so any devices which the user should be able to use need to either be owned by that user or have the appropriate global permissions.

Originally posted by Ryan with karma: 3248 on 2012-04-15
This answer was ACCEPTED on the original site
Post score: 0

Original comments
Comment by Hansg91 on 2012-04-15:
Yes I noticed the setuidgid, but that removes root rights from the command, making it run under the turtlebot user, in the turtlebot case. Are you saying it would be best to alter the ps3joy script so it is allowed to be run in non-root, and modify permissions for the bluetooth device?
Comment by Ryan on 2012-04-15:
If you want to use roslaunch, that's probably the best way to do it. We do it that way with most of our robots.
Comment by Hansg91 on 2012-04-15:
I tried doing that, but I ran into another problem. The ps3joy_node.py script tries to open a bluetooth socket (port 17 and 19) and according to various websites, root privileges are a must for socket binding with ports < 1024, so that can't be done either I guess. Ideas ?
Comment by Ryan on 2012-04-15:
Not sure, but that might be the reason why the setuidgid method wasn't used on ps3joy as well. @mwise_wg would know better.

