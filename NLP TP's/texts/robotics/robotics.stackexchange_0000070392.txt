Q:

Show all message types which contain a given msg

Is there a way to use rosmsg to query for all messages that contain another msg type?
For instance, I'd like to see all message types which contain a sensor_msgs/Image.  (querying services the same thing would also be useful)
Doing a rosmsg show on every message output by rosmsg and grepping it for the type is super slow, probably 10 minutes or more for all the messages.

Originally posted by lucasw on ROS Answers with karma: 8729 on 2015-11-14
Post score: 0

Original comments
Comment by NEngelhard on 2015-11-15:
I've never heard of a function/script for that, but the code for the auto completion for 'rosmsg show' should be able to create a list of msg definitions in which you could just grep. Sounds like a fun python finger exercise.
Comment by jeremya on 2015-11-15:
Are you looking for "all" published topics that contain that message type? Or are you looking for messages that contain another message type (the message hierarchy)?
Comment by lucasw on 2015-11-16:
@jeremya messages types, I updated the question to reflect that.

A:

This can be a good start:
 grep -R --include \*.msg --include \*.srv "sensor_msgs/Image" $(echo $ROS_PACKAGE_PATH | sed 's/:/ /g')

Maybe a recursive call to grep is necessary, so you could find message types that use Image indirectly. But in my case this can be done manually, because I get just one result (and 2 comments):
/opt/ros/indigo/share/polled_camera/srv/GetPolledImage.srv:                      # against incoming sensor_msgs/Image header.
/opt/ros/indigo/share/stereo_msgs/msg/DisparityImage.msg:sensor_msgs/Image image
/opt/ros/indigo/share/theora_image_transport/msg/Packet.msg:Header header     # Original sensor_msgs/Image header

To exclude the comments:
 grep -R --include \*.msg --include \*.srv "^sensor_msgs/Image" $(echo $ROS_PACKAGE_PATH | sed 's/:/ /g')

Originally posted by MichaelKorn with karma: 1480 on 2015-11-17
This answer was ACCEPTED on the original site
Post score: 1

Original comments
Comment by lucasw on 2015-11-21:
Cool!  I've edited your answer to search the entire ROS_PACKAGE_PATH

