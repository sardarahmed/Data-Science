Q:

how to publish map in ros2 galactic?

Hi
I installed ros galactic on ubuntu 20.04 using this bash script (https://github.com/turtlebot/TurtleBot4Lessons/tree/main/installation), then I ran turtlebot4 simulation in depot and map its surrounding. I saved the map with
**
ros2 service call /slam_toolbox/save_map slam_toolbox/srv/SaveMap "name:
  data: 'map_name'

**
then when I want to publish the map, and use
ros2 run nav2_map_server map_server $PWD/map_name.yaml

I get stuck with the following log
[INFO] [1662497993.651852411] [map_server]: 
    map_server lifecycle node launched. 
    Waiting on external lifecycle transitions to activate
    See https://design.ros2.org/articles/node_lifecycle.html for more information.
[INFO] [1662497993.651943245] [map_server]: Creating

here is the available service list:
ros2 service list
/map_server/change_state
/map_server/describe_parameters
/map_server/get_available_states
/map_server/get_available_transitions
/map_server/get_parameter_types
/map_server/get_parameters
/map_server/get_state
/map_server/get_transition_graph
/map_server/list_parameters
/map_server/set_parameters
/map_server/set_parameters_atomically

and here is the result of node list
ros2 node list
/map_server

Am I doing something wrong? should I add any other node to this?

Originally posted by dastan_forum on ROS Answers with karma: 19 on 2022-09-06
Post score: 0

A:

first create a map_server_params.yaml file to set the ros parameters,
map_server:
    ros__parameters:
    frame_id: map   
    topic_name: map
    use_sim_time: false
    yaml_filename: "/home/dastan/map.yaml"

then run the map_server node with passing the .yaml file as the input,
ros2 run nav2_map_server map_server --ros-args --params-file map_server_params.yaml

then since all nodes in nav2 are lifecycle nodes, you need to transition them into active mode,
ros2 lifecycle set /map_server configure
ros2 lifecycle set /map_server activate

then the subscriber to the /map topic should have the QoS of local_transient in order to recieve the map data.

Originally posted by dastan_forum with karma: 19 on 2022-09-10
This answer was ACCEPTED on the original site
Post score: 2

Original comments
Comment by ljaniec on 2022-09-11:
Good work! It was a bit more than I thought, you should self-accept this answer to your question
Comment by dastan_forum on 2022-09-12:
Thanks @ljaniec

