Q:

How to implement avoid obstacle with open_planner in Autoware?

Hi, I used Autoware 1.12.0 in Ubuntu 16.04
I want to avoid obstacle with open planner.
Now, I used these below nodes.

lidar_euclidean_cluster_detect
lidar_kf_contour_track
op_global_planner
op_common_params
op_trajectory_generator
op_trajectory_evaluator
op_behavior_selector
pure_pursuit
twist_filter

I have vector_map, /current_pose, /points_raw already. That's why I didn't use the ndt_matching node.
How to avoid obstacle with those nodes?
This is rviz of current situation. There's no 'red' path..

please answer on this question.
Thank you!

Originally posted by cwhong on ROS Answers with karma: 58 on 2020-11-11
Post score: 0

Original comments
Comment by Josh Whitley on 2020-12-03:
@hatem Would you be able to answer this question?
Comment by Hatem on 2020-12-06:
sure, thanks.
Comment by Josh Whitley on 2020-12-07:
Thank you!
Comment by wangludong on 2021-01-11:
@cwhong
Hello.
I enabled the same nodes as you mentioned, but I can't see the bunch of green lines before the car.
Could you tell me how to turn them on?
Thank you.
Comment by cwhong on 2021-01-11:
So what do you see in rviz now? Can you see everything except the green line?
ex) vectormap_center_lines etc.
Comment by wangludong on 2021-01-11:
@cwhong
Please check the image.
https://ibb.co/SwpfYrq
I placed an obstacle before my car and wanted to overtake it, but my car just stopped then.I think these green lines(maybe called roll out trajectory) are big deal.
Comment by cwhong on 2021-01-11:
I think that green line doesn't appear seems to be the 'local planner' not working properly.
Please check below nodes.
op_common_params,
op_trajectory_generator,
op_trajectory_evaluator,
op_behavior_selector.
In op_common_params(config), please check 'roll_out_num'. I set that 8.
Comment by Mohsen.ciw on 2021-01-11:
@wangludong
after checking your setting for rollout num, check your op_trajectory_generator node. after that check the rviz and turn off and on the rollout feature once. sometimes it can be the issue.
Comment by wangludong on 2021-01-11:
@cwhong @Mohsen.ciw
Thank you all of you.
I have turned these trajectories on now.
In my case, I associated autoware with carla and spawned a car in carla as an obstacle.
But it seemed my ego car can't detect it.
As you can see from the image below, all trajectories are green, and the obstacle is in purple color.
https://ibb.co/PZ3T8jB
Do you know how to place an obstacle in RViz directly.
Once I clicked the "Publish Point" button, RViz crashed unexpectedly.
Comment by cwhong on 2021-01-11:
I run the 'lidar_euclidean_cluster_detect' node in autoware to mark the obstacle in rviz and to let the car recognize it. And when I matched the 'tf' of that node to 'map', my ego car detect the obstacle.
Comment by Mohsen.ciw on 2021-01-12:
@wangludong
I had the same problem for publishing a point in RViz by using that but. I suggest using a python code for publishing a position you can find a sample easily by googling.
@cwhong I also did the same, I set the output frame of "lidar_euclidean_cluster_detect" to "map" but no obstacle was detected by my local trajectory generator. do you know which node the open planner listens to for detecting the object? I also turn on "lidar_kf_contour_track_object" but the topic "tracked_object" that is publishing by this node is empty! I am using autoware.ai 1.14. do you have any idea?
Comment by cwhong on 2021-01-12:
@Mohsen.ciw Is it correct that the obstacle you are using was detected by the LiDAR?
If yes, try running 'ray_ground_filter' in the sensing tab.
Then use 'rostopic echo' to print /points_no_ground.
Please print the topic to rviz as well and let me know if no obstacles are detected there.
Comment by Mohsen.ciw on 2021-01-13:
@cwhong thank you very much, so let's create a new post here to put pictures and explain what's going in my case.

A:

Hello,
1- Not using ndt_matching could be the problem. you need TF to be published, that one is published from ndt_matching node.
2- I want to make sure, you don't want to do obstacle avoidance on rosbag log data. this should be live, with control feedback.
3- if you can record a video of your steps and share that one with me I could be able to find what went wrong.
Regards,

Originally posted by Hatem with karma: 443 on 2020-12-06
This answer was ACCEPTED on the original site
Post score: 1

Original comments
Comment by cwhong on 2020-12-08:
Hi, thank you so much for answering this question.
I solved this problem because of "TF".
In 'lidar_euclidean_cluster_detect', output_frame was 'velodyne'.
So, I changed that to 'map'.
It was my problem..
I think it's the first thing you've answered.
Thank you very much.
Comment by Hatem on 2020-12-08:
That's great,
Can you mark the question as answered ?
Comment by cwhong on 2020-12-15:
Sure! Thank you. :)

