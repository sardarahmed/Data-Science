Q:

Error when building package of calibration_publisher while installing Autoware

In autoware 1.12.0, I build the packages as the tutorial from source, and  I came across the errors by calibration_publisher as follows:
--- stderr: calibration_publisher                                                                                                
CMakeFiles/calibration_publisher.dir/src/calibration_publisher.cpp.o: In function `main':
calibration_publisher.cpp:(.text.startup+0x9b4): undefined reference to `cv::read(cv::FileNode const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&)'
collect2: error: ld returned 1 exit status
make[2]: *** [devel/lib/calibration_publisher/calibration_publisher] Error 1
make[1]: *** [CMakeFiles/calibration_publisher.dir/all] Error 2
make: *** [all] Error 2
Failed   <<< calibration_publisher  [ Exited with code 2 ]
Aborted  <<< ds4                                                                                                                              
Aborted  <<< detected_objects_visualizer                                                                                                  
Aborted  <<< decision_maker_panel    

I have tried many times to fix it, but not work

Originally posted by park on ROS Answers with karma: 21 on 2019-08-31
Post score: 0

Original comments
Comment by park on 2019-09-01:
I add an empty file named "COLCON_IGNORE" in the package of calibration_publisher to avoid the bug, and finally build successfully
Ignore calibration_publisher, the demo test will fail.
Comment by amc-nu on 2019-09-02:
Can you please provide information about your system? ROS version? Did you install OpenCV from source? (if so what version?).
Comment by park on 2019-09-02:
Sorry, I didn't provide enough information
Hardware Platform: Jetson AGX Xavier
OS: Ubuntu 18.04, installed by the SDK Manager
ROS: melodic,   installed from sources by using  installROSXavier script
OpenCV: version is 3.4.3, installed from sources by using  buildOpenCVXavier script in the path /usr/local, and during install ROS, 3.2.0 is also installed in the path /usr
I also notice that the error also existed in opencv's answers camera_calibration.cpp: undefined reference to cv::read
Comment by amc-nu on 2019-09-02:
I haven’t used the Jetson Hacks’ script you mentioned. I would recommend you to try a clean install. Don’t forget to run rosdep to install the opencv version to which ros’ cv_bridge was linked.( please also have in mind that Nvidia provides its own versions of OpenCV. In the case you selected that when you set up your AGX).
Comment by park on 2019-09-02:
Yes, I have tried the version of OpenCV provided by Nvidia, but it also failed. Next step, I will try to build autoware 1.12.0 on a x86_64 platform for test
Comment by park on 2019-09-02:
The error is caused by the codes in calibration_publisher.cpp;
fs["CameraExtrinsicMat"] >> CameraExtrinsicMat;
fs["CameraMat"] >> CameraMat;
fs["DistCoeff"] >> DistCoeff;
fs["ImageSize"] >> ImageSize;
fs["DistModel"] >> DistModel;

Comment by amc-nu on 2019-09-02:
Please use apt versions of OpenCV. The easiest way is to use rosdep to install the correct ones.
Comment by park on 2019-09-02:
Yes I have also tried and it doesn't seem to be a problem of the OpenCV installation.
Now, I comment the following line:
fs["DistModel"] >> DistModel;

and passed the build,  very strange.

A:

This error occurs when the opencv library cannot be loaded. Please refer to the address below
https://github.com/Autoware-AI/autoware.ai/pull/2090/commits/63abbb1c4d26be67ea0312b04b6dd9918cef3978

Originally posted by jdj with karma: 56 on 2020-11-02
This answer was ACCEPTED on the original site
Post score: 2

Original comments
Comment by heylypp on 2020-11-11:
Awesome! It works.
Comment by warriorUSP on 2021-08-12:
Great, this works for me too.
Basically adding opencv libraries path in CMakeLists.txt and package.xml fixed my issue.

