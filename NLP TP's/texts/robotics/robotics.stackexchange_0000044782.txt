Q:

gmapping with odom from laser_scan_matcher

Hi,
i tried to use laser_scan_matcher to simulate a odometry. I used the pose2d and the iri_msg_to_odom to create this. It seems to work. Now i want gmapping to subscribe this odometry and i used static_transform_publisher for odom -> base_link and base_link -> laser. But now gmapping told me this:

*************RESAMPLE***************
Deleting Nodes: 0 1 2 3 4 5 6 8 9 10 11 12 14 15 16 17 18 19 20 21 22 23 24 26 27 28 29 31 32 33 35 36 37 38 39 40 41 43 44 45 46 47 49 Done
Deleting old particles...Done
Copying Particles and  Registering  scans... Done
update frame 1743
update ld=2 ad=0
Laser Pose= 1 0 0
m_count 4
Scan Matching Failed, using odometry. Likelihood=-1793.34
lp:-1 0 0
op:1 0 0
Scan Matching Failed, using odometry. Likelihood=-1806.67
lp:-1 0 0
op:1 0 0
Scan Matching Failed, using odometry. Likelihood=-1586.92
lp:-1 0 0
op:1 0 0
Average Scan Matching Score=41.0745
neff= 26.2824
Registering Scans:Done
update frame 2180
update ld=2 ad=0
Laser Pose= -1 0 0
m_count 5
Scan Matching Failed, using odometry. Likelihood=-1600.2
lp:1 0 0
op:-1 0 0
Average Scan Matching Score=51.2145
neff= 1.01368
*************RESAMPLE***************
Deleting Nodes: 0 1 2 3 4 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 Done
Deleting old particles...Done
Copying Particles and  Registering  scans... Done
update frame 2184
update ld=2 ad=0
Laser Pose= 1 0 0
m_count 6
Average Scan Matching Score=83.3891
neff= 2.09414
*************RESAMPLE***************
Deleting Nodes: 0 1 2 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 31 32 33 34 36 37 38 40 41 42 43 44 45 46 47 48 49 Done
Deleting old particles...Done
Copying Particles and  Registering  scans... Done
[ERROR] [1349870939.297038752]: Transform from base_link to odom failed

if i change tf_publisher to base_link -> odom it seems to work but sometimes every few seconds or so the error comes again. And the map doesn't really looks fine in rviz.
Whats wrong? :)

Originally posted by darkchris90 on ROS Answers with karma: 1 on 2012-10-10
Post score: 0

Original comments
Comment by Ben_S on 2012-10-10:
Are you really using a static_transform_publisher for odom -> base_link? This should be a dynamic transform, published by your laser_scan_matcher. Its not that important, if this odometry is a bit poor, but it should be continuos during the entire run (e.g. no big jumps).
Comment by darkchris90 on 2012-10-10:
how stupid :( Of course.... Thx

A:

You cannot use a static_transform_publisher for the transform odom -> base_link. This transform must be generated by laser_scan_matcher. Just change the parameter fixed_frame from world to odom in laser_scan_matcher to achieve that.

Originally posted by Lorenz with karma: 22731 on 2012-10-10
This answer was ACCEPTED on the original site
Post score: 0

