Q:

How to Label an object in /map

Right now I have a pioneer dx that navigates using gmapping, and learns from the environment to avoid obstacles to reach its goal.  Also i have a code that detects people, and from which i can obtain its position.  What i need to do is connect this two parts of the project and label in the /map that is being used in gmapping the person i detected, so that for example in the /map an orange dot appears where the person was detected.  The idea is to dynamically create a semantic map. Does anyone have an idea how to accomplish this?

Originally posted by ctguell on ROS Answers with karma: 63 on 2013-09-26
Post score: 0

A:

The usual ROS way to label things for visualization is publishing rviz Markers with the appropriate coordinates in the map frame. There is a Tutorial.
You seem to want something different. Can you explain what you need?
UPDATE: I agree with @jorge that you should publish a separate topic with semantic map information. Many ROS components use standard map messages.
Instead of breaking that interface, publish your data on a parallel topic, like semantic_map. You can invent a custom message, or just use the rviz message if it is close enough to suit your needs.
I would still publish the markers on the rviz visualization_marker_array topic. It can contain text labels, if desired.
I suspect other people are already doing similar things. Maybe there would be interest in designing a common ROS semantic mapping message.
UPDATE2: since people are not fixed in either the robot's frame of reference or the map, you probably need to assign them each their own frame ID to track their motion. You can publish the marker in that frame, and your person detector can publish the transform from each person to the /map frame.
To do that you're going to need to learn the tf package pretty thoroughly. Start with its Tutorials. Ask (separate) questions if they are unclear.

Originally posted by joq with karma: 25443 on 2013-09-26
This answer was ACCEPTED on the original site
Post score: 2

Original comments
Comment by ctguell on 2013-09-26:
@joq
Even thought I had not thought in markers this might work as a worst case scenario.  What I want to accomplish is to change the the /map topic and add information to this topic.  Or generate one that listens to /map adds the new information and the publishes in a new topic.  Do you have any idea how to manage this, to create a dynamic semantic map?
Comment by sam on 2013-09-26:
Maybe you can use ROS message to build your own structure for topic.
Comment by ctguell on 2013-10-01:
@joq @felix k ive just finished the tutorial, and understand how to generate Markers, but as Im using it on a moving robot i wanted to create a marker that as the robot moves moves accordingly to it.  So if the robot moves towards the marker the marker would get closer to the robot, i think this might be done with  tf but i dont really understand it any help would be appreciated
Comment by joq on 2013-10-01:
Each marker contains a tf frame_id. Make sure you set that appropriately. For markers that remain attached to the map regardless of robot motion, you would typically set frame_id to /map. For markers that move with the robot, use something like base_footprint. See REP-0105.
Comment by ctguell on 2013-10-01:
@joq thanks a lot your a life saver.  The last question I need to create a marker but at a distance that i have to set at a given time and only then create the marker, do you have any idea how to do it?
Comment by joq on 2013-10-01:
@ctguell: your last question is unclear. You can create and destroy markers any time you like. Distances are determined by the coordinates and frame_id of the marker.
Comment by ctguell on 2013-10-01:
@joq sorry if I was unclear, what i want to accomplish is that once i detect a person ( with another program) i create a new marker to show that person in rviz.  To do this i want to publish a topic ( my_marker_ct) which sends a number (int) reflecting the distance of the person to the laser, and then obtain that int and create a marker with that information.  I wanted to now if this is possible and how to create a subscribes and publisher for a topic that only send a number
Comment by ctguell on 2013-10-01:
@joq @jorge thatnks a lot, ill look into it.  One last thing do you know if its possible to create a subscribes in a publisher? and if so how to do it?
Comment by joq on 2013-10-02:
Yes, you can publish from within a subscriber callback. See: http://answers.ros.org/question/9339/subscriber-and-publisher-node-at-once-in-cpp/

