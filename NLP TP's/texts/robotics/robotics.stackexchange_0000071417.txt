Q:

Gazebo laser plug-in fails to publish scan results in rviz

I have added differential drive plug-in and laser sensor (hokuyo) plug-in to my urdf file. I launched the robot in environment shown below and moved the robot using tele-operation.

Then i launched the rviz and did the setup required to view the scan results fron laser plug-in but it failed (refer the pic below).

Following are my terminal result and result for rostopic echo /scan respectively.

Where have i gone wrong how to fix this, does the warnings in terminal cause this problem?
Below is my plug-in code
Link:
<link name="hokuyo_link">
    <collision>
      <origin xyz="0 0 0" rpy="0 0 0"/>
      <geometry>
        <box size="0.1 0.1 0.1"/>
      </geometry>
    </collision>
    <visual>
      <origin xyz="0 0 0" rpy="0 0 0"/>
      <geometry>
        <box size="0.1 0.1 0.1"/>
      </geometry>
    </visual>
    <inertial>
      <mass value="1e-5" />
      <origin xyz="0 0 0" rpy="0 0 0"/>
      <inertia ixx="1e-6" ixy="0" ixz="0" iyy="1e-6" iyz="0" izz="1e-6" />
    </inertial>
  </link>

  <joint name="hokuyo_joint" type="fixed">
    <axis xyz="0 1 0" />
    <origin xyz="0 -0.055 0.2" rpy="0 0 0"/>
    <parent link="Base_plate"/>
    <child link="hokuyo_link"/>
  </joint>

laser Controller
<gazebo reference="hokuyo_link">
    <sensor type="gpu_ray" name="hokuyo">
      <pose>0 0 0 0 0 0</pose>
      <visualize>false</visualize>
      <update_rate>40</update_rate>
      <ray>
        <scan>
          <horizontal>
            <samples>100</samples>
            <resolution>1</resolution>
            <min_angle>-1.570796</min_angle>
            <max_angle>1.570796</max_angle>
          </horizontal>
        </scan>
        <range>
          <min>0.10</min>
          <max>30.0</max>
          <resolution>0.01</resolution>
        </range>
      </ray>
      <plugin name="gpu_laser" filename="libgazebo_ros_gpu_laser.so">
        <topicName>/scan</topicName>
        <frameName>hokuyo_link</frameName>
      </plugin>
    </sensor>
  </gazebo>

My RQT result

Originally posted by Kishore Kumar on ROS Answers with karma: 173 on 2016-01-18
Post score: 1

Original comments
Comment by jeremya on 2016-01-18:
Have you used RQT to look at the TF graph? Is it complete from the odom frame to the hokuyo_link frame?
Comment by Kishore Kumar on 2016-01-19:
Yes, it seems to be fine. Please refer it above in my last edit.

A:

It's rather unusual to only have 0.0 ranges in the scan message. This also pretty much rules out issues due to rays hitting the inside of the laser box geometry and therefore not appearing in the scene.
I'd first test if the situation is different with the standard (not GPU) sensor. I've seen graphics driver related issues with the gpu ray sensor before, so it's a good idea to test for that. For the differences between both you can have a look at hokuyo_utm30lx.urdf.xacro. This macro contains both a gpu and non-gpu script. If the non-gpu sensor works, you're looking at a graphics card/driver compatibility problem.

Originally posted by Stefan Kohlbrecher with karma: 24361 on 2016-01-20
This answer was ACCEPTED on the original site
Post score: 2

Original comments
Comment by Kishore Kumar on 2016-01-21:
yes, non-gpu version works fine for me. How to root cause the graphics issue and fix it?
Comment by Stefan Kohlbrecher on 2016-01-21:
Running OGRE-based rviz and gazebo on non-nvidia cards is problematic since the "dawn of time" :) and there is no general solution. You can try using updated graphics drivers and such, but there's not silver bullet to solve the problem. Search for "gazebo"+ your graphics card type here and on google
Comment by Kishore Kumar on 2016-01-21:
I am using AMD graphics card, does it be the culprit?
Comment by Stefan Kohlbrecher on 2016-01-21:
Yes. If you have a dual graphics setup you could try using your other GPU. Otherwise your could try instaling a newer driver or so, but there are no guarantees for improvement.
Comment by bob on 2016-06-11:
What would you suggest if the the non-GPU laser didn't work? I'm having an identical problem to this and when I tried to use the non-GPU laser I recived the following error:
Controller Spawner couldn't find the expected controller_manager ROS interface.
Comment by achmad_fathoni on 2018-06-02:
Any update running gpu_laser on non-nvidia?

