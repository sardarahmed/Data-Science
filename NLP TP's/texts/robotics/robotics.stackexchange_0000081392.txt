Q:

Cannot connect mavros to gazebo

I'm trying to launch a drone in gazebo, arm it and make it takeoff. So far I'm failing.
This is what happens when i do roslaunch drone_gazebo drone_world.launch
xacro: Traditional processing is deprecated. Switch to --inorder processing!
To check for compatibility of your document, use option --check-order.
For more infos, see http://wiki.ros.org/xacro#Processing_Order
xacro.py is deprecated; please use xacro instead
started roslaunch server http://ECPC:45272/

SUMMARY
========

CLEAR PARAMETERS
 * /mavros/

PARAMETERS
 * /mavros/cmd/use_comp_id_system_control: False
 * /mavros/conn/heartbeat_rate: 1.0
 * /mavros/conn/system_time_rate: 1.0
 * /mavros/conn/timeout: 10.0
 * /mavros/conn/timesync_rate: 10.0
 * /mavros/distance_sensor/hrlv_ez4_pub/field_of_view: 0.0
 * /mavros/distance_sensor/hrlv_ez4_pub/frame_id: hrlv_ez4_sonar
 * /mavros/distance_sensor/hrlv_ez4_pub/id: 0
 * /mavros/distance_sensor/hrlv_ez4_pub/orientation: ROLL_180
 * /mavros/distance_sensor/hrlv_ez4_pub/send_tf: True
 * /mavros/distance_sensor/hrlv_ez4_pub/sensor_position/x: 0.0
 * /mavros/distance_sensor/hrlv_ez4_pub/sensor_position/y: 0.0
 * /mavros/distance_sensor/hrlv_ez4_pub/sensor_position/z: -0.1
 * /mavros/distance_sensor/laser_1_sub/id: 3
 * /mavros/distance_sensor/laser_1_sub/orientation: ROLL_180
 * /mavros/distance_sensor/laser_1_sub/subscriber: True
 * /mavros/distance_sensor/lidarlite_pub/field_of_view: 0.0
 * /mavros/distance_sensor/lidarlite_pub/frame_id: lidarlite_laser
 * /mavros/distance_sensor/lidarlite_pub/id: 1
 * /mavros/distance_sensor/lidarlite_pub/orientation: ROLL_180
 * /mavros/distance_sensor/lidarlite_pub/send_tf: True
 * /mavros/distance_sensor/lidarlite_pub/sensor_position/x: 0.0
 * /mavros/distance_sensor/lidarlite_pub/sensor_position/y: 0.0
 * /mavros/distance_sensor/lidarlite_pub/sensor_position/z: -0.1
 * /mavros/distance_sensor/sonar_1_sub/id: 2
 * /mavros/distance_sensor/sonar_1_sub/orientation: ROLL_180
 * /mavros/distance_sensor/sonar_1_sub/subscriber: True
 * /mavros/fcu_url: udp://localhost:1...
 * /mavros/gcs_url: udp://localhost:1...
 * /mavros/global_position/frame_id: fcu
 * /mavros/global_position/rot_covariance: 99999.0
 * /mavros/global_position/tf/child_frame_id: fcu_utm
 * /mavros/global_position/tf/frame_id: local_origin
 * /mavros/global_position/tf/send: False
 * /mavros/image/frame_id: px4flow
 * /mavros/imu/angular_velocity_stdev: 0.000349065850399
 * /mavros/imu/frame_id: fcu
 * /mavros/imu/linear_acceleration_stdev: 0.0003
 * /mavros/imu/magnetic_stdev: 0.0
 * /mavros/imu/orientation_stdev: 1.0
 * /mavros/local_position/frame_id: fcu
 * /mavros/local_position/tf/child_frame_id: fcu
 * /mavros/local_position/tf/frame_id: local_origin
 * /mavros/local_position/tf/send: False
 * /mavros/local_position/tf/send_fcu: False
 * /mavros/mission/pull_after_gcs: True
 * /mavros/mocap/use_pose: True
 * /mavros/mocap/use_tf: False
 * /mavros/odometry/estimator_type: 3
 * /mavros/plugin_blacklist: ['safety_area', '...
 * /mavros/plugin_whitelist: []
 * /mavros/px4flow/frame_id: px4flow
 * /mavros/px4flow/ranger_fov: 0.0
 * /mavros/px4flow/ranger_max_range: 5.0
 * /mavros/px4flow/ranger_min_range: 0.3
 * /mavros/safety_area/p1/x: 1.0
 * /mavros/safety_area/p1/y: 1.0
 * /mavros/safety_area/p1/z: 1.0
 * /mavros/safety_area/p2/x: -1.0
 * /mavros/safety_area/p2/y: -1.0
 * /mavros/safety_area/p2/z: -1.0
 * /mavros/setpoint_accel/send_force: False
 * /mavros/setpoint_attitude/reverse_throttle: False
 * /mavros/setpoint_attitude/tf/child_frame_id: attitude
 * /mavros/setpoint_attitude/tf/frame_id: local_origin
 * /mavros/setpoint_attitude/tf/listen: False
 * /mavros/setpoint_attitude/tf/rate_limit: 10.0
 * /mavros/setpoint_position/tf/child_frame_id: setpoint
 * /mavros/setpoint_position/tf/frame_id: local_origin
 * /mavros/setpoint_position/tf/listen: False
 * /mavros/setpoint_position/tf/rate_limit: 50.0
 * /mavros/startup_px4_usb_quirk: True
 * /mavros/sys/disable_diag: False
 * /mavros/sys/min_voltage: 10.0
 * /mavros/target_component_id: 1
 * /mavros/target_system_id: 1
 * /mavros/tdr_radio/low_rssi: 40
 * /mavros/time/time_ref_source: fcu
 * /mavros/time/timesync_avg_alpha: 0.6
 * /mavros/time/timesync_mode: MAVLINK
 * /mavros/vibration/frame_id: vibration
 * /mavros/vision_pose/tf/child_frame_id: vision
 * /mavros/vision_pose/tf/frame_id: local_origin
 * /mavros/vision_pose/tf/listen: False
 * /mavros/vision_pose/tf/rate_limit: 10.0
 * /mavros/vision_speed/listen_twist: False
 * /robot_description: <?xml version="1....
 * /rosdistro: kinetic
 * /rosversion: 1.12.7
 * /use_sim_time: True

NODES
  /
    arm_and_takeoff (formaciones/arm_takeoff.py)
    gazebo (gazebo_ros/debug)
    gazebo_gui (gazebo_ros/gzclient)
    iris_spawn (gazebo_ros/spawn_model)
    mavros (mavros/mavros_node)

auto-starting new master
process[master]: started with pid [32726]
ROS_MASTER_URI=http://localhost:11311

setting /run_id to 343a72f0-568a-11e7-a601-408d5c04aa4b
process[rosout-1]: started with pid [32739]
started core service [/rosout]
process[gazebo-2]: started with pid [32764]
/home/maureen/sant_workspace/src/gazebo_ros_pkgs/gazebo_ros/scripts/debug: 5: [: Linux: unexpected operator
process[gazebo_gui-3]: started with pid [300]
process[iris_spawn-4]: started with pid [304]
process[mavros-5]: started with pid [305]
process[arm_and_takeoff-6]: started with pid [306]
[ INFO] [1498053724.607594009]: FCU URL: udp://localhost:14560@localhost:14565
[ WARN] [1498053724.608608537]: init: message from ASLUAV, MSG-ID 201 ignored! Table has different entry.
[ WARN] [1498053724.608831545]: init: message from autoquad, MSG-ID 150 ignored! Table has different entry.
[ WARN] [1498053724.608848901]: init: message from autoquad, MSG-ID 152 ignored! Table has different entry.
[ WARN] [1498053724.609033970]: init: message from matrixpilot, MSG-ID 150 ignored! Table has different entry.
[ WARN] [1498053724.609048664]: init: message from matrixpilot, MSG-ID 151 ignored! Table has different entry.
[ WARN] [1498053724.609072941]: init: message from matrixpilot, MSG-ID 152 ignored! Table has different entry.
[ WARN] [1498053724.609087027]: init: message from matrixpilot, MSG-ID 153 ignored! Table has different entry.
[ WARN] [1498053724.609101286]: init: message from matrixpilot, MSG-ID 155 ignored! Table has different entry.
[ WARN] [1498053724.609120213]: init: message from matrixpilot, MSG-ID 156 ignored! Table has different entry.
[ WARN] [1498053724.609134845]: init: message from matrixpilot, MSG-ID 157 ignored! Table has different entry.
[ WARN] [1498053724.609148850]: init: message from matrixpilot, MSG-ID 158 ignored! Table has different entry.
[ WARN] [1498053724.609162562]: init: message from matrixpilot, MSG-ID 170 ignored! Table has different entry.
[ WARN] [1498053724.609176259]: init: message from matrixpilot, MSG-ID 171 ignored! Table has different entry.
[ WARN] [1498053724.609189888]: init: message from matrixpilot, MSG-ID 172 ignored! Table has different entry.
[ WARN] [1498053724.609203575]: init: message from matrixpilot, MSG-ID 173 ignored! Table has different entry.
[ WARN] [1498053724.609217724]: init: message from matrixpilot, MSG-ID 174 ignored! Table has different entry.
[ WARN] [1498053724.609231217]: init: message from matrixpilot, MSG-ID 175 ignored! Table has different entry.
[ WARN] [1498053724.609245340]: init: message from matrixpilot, MSG-ID 176 ignored! Table has different entry.
[ WARN] [1498053724.609258938]: init: message from matrixpilot, MSG-ID 177 ignored! Table has different entry.
[ WARN] [1498053724.609272859]: init: message from matrixpilot, MSG-ID 178 ignored! Table has different entry.
[ WARN] [1498053724.609286323]: init: message from matrixpilot, MSG-ID 179 ignored! Table has different entry.
[ WARN] [1498053724.609299658]: init: message from matrixpilot, MSG-ID 180 ignored! Table has different entry.
[ WARN] [1498053724.609313084]: init: message from matrixpilot, MSG-ID 181 ignored! Table has different entry.
[ WARN] [1498053724.609326673]: init: message from matrixpilot, MSG-ID 182 ignored! Table has different entry.
[ WARN] [1498053724.609340477]: init: message from matrixpilot, MSG-ID 183 ignored! Table has different entry.
[ WARN] [1498053724.609353981]: init: message from matrixpilot, MSG-ID 184 ignored! Table has different entry.
[ WARN] [1498053724.609368066]: init: message from matrixpilot, MSG-ID 185 ignored! Table has different entry.
[ WARN] [1498053724.609381848]: init: message from matrixpilot, MSG-ID 186 ignored! Table has different entry.
[ WARN] [1498053724.609571276]: init: message from paparazzi, MSG-ID 180 ignored! Table has different entry.
[ WARN] [1498053724.609585711]: init: message from paparazzi, MSG-ID 181 ignored! Table has different entry.
[ WARN] [1498053724.609600788]: init: message from paparazzi, MSG-ID 182 ignored! Table has different entry.
[ WARN] [1498053724.609620718]: init: message from paparazzi, MSG-ID 183 ignored! Table has different entry.
[ WARN] [1498053724.609634731]: init: message from paparazzi, MSG-ID 184 ignored! Table has different entry.
[ WARN] [1498053724.609818104]: init: message from slugs, MSG-ID 170 ignored! Table has different entry.
[ WARN] [1498053724.609832193]: init: message from slugs, MSG-ID 172 ignored! Table has different entry.
[ WARN] [1498053724.609852056]: init: message from slugs, MSG-ID 173 ignored! Table has different entry.
[ WARN] [1498053724.609866362]: init: message from slugs, MSG-ID 176 ignored! Table has different entry.
[ WARN] [1498053724.609880088]: init: message from slugs, MSG-ID 177 ignored! Table has different entry.
[ WARN] [1498053724.609893536]: init: message from slugs, MSG-ID 179 ignored! Table has different entry.
[ WARN] [1498053724.609907084]: init: message from slugs, MSG-ID 180 ignored! Table has different entry.
[ WARN] [1498053724.609920372]: init: message from slugs, MSG-ID 181 ignored! Table has different entry.
[ WARN] [1498053724.609933646]: init: message from slugs, MSG-ID 184 ignored! Table has different entry.
[ WARN] [1498053724.609947560]: init: message from slugs, MSG-ID 185 ignored! Table has different entry.
[ WARN] [1498053724.609961354]: init: message from slugs, MSG-ID 186 ignored! Table has different entry.
[ WARN] [1498053724.609974781]: init: message from slugs, MSG-ID 188 ignored! Table has different entry.
[ WARN] [1498053724.609991294]: init: message from slugs, MSG-ID 191 ignored! Table has different entry.
[ WARN] [1498053724.610004875]: init: message from slugs, MSG-ID 192 ignored! Table has different entry.
[ WARN] [1498053724.610018379]: init: message from slugs, MSG-ID 193 ignored! Table has different entry.
[ WARN] [1498053724.610031858]: init: message from slugs, MSG-ID 194 ignored! Table has different entry.
[ INFO] [1498053724.610848186]: udp0: Bind address: 127.0.0.1:14560
[ INFO] [1498053724.610927951]: udp0: Remote address: 127.0.0.1:14565
[ INFO] [1498053724.611182093]: GCS URL: udp://localhost:14550@localhost:14555
[ INFO] [1498053724.611294567]: udp1: Bind address: 127.0.0.1:14550
[ INFO] [1498053724.611363011]: udp1: Remote address: 127.0.0.1:14555
[ INFO] [1498053724.645294362]: Plugin 3dr_radio loaded
[ INFO] [1498053724.647885644]: Plugin 3dr_radio initialized
[ INFO] [1498053724.648076406]: Plugin actuator_control loaded
[ INFO] [1498053724.650636182]: Plugin actuator_control initialized
[ INFO] [1498053724.678331142]: Plugin adsb loaded
[ INFO] [1498053724.681741307]: Plugin adsb initialized
[ INFO] [1498053724.681937153]: Plugin altitude loaded
[ INFO] [1498053724.682873856]: Plugin altitude initialized
[ INFO] [1498053724.682966734]: Plugin cam_imu_sync loaded
[ INFO] [1498053724.683511360]: Plugin cam_imu_sync initialized
[ INFO] [1498053724.683650245]: Plugin command loaded
[ INFO] [1498053724.687871461]: Plugin command initialized
[ INFO] [1498053724.687904301]: Plugin distance_sensor blacklisted
spawn_model script started
[ INFO] [1498053724.688058060]: Plugin ftp loaded
GNU gdb (Ubuntu 7.11.1-0ubuntu1~16.04) 7.11.1
Copyright (C) 2016 Free Software Foundation, Inc.
License GPLv3+: GNU GPL version 3 or later <http://gnu.org/licenses/gpl.html>
This is free software: you are free to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.  Type "show copying"
and "show warranty" for details.
This GDB was configured as "x86_64-linux-gnu".
Type "show configuration" for configuration details.
For bug reporting instructions, please see:
<http://www.gnu.org/software/gdb/bugs/>.
Find the GDB manual and other documentation resources online at:
<http://www.gnu.org/software/gdb/documentation/>.
For help, type "help".
Type "apropos word" to search for commands related to "word"...
Reading symbols from gzserver...(no debugging symbols found)...done.
[tcsetpgrp failed in terminal_inferior: Inappropriate ioctl for device]
[ INFO] [1498053724.694860308]: Plugin ftp initialized
[ INFO] [1498053724.695010211]: Plugin global_position loaded
[tcsetpgrp failed in terminal_inferior: Inappropriate ioctl for device]
[ INFO] [1498053724.702242094]: Plugin global_position initialized
[ INFO] [1498053724.702381087]: Plugin hil_actuator_controls loaded
[ INFO] [1498053724.702967454]: Plugin hil_actuator_controls initialized
[ INFO] [1498053724.703068271]: Plugin hil_controls loaded
[ INFO] [1498053724.703587555]: Plugin hil_controls initialized
[ INFO] [1498053724.703691732]: Plugin home_position loaded
[ INFO] [1498053724.706892087]: Plugin home_position initialized
[ INFO] [1498053724.707017724]: Plugin imu_pub loaded
[ INFO] [1498053724.713092120]: Plugin imu_pub initialized
[ INFO] [1498053724.713282003]: Plugin local_position loaded
[ INFO] [1498053724.717959610]: Plugin local_position initialized
[ INFO] [1498053724.718107920]: Plugin manual_control loaded
[ INFO] [1498053724.718637743]: Plugin manual_control initialized
[ INFO] [1498053724.718745870]: Plugin mocap_fake_gps loaded
[ INFO] [1498053724.720883291]: Plugin mocap_fake_gps initialized
[ INFO] [1498053724.720971476]: Plugin mocap_pose_estimate loaded
[ INFO] [1498053724.724442534]: Plugin mocap_pose_estimate initialized
[ INFO] [1498053724.724545602]: Plugin odom loaded
[ INFO] [1498053724.727198224]: Plugin odom initialized
[ INFO] [1498053724.727362703]: Plugin param loaded
[ INFO] [1498053724.730051174]: Plugin param initialized
[ INFO] [1498053724.730248541]: Plugin px4flow loaded
[ INFO] [1498053724.734537682]: Plugin px4flow initialized
[ INFO] [1498053724.734700249]: Plugin rc_io loaded
[ INFO] [1498053724.737583554]: Plugin rc_io initialized
[ INFO] [1498053724.737606431]: Plugin safety_area blacklisted
[ INFO] [1498053724.737732150]: Plugin setpoint_accel loaded
[ INFO] [1498053724.740118520]: Plugin setpoint_accel initialized
[ INFO] [1498053724.740227414]: Plugin setpoint_attitude loaded
[ INFO] [1498053724.749577354]: Plugin setpoint_attitude initialized
[ INFO] [1498053724.749729720]: Plugin setpoint_position loaded
[ INFO] [1498053724.754295513]: Plugin setpoint_position initialized
[ INFO] [1498053724.754452886]: Plugin setpoint_raw loaded
[ INFO] [1498053724.762059394]: Plugin setpoint_raw initialized
[ INFO] [1498053724.762215932]: Plugin setpoint_velocity loaded
[ INFO] [1498053724.766491023]: Plugin setpoint_velocity initialized
[ INFO] [1498053724.766711849]: Plugin sys_status loaded
[ INFO] [1498053724.771686421]: Plugin sys_status initialized
[ INFO] [1498053724.771809220]: Plugin sys_time loaded
[ INFO] [1498053724.774507793]: TM: Timesync mode: MAVLINK
[ INFO] [1498053724.775499621]: Plugin sys_time initialized
[ INFO] [1498053724.775610451]: Plugin vfr_hud loaded
[ INFO] [1498053724.776870780]: Plugin vfr_hud initialized
[ INFO] [1498053724.776900540]: Plugin vibration blacklisted
[ INFO] [1498053724.777010180]: Plugin vision_pose_estimate loaded
[INFO] [1498053724.782402, 0.000000]: Tiempo antes de arming: 0 segundos
[ INFO] [1498053724.786024546]: Plugin vision_pose_estimate initialized
[ INFO] [1498053724.786170495]: Plugin vision_speed_estimate loaded
[ INFO] [1498053724.788728078]: Plugin vision_speed_estimate initialized
[ INFO] [1498053724.788865202]: Plugin waypoint loaded
[ INFO] [1498053724.792267034]: Plugin waypoint initialized
[ INFO] [1498053724.792321800]: Autostarting mavlink via USB on PX4
[ INFO] [1498053724.792446899]: Built-in SIMD instructions: SSE, SSE2
[ INFO] [1498053724.792468670]: Built-in MAVLink package version: 2017.6.6
[ INFO] [1498053724.792490682]: Known MAVLink dialects: common ardupilotmega ASLUAV autoquad matrixpilot paparazzi slugs standard uAvionix ualberta
[ INFO] [1498053724.792509370]: MAVROS started. MY ID 1.240, TARGET ID 1.1
[INFO] [1498053724.816312, 0.000000]: Loading model xml from ros parameter
[INFO] [1498053724.818444, 0.000000]: Waiting for service /gazebo/spawn_urdf_model
[Thread debugging using libthread_db enabled]
Using host libthread_db library "/lib/x86_64-linux-gnu/libthread_db.so.1".
[tcsetpgrp failed in terminal_inferior: Inappropriate ioctl for device]
[New Thread 0x7fffcebda700 (LWP 712)]
Gazebo multi-robot simulator, version 7.8.1
Copyright (C) 2012 Open Source Robotics Foundation.
Released under the Apache 2 License.
http://gazebosim.org

[tcsetpgrp failed in terminal_inferior: Inappropriate ioctl for device]
[tcsetpgrp failed in terminal_inferior: Inappropriate ioctl for device]
[tcsetpgrp failed in terminal_inferior: Inappropriate ioctl for device]
[tcsetpgrp failed in terminal_inferior: Inappropriate ioctl for device]
[New Thread 0x7fffca580700 (LWP 714)]
[New Thread 0x7fffc9d7f700 (LWP 715)]
[New Thread 0x7fffc957e700 (LWP 718)]
[New Thread 0x7fffc8d7d700 (LWP 719)]
[New Thread 0x7fffc3fff700 (LWP 720)]
[New Thread 0x7fffc37fe700 (LWP 733)]
[New Thread 0x7fffc2ffd700 (LWP 734)]
[New Thread 0x7fffc27fc700 (LWP 735)]
[New Thread 0x7fffc1ffb700 (LWP 737)]
[New Thread 0x7fffc17fa700 (LWP 738)]
[New Thread 0x7fffc0ff9700 (LWP 739)]
[New Thread 0x7fffabfff700 (LWP 740)]
[New Thread 0x7fffab7fe700 (LWP 741)]
[New Thread 0x7fffaaffd700 (LWP 742)]
[New Thread 0x7fffaa7fc700 (LWP 743)]
[New Thread 0x7fffa9ffb700 (LWP 744)]
[ INFO] [1498053725.529683648]: Finished loading Gazebo ROS API Plugin.
[ INFO] [1498053725.529917072]: waitForService: Service [/gazebo/set_physics_properties] has not been advertised, waiting...
[Msg] Waiting for master.
[Msg] Connected to gazebo master @ http://127.0.0.1:11345
[Msg] Publicized address: 10.1.202.12
[New Thread 0x7fffa97fa700 (LWP 746)]
[tcsetpgrp failed in terminal_inferior: Inappropriate ioctl for device]
[tcsetpgrp failed in terminal_inferior: Inappropriate ioctl for device]
[tcsetpgrp failed in terminal_inferior: Inappropriate ioctl for device]
[tcsetpgrp failed in terminal_inferior: Inappropriate ioctl for device]
[tcsetpgrp failed in terminal_inferior: Inappropriate ioctl for device]
[tcsetpgrp failed in terminal_inferior: Inappropriate ioctl for device]
[tcsetpgrp failed in terminal_inferior: Inappropriate ioctl for device]
[New Thread 0x7fff7c4bf700 (LWP 747)]
[New Thread 0x7fff7bcbe700 (LWP 748)]
[New Thread 0x7fff7b4bd700 (LWP 749)]
[New Thread 0x7fff7acbc700 (LWP 750)]
[New Thread 0x7fff7a4bb700 (LWP 751)]
[New Thread 0x7fff79cba700 (LWP 752)]
[New Thread 0x7fff794b9700 (LWP 753)]
[New Thread 0x7fff78cb8700 (LWP 754)]
[tcsetpgrp failed in terminal_inferior: Inappropriate ioctl for device]
[New Thread 0x7fff53dff700 (LWP 772)]
[New Thread 0x7fff539fe700 (LWP 774)]
[New Thread 0x7fff535fd700 (LWP 775)]
[New Thread 0x7fff52dfb700 (LWP 776)]
[New Thread 0x7fff529fa700 (LWP 778)]
[New Thread 0x7fff531fc700 (LWP 777)]
[New Thread 0x7fff525f9700 (LWP 779)]
[New Thread 0x7fff521f8700 (LWP 825)]
[New Thread 0x7fff519f7700 (LWP 826)]
[New Thread 0x7fff511f6700 (LWP 827)]
[New Thread 0x7fff509f5700 (LWP 828)]
[ INFO] [1498053725.844152843, 0.023000000]: waitForService: Service [/gazebo/set_physics_properties] is now available.
[ INFO] [1498053725.883559762, 0.061000000]: Physics dynamic reconfigure ready.
[Thread 0x7fffa9ffb700 (LWP 744) exited]
[INFO] [1498053726.024558, 0.199000]: Calling service /gazebo/spawn_urdf_model
[INFO] [1498053726.224786, 0.352000]: Spawn status: SpawnModel: Successfully spawned model
[tcsetpgrp failed in terminal_inferior: Inappropriate ioctl for device]
[tcsetpgrp failed in terminal_inferior: Inappropriate ioctl for device]
[tcsetpgrp failed in terminal_inferior: Inappropriate ioctl for device]
[iris_spawn-4] process has finished cleanly
log file: /home/maureen/.ros/log/343a72f0-568a-11e7-a601-408d5c04aa4b/iris_spawn-4*.log
[tcsetpgrp failed in terminal_inferior: Inappropriate ioctl for device]

Afterwards I can see the output of the node I told it to run, but the arm and takeoff both fail.
mavros/state shows:
      seq: 0
  stamp: 
    secs: 0
    nsecs:         0
  frame_id: ''
connected: False
armed: False
guided: False
mode: ''
system_status: 0 

So clearly I can't get anything to connect.
This is the launch file
<arg name="mav_name" default="iris" />
<arg name="mav_color" value="DarkGrey" />
<arg name="model" value="$(find drone_description)/urdf/$(arg mav_name)_base.xacro" />
<arg name="enable_logging" value= "false" />
<arg name="enable_ground_truth" value="true" />
<arg name="log_file" default="$(arg mav_name)"/>
<arg name="enable_mavlink_interface" default="false"/>
<include file="$(find gazebo_ros)/launch/empty_world.launch">       
    <arg name="world_name" value="$(find drone_gazebo)/worlds/drone.world"/>        
    <arg name="gui" value="true"/>
    <arg name="debug" default="true"/>
    <arg name="verbose" default="true"/> 
</include>
<param name="robot_description" command=
    "$(find xacro)/xacro.py '$(find drone_description)/urdf/iris_base.xacro'
    enable_logging:=$(arg enable_logging)
    enable_ground_truth:=$(arg enable_ground_truth)
    log_file:=$(arg log_file)
    mav_name:=$(arg mav_name)
    namespace:=$(arg mav_name)
    mav_color:=$(arg mav_color)
    enable_mavlink_interface:=$(arg enable_mavlink_interface)"/> 
<node 
    name="$(arg mav_name)_spawn" 
    pkg="gazebo_ros"
    type="spawn_model"
    output="screen"
    args="-urdf -param robot_description -model $(arg mav_name)" />
<include file="$(find mavros)/launch/px4.launch">
    <arg name="fcu_url" value="udp://:14560@localhost:14565" />
</include>
<node name="arm_and_takeoff" pkg="formaciones" type="arm_takeoff.py"  output="screen"/> 
</launch>

I've been trying to fix this for ages so any help would be greatly appreciated

Originally posted by Maureen on ROS Answers with karma: 3 on 2017-06-21
Post score: 0

Original comments
Comment by Maureen on 2017-06-26:
The answer seems to be correct, but since I had other problems I could not test it correctly

A:

So first, may I ask why you have gdb running? It shouldn't affect operations but it does not seem necessary.
Second, PX4 already has a process of launching a mavros connected gazebo simulation, documented here:
https://dev.px4.io/en/simulation/ros_interface.html
Specifically, the mavros_posix_sitl.launch file seems exactly what you need, and has been verified to work. If you need to customize aspects you can simply change some of the Args going into that launch file.
At a glance I'd say your issue is probably two fold, an improperly setup fcu_url, resulting in mavros being unable to connect to launched px4 software. As well as the fact that the px4 software isn't launched in the first place. The SITL consists of three separate software components, the gazebo simulation, the mavros ROS node, and the px4 SITL node. It looks like you never launched the px4 SITL node, so mavros thus has nothing to connect to. If you did the px4 Nsh interface should show up on terminal as well.
<node name="sitl" pkg="px4" type="px4" output="screen"
    args="$(find px4) $(arg rcS)">
</node>

This is the relevant line in px4 's gazebo launch file that I think you missed.

Originally posted by eric1221bday with karma: 245 on 2017-06-21
This answer was ACCEPTED on the original site
Post score: 1

Original comments
Comment by Maureen on 2017-06-21:
Thank you! The debug was left there from a moment when I was trying to figure out what was wrong.

