Q:

ros_control makes Gazebo abort

Until last week, I was working on a robot simulation in Gazebo, with the ros_control plugin, without problems. But after a few days ago, Gazebo just started to abort with the folllowing error:
*** Error in `gzserver': malloc(): smallbin double linked list corrupted: 0x00007fc0ccbe61a0 ***

It is also a double free or corruption (out) error related to malloc, that I can't reproduce for now.
When I remove the piece of URDF description that calls gazebo_ros_control plugin, it initializes normally. When the plugin is loaded, gzserver simply aborts with Segmentation fault (core dumped), leaving the GUI working, but frozen. It is so weird, given that I haven't changed nothing in the code since few weeks ago...
How can I solve it?
The robot description is here.
I'm using ROS Indigo with Gazebo 6.
Edit: it is giving a new error:
*** Error in `gzserver': free(): invalid pointer: 0x00007fed70026e50 ***

Originally posted by longforgotten on ROS Answers with karma: 55 on 2016-06-06
Post score: 1

Original comments
Comment by mayur on 2016-06-10:
i am also facing same problem.Till tomorrow, my robot simulation was working properly. But today while running roslaunch of my robot file i got error in gzserver double free or corruption and gui got frozen.
i am using ros indigo and gazebo7 for my robot
emersonfs did you get any solution for that?
Comment by longforgotten on 2016-06-11:
@mayur unfortunately I have no solution to this problem till now. I believe this is a bug in gazebo_ros_control; I'll check the gazebo_ros_pkgs issue tracker on Github.

A:

The current solution is to remove the following packages installed via .deb and manually build them. Run
sudo apt-get remove ros--gazebo-ros-control
sudo apt-get remove ros--gazebo-plugings
and also any other gazebo pkgs you want to remove, but these two do the trick. Notice that you'd have to add version number next to gazebo above is you are not using the default gazebo for your distro. I am using gazebo7 with Indigo so I replaced gazebo with gazebo7.
afterwards, clone the following in your own catkin_ws, and checkout the branch which corresponds to your gazebo version. Default should work with Indigo.
https://github.com/ros-simulation/gazebo_ros_pkgs.git
just build them by catkin_make and source your workspace. Hopefully Gazebo won't crash now.
This worked for me.

Originally posted by Adnan Munawar with karma: 71 on 2016-06-21
This answer was ACCEPTED on the original site
Post score: 3

Original comments
Comment by ycheng517 on 2016-07-25:
You are a saviour. This solves all my problems with Gazebo7 and ROS Indigo. I used the indigo-devel-gazebo7-warnings branch

