Q:

RGB To Depth mapping

Hi All,
I did try to search this kind of problem if someone already faced earlier but I did found If I missed I am sorry.So please guide.
I mapped the RGB to depth frame in ROS but it is not mapped correctly.
Can any one please guide me.
Why its like this ?

Originally posted by Muhammad Atif on ROS Answers with karma: 3 on 2013-03-24
Post score: 0

Original comments
Comment by Pep Lluis Negre on 2013-03-24:
Are you using a stereo camera or some RGBD sensor like kinect?
Comment by Muhammad Atif on 2013-03-25:
I am using Microsoft Kinect and.....subscribed to the following..../camera/depth/points and /camera/rgb/image_color.....
Comment by hiranya on 2013-03-25:
You can use topic "/camera/depth_registered/points"

A:

You can use topic "/camera/depth_registered/points" and callback function as follows
    void callback(const pcl::PointCloud<pcl::PointXYZRGB>::ConstPtr& msg){
      BOOST_FOREACH (const pcl::PointXYZRGB& pt, msg->points){
         ROS_INFO("\t(%f, %f, %f,%d, %d, %d)\n", pt.x, pt.y, pt.z,pt.r,pt.g,pt.b);
        }
  

in your main you can subscribe as follows
ros::Subscriber sub = nh.subscribe<pcl::PointCloud<pcl::PointXYZRGB> >("/camera/depth_registered/points", 1, callback);

Then you can get the points with RGB valuse :)

Originally posted by hiranya with karma: 104 on 2013-03-25
This answer was ACCEPTED on the original site
Post score: 0

Original comments
Comment by Muhammad Atif on 2013-03-25:
Thanks hiranya for your reply.It really works.My one question regarding the above code.Why "nan" values appear in it.2ndly How I can get the each pixel number to the corresponding information (xyz and rgb), because I am doing Image Identification I need that info also.thanks in advance..
Comment by hiranya on 2013-03-25:\

The nan values are value points that Kinect cannot capture depth information everywhere such as reflective surface, light-emitting surfaces etc. 2.There are two types of point clouds organized (get the each pixel number to corresponding 3d information)and unorganized.you need an organized one.

Comment by Muhammad Atif on 2013-03-25:
The above mentioned are organized or unorganized ?How to get the organized point clouds ?
Comment by hiranya on 2013-03-26:
yes its organized pcl. WIDTH 640* HEIGHT 480  hope you can get an idea from this http://pointclouds.org/documentation/tutorials/pcd_file_format.php about organized PCL.
Comment by Muhammad Atif on 2013-03-28:
It really works but with one problem.If we cut first 32 pixel then it works very well.I am trying to dig out this problem I did not found but if some one know please share with us."Matching of depth with RGB works when first 32 pixel removed."

