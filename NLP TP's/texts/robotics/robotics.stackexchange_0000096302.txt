Q:

Generating a C++ Code Coverage Report with Colcon

Just trying to create something similar to the ROS 2 CI for code coverage (example here).
With colcon mixins, I've seen coverage-gcc under build mixins, but I'm not sure how to use it.

Originally posted by allenh1 on ROS Answers with karma: 3055 on 2020-06-19
Post score: 3

A:

For those curious, I was able to do it by invoking colcon as follows.
colcon build --symlink-install --cmake-args -DCMAKE_BUILD_TYPE=Debug -DCMAKE_CXX_FLAGS="--coverage" -DCMAKE_CXX_OUTPUT_EXTENSION_REPLACE=ON

Then I ran the tests.
colcon test

Finally, I ran lcov.
lcov --capture --directory build/ --output-file my_fantastic_coverage_report.info

And generated fancy HTML with this.
genhtml my_fantastic_coverage_report.info --output-directory fancy_html_coverage_report

Then just sensible-browser fancy_html_coverage_report/index.html.

Originally posted by allenh1 with karma: 3055 on 2020-07-05
This answer was ACCEPTED on the original site
Post score: 4

Original comments
Comment by gvdhoorn on 2020-07-05:
For CI purposes, the following PR may be interesting: ros-industrial/industrial_ci/pull/504.
Comment by Dirk Thomas on 2020-07-06:
The colcon mixin repository provides a mixin to generate C++ coverage (https://github.com/colcon/colcon-mixin-repository/blob/1ddb69bedfd1f04c2f000e95452f7c24a4d6176b/coverage.mixin#L3-L8) which contains all the CMake arguments you need.
Comment by TomSon on 2021-11-05:
That's nice to get back the details of the commands but can you get back the CmakeModule to directly generate report as new target ?

