Q:

Buildfarm doesn't define the ROS_DISTRO environment variable

My package uses the $ROS_DISTRO environment variable at configure time for dh_installudev and for differences between Indigo and Kinetic. The buildfarm doesn't seem to define $ROS_DISTRO.
CMakeLists.txt:
https://bitbucket.org/DataspeedInc/sainsmart_relay_usb/src/0.0.1/CMakeLists.txt?fileviewer=file-view-default#CMakeLists.txt-29
Buildfarm errors:
http://build.ros.org/job/Ibin_uT64__sainsmart_relay_usb__ubuntu_trusty_amd64__binary/1/console
http://build.ros.org/job/Kbin_uX64__sainsmart_relay_usb__ubuntu_xenial_amd64__binary/1/console

Originally posted by kmhallen on ROS Answers with karma: 1416 on 2017-12-01
Post score: 3

A:

EDIT: UPDATE 2022
We have formalized the solution to getting this environment variable. You should use the ros_environment package to get these sorts of variables defined and available in your workspace.

Old answer:
Yeah, we don't set that in the debian build environment. You can see it for your package here: https://github.com/DataspeedInc-release/sainsmart_relay_usb-release/blob/debian/kinetic/sainsmart_relay_usb/debian/rules.em
You could try extending the template in bloom: https://github.com/ros-infrastructure/bloom/blob/master/bloom/generators/debian/templates/catkin/rules.em and if that resolves your problem it might be worth considering a pull request. Though I'd like to see if there's a cleaner way to determine the debian package name during the compile, but I can't find anything.
@nuclearsandwich @william FYI

Originally posted by tfoote with karma: 58457 on 2017-12-01
This answer was ACCEPTED on the original site
Post score: 1

Original comments
Comment by kmhallen on 2017-12-02:
It looks like it's not necessary to know the debian package name. The simple filename udev can be used.
https://github.com/ros-drivers/pointgrey_camera_driver/pull/131
https://github.com/ros-drivers/pointgrey_camera_driver/tree/0.13.4/pointgrey_camera_driver/debian

