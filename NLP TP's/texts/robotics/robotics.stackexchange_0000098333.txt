Q:

A question about Service and Client

I followed the tutorials (http://wiki.ros.org/ROS/Tutorials/WritingServiceClient%28c%2B%2B%29).
I found that in my client cpp file there's a code line
 beginner_tutorials::AddTwoInts srv

and
if (client.call(srv))
So I think the server function received data from client by “srv”.
But in my server cpp file， it says
ros::ServiceServer service = n.advertiseService("add_two_ints", add);

and
`bool add(beginner_tutorials::AddTwoInts::Request  &req,
       beginner_tutorials::AddTwoInts::Response &res)`{}

so it looks like server function received two variables（one for request one for response）.
My question is that if I wrrite it
`bool add(beginner_tutorials::AddTwoInts srv)`{}

will it work?
Thank you.

Originally posted by sunpansiyu on ROS Answers with karma: 3 on 2021-02-17
Post score: 0

A:

The line
beginner_tutorials::AddTwoInts srv;

Is actually declaring a service message, which is defined here as:
int64 a
int64 b
---
int64 sum

A service message, by convention is split into a "request" and "response" part. For this message "a" and "b" are part of the request and "sum" is part of the response. To access these variables in code you can do like:
 beginner_tutorials::AddTwoInts srv;
 srv.request.a = 5;
 srv.request.b = 4;

Your service, defined by:
ros::ServiceServer service = n.advertiseService("add_two_ints", add);

Has a "callback" function, here named "add" whose signature by design explicitly names the the request AND response parts. That is why "add" takes two arguments.
bool add(beginner_tutorials::AddTwoInts::Request  &req,
               beginner_tutorials::AddTwoInts::Response &res)

For practical purposes however all you have to do to call the service is declare the client:
ros::ServiceClient client = n.serviceClient<beginner_tutorials::AddTwoInts>("add_two_ints");

And then call it with the SINGLE argument, srv:
 client.call(srv)

And after the call, it it was successful, you can access the result like this:
srv.response.sum

Does that help answer your question at all?
Cheers, JB

Originally posted by JackB with karma: 977 on 2021-02-18
This answer was ACCEPTED on the original site
Post score: 1

Original comments
Comment by JackB on 2021-02-24:
@sunpansiyu any update on this?
Comment by sunpansiyu on 2021-03-21:
I am so sorry for my late response!
Thank you for your answer, it helps me a lot!
Comment by sunpansiyu on 2021-03-21:
I understand it now ,thank you!

