Q:

Can't get transform from /base_link to /odom although it's definitely there

Hi folks,
this is a very weird issue. I'm trying to post a goal to move_base but need a transform to get the right movement vector for my robot. That transform is definitely available. I can do this
$ rosrun tf tf_echo /base_link /odom
At time 1379711306.536
- Translation: [-0.281, -1.081, 0.000]
- Rotation: in Quaternion [0.000, 0.000, -0.004, 1.000]
        in RPY [0.000, 0.000, -0.008]

however when I try to get that transform from within a ROS node it's not available (timeout after a duration of 3 seconds). Here's the source code of my goal sending example node:
http://pastebin.com/Gvm6jcsC
And three seconds after rosrun'ing the node I get the error message "Transform /base_link /odom not found".
Here's the corresponding tf graph:
EDIT: image removed; faaaaar too huge!
Link to image
Can somebody help me figure out how and why this can happen?
EDIT 2: It is a time issue. After replacing all references to ros::Time::now() with ros::Time(0) it works. Does it have to be like that? Or is it just fighting symptomes of a different cause?
Thanks a lot!
Cheers,
Hendrik

Originally posted by Hendrik Wiese on ROS Answers with karma: 1145 on 2013-09-20
Post score: 0

A:

I believe that your problem is that you are picking a timestamp which is approximately at the startup time of your program, however you have not given the tf buffer time to fill prior to your query.
If you were to implement a loop with retrying you would find it would likely work.  Or if you initialized the Listener long enough for the tf data to arrive it would likely work as well. Time zero works because it will return as soon as a set of transforms exists.
waitForTransform is only useful if your data is newer than the information in the buffer. You have the other case that your data is older than the buffer. Since old tf data is not republished waiting into the future is never going to work if your timestamp is older than the earliest data in the buffer.

Originally posted by tfoote with karma: 58457 on 2013-09-21
This answer was ACCEPTED on the original site
Post score: 1

