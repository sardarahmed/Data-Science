Q:

How to clone a PointCloud in a subscriber callback

Dear all, I am using Indigo,
coming from Groovy and Hydro, I found it difficult to understand the internals of pcl_ros and pcl_conversions packages.
My problem is the following: I have a subscription callback like this:
void RosHandler::xtionCloudCallback(const sensor_msgs::PointCloud2::ConstPtr& msg);
or, for me it's the same, like this:
void RosHandler::xtionCloudCallback(const pcl::PointCloudpcl::PointXYZRGB::ConstPtr& msg);
the first question is: is this pcl::PointCloudpcl::PointXYZRGB the same as in pcl?
if it is the same, how can I clone the data, in such a way that I can use them without bothering of what ROS is doing meanwhile (i.e., in another thread)?
What I did in Groovy (and it worked) was to manually copy the message field by field (and cloning "data"), but it does not work anymore (and, indeed, I was not sure it was safe to do that in that way).
EDIT:
when I say "it does not work" I mean that it segfault when I delete the new (cloned) cloud, so this means the ownership of the cloud was not (entirely?) mine
EDIT2:
the problem is not only I cannot delete the cloud, of course, but also that I cannot read it (it has been deleted by someone else)

Originally posted by madmage on ROS Answers with karma: 293 on 2014-09-18
Post score: 1

A:

just to expand on @Paulbovbel 's answer
If you want to continue with processing shared_ptrs maybe the makeShared() method helps you. Creates a deep copy of the cloud and returns you a shared_ptr to the copied cloud, see:
http://docs.pointclouds.org/trunk/classpcl_1_1_point_cloud.html#a7b01fdbe1dba1e640bbabc0295021e75

Originally posted by Wolf with karma: 7555 on 2014-09-19
This answer was ACCEPTED on the original site
Post score: 1

