Q:

Compilation error building Rviz on OSX Lion

Hi all,
I'm trying to build rviz on Osx Lion.
I found some errors along the path but I fixed it by replacing my old macports libraries with the corresponding universal version.
Otherwise at the moment I have a problem with yaml_cpp. Below you can see the log:
make -f Makefile wipe
rm -rf yaml-cpp build/yaml-cpp-0.2.5
cd build && make clean
/bin/sh: line 0: cd: build: No such file or directory
make[1]: [clean] Error 1 (ignored)
rm -rf build
touch wiped
mkdir -p build
if [ ! -f yaml-cpp-0.2.5.tar.gz.md5sum ]; then echo "Error: Couldn't find md5sum file yaml-cpp-0.2.5.tar.gz.md5sum" && false; fi
`rospack find rosbuild`/bin/download_checkmd5.py http://yaml-cpp.googlecode.com/files/yaml-cpp-0.2.5.tar.gz build/yaml-cpp-0.2.5.tar.gz `awk {'print $1'} yaml-cpp-0.2.5.tar.gz.md5sum`
[rosbuild] Downloading http://yaml-cpp.googlecode.com/files/yaml-cpp-0.2.5.tar.gz to build/yaml-cpp-0.2.5.tar.gz...Done
[rosbuild] Checking md5sum on build/yaml-cpp-0.2.5.tar.gz
touch -c build/yaml-cpp-0.2.5.tar.gz
rm -rf build/yaml-cpp-0.2.5 
cd build; tar -xzf  ../build/yaml-cpp-0.2.5.tar.gz
touch build/yaml-cpp-0.2.5/unpacked
cd build && cmake -DCMAKE_INSTALL_PREFIX=../yaml-cpp yaml-cpp-0.2.5
-- The C compiler identification is GNU
-- The CXX compiler identification is GNU
-- Checking whether C compiler has -isysroot
-- Checking whether C compiler has -isysroot - yes
-- Checking whether C compiler supports OSX deployment target flag
-- Checking whether C compiler supports OSX deployment target flag - yes
-- Check for working C compiler: /usr/bin/gcc
-- Check for working C compiler: /usr/bin/gcc -- works
-- Detecting C compiler ABI info
-- Detecting C compiler ABI info - done
-- Checking whether CXX compiler has -isysroot
-- Checking whether CXX compiler has -isysroot - yes
-- Checking whether CXX compiler supports OSX deployment target flag
-- Checking whether CXX compiler supports OSX deployment target flag - yes
-- Check for working CXX compiler: /usr/bin/c++
-- Check for working CXX compiler: /usr/bin/c++ -- works
-- Detecting CXX compiler ABI info
-- Detecting CXX compiler ABI info - done
-- Configuring done
-- Generating done
-- Build files have been written to: /Users/luca/Software/ros/common/yaml_cpp/build
cd build && make && make install
Scanning dependencies of target yaml-cpp
[  3%] Building CXX object CMakeFiles/yaml-cpp.dir/src/aliascontent.cpp.o
[  6%] Building CXX object CMakeFiles/yaml-cpp.dir/src/conversion.cpp.o
[ 10%] Building CXX object CMakeFiles/yaml-cpp.dir/src/emitter.cpp.o
[ 13%] Building CXX object CMakeFiles/yaml-cpp.dir/src/emitterstate.cpp.o
[ 17%] Building CXX object CMakeFiles/yaml-cpp.dir/src/emitterutils.cpp.o
[ 20%] Building CXX object CMakeFiles/yaml-cpp.dir/src/exp.cpp.o
[ 24%] Building CXX object CMakeFiles/yaml-cpp.dir/src/iterator.cpp.o
[ 27%] Building CXX object CMakeFiles/yaml-cpp.dir/src/map.cpp.o
[ 31%] Building CXX object CMakeFiles/yaml-cpp.dir/src/node.cpp.o
[ 34%] Building CXX object CMakeFiles/yaml-cpp.dir/src/null.cpp.o
[ 37%] Building CXX object CMakeFiles/yaml-cpp.dir/src/ostream.cpp.o
[ 41%] Building CXX object CMakeFiles/yaml-cpp.dir/src/parser.cpp.o
[ 44%] Building CXX object CMakeFiles/yaml-cpp.dir/src/parserstate.cpp.o
[ 48%] Building CXX object CMakeFiles/yaml-cpp.dir/src/regex.cpp.o
[ 51%] Building CXX object CMakeFiles/yaml-cpp.dir/src/scalar.cpp.o
[ 55%] Building CXX object CMakeFiles/yaml-cpp.dir/src/scanner.cpp.o
[ 58%] Building CXX object CMakeFiles/yaml-cpp.dir/src/scanscalar.cpp.o
[ 62%] Building CXX object CMakeFiles/yaml-cpp.dir/src/scantag.cpp.o
[ 65%] Building CXX object CMakeFiles/yaml-cpp.dir/src/scantoken.cpp.o
[ 68%] Building CXX object CMakeFiles/yaml-cpp.dir/src/sequence.cpp.o
[ 72%] Building CXX object CMakeFiles/yaml-cpp.dir/src/simplekey.cpp.o
[ 75%] Building CXX object CMakeFiles/yaml-cpp.dir/src/stream.cpp.o
[ 79%] Building CXX object CMakeFiles/yaml-cpp.dir/src/tag.cpp.o
/usr/include/c++/4.2.1/bits/ostream_insert.h: In function ‘std::basic_ostream<_CharT, _Traits>& std::__ostream_insert(std::basic_ostream<_CharT, _Traits>&, const _CharT*, std::streamsize) [with _CharT = char, _Traits = std::char_traits<char>]’:
/usr/include/c++/4.2.1/bits/basic_string.h:2414:   instantiated from ‘std::basic_ostream<_CharT, _Traits>& std::operator<<(std::basic_ostream<_CharT, _Traits>&, const std::basic_string<_CharT, _Traits, _Alloc>&) [with _CharT = char, _Traits = std::char_traits<char>, _Alloc = std::allocator<char>]’
/Users/luca/Software/ros/common/yaml_cpp/build/yaml-cpp-0.2.5/src/token.h:67:   instantiated from here
/usr/include/c++/4.2.1/bits/ostream_insert.h:82: error: invalid use of incomplete type ‘struct std::basic_ostream<char, std::char_traits<char> >’
/usr/include/c++/4.2.1/iosfwd:64: error: declaration of ‘struct std::basic_ostream<char, std::char_traits<char> >’
/usr/include/c++/4.2.1/bits/ostream_insert.h:84: error: invalid use of incomplete type ‘struct std::basic_ostream<char, std::char_traits<char> >’
/usr/include/c++/4.2.1/iosfwd:64: error: declaration of ‘struct std::basic_ostream<char, std::char_traits<char> >’
/usr/include/c++/4.2.1/bits/ostream_insert.h:84: error: invalid use of incomplete type ‘struct std::basic_ostream<char, std::char_traits<char> >’
/usr/include/c++/4.2.1/iosfwd:64: error: declaration of ‘struct std::basic_ostream<char, std::char_traits<char> >’
/usr/include/c++/4.2.1/bits/ostream_insert.h:89: error: invalid use of incomplete type ‘struct std::basic_ostream<char, std::char_traits<char> >’
/usr/include/c++/4.2.1/iosfwd:64: error: declaration of ‘struct std::basic_ostream<char, std::char_traits<char> >’
/usr/include/c++/4.2.1/bits/ostream_insert.h:94: error: invalid use of incomplete type ‘struct std::basic_ostream<char, std::char_traits<char> >’
/usr/include/c++/4.2.1/iosfwd:64: error: declaration of ‘struct std::basic_ostream<char, std::char_traits<char> >’
/usr/include/c++/4.2.1/bits/ostream_insert.h:94: error: invalid use of incomplete type ‘struct std::basic_ostream<char, std::char_traits<char> >’
/usr/include/c++/4.2.1/iosfwd:64: error: declaration of ‘struct std::basic_ostream<char, std::char_traits<char> >’
/usr/include/c++/4.2.1/bits/ostream_insert.h:94: error: invalid use of incomplete type ‘struct std::basic_ostream<char, std::char_traits<char> >’
/usr/include/c++/4.2.1/iosfwd:64: error: declaration of ‘struct std::basic_ostream<char, std::char_traits<char> >’
/usr/include/c++/4.2.1/bits/basic_string.h:2414:   instantiated from ‘std::basic_ostream<_CharT, _Traits>& std::operator<<(std::basic_ostream<_CharT, _Traits>&, const std::basic_string<_CharT, _Traits, _Alloc>&) [with _CharT = char, _Traits = std::char_traits<char>, _Alloc = std::allocator<char>]’
/Users/luca/Software/ros/common/yaml_cpp/build/yaml-cpp-0.2.5/src/token.h:67:   instantiated from here
/usr/include/c++/4.2.1/bits/ostream_insert.h:97: error: invalid use of incomplete type ‘struct std::basic_ostream<char, std::char_traits<char> >’
/usr/include/c++/4.2.1/iosfwd:64: error: declaration of ‘struct std::basic_ostream<char, std::char_traits<char> >’
/usr/include/c++/4.2.1/bits/basic_string.h:2414:   instantiated from ‘std::basic_ostream<_CharT, _Traits>& std::operator<<(std::basic_ostream<_CharT, _Traits>&, const std::basic_string<_CharT, _Traits, _Alloc>&) [with _CharT = char, _Traits = std::char_traits<char>, _Alloc = std::allocator<char>]’
/Users/luca/Software/ros/common/yaml_cpp/build/yaml-cpp-0.2.5/src/token.h:67:   instantiated from here
/usr/include/c++/4.2.1/bits/ostream_insert.h:99: error: invalid use of incomplete type ‘struct std::basic_ostream<char, std::char_traits<char> >’
/usr/include/c++/4.2.1/iosfwd:64: error: declaration of ‘struct std::basic_ostream<char, std::char_traits<char> >’
/usr/include/c++/4.2.1/bits/ostream_insert.h:104: error: invalid use of incomplete type ‘struct std::basic_ostream<char, std::char_traits<char> >’
/usr/include/c++/4.2.1/iosfwd:64: error: declaration of ‘struct std::basic_ostream<char, std::char_traits<char> >’
/usr/include/c++/4.2.1/bits/ostream_insert.h:107: error: invalid use of incomplete type ‘struct std::basic_ostream<char, std::char_traits<char> >’
/usr/include/c++/4.2.1/iosfwd:64: error: declaration of ‘struct std::basic_ostream<char, std::char_traits<char> >’
/usr/include/c++/4.2.1/bits/ostream_insert.h:107: error: invalid use of incomplete type ‘struct std::basic_ostream<char, std::char_traits<char> >’
/usr/include/c++/4.2.1/iosfwd:64: error: declaration of ‘struct std::basic_ostream<char, std::char_traits<char> >’
/usr/include/c++/4.2.1/bits/ostream_insert.h: In function ‘void std::__ostream_fill(std::basic_ostream<_CharT, _Traits>&, std::streamsize) [with _CharT = char, _Traits = std::char_traits<char>]’:
/usr/include/c++/4.2.1/bits/ostream_insert.h:96:   instantiated from ‘std::basic_ostream<_CharT, _Traits>& std::__ostream_insert(std::basic_ostream<_CharT, _Traits>&, const _CharT*, std::streamsize) [with _CharT = char, _Traits = std::char_traits<char>]’
/usr/include/c++/4.2.1/bits/basic_string.h:2414:   instantiated from ‘std::basic_ostream<_CharT, _Traits>& std::operator<<(std::basic_ostream<_CharT, _Traits>&, const std::basic_string<_CharT, _Traits, _Alloc>&) [with _CharT = char, _Traits = std::char_traits<char>, _Alloc = std::allocator<char>]’
/Users/luca/Software/ros/common/yaml_cpp/build/yaml-cpp-0.2.5/src/token.h:67:   instantiated from here
/usr/include/c++/4.2.1/bits/ostream_insert.h:62: error: invalid use of incomplete type ‘struct std::basic_ostream<char, std::char_traits<char> >’
/usr/include/c++/4.2.1/iosfwd:64: error: declaration of ‘struct std::basic_ostream<char, std::char_traits<char> >’
/usr/include/c++/4.2.1/bits/ostream_insert.h:64: error: invalid use of incomplete type ‘struct std::basic_ostream<char, std::char_traits<char> >’
/usr/include/c++/4.2.1/iosfwd:64: error: declaration of ‘struct std::basic_ostream<char, std::char_traits<char> >’
/usr/include/c++/4.2.1/bits/ostream_insert.h:67: error: invalid use of incomplete type ‘struct std::basic_ostream<char, std::char_traits<char> >’
/usr/include/c++/4.2.1/iosfwd:64: error: declaration of ‘struct std::basic_ostream<char, std::char_traits<char> >’
/usr/include/c++/4.2.1/bits/ostream_insert.h:70: error: invalid use of incomplete type ‘struct std::basic_ostream<char, std::char_traits<char> >’
/usr/include/c++/4.2.1/iosfwd:64: error: declaration of ‘struct std::basic_ostream<char, std::char_traits<char> >’
/usr/include/c++/4.2.1/bits/ostream_insert.h:70: error: invalid use of incomplete type ‘struct std::basic_ostream<char, std::char_traits<char> >’
/usr/include/c++/4.2.1/iosfwd:64: error: declaration of ‘struct std::basic_ostream<char, std::char_traits<char> >’
/usr/include/c++/4.2.1/bits/ostream_insert.h: In function ‘void std::__ostream_write(std::basic_ostream<_CharT, _Traits>&, const _CharT*, std::streamsize) [with _CharT = char, _Traits = std::char_traits<char>]’:
/usr/include/c++/4.2.1/bits/ostream_insert.h:98:   instantiated from ‘std::basic_ostream<_CharT, _Traits>& std::__ostream_insert(std::basic_ostream<_CharT, _Traits>&, const _CharT*, std::streamsize) [with _CharT = char, _Traits = std::char_traits<char>]’
/usr/include/c++/4.2.1/bits/basic_string.h:2414:   instantiated from ‘std::basic_ostream<_CharT, _Traits>& std::operator<<(std::basic_ostream<_CharT, _Traits>&, const std::basic_string<_CharT, _Traits, _Alloc>&) [with _CharT = char, _Traits = std::char_traits<char>, _Alloc = std::allocator<char>]’
/Users/luca/Software/ros/common/yaml_cpp/build/yaml-cpp-0.2.5/src/token.h:67:   instantiated from here
/usr/include/c++/4.2.1/bits/ostream_insert.h:50: error: invalid use of incomplete type ‘struct std::basic_ostream<char, std::char_traits<char> >’
/usr/include/c++/4.2.1/iosfwd:64: error: declaration of ‘struct std::basic_ostream<char, std::char_traits<char> >’
/usr/include/c++/4.2.1/bits/ostream_insert.h:52: error: invalid use of incomplete type ‘struct std::basic_ostream<char, std::char_traits<char> >’
/usr/include/c++/4.2.1/iosfwd:64: error: declaration of ‘struct std::basic_ostream<char, std::char_traits<char> >’
/usr/include/c++/4.2.1/bits/ostream_insert.h:54: error: invalid use of incomplete type ‘struct std::basic_ostream<char, std::char_traits<char> >’
/usr/include/c++/4.2.1/iosfwd:64: error: declaration of ‘struct std::basic_ostream<char, std::char_traits<char> >’
/usr/include/c++/4.2.1/bits/ostream_insert.h:54: error: invalid use of incomplete type ‘struct std::basic_ostream<char, std::char_traits<char> >’
/usr/include/c++/4.2.1/iosfwd:64: error: declaration of ‘struct std::basic_ostream<char, std::char_traits<char> >’
make[3]: *** [CMakeFiles/yaml-cpp.dir/src/tag.cpp.o] Error 1
make[2]: *** [CMakeFiles/yaml-cpp.dir/all] Error 2
make[1]: *** [all] Error 2
make: *** [yaml-cpp] Error 2

Does anyone know a fix?
Thanks!

Originally posted by LucaGhera on ROS Answers with karma: 128 on 2011-08-13
Post score: 0

Original comments
Comment by LucaGhera on 2011-08-15:
@ftoote Where can I find some instructions for installing nvidia-cg-toolkit? I downloaded and installed it but no progress!
Comment by LucaGhera on 2011-08-15:
@ftoote Hi, thanks but i didn't find a solution. Now I add the same problem when I run rosmake in the yaml_cpp folder. Instead, when I run rosmake in the rviz folder it reports a different error about Ogre: BUILD FAILED: Plugin_CgProgramManager.so not created.  Is nvidia-cg-toolkit installed?
Comment by AHornung on 2011-08-13:
I would suggest to add "OSX" and "Lion" to the question title as it seems like these are problem specific for that OS. Maybe this ros-users mailing list thread helps you further? http://ros-users.122217.n3.nabble.com/progress-on-ROS-on-OS-X-td3210013.html

A:

I am guessing you figured this out already, but for others.
Change your common_rosdeps/rosdep.yaml file so that yaml-cpp isn't satisfied by macports or homebrew instead of built from source.
Homebrew patch:
diff -r 6d4935c374bf rosdep.yaml
--- a/rosdep.yaml   Wed Jul 27 18:19:09 2011 -0700
+++ b/rosdep.yaml   Thu Aug 25 17:56:56 2011 -0500
@@ -38,6 +45,10 @@
       uri: 'https://kforge.ros.org/rosrelease/viewvc/sourcedeps/yaml-cpp/yaml-cpp-0.2.5.rdmanifest'
       md5sum: f7fb81fd4a2fbd5022daa7686e816359
   osx:
+    lion:
+      homebrew:
+        packages: [ yaml-cpp ]
+        depends: [ yaml ]
     source:
       uri: 'https://kforge.ros.org/rosrelease/viewvc/sourcedeps/yaml-cpp/yaml-cpp-cmake-0.2.5.rdmanifest'
       md5sum: 863fb3b7e5b5f1e22ff1365de6e66b34

A macports patch might look something like this:
diff -r 6d4935c374bf rosdep.yaml
--- a/rosdep.yaml   Wed Jul 27 18:19:09 2011 -0700
+++ b/rosdep.yaml   Thu Aug 25 17:56:56 2011 -0500
@@ -38,6 +45,10 @@
       uri: 'https://kforge.ros.org/rosrelease/viewvc/sourcedeps/yaml-cpp/yaml-cpp-0.2.5.rdmanifest'
       md5sum: f7fb81fd4a2fbd5022daa7686e816359
   osx:
+    lion:
+      macports:
+        packages: [ yaml-cpp ]
+        depends: [ yaml ]
     source:
       uri: 'https://kforge.ros.org/rosrelease/viewvc/sourcedeps/yaml-cpp/yaml-cpp-cmake-0.2.5.rdmanifest'
       md5sum: 863fb3b7e5b5f1e22ff1365de6e66b34

But might need some adjustment.

Originally posted by William with karma: 17335 on 2011-09-04
This answer was ACCEPTED on the original site
Post score: 1

