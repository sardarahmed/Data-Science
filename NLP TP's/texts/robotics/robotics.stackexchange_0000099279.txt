Q:

Autoware car following issue using Open Planner

Hi all,
I am trying to do some field test using the Autoware 1.13 Release + Open Planner. I would like test the car following scenario. The leading vehicle is travelling at 3m/s. The ego-vehicle is controlled using the Autoware+open planner. The parameters used for local planning are as below:

The ego-vehicle did not try to maintain a safe car-following distance (I assume it will maintain a safe gap with the same velocity with the leading vehicle). Instead, It approached the leading vehicle and made a hard brake to a full stop. Here is a video showing the process (sorry for the low resolution).
I am using default values for Internal ACC parameters as shown below:

And yes I am using pure pursuit to track the trajectory, the parameters used for pure pursuit are as below:

Is this caused by improper setting of some parameters? Any comments and suggestions are appreciated. Thanks!

Originally posted by yougeyxt on ROS Answers with karma: 9 on 2021-06-15
Post score: 0

Original comments
Comment by yougeyxt on 2021-06-15:
Hi @Hatem, could you please take a look on this? Thanks :)!
Comment by Hatem on 2021-06-16:
what is the value of "enableinternalACC" parameter?
what controller are you using? pure pursuit ?
Comment by yougeyxt on 2021-06-16:
Hi @Hatem, I did not find the "enableinternalACC" parameter in the code (Am I using the right version of the open planner for Autoware 1.13 release?). But I find the "use_internal_acc" parameter and it is set as False. I have uploaded the screenshot of parameters regarding to Internal ACC parameters in the main content (it seems I cannot upload figures in the comment).
And yes, I am using pure pursuit to track the trajectory and the parameters used in pure pursuit is uploaded above.
Thanks :)
Comment by yougeyxt on 2021-06-16:
Hi Hatem,
The line 627 and 657 in the file common/op_planner/src/DecisionMaker.cpp (I am using the branch openplanner.1.13 seems should be commented out? Is these two lines causing problems? The two lines of code are: desiredVelocity = 0; //for CARLA

A:

If you set use_internal_acc to False, you shouldn't use pure pursuit, the stop go behavior is the expected behavior in this case. and you need to use another controller such as op_waypoint_follower.
if you want to use pure_pursuit, set use_internal_acc to True, and tune values (PushRatio, acceleration, deceleration) to adjust how smooth you want to follow other vehicles.

Originally posted by Hatem with karma: 443 on 2021-06-17
This answer was ACCEPTED on the original site
Post score: 0

Original comments
Comment by yougeyxt on 2021-06-17:
Got it! Could you please confirm that lines 627 and 657 in DecisionMaker.cpp should be commented out? It seems like a bug to me.
Comment by Hatem on 2021-06-17:
commenting them will raise another issue,
when you enable use_internal_acc "UpdateVelocityDirectlyToTrajectorySmooth" will be called and disabling it will lead to calling "UpdateVelocityDirectlyToTrajectory"
you can try to comment them and try, it is opensource !
Comment by yougeyxt on 2021-06-17:
Sure thing, just want to double-check it :) thanks a lot for the detailed answer!

