Q:

Unable to load ROS2 workspace into CLion

I've been trying to get Ros2 to work with my copy of CLion using this guide on the Discussion Forums, but have been having no luck. I was wondering if there were more up-to-date instructions, since these were written in 2017. Or if I'm inadvertently messing something up. Probably the latter.
Before we start, this is all on Ubuntu version 18.04 LTE, running on a Lenovo ThinkPad P52.
So first off, the step for compilation seems to have a couple stderrors for me. I don't think they're the cause of my pain, but I'm a bit new to this, so who knows!

This code block was moved to the following github gist:
https://gist.github.com/answers-se-migration-openrobotics/dde06afe63091e2444be2afd40bf39a4

Second, he has me create a top-level CMakeLists.txt file:
add_subdirectory(src/ament/googletest/googlemock)
add_subdirectory(src/ament/googletest/googletest)
add_subdirectory(src/ament/uncrustify_vendor)
add_subdirectory(src/eProsima/Fast-CDR)
add_subdirectory(src/eProsima/Fast-CDR/src/cpp)
add_subdirectory(src/eProsima/Fast-CDR/test)
add_subdirectory(src/osrf/osrf_testing_tools_cpp/osrf_testing_tools_cpp)
add_subdirectory(src/osrf/osrf_testing_tools_cpp/osrf_testing_tools_cpp/src)
add_subdirectory(src/osrf/osrf_testing_tools_cpp/osrf_testing_tools_cpp/src/memory_tools)
add_subdirectory(src/osrf/osrf_testing_tools_cpp/osrf_testing_tools_cpp/src/test_runner)
add_subdirectory(src/osrf/osrf_testing_tools_cpp/osrf_testing_tools_cpp/test)
add_subdirectory(src/osrf/osrf_testing_tools_cpp/osrf_testing_tools_cpp/test/cmake)
add_subdirectory(src/osrf/osrf_testing_tools_cpp/osrf_testing_tools_cpp/test/memory_tools)
add_subdirectory(src/osrf/osrf_testing_tools_cpp/osrf_testing_tools_cpp/test/test_runner)
add_subdirectory(src/osrf/osrf_testing_tools_cpp/test_osrf_testing_tools_cpp)
add_subdirectory(src/ros2/ament_cmake_ros/ament_cmake_ros)
add_subdirectory(src/ros2/common_interfaces/actionlib_msgs)
add_subdirectory(src/ros2/common_interfaces/common_interfaces)
add_subdirectory(src/ros2/common_interfaces/diagnostic_msgs)
add_subdirectory(src/ros2/common_interfaces/geometry_msgs)
add_subdirectory(src/ros2/common_interfaces/nav_msgs)
add_subdirectory(src/ros2/common_interfaces/sensor_msgs)
add_subdirectory(src/ros2/common_interfaces/shape_msgs)
add_subdirectory(src/ros2/common_interfaces/std_msgs)
add_subdirectory(src/ros2/common_interfaces/std_srvs)
add_subdirectory(src/ros2/common_interfaces/stereo_msgs)
add_subdirectory(src/ros2/common_interfaces/trajectory_msgs)
add_subdirectory(src/ros2/common_interfaces/visualization_msgs)
add_subdirectory(src/ros2/console_bridge_vendor)
add_subdirectory(src/ros2/demos/composition)
add_subdirectory(src/ros2/demos/demo_nodes_cpp)
add_subdirectory(src/ros2/demos/demo_nodes_cpp_native)
add_subdirectory(src/ros2/demos/dummy_robot/dummy_map_server)
add_subdirectory(src/ros2/demos/dummy_robot/dummy_robot_bringup)
add_subdirectory(src/ros2/demos/dummy_robot/dummy_sensors)
add_subdirectory(src/ros2/demos/image_tools)
add_subdirectory(src/ros2/demos/intra_process_demo)
add_subdirectory(src/ros2/demos/lifecycle)
add_subdirectory(src/ros2/demos/logging_demo)
add_subdirectory(src/ros2/demos/pendulum_control)
add_subdirectory(src/ros2/demos/pendulum_msgs)
add_subdirectory(src/ros2/example_interfaces)
add_subdirectory(src/ros2/examples/rclcpp/minimal_action_client)
add_subdirectory(src/ros2/examples/rclcpp/minimal_action_server)
add_subdirectory(src/ros2/examples/rclcpp/minimal_client)
add_subdirectory(src/ros2/examples/rclcpp/minimal_composition)
add_subdirectory(src/ros2/examples/rclcpp/minimal_publisher)
add_subdirectory(src/ros2/examples/rclcpp/minimal_service)
add_subdirectory(src/ros2/examples/rclcpp/minimal_subscriber)
add_subdirectory(src/ros2/examples/rclcpp/minimal_timer)
add_subdirectory(src/ros2/geometry2/geometry2)
add_subdirectory(src/ros2/geometry2/geometry_experimental)
add_subdirectory(src/ros2/geometry2/test_tf2)
add_subdirectory(src/ros2/geometry2/tf2)
add_subdirectory(src/ros2/geometry2/tf2_bullet)
add_subdirectory(src/ros2/geometry2/tf2_eigen)
add_subdirectory(src/ros2/geometry2/tf2_geometry_msgs)
add_subdirectory(src/ros2/geometry2/tf2_kdl)
add_subdirectory(src/ros2/geometry2/tf2_msgs)
add_subdirectory(src/ros2/geometry2/tf2_py)
add_subdirectory(src/ros2/geometry2/tf2_ros)
add_subdirectory(src/ros2/geometry2/tf2_sensor_msgs)
add_subdirectory(src/ros2/geometry2/tf2_tools)
add_subdirectory(src/ros2/kdl_parser/kdl_parser)
add_subdirectory(src/ros2/kdl_parser/kdl_parser_py)
add_subdirectory(src/ros2/launch/apex_rostest/apex_launchtest_cmake)
add_subdirectory(src/ros2/launch/launch_testing)
add_subdirectory(src/ros2/libyaml_vendor)
add_subdirectory(src/ros2/message_filters)
add_subdirectory(src/ros2/orocos_kinematics_dynamics/orocos_kdl)
add_subdirectory(src/ros2/orocos_kinematics_dynamics/orocos_kdl/doc)
add_subdirectory(src/ros2/orocos_kinematics_dynamics/orocos_kdl/examples)
add_subdirectory(src/ros2/orocos_kinematics_dynamics/orocos_kdl/models)
add_subdirectory(src/ros2/orocos_kinematics_dynamics/orocos_kdl/src)
add_subdirectory(src/ros2/orocos_kinematics_dynamics/orocos_kdl/tests)
add_subdirectory(src/ros2/orocos_kinematics_dynamics/python_orocos_kdl)
add_subdirectory(src/ros2/poco_vendor)
add_subdirectory(src/ros2/rclcpp/rclcpp)
add_subdirectory(src/ros2/rclcpp/rclcpp_action)
add_subdirectory(src/ros2/rclcpp/rclcpp_lifecycle)
add_subdirectory(src/ros2/rcl_interfaces/action_msgs)
add_subdirectory(src/ros2/rcl_interfaces/builtin_interfaces)
add_subdirectory(src/ros2/rcl_interfaces/composition_interfaces)
add_subdirectory(src/ros2/rcl_interfaces/lifecycle_msgs)
add_subdirectory(src/ros2/rcl_interfaces/rcl_interfaces)
add_subdirectory(src/ros2/rcl_interfaces/rosgraph_msgs)
add_subdirectory(src/ros2/rcl_interfaces/test_msgs)
add_subdirectory(src/ros2/rcl_logging/rcl_logging_log4cxx)
add_subdirectory(src/ros2/rcl_logging/rcl_logging_noop)
add_subdirectory(src/ros2/rclpy/rclpy)
add_subdirectory(src/ros2/rcl/rcl)
add_subdirectory(src/ros2/rcl/rcl_action)
add_subdirectory(src/ros2/rcl/rcl_lifecycle)
add_subdirectory(src/ros2/rcl/rcl/test)
add_subdirectory(src/ros2/rcl/rcl_yaml_param_parser)
add_subdirectory(src/ros2/rcpputils)
add_subdirectory(src/ros2/rcutils)
add_subdirectory(src/ros2/realtime_support/rttest)
add_subdirectory(src/ros2/realtime_support/rttest/examples)
add_subdirectory(src/ros2/realtime_support/tlsf_cpp)
add_subdirectory(src/ros2/rmw_connext/rmw_connext_cpp)
add_subdirectory(src/ros2/rmw_connext/rmw_connext_dynamic_cpp)
add_subdirectory(src/ros2/rmw_connext/rmw_connext_shared_cpp)
add_subdirectory(src/ros2/rmw_fastrtps/rmw_fastrtps_cpp)
add_subdirectory(src/ros2/rmw_fastrtps/rmw_fastrtps_dynamic_cpp)
add_subdirectory(src/ros2/rmw_fastrtps/rmw_fastrtps_shared_cpp)
add_subdirectory(src/ros2/rmw_implementation/rmw_implementation)
add_subdirectory(src/ros2/rmw_opensplice/rmw_opensplice_cpp)
add_subdirectory(src/ros2/rmw/rmw)
add_subdirectory(src/ros2/rmw/rmw_implementation_cmake)
add_subdirectory(src/ros2/rmw/rmw/test)
add_subdirectory(src/ros2/robot_state_publisher)
add_subdirectory(src/ros2/ros1_bridge)
add_subdirectory(src/ros2/rosidl_dds/rosidl_generator_dds_idl)
add_subdirectory(src/ros2/rosidl_defaults/rosidl_default_generators)
add_subdirectory(src/ros2/rosidl_defaults/rosidl_default_runtime)
add_subdirectory(src/ros2/rosidl_python/python_cmake_module)
add_subdirectory(src/ros2/rosidl_python/rosidl_generator_py)
add_subdirectory(src/ros2/rosidl/rosidl_adapter)
add_subdirectory(src/ros2/rosidl/rosidl_cmake)
add_subdirectory(src/ros2/rosidl/rosidl_generator_c)
add_subdirectory(src/ros2/rosidl/rosidl_generator_cpp)
add_subdirectory(src/ros2/rosidl/rosidl_parser)
add_subdirectory(src/ros2/rosidl/rosidl_typesupport_interface)
add_subdirectory(src/ros2/rosidl/rosidl_typesupport_introspection_c)
add_subdirectory(src/ros2/rosidl/rosidl_typesupport_introspection_cpp)
add_subdirectory(src/ros2/rosidl_typesupport_connext/connext_cmake_module)
add_subdirectory(src/ros2/rosidl_typesupport_connext/rosidl_typesupport_connext_c)
add_subdirectory(src/ros2/rosidl_typesupport_connext/rosidl_typesupport_connext_cpp)
add_subdirectory(src/ros2/rosidl_typesupport_fastrtps/fastrtps_cmake_module)
add_subdirectory(src/ros2/rosidl_typesupport_fastrtps/rosidl_typesupport_fastrtps_c)
add_subdirectory(src/ros2/rosidl_typesupport_fastrtps/rosidl_typesupport_fastrtps_cpp)
add_subdirectory(src/ros2/rosidl_typesupport_opensplice/opensplice_cmake_module)
add_subdirectory(src/ros2/rosidl_typesupport_opensplice/rosidl_typesupport_opensplice_c)
add_subdirectory(src/ros2/rosidl_typesupport_opensplice/rosidl_typesupport_opensplice_cpp)
add_subdirectory(src/ros2/rosidl_typesupport/rosidl_typesupport_c)
add_subdirectory(src/ros2/rosidl_typesupport/rosidl_typesupport_cpp)
add_subdirectory(src/ros2/rviz/rviz)
add_subdirectory(src/ros2/rviz/rviz2)
add_subdirectory(src/ros2/rviz/rviz2/test)
add_subdirectory(src/ros2/rviz/rviz2/test/tools)
add_subdirectory(src/ros2/rviz/rviz_assimp_vendor)
add_subdirectory(src/ros2/rviz/rviz_common)
add_subdirectory(src/ros2/rviz/rviz_default_plugins)
add_subdirectory(src/ros2/rviz/rviz_ogre_vendor)
add_subdirectory(src/ros2/rviz/rviz_rendering)
add_subdirectory(src/ros2/rviz/rviz_rendering_tests)
add_subdirectory(src/ros2/rviz/rviz/src)
add_subdirectory(src/ros2/rviz/rviz/src/image_view)
add_subdirectory(src/ros2/rviz/rviz/src/python_bindings)
add_subdirectory(src/ros2/rviz/rviz/src/python_bindings/shiboken)
add_subdirectory(src/ros2/rviz/rviz/src/python_bindings/sip)
add_subdirectory(src/ros2/rviz/rviz/src/rviz)
add_subdirectory(src/ros2/rviz/rviz/src/rviz/default_plugin)
add_subdirectory(src/ros2/rviz/rviz/src/test)
add_subdirectory(src/ros2/rviz/rviz_visual_testing_framework)
add_subdirectory(src/ros2/sros2/sros2_cmake)
add_subdirectory(src/ros2/system_tests/test_cli)
add_subdirectory(src/ros2/system_tests/test_cli_remapping)
add_subdirectory(src/ros2/system_tests/test_communication)
add_subdirectory(src/ros2/system_tests/test_rclcpp)
add_subdirectory(src/ros2/system_tests/test_security)
add_subdirectory(src/ros2/tinydir_vendor)
add_subdirectory(src/ros2/tinyxml2_vendor)
add_subdirectory(src/ros2/tinyxml_vendor)
add_subdirectory(src/ros2/tlsf/tlsf)
add_subdirectory(src/ros2/unique_identifier_msgs)
add_subdirectory(src/ros2/urdfdom)
add_subdirectory(src/ros2/urdfdom/urdf_parser)
add_subdirectory(src/ros2/urdfdom/urdf_parser/test)
add_subdirectory(src/ros2/urdfdom/urdf_parser/test/gtest)
add_subdirectory(src/ros2/urdf/urdf)
add_subdirectory(src/ros2/urdf/urdf_parser_plugin)
add_subdirectory(src/ros2/yaml_cpp_vendor)
add_subdirectory(src/ros/class_loader)
add_subdirectory(src/ros/class_loader/test)
add_subdirectory(src/ros/class_loader/test/fviz_case_study)
add_subdirectory(src/ros-perception/laser_geometry)
add_subdirectory(src/ros-planning/navigation_msgs/map_msgs)
add_subdirectory(src/ros-planning/navigation_msgs/move_base_msgs)
add_subdirectory(src/ros/pluginlib/pluginlib)
add_subdirectory(src/ros/resource_retriever/libcurl_vendor)
add_subdirectory(src/ros/resource_retriever/resource_retriever)
add_subdirectory(src/ros/resource_retriever/resource_retriever/test)
add_subdirectory(src/ros/ros_environment)
add_subdirectory(src/ros/urdfdom_headers)
add_subdirectory(src/ros/urdfdom_headers/urdf_exception)
add_subdirectory(src/ros/urdfdom_headers/urdf_model)
add_subdirectory(src/ros/urdfdom_headers/urdf_model_state)
add_subdirectory(src/ros/urdfdom_headers/urdf_sensor)
add_subdirectory(src/ros/urdfdom_headers/urdf_world)
add_subdirectory(src/ros-visualization/python_qt_binding)
add_subdirectory(src/ros-visualization/qt_gui_core/qt_dotgraph)
add_subdirectory(src/ros-visualization/qt_gui_core/qt_gui)
add_subdirectory(src/ros-visualization/qt_gui_core/qt_gui_app)
add_subdirectory(src/ros-visualization/qt_gui_core/qt_gui_core)
add_subdirectory(src/ros-visualization/qt_gui_core/qt_gui_cpp)
add_subdirectory(src/ros-visualization/qt_gui_core/qt_gui_cpp/src)
add_subdirectory(src/ros-visualization/qt_gui_core/qt_gui_cpp/src/qt_gui_cpp)
add_subdirectory(src/ros-visualization/qt_gui_core/qt_gui_cpp/src/qt_gui_cpp_shiboken)
add_subdirectory(src/ros-visualization/qt_gui_core/qt_gui_cpp/src/qt_gui_cpp_sip)
add_subdirectory(src/ros-visualization/qt_gui_core/qt_gui_py_common)
add_subdirectory(src/ros-visualization/rqt_console)
add_subdirectory(src/ros-visualization/rqt_msg)
add_subdirectory(src/ros-visualization/rqt_plot)
add_subdirectory(src/ros-visualization/rqt_publisher)
add_subdirectory(src/ros-visualization/rqt_py_console)
add_subdirectory(src/ros-visualization/rqt/rqt_gui_cpp)
add_subdirectory(src/ros-visualization/rqt/rqt_py_common)
add_subdirectory(src/ros-visualization/rqt_service_caller)
add_subdirectory(src/ros-visualization/rqt_shell)
add_subdirectory(src/ros-visualization/rqt_srv)
add_subdirectory(src/ros-visualization/rqt_top)

... and then I place this file in my ROS2 workspace (Appropriately named, ros2_ws):
jhassold@jhassold-ThinkPad-P52:~/ros2_ws$ ls .
build  CMakeLists.txt  install  log  ros2.repos  src

I'm then asked to comment out a line in src/ament/ament_cmake/ament_cmake_core/ament_cmake_uninstall_target-extras.cmake, so now my file looks like:
# Copyright 2015 Open Source Robotics Foundation, Inc.
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#     http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.

# copied from ament_cmake_core/ament_cmake_uninstall_target-extras.cmake

option(AMENT_CMAKE_UNINSTALL_TARGET
  "Generate an uninstall target to revert the effects of the install step" ON)

if(AMENT_CMAKE_UNINSTALL_TARGET)
  include(
    "${ament_cmake_core_DIR}/uninstall_target/ament_cmake_uninstall_target_append_uninstall_code.cmake")

  # create the install script from the template
  # ament_cmake_core/uninstall_target/ament_cmake_uninstall_target.cmake.in
  set(AMENT_CMAKE_UNINSTALL_TARGET_UNINSTALL_SCRIPT
    "${CMAKE_CURRENT_BINARY_DIR}/ament_cmake_uninstall_target/ament_cmake_uninstall_target.cmake")
  configure_file(
    "${ament_cmake_core_DIR}/uninstall_target/ament_cmake_uninstall_target.cmake.in"
    "${AMENT_CMAKE_UNINSTALL_TARGET_UNINSTALL_SCRIPT}"
    @ONLY
  )

  # register uninstall target to run generated CMake script
# add_custom_target(uninstall
#   COMMAND ${CMAKE_COMMAND} -P "${AMENT_CMAKE_UNINSTALL_TARGET_UNINSTALL_SCRIPT}")
endif()

After this, I divert from the guide a little bit. I do not have a file called ~/ros2_ws/build/rclcpp/cmake_build.sh, so I use the following commands to start CLion (stored in an .sh file, and called by the .desktop file for CLion):
#!/bin/bash

source ~/ros2_ws/install/local_setup.sh
sh ~/CLion/CLion-2018.3.4/clion-2018.3.4/bin/clion.sh

I also do not disable BUILD_TESTING since I thought that I was supposed to have BUILD_TESTING enabled when developing for ROS.
Lastly, I reload the CMake project in ros2_ws, and get the following output:
/usr/bin/cmake -DCMAKE_BUILD_TYPE=Debug -G "CodeBlocks - Unix Makefiles" /home/jhassold/ros2_ws
-- Found ament_cmake: 0.6.0 (/home/jhassold/ros2_ws/install/share/ament_cmake/cmake)
-- Using PYTHON_EXECUTABLE: /usr/bin/python3
-- Configuring Fast CDR
-- Version: 1.0.8
-- To change de version modify the file configure.ac
CMake Warning (dev) at CMakeLists.txt:5 (add_subdirectory):
  Policy CMP0013 is not set: Duplicate binary directories are not allowed.
  Run "cmake --help-policy CMP0013" for policy details.  Use the cmake_policy
  command to set the policy and suppress this warning.

  The binary directory

    /home/jhassold/ros2_ws/build/src/eProsima/Fast-CDR/src/cpp

  is already used to build a source directory.  This command uses it to build
  source directory

    /home/jhassold/ros2_ws/src/eProsima/Fast-CDR/src/cpp

  which can generate conflicting build files.  CMake does not support this
  use case but it used to work accidentally and is being allowed for
  compatibility.
This warning is for project developers.  Use -Wno-dev to suppress it.

CMake Error at src/eProsima/Fast-CDR/src/cpp/CMakeLists.txt:15 (include):
  include could not find load file:

    /home/jhassold/ros2_ws/cmake/dev/set_sources.cmake

CMake Error at src/eProsima/Fast-CDR/src/cpp/CMakeLists.txt:16 (include):
  include could not find load file:

    /home/jhassold/ros2_ws/cmake/dev/generate_msvc_libraries.cmake

CMake Error: File /home/jhassold/ros2_ws/include/Project/config.h.in does not exist.
CMake Error at src/eProsima/Fast-CDR/src/cpp/CMakeLists.txt:29 (configure_file):
  configure_file Problem configuring file

CMake Error at src/eProsima/Fast-CDR/src/cpp/CMakeLists.txt:52 (set_target_properties):
  set_target_properties called with incorrect number of arguments.

CMake Error at src/eProsima/Fast-CDR/src/cpp/CMakeLists.txt:53 (set_target_properties):
  set_target_properties called with incorrect number of arguments.

CMake Error: File /home/jhassold/ros2_ws/cmake/packaging/Config.cmake.in does not exist.
CMake Error at /usr/share/cmake-3.10/Modules/CMakePackageConfigHelpers.cmake:312 (configure_file):
  configure_file Problem configuring file
Call Stack (most recent call first):
  src/eProsima/Fast-CDR/src/cpp/CMakeLists.txt:181 (configure_package_config_file)

CMake Error at /usr/share/cmake-3.10/Modules/WriteBasicConfigVersionFile.cmake:40 (message):
  No VERSION specified for WRITE_BASIC_CONFIG_VERSION_FILE()
Call Stack (most recent call first):
  /usr/share/cmake-3.10/Modules/CMakePackageConfigHelpers.cmake:207 (write_basic_config_version_file)
  src/eProsima/Fast-CDR/src/cpp/CMakeLists.txt:186 (write_basic_package_version_file)

CMake Warning (dev) in CMakeLists.txt:
  No cmake_minimum_required command is present.  A line of code such as

    cmake_minimum_required(VERSION 3.10)

  should be added at the top of the file.  The version specified may be lower
  if you wish to support older CMake versions for this project.  For more
  information run "cmake --help-policy CMP0000".
This warning is for project developers.  Use -Wno-dev to suppress it.

-- Configuring incomplete, errors occurred!
See also "/home/jhassold/ros2_ws/build/CMakeFiles/CMakeOutput.log".

[Finished]

I'm at a loss. I feel like I'm missing something obvious, but for the life of me I just can't find it. If anyone has any leads on where to go from here, I'd greatly appreciate it. And hopefully this will help anyone else that's trying to get CLion and ROS2 to work with eachother.

Originally posted by jhassold on ROS Answers with karma: 50 on 2019-03-27
Post score: 1

A:

After significant fighting, I have not been able to successfully get the entire workspace into CLion. However, you can still work with packages individually by opening their respective CMakeLists.txt files as projects.
It's theoretically possible to open the entire workspace if there's a top-level CMakeLists.txt file. But I'm not sure how feasible that is to implement, given the amount of trouble I've had with it.

Originally posted by jhassold with karma: 50 on 2019-04-01
This answer was ACCEPTED on the original site
Post score: 1

