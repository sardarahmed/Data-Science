Q:

rosbridge /rosjs/typeStringFromTopic does not work

I call this service (/rosjs/typeStringFromTopic) with the following code:

var types=[]; 
con.callService('/rosjs/typeStringFromTopic', '[/mav2/fcu/mag]', function(rsp)
{

alert("here");

alert(rsp);

types.push(rsp);
});

My topic is not empty but I "here" is never alerted. There is the following error in my rosbridge terminal

Problem Problem Problem Problem Problem Problem Problem Problem Problem Problem 
Traceback (most recent call last):
File "/data/my_ros/rosbridge/bin/rosbridge.py", line 39, in handleFrameHelper
call = json.loads(frame)
File "/usr/lib/python2.7/json/init.py", line 326, in loads
return _default_decoder.decode(s)
File "/usr/lib/python2.7/json/decoder.py", line 366, in decode
obj, end = self.raw_decode(s, idx=_w(s, 0).end())
File "/usr/lib/python2.7/json/decoder.py", line 384, in raw_decode
raise ValueError("No JSON object could be decoded")
ValueError: No JSON object could be decoded
Problem Problem Problem Problem Problem Problem Problem Problem Problem Problem

Thank you for your help :)
Beno√Æt

Originally posted by BeuBeu on ROS Answers with karma: 56 on 2012-04-19
Post score: 0

A:

It looks like your issue is likely how you're passing the topic argument. ros.js can take proper JSON strings or (in newer versions) pure Javascript objects, which it will convert for you. Unfortunately, your current syntax is somewhat in-between. Either:
 '["/mav2/fcu/mag"]'

or the simpler and much preferable:
  ["/mav2/fcu/mag"]

should work.
Notice how answer.ros.org's highlighting turns the first example fully green because it's a string. The second example is preferred because its harder to mess up. It's just an array containing a single string. Also remember that Javascript has two types of quotes. So:
  "['/mav2/fcu/mag']"

and:
  ['/mav2/fcu/mag']

are also fine.
This example shows reading in all of the currently published topics and displaying their types.

Originally posted by tjay with karma: 461 on 2012-04-19
This answer was ACCEPTED on the original site
Post score: 0

