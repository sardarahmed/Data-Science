Q:

Publish a Gazebo message into a ROS topic?

I've been following this toturial (http://gazebosim.org/tutorials?tut=guided_i1) to create a pulgin in Gazebo and to be able to control it with ROS. Now i would like to publish the sensor scan data (that i think is only available as a Gazebo message ) into a ROS node. It is posible to edit this plugin to add this functionality?Is there any tutorial/resource/code explained that I can take a look to understand how it works?

Originally posted by Mansan on Gazebo Answers with karma: 68 on 2018-04-01
Post score: 0

A:

It is definitely possible to edit the plugin you already have. Another option is to use an already existing plugin in the gazebo_ros_pkgs library that publishes your laser data to a ROS topic. The plugin you are looking for is libgazebo_ros_laser.so. You can find the source code from here:
http://docs.ros.org/jade/api/gazebo_plugins/html/gazebo__ros__laser_8cpp_source.html

So you have two options here:

Modify your existing plugin to also have the functionality of advertising the laser scan data to a ROS topic by using the given source code as a reference.

Adding the existing gazebo_ros_laser plugin to your SDF file like so:
 
   0 0 -0.004645 1.5707 0 0
   true
   30
   
     
       
         32
         1
         -0.53529248
         0.18622663
       
     
     
       0.05
       70
       0.02
     
   
   
     /your/sensor/topic/name
     /your/frame/name
   
 

Notice the plugin tag at the end of the sensor tag. The libgazebo_ros_laser come inside the gazebo_ros_pkgs package which you probably already have installed.

Originally posted by Raskkii with karma: 376 on 2018-04-02
This answer was ACCEPTED on the original site
Post score: 1

Original comments
Comment by Mansan on 2018-04-02:
Thanks for answering!
I've been trying to solve it in the easy way, and its not working for me. I add the "libgazebo_ros_laser.so" , and set the topic and framename, but i canÂ´t see the rostopic. And I think that the problem is that Gazebo doesn't even try to load the plugin, because no matter what I write in the "filename" field, I don't get an error  which is weird. Any idea why this happends?
Anyway, the code of the plugin is being useful and maybe I can adapt my own gazebo plugi
Comment by Raskkii on 2018-04-02:
Can you launch Gazebo with --verbose option to possibly see more error messages?
Comment by Mansan on 2018-04-02:
Ok, I get the error message(gazebo cannot find the plugin).But I've tried with rosrun gazebo_ros gazebo, and when I add my model I can see the laserscan topic. The only thing is ,that I cannot run the .world (so the model doesn,t rotate ) but I think that it can be solved creating a launch file with my .world file, and then using roslaunch.
Comment by Raskkii on 2018-04-03:
To run a .world file you can just do rosrun gazebo gazebo_ros your.world. But you're right you can also use a .launch file for this.

