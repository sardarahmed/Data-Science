Q:

ros2 pkg list show cmake packages

Hello,
I have a ros2 workspace with both ament and cmake packages.
The command "ros2 pkg list" does not show cmake packages that I have built and installed. It only shows ament packages.
How do I get it to list cmake packages?
For the cmake packages, in package.xml, I use package version 3 and set buildtool_depend, buildtool_export_depend, and export/build_type to cmake.
I am assuming that is problem connected with failure of "ros2 launch package launch-file" failing on cmake packages. Have not tested the xacro "$(find package)" on cmake packages, but am assuming that would fail too.

Originally posted by ananya.muddu on ROS Answers with karma: 13 on 2020-01-16
Post score: 0

A:

In order to be detectable as an installed ROS package your package should do two things (which ament_cmake packages does automatically in the ament_package() function):

install an empty marker file named ${PROJECT_NAME} to share/ament_index/resource_index (see https://github.com/ament/ament_cmake/blob/83e1b8147e2eda7d805e45c163aea60230a4d160/ament_cmake_core/cmake/index/ament_index_register_package.cmake#L28-L29 and https://github.com/ament/ament_cmake/blob/83e1b8147e2eda7d805e45c163aea60230a4d160/ament_cmake_core/cmake/index/ament_index_register_package.cmake#L28-L29) and
install the package.xml file to share/${PROJECT_NAME} (see https://github.com/ament/ament_cmake/blob/83e1b8147e2eda7d805e45c163aea60230a4d160/ament_cmake_core/cmake/core/ament_package.cmake#L156-L158) which might not strictly be necessary for your use case but your package should do anyway.

In contrast to ROS 1 the presence of the marker file allows for more efficient queries what packages are installed and where.

Originally posted by Dirk Thomas with karma: 16276 on 2020-01-16
This answer was ACCEPTED on the original site
Post score: 1

Original comments
Comment by ananya.muddu on 2020-01-17:
Thanks for the fast response. I installed the the empty marker file to the directory ament_index/resource_index/packages/.

