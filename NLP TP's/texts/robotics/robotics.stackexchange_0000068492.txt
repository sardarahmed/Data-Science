Q:

Convert Raw Velodyne VLP16 pcap to bagFile

Hi,
I have some raw velodyne VLP16 data in a pcap file.  Is there a way to convert it to a ros bagFile?
Here is a link to the raw log file:  https://goo.gl/MJDfWA
Thanks,
Matt

Originally posted by Droter on ROS Answers with karma: 90 on 2015-07-07
Post score: 0

A:

There is preliminary VLP16 support in the ROS velodyne driver, but it is not yet released.
Update: VLP-16 support is now released as binary packages in both Indigo and Kinetic.
Since that version is not released, you would need to build it from source in a catkin workspace. (Ask if you don't know how to do that.)
Once you have built that driver in your catkin workspace, run these commands in separate terminal windows:
roscore

...
rosrun velodyne_driver velodyne_node _model:=VLP16 _pcap:=/your/pcap/path/data.pcap _read_once:=true

...
rosrun rosbag record -O your_vlp16_070815.bag /velodyne_packets

See the rosbag record documentation for other options and details.

Originally posted by joq with karma: 25443 on 2015-07-08
This answer was ACCEPTED on the original site
Post score: 5

Original comments
Comment by dwolfe on 2015-07-20:
I built my driver into my catkin workspace but after executing the first rosrun "rosrun velodyne_driver velodyne_node _model:=VLP16 _pcap:=/your/pcap/path/data.pcap _read_once:=true" it gives me a fatal error (Error opening Velodyne socket dump file). Any suggestions as to why?
Comment by joq on 2015-07-21:
Is the path to your PCAP file correct?
Comment by dwolfe on 2015-07-23:
yes that was the problem. Thanks. It seems like the last two commands should be run simultaneously. Is that True? In order to capture the whole pcap file? or does it not matter?
Is this only recording the velodyne packets? no points show up when i rosbag play the file in rviz
Comment by joq on 2015-07-23:
All three commands should be run in separate terminal windows. To get all the packets, you should probably start the velodyne_driver several seconds after starting rosbag.
Comment by dwolfe on 2015-07-30:
Once I have the bag file how can I view it?
Comment by joq on 2015-07-31:
Use rosbag play to publish /velodyne_packets, then use velodyne_pointcloud and rviz to view the results, as if using with the actual device.
Comment by Bill5785 on 2017-01-30:
After I run the second command, it says
"[ERROR] [1485795341.945746381]: unknown Velodyne LIDAR model: VLP16"
Do you have any idea?
Comment by joq on 2017-01-30:
Please open a new page to ask a new question.
Comment by Bill5785 on 2017-01-30:
Hi, I have posted the new question here http://answers.ros.org/question/253321/meet-error-when-implementing-velodyne_driver-command-for-vlp-16/
Can you help me
Comment by Bill5785 on 2017-02-07:
@joq Should there be /velodyne_pakcets in rostopic list?? after I run:
rosrun velodyne_driver velodyne_node _model:=VLP16 _pcap:=/your/pcap/path/data.pcap _read_once:=true

Comment by joq on 2017-02-08:
Yes, there should.
Comment by Pelacho on 2017-04-26:
Hi there, I got this in one window: end of file reached -- done reading.
but the recording windows remains: Recording to grabacion.bag. and never finish
I finish it manually and nothing appear when I rosplay it
Comment by sohel on 2017-11-13:
I am getting .bag.active file in my home directory. where is my .bag file
Comment by mathbeaudry on 2017-12-02:
I got the same result as Pelacho, what could we do with this ?
Comment by GuimingChen on 2020-03-20:
Hi, I was trying to do the same thing. But I realized that the recorded rosbag file has some missing frames compared with the pcap file. (I did make sure that I ran the record before start playing the pcap file) Is this expected? Is there a way to capture all the frames in pcap file?

