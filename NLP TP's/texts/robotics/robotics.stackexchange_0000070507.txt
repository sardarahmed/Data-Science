Q:

Third Party Release of Python Package

Hello,
Since I have a lot of python dependencies to manage, and I don't want to maintain all of the fork of these repositories just to add a file, I am currently experimenting with Third Party Release ( on indigo ), which is conceptually what I am trying to do anyway.
http://wiki.ros.org/bloom/Tutorials/ReleaseThirdParty
I am using a simple and stable python package for a first try : https://github.com/marshmallow-code/marshmallow
I managed to get my patches into the release repo, and do a bloom release properly :  https://github.com/asmodehn/marshmallow-rosrelease/tree/release/indigo/python-marshmallow
However it seems that catkin_make does something strange with the setup.py:
-- ==> add_subdirectory(marshmallow-rosrelease)
Traceback (most recent call last):
  File "/opt/ros/indigo/share/catkin/cmake/interrogate_setup_dot_py.py", line 253, in <module>
    main()
  File "/opt/ros/indigo/share/catkin/cmake/interrogate_setup_dot_py.py", line 244, in main
    exec(fh.read())
  File "<string>", line 24, in <module>
  File "<string>", line 14, in find_version
NameError: global name 're' is not defined
CMake Error at /opt/ros/indigo/share/catkin/cmake/safe_execute_process.cmake:11 (message):
  
  execute_process(/home/alexv/Projects/testws/build/catkin_generated/env_cached.sh
  "/usr/bin/python"
  "/opt/ros/indigo/share/catkin/cmake/interrogate_setup_dot_py.py"
  "python-marshmallow"
  "/home/alexv/Projects/testws/src/marshmallow-rosrelease/setup.py"
  "/home/alexv/Projects/testws/build/marshmallow-rosrelease/catkin_generated/setup_py_interrogation.cmake")
  returned error code 1
Call Stack (most recent call first):
  /opt/ros/indigo/share/catkin/cmake/catkin_python_setup.cmake:69 (safe_execute_process)
  marshmallow-rosrelease/CMakeLists.txt:5 (catkin_python_setup)

-- Configuring incomplete, errors occurred!

As a side note, running python setup.py install works fine, and even running build/marshmallow-rosrelease/catkin_generated/python_distutils_install.sh seems to work fine.
Thanks for any hint on what might be going wrong there.
Also if there is a third party release of a pip package that works somewhere, please point me to it so I can compare...
Cheers

Originally posted by asmodehn on ROS Answers with karma: 131 on 2015-11-21
Post score: 1

A:

Based on the output I'd say that your setup.py uses re but doesn't import it.
Also the setup.py used in catkin packages have some special considerations:
http://docs.ros.org/api/catkin/html/user_guide/setup_dot_py.html

Originally posted by William with karma: 17335 on 2015-11-22
This answer was ACCEPTED on the original site
Post score: 1

