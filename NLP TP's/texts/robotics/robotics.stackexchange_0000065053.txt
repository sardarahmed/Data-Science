Q:

Access ObstacleLayer Costmap2D in localplanner

Hi,
Is there a way I can access Costmap2D of a layer in the local planner? I saw this question here, but I couldnt get it to work. The only way I can access the costmap is though layered_costmap_, but it is protected.

Originally posted by aswin on ROS Answers with karma: 528 on 2015-01-09
Post score: 1

A:

I got confused with the CostmapLayer doxygen docs here which doesnt show inheritance from Costmap2D
std::vector<boost::shared_ptr<costmap_2d::Layer> >* plugins = costmap_ros_->getLayeredCostmap()->getPlugins();

for (std::vector<boost::shared_ptr<costmap_2d::Layer> >::iterator pluginp = plugins->begin(); pluginp != plugins->end(); ++pluginp) {

boost::shared_ptr<costmap_2d::Layer> plugin = *pluginp;

if(plugin->getName().find(layer_search_string_)!=std::string::npos) {
    boost::shared_ptr<costmap_2d::CostmapLayer> costmap;
    costmap = boost::static_pointer_cast<costmap_2d::CostmapLayer>(plugin);
    unsigned char* grid = costmap->getCharMap();

    // do sth with it

}

}

Originally posted by aswin with karma: 528 on 2015-01-09
This answer was ACCEPTED on the original site
Post score: 2

