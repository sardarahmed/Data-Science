Q:

Is there a way to determine IP address of publisher for each message

Hello,
I'm currently developing small system for monitoring and management of a mobile robot group in ROS.
One of system's features is reservation mechanism, which lets students reserve exclusive access to the robot - reserved robot only reacts to commands coming from that computer.
I want to base it on IP addresses of computers in laboratory.
Here comes my question: Is there a (ROS-based) way to determine IP address of publisher for each message coming to the robots from computers in the laboratory?

Originally posted by Creed on ROS Answers with karma: 11 on 2017-11-21
Post score: 1

A:

Hi,
Maybe I found a solution, not the pretiest, not the easiest, but it may work (but it's cpp only) :

You can find the IP of a ROS node by contacting the master (rosnode info my_node will return the ip of the node, with many other information)

According to The connection header documentation, the node currently sending data can be found in the connection header.

You can use Message event to get the connection header.

To manipulate Message event, you can check Passthrough Filter, just adapt the code to not let the message go through unless the IP is OK. Also check the message filter documentation.

The 3. and 4. are optional, if you can manage to get the connection header by an another way, or the message event by an another way.
It may be easier in Python but i'm not experimented enough in python to help.

Edit from Creed comment :
In CPP, use the cpp publisher tutorial / 2.4 MessageEvent to get message event.
for python check Creed's comment below

Originally posted by lmathieu with karma: 591 on 2017-11-21
This answer was ACCEPTED on the original site
Post score: 2

Original comments
Comment by Creed on 2017-11-21:
Thank you for directing me to the solution.
So finally I came up with this (based on simple publisher/subscriber tutorial):
def callback(data):
    callerid = data._connection_header['callerid']
    master = rosgraph.Master('listener')
    ip = master.lookupNode(callerid)
    print(ip)

Comment by lmathieu on 2017-11-21:
Nice, it's indeed easier in python, thanks for the python code :)

