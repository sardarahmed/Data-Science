Q:

Create new topic that copies odometry topic

Hi all,
I want to create a new topic that copies the odometry topic data in order to be able to reset the new topic.
#! /usr/bin/env python
import rospy
from sensor_msgs.msg import LaserScan
from geometry_msgs.msg import Twist
from nav_msgs.msg import Odometry

class reset_odometry:
    def __init__(self):

    rospy.init_node('reset_odometry', anonymous=False)
    self.sub = rospy.Subscriber ('/marvin/diff_drive_controller/odom', Odometry, self.get_odom)
    rospy.sleep(0)
    self.pub = rospy.Publisher('new_pose', Odometry, queue_size=1)
    self.odom = ()
    rospy.spin()
def get_odom (self,msg):
        pose = Odometry()
    self.odom = pose
    print ("pose in callback",self.odom)

    
def main():
""" main function
"""
node = reset_odometry()

if __name__ == '__main__':
while not rospy.is_shutdown() :
    main()

The way I have written my code the values returned in the new topic are always zero. Any thoughts?

Originally posted by johnbryant on ROS Answers with karma: 13 on 2018-12-20
Post score: 0

A:

You never actually get the odometry value here :
def get_odom (self,msg):
    pose = Odometry()
    self.odom = pose
    print ("pose in callback",self.odom)

You only initialize the variable pose with the default constructor Odometry().
You would just have to do :
self.odom = msg

Originally posted by Delb with karma: 3907 on 2018-12-20
This answer was ACCEPTED on the original site
Post score: 0

Original comments
Comment by johnbryant on 2018-12-20:
Oh yes you are right. Sorry for asking such a trivial question. Thank you again.

