Q:

Setting position on heightmap creates offset between collision and visual

Hi,
when I set a position in my sdf for my heightmap I get an offset between collision and visual for the map as shown in the snapshot below. If I move the objects around I can see that the collision of the map has an offset. I'm able to move the objects into the mountains etc. All objects are affected by this not only the ones in the example snapshot.
When I set the y position in the collision and visual to 0 the offset is gone. This error is a new behaviour that wasn't there 2 month ago(I haven't changed anything on the sdf files since july) so this is probably a bug... I'm not sure when this behaviour first occured because I haven't worked with an heightmap for quite a while...
I'm working with ubuntu precise and gazebo 1.9.1 from the osrf repository(not from source)
Snapshot of the BUG:

Here is the SDF for the heightmap:
<?xml version='1.0'?>
<sdf version='1.4'>
<model name="my_map">
  <static>true</static>
  <link name="link">
    <collision name="collision">
      <geometry>
        <heightmap>
          <uri>file://path/to/image/terrain.png</uri>
          <size>1500 1500 450</size>
          <pos>0 -35 -71</pos>
        </heightmap>
      </geometry>
    </collision>
    <visual name="visual">
      <geometry>
        <heightmap>
          <texture>
            <diffuse>file://path/to/image/GrassFrozen.png</diffuse>
            <normal>file://path/to/image/flat_normal.png</normal>
            <size>50</size>
          </texture>
          <texture>
            <diffuse>file://path/to/image/Snow.png</diffuse>
            <normal>file://path/to/image/flat_normal.png</normal>
            <size>20</size>
          </texture>
          <texture>
            <diffuse>file://path/to/image/RockRough.png</diffuse>
            <normal>file://path/to/image/flat_normal.png</normal>
            <size>80</size>
          </texture>
          <blend>
            <min_height>-100</min_height>
            <fade_dist>5</fade_dist>
          </blend>
          <blend>
            <min_height>-50</min_height>
            <fade_dist>5</fade_dist>
          </blend>
          <uri>file://path/to/image/terrain.png</uri>
          <size>1500 1500 450</size>
          <pos>0 -35 -71</pos>
        </heightmap>
      </geometry>
    </visual>
  </link>
</model>

</sdf>

Originally posted by evilBiber on Gazebo Answers with karma: 881 on 2013-10-01
Post score: 1

A:

Hi evilBiber,
I'm looking at it right now. It might be a bug.
I filed a ticket to track the issue.
https://bitbucket.org/osrf/gazebo/issue/868/setting-position-on-heightmap-creates
Checkout the issue_868 branch that should fix the problem and let us know.

Originally posted by Carlos Agüero with karma: 626 on 2013-10-01
This answer was ACCEPTED on the original site
Post score: 1

Original comments
Comment by nkoenig on 2013-10-01:
Here is the bitbucket issue
Comment by evilBiber on 2013-10-04:
Hi, thanks for fixing this problem so fast :D. I can't test it right now because I am not working with source Version of gazebo so I just changed my image ;) if you need testing I can compile/install gazebo from source but the fix looks reasonable THX. I mark the question as  solved next time I will post such reposts directly on Bitbucket ;)
Comment by evilBiber on 2013-10-04:
Hi, thanks for fixing this problem so fast :D
Comment by evilBiber on 2013-10-04:
Hi, thanks for fixing this problem so fast :D
Comment by Carlos Agüero on 2013-10-08:
No problem evilBer. This patch will appear in the next gazebo version (2.0.0). Just confirm us that the problem is solved when you have a chance.

