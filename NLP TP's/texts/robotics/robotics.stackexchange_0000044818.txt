Q:

Problem with wiimote, summit and nodes

Hi,
I have a Summit with ROS electric, and I have the drivers for wiimote. I created a package for using the wiimote with turtlesim (http://www.ros.org/wiki/wiimote/Tutorials/WritingTeleopNode), and everything works properly.
Now, I want to control the Summit with the wiimote. I have created a package for it, following the same steps that I followed before for turtlesim, but changing the code in order to have SummitJoy instead of TeleopTurtle, etc. But when I do the "rosmake", the node is not built properly, so nothing appears in "bin/".
My CMakeLists.txt file looks like this (I have changed the "#" comment items into "//" here, because otherwise I had problems with the letter size, sorry for that):
cmake_minimum_required(VERSION 2.4.6) include($ENV{ROS_ROOT}/core/rosbuild/rosbuild.cmake)

// Set the build type. Options are:

// Coverage : w/ debug symbols, w/o optimization, w/ code-coverage

// Debug : w/ debug symbols, w/o optimization

// Release : w/o debug symbols, w/ optimization

// RelWithDebInfo : w/ debug symbols, w/ optimization

// MinSizeRel : w/o debug symbols, w/ optimization, stripped binaries

//set(ROS_BUILD_TYPE RelWithDebInfo)

rosbuild_init()

//set the default path for built executables to the "bin" directory

set(EXECUTABLE_OUTPUT_PATH ${PROJECT_SOURCE_DIR}/bin)

//set the default path for built libraries to the "lib" directory

set(LIBRARY_OUTPUT_PATH ${PROJECT_SOURCE_DIR}/lib)

//uncomment if you have defined messages

//rosbuild_genmsg()

//uncomment if you have defined services

//rosbuild_gensrv()

//common commands for building c++ executables and libraries

//rosbuild_add_library(${PROJECT_NAME} src/example.cpp)

//target_link_libraries(${PROJECT_NAME} another_library)

//rosbuild_add_boost_directories()

//rosbuild_link_boost(${PROJECT_NAME} thread)

//rosbuild_add_executable(example examples/example.cpp)

//target_link_libraries(example ${PROJECT_NAME})

rosbuild_add_executable(summit_teleop_wiimote src/summit_teleop_wiimote.cpp)

What I changed is everything that had something in common with turtlesim in the code (in the .cpp and .launch).
I actually get an error, when the "rosmake" is executing, it says that the execution goes out from "build/". It says that same thing several times. This is the error:
  root@summit-desktop:/opt/ros/electric/ros/summit_wiimote# rosmake 
[ rosmake ] No package specified.  Building ['summit_wiimote']                  
[ rosmake ] Packages requested are: ['summit_wiimote']                          
[ rosmake ] Logging to directory/home/summit/.ros/rosmake/rosmake_output-20121017-114930 
[ rosmake ] Expanded args ['summit_wiimote'] to: 
['summit_wiimote']             
[ rosmake ] Checking rosdeps compliance for packages summit_wiimote.  This may take a few seconds. 
Failed to find rosdep python-cwiid for package summit_wiimote on OS:ubuntu version:lucid 
WARNING: Rosdeps [u'python-cwiid'] could not be resolved 
Failed to find rosdep python-cwiid for package summit_wiimote on OS:ubuntu version:lucid 
[ rosmake ] rosdep check failed to find system dependencies: python-cwiid       
[rosmake-1] Starting >>> rosbuild [ make ]                                      
[rosmake-1] Finished <<< rosbuild ROS_NOBUILD in package rosbuild 
 No Makefile in package rosbuild 
[rosmake-0] Starting >>> cpp_common [ make ]                                    
[rosmake-1] Starting >>> roslang [ make ]                                       
[rosmake-1] Finished <<< roslang ROS_NOBUILD in package roslang 
 No Makefile in package roslang 
[rosmake-0] Finished <<< cpp_common ROS_NOBUILD in package cpp_common           
[rosmake-1] Starting >>> roslib [ make ]                                        
[rosmake-0] Starting >>> roscpp_traits [ make ]                                 
[rosmake-0] Finished <<< roscpp_traits ROS_NOBUILD in package roscpp_traits     
[rosmake-0] Starting >>> rostime [ make ]                                       
[rosmake-1] Finished <<< roslib ROS_NOBUILD in package roslib                   
[rosmake-0] Finished <<< rostime ROS_NOBUILD in package rostime                 
[rosmake-0] Starting >>> roscpp_serialization [ make ]                          
[rosmake-0] Finished <<< roscpp_serialization ROS_NOBUILD in package roscpp_serialization 
[rosmake-1] Starting >>> xmlrpcpp [ make ]                                      
[rosmake-1] Finished <<< xmlrpcpp ROS_NOBUILD in package xmlrpcpp               
[rosmake-0] Starting >>> rosconsole [ make ]                                    
[rosmake-0] Finished <<< rosconsole ROS_NOBUILD in package rosconsole           
[rosmake-1] Starting >>> std_msgs [ make ]                                      
[rosmake-1] Finished <<< std_msgs ROS_NOBUILD in package std_msgs               
[rosmake-0] Starting >>> rosgraph_msgs [ make ]                                 
[rosmake-0] Finished <<< rosgraph_msgs ROS_NOBUILD in package rosgraph_msgs     
[rosmake-1] Starting >>> rosclean [ make ]                                      
[rosmake-0] Starting >>> roscpp [ make ]                                        
[rosmake-1] Finished <<< rosclean ROS_NOBUILD in package rosclean               
[rosmake-0] Finished <<< roscpp ROS_NOBUILD in package roscpp                   
[rosmake-0] Starting >>> rospy [ make ]                                         
[rosmake-0] Finished <<< rospy ROS_NOBUILD in package rospy                     
[rosmake-1] Starting >>> rosgraph [ make ]                                      
[rosmake-1] Finished <<< rosgraph ROS_NOBUILD in package rosgraph               
[rosmake-1] Starting >>> rosparam [ make ]                                      
[rosmake-1] Finished <<< rosparam ROS_NOBUILD in package rosparam               
[rosmake-1] Starting >>> rosmaster [ make ]                                     
[rosmake-1] Finished <<< rosmaster ROS_NOBUILD in package rosmaster             
[rosmake-1] Starting >>> rosout [ make ]                                        
[rosmake-1] Finished <<< rosout ROS_NOBUILD in package rosout                   
[rosmake-1] Starting >>> rosunit [ make ]                                       
[rosmake-1] Finished <<< rosunit ROS_NOBUILD in package rosunit                 
[rosmake-1] Starting >>> std_srvs [ make ]                                      
[rosmake-0] Starting >>> roslaunch [ make ]                                     
[rosmake-0] Finished <<< roslaunch ROS_NOBUILD in package roslaunch 
 No Makefile in package roslaunch 
[rosmake-1] Finished <<< std_srvs ROS_NOBUILD in package std_srvs               
[rosmake-1] Starting >>> rostest [ make ]                                       
[rosmake-1] Finished <<< rostest ROS_NOBUILD in package rostest                 
[rosmake-1] Starting >>> topic_tools [ make ]                                   
[rosmake-1] Finished <<< topic_tools ROS_NOBUILD in package topic_tools         
[rosmake-1] Starting >>> rosbag [ make ]                                        
[rosmake-1] Finished <<< rosbag ROS_NOBUILD in package rosbag                   
[rosmake-1] Starting >>> rosbagmigration [ make ]                               
[rosmake-1] Finished <<< rosbagmigration ROS_NOBUILD in package rosbagmigration 
 No Makefile in package rosbagmigration 
[rosmake-1] Starting >>> geometry_msgs [ make ]                                 
[rosmake-1] Finished <<< geometry_msgs ROS_NOBUILD in package geometry_msgs     
[rosmake-1] Starting >>> sensor_msgs [ make ]                                   
[rosmake-1] Finished <<< sensor_msgs ROS_NOBUILD in package sensor_msgs         
[rosmake-1] Starting >>> wiimote [ make ]                                       
[rosmake-1] Finished <<< wiimote [PASS] [ 2.97 seconds ]                        
[rosmake-1] Starting >>> summit_wiimote [ make ]                                
[ rosmake ] Last 40 linesmmit_wiimote: 9.3 sec ]     [ 1 Active 29/30 Complete ] 
{------------------------------------------------------------------------------- 
  mkdir -p bin 
  cd build && cmake -Wdev -DCMAKE_TOOLCHAIN_FILE=`rospack find rosbuild`/rostoolchain.cmake  .. 
  [rosbuild] Building package summit_wiimote 
  [rosbuild] Including /opt/ros/electric/stacks/ros_comm/clients/rospy/cmake/rospy.cmake 
  [rosbuild] Including /opt/ros/electric/stacks/ros_comm/clients/roslisp/cmake/roslisp.cmake 
  [rosbuild] Including /opt/ros/electric/stacks/ros_comm/clients/cpp/roscpp/cmake/roscpp.cmake 
  -- Configuring done 
  -- Generating done 
  -- Build files have been written to: /opt/ros/electric/ros/summit_wiimote/build 
  cd build && make -l2 
  make[1]: se ingresa al directorio «/opt/ros/electric/ros/summit_wiimote/build» 
  make[2]: se ingresa al directorio «/opt/ros/electric/ros/summit_wiimote/build» 
  make[3]: se ingresa al directorio «/opt/ros/electric/ros/summit_wiimote/build» 
  make[3]: se sale del directorio «/opt/ros/electric/ros/summit_wiimote/build» 
  [  0%] Built target rospack_genmsg_libexe 
  make[3]: se ingresa al directorio «/opt/ros/electric/ros/summit_wiimote/build» 
  make[3]: se sale del directorio «/opt/ros/electric/ros/summit_wiimote/build» 
  [  0%] Built target rosbuild_precompile 
  make[3]: se ingresa al directorio «/opt/ros/electric/ros/summit_wiimote/build» 
  make[3]: se sale del directorio «/opt/ros/electric/ros/summit_wiimote/build» 
  make[3]: se ingresa al directorio «/opt/ros/electric/ros/summit_wiimote/build» 
  [100%] Building CXX object CMakeFiles/summit_teleop_wiimote.dir/src/summit_teleop_wiimote.o 
  /opt/ros/electric/ros/summit_wiimote/src/summit_teleop_wiimote.cpp: In member function ‘void SummitJoy::joyCallback(const boost::shared_ptr<const sensor_msgs::Joy_<std::allocator<void> > >&)’: 
  /opt/ros/electric/ros/summit_wiimote/src/summit_teleop_wiimote.cpp:83: error: no match for ‘operator=’ in ‘vel.geometry_msgs::Twist_<std::allocator<void> >::linear = (((SummitJoy*)this)->SummitJoy::l_scale_ * ((SummitJoy*)this)->SummitJoy::current_vel)’ 
  /opt/ros/electric/stacks/common_msgs/geometry_msgs/msg_gen/cpp/include/geometry_msgs/Vector3.h:21: note: candidates are: geometry_msgs::Vector3_<std::allocator<void> >& geometry_msgs::Vector3_<std::allocator<void> >::operator=(const geometry_msgs::Vector3_<std::allocator<void> >&) 
  /opt/ros/electric/ros/summit_wiimote/src/summit_teleop_wiimote.cpp:84: error: no match for ‘operator=’ in ‘vel.geometry_msgs::Twist_<std::allocator<void> >::angular = (((SummitJoy*)this)->SummitJoy::a_scale_ * ((double)((const boost::shared_ptr<const sensor_msgs::Joy_<std::allocator<void> > >*)joy)->boost::shared_ptr< <template-parameter-1-1> >::operator-> [with T = const sensor_msgs::Joy_<std::allocator<void> >]()->sensor_msgs::Joy_<std::allocator<void> >::axes.std::vector<_Tp, _Alloc>::operator[] [with _Tp = float, _Alloc = std::allocator<float>](((unsigned int)((SummitJoy*)this)->SummitJoy::angular_))))’ 
  /opt/ros/electric/stacks/common_msgs/geometry_msgs/msg_gen/cpp/include/geometry_msgs/Vector3.h:21: note: candidates are: geometry_msgs::Vector3_<std::allocator<void> >& geometry_msgs::Vector3_<std::allocator<void> >::operator=(const geometry_msgs::Vector3_<std::allocator<void> >&) 
  /opt/ros/electric/ros/summit_wiimote/src/summit_teleop_wiimote.cpp:89: error: no match for ‘operator=’ in ‘vel.geometry_msgs::Twist_<std::allocator<void> >::linear = ((-((SummitJoy*)this)->SummitJoy::l_scale_) * ((SummitJoy*)this)->SummitJoy::current_vel)’ 
  /opt/ros/electric/stacks/common_msgs/geometry_msgs/msg_gen/cpp/include/geometry_msgs/Vector3.h:21: note: candidates are: geometry_msgs::Vector3_<std::allocator<void> >& geometry_msgs::Vector3_<std::allocator<void> >::operator=(const geometry_msgs::Vector3_<std::allocator<void> >&) 
  /opt/ros/electric/ros/summit_wiimote/src/summit_teleop_wiimote.cpp:90: error: no match for ‘operator=’ in ‘vel.geometry_msgs::Twist_<std::allocator<void> >::angular = ((-((SummitJoy*)this)->SummitJoy::a_scale_) * ((double)((const boost::shared_ptr<const sensor_msgs::Joy_<std::allocator<void> > >*)joy)->boost::shared_ptr< <template-parameter-1-1> >::operator-> [with T = const sensor_msgs::Joy_<std::allocator<void> >]()->sensor_msgs::Joy_<std::allocator<void> >::axes.std::vector<_Tp, _Alloc>::operator[] [with _Tp = float, _Alloc = std::allocator<float>](((unsigned int)((SummitJoy*)this)->SummitJoy::angular_))))’ 
  /opt/ros/electric/stacks/common_msgs/geometry_msgs/msg_gen/cpp/include/geometry_msgs/Vector3.h:21: note: candidates are: geometry_msgs::Vector3_<std::allocator<void> >& geometry_msgs::Vector3_<std::allocator<void> >::operator=(const geometry_msgs::Vector3_<std::allocator<void> >&) 
  /opt/ros/electric/ros/summit_wiimote/src/summit_teleop_wiimote.cpp:98: error: no match for ‘operator=’ in ‘vel.geometry_msgs::Twist_<std::allocator<void> >::angular = (((SummitJoy*)this)->SummitJoy::a_scale_ * ((double)((const boost::shared_ptr<const sensor_msgs::Joy_<std::allocator<void> > >*)joy)->boost::shared_ptr< <template-parameter-1-1> >::operator-> [with T = const sensor_msgs::Joy_<std::allocator<void> >]()->sensor_msgs::Joy_<std::allocator<void> >::axes.std::vector<_Tp, _Alloc>::operator[] [with _Tp = float, _Alloc = std::allocator<float>](((unsigned int)((SummitJoy*)this)->SummitJoy::angular_))))’ 
  /opt/ros/electric/stacks/common_msgs/geometry_msgs/msg_gen/cpp/include/geometry_msgs/Vector3.h:21: note: candidates are: geometry_msgs::Vector3_<std::allocator<void> >& geometry_msgs::Vector3_<std::allocator<void> >::operator=(const geometry_msgs::Vector3_<std::allocator<void> >&) 
  make[3]: *** [CMakeFiles/summit_teleop_wiimote.dir/src/summit_teleop_wiimote.o] Error 1 
  make[3]: se sale del directorio «/opt/ros/electric/ros/summit_wiimote/build» 
  make[2]: *** [CMakeFiles/summit_teleop_wiimote.dir/all] Error 2 
  make[2]: se sale del directorio «/opt/ros/electric/ros/summit_wiimote/build» 
  make[1]: *** [all] Error 2 
  make[1]: se sale del directorio «/opt/ros/electric/ros/summit_wiimote/build» 
-------------------------------------------------------------------------------} 
[ rosmake ] Output from build of package summit_wiimote written to: 
[ rosmake ]    /home/summit/.ros/rosmake/rosmake_output-20121017-114930/summit_wiimote/build_output.log 
[rosmake-1] Finished <<< summit_wiimote [FAIL] [ 9.30 seconds ]                 
[ rosmake ] Halting due to failure in package summit_wiimote. 
[ rosmake ] Waiting for other threads to complete. 
[ rosmake ] Results:                                                            
[ rosmake ] Built 30 packages with 1 failures.                                  
[ rosmake ] Summary output to directory                                         
[ rosmake ] /home/summit/.ros/rosmake/rosmake_output-20121017-114930            
[ rosmake ] WARNING: Rosdep did not detect the following system dependencies as installed: python-cwiid Consider using --rosdep-install option or `rosdep install summit_wiimote` 

This are the lines that have errors:
Line 83:
vel.linear=l_scale_*current_vel;
Line 84:
vel.angular = a_scale_*joy->axes[angular_];
Line 89:
vel.linear=-l_scale_*current_vel;
Line 90:
vel.angular = -a_scale_*joy->axes[angular_];
Line 98:
vel.angular = a_scale_*joy->axes[angular_];
And here are two more lines that I think that might have something to do with the error:
vel_pub_ = nh_.advertise<geometry_msgs::Twist>("cmd_topic_", 1);
geometry_msgs::Twist vel;
Any ideas of what can be happening?
Thank you very much!

Originally posted by egoitzas on ROS Answers with karma: 46 on 2012-10-11
Post score: 0

Original comments
Comment by Lorenz on 2012-10-11:
Please provide more information. How does your CMakeLists.txt look like? Are you getting any errors? What exactly did you change? Make sure you have a look at http://ros.org/wiki/Support
Comment by Lorenz on 2012-10-16:
Please always copy-paste the exact error message. It provides useful information for us to infer what is going on. Have a look at http://ros.org/wiki/Support
Comment by egoitzas on 2012-10-16:
I pasted the error at the end of my question, it is in Spanish.
Comment by Lorenz on 2012-10-16:
this doesn't seem to be the complete error output. Please paste everything. It's really important. Otherwise it's hard to help.
Comment by egoitzas on 2012-10-16:
OK, I will paste everything, then. Thank you.
Comment by Lorenz on 2012-10-18:
Just some lines without context often don't help. We are really losing a lot of time because you do not show us the important parts of the code, e.g. declarations of the variables involved. Best if you copy-paste all relevant parts of the code. And please format the code (mark it and press Ctrl-K).

A:

Hi,
I finally found the problem. In the code, there is a variable which I was using as a single variable, and in fact it was a vector.
Thanks for your help!

Originally posted by egoitzas with karma: 46 on 2012-10-22
This answer was ACCEPTED on the original site
Post score: 0

