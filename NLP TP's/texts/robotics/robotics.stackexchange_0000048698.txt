Q:

Set RViz camera/view on fuerte

Hi,
I'm writing a RViz plugin which allows the user to play rosbags and record them.
During playing the rosbags I would like to make it possible to do a tracking shot in the scene. Therefore I have to set the current view in RViz.
Is there a possibility to do this programmatically?
There are some articles which say it is possible with a RViz plugin, but it's never explained anywhere.
If it is not possible in a single plugin, is it possible via librviz?
Thanks in advance, best regards, Josch.
EDIT:
The node should run on fuerte and Ubuntu 12.04 LTS.
EDIT 2:
New question: How do I get an instance from the VisualizationManager? Creating my own one requires a RenderPanel and a WindowManagerInterface-implementing class.

Originally posted by Josch on ROS Answers with karma: 230 on 2013-02-25
Post score: 3

Original comments
Comment by Stephane.M on 2013-02-25:
Hi, please mention your ROS version, and your ubuntu distribution. If you are in Groovy, I guess what you want already exist partly in the package rqt. Bests, Steph
Comment by Josch on 2013-02-25:
Hi, thanks for your answer. I added the versions to my post.
What features from rqt do you think could help me?

A:

There are multiple options:

Add a specialized view controller to your plugin (the most powerful option)
Use the animated view controller plugin to control the camera via ROS messages (not released yet): https://github.com/ros-visualization/rviz_animated_view_controller
Set the "target frame" to a special tf frame you create for that purpose
Use the C++ API (see VisualizationManager::getCurrentViewController, ViewController::setTargetFrame and ViewController:lookAt)

You will find more information in the tutorials and API docs via the ROS Wiki: http://www.ros.org/wiki/rviz

Originally posted by dgossow with karma: 1444 on 2013-02-26
This answer was ACCEPTED on the original site
Post score: 6

Original comments
Comment by Josch on 2013-02-26:
Thank you very much!
When using the custom ViewController, how can I tell RViz to use that ViewController?
And when using the C++ API, how can I get the current VisualizationManager? Are these static methods?
Using the target frame my orientation won't bind to the target frame's orientation. :-/
Comment by dgossow on 2013-02-27:
If your plugin is a Display, you can access the Visualization Manager via it's member vis_mananger_.
Apart from that, the API docs on http://ros.org/doc/fuerte/api/rviz/html/index.html are an excellent reference and will hopefully answer your questions.
Comment by Josch on 2013-03-04:
My plugin is a rviz::Panel plugin, but i just figured out it still has the vis_manager_ variable. Unfortunately it is not set during the hole runtime. Can I set the VisualizationManager and RViz will use it? Or can I get the original instance from somewhere?
Comment by Josch on 2013-03-05:
Does somebody know if getting the instance from the VisualizationManager used by RViz is possible from an rviz::Panel plugin?
Otherwise I will have to create a second plugin and do some service communication.
Comment by dgossow on 2013-03-06:
Panel::initialize populates vis_manager_ and then calls your onInitialize method: https://github.com/ros-visualization/rviz/blob/visualization-1.8/src/rviz/panel.cpp
Comment by Josch on 2013-03-06:
Thank you again. So I have to call initialize, since it is obviously not called. But I need to pass a VisualizationManager to the initialize function. Therefore I have to create a vis_manager inststance, which requires a RenderPanel and a WindowManagerInterface-implementing class, am I correct?
Comment by Josch on 2013-03-06:
I'm saying that because vis_manager_ accessing vis_manager_ in any way ended up in crashing RViz. So it must either be empty or not accessable from my classes.
Comment by dgossow on 2013-03-07:
You need to overwrite virtual void onInitialize() in you panel. Before that is called, vis_manager_ will not be initialized.
Comment by Josch on 2013-03-11:
Thank for you help, now it's working!

