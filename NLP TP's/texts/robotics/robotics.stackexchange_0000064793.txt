Q:

Failed to build package moveit_pr2 under indigo

Sorry if this is a total noob question.
I try to build the moveit_pr2 package under ROS indigo .and have cloned the following  packages  into <catkin_workspace>/src directory:
ivcon            pr2_controllers     realtime_tools
CMakeLists.txt   moveit_pr2          pr2_mechanism       ros_control
control_toolbox  pr2_common          pr2_mechanism_msgs

when I  built these packages ,i got following errors
lzm@ubuntu:~/ROS/catkin_ws$ catkin_make
Base path: /home/lzm/ROS/catkin_ws
Source space: /home/lzm/ROS/catkin_ws/src
Build space: /home/lzm/ROS/catkin_ws/build
Devel space: /home/lzm/ROS/catkin_ws/devel
Install space: /home/lzm/ROS/catkin_ws/install
####
#### Running command: "make cmake_check_build_system" in "/home/lzm/ROS/catkin_ws/build"
####
####
#### Running command: "make -j4 -l4" in "/home/lzm/ROS/catkin_ws/build"
####
[  0%] Built target ivcon
[  0%] Built target _controller_manager_msgs_generate_messages_check_deps_UnloadController
[  0%] [  0%] Built target _controller_manager_msgs_generate_messages_check_deps_SwitchController
Built target _controller_manager_msgs_generate_messages_check_deps_ListControllerTypes
[  0%] Built target _controller_manager_msgs_generate_messages_check_deps_LoadController
[  0%] [  0%] [  0%] Built target _controller_manager_msgs_generate_messages_check_deps_ReloadControllerLibraries
Built target std_msgs_generate_messages_py
Built target _controller_manager_msgs_generate_messages_check_deps_ControllerStatistics
[  0%] Built target _controller_manager_msgs_generate_messages_check_deps_ControllerState
[  0%] Built target std_msgs_generate_messages_lisp
[  0%] Built target std_msgs_generate_messages_cpp
[  0%] Built target _controller_manager_msgs_generate_messages_check_deps_ControllersStatistics
[  0%] Built target _controller_manager_msgs_generate_messages_check_deps_ListControllers
[  0%] Built target _pr2_mechanism_msgs_generate_messages_check_deps_SwitchControllerGoal
[  0%] Built target _pr2_mechanism_msgs_generate_messages_check_deps_ListControllers
[  0%] [  0%] Built target _pr2_mechanism_msgs_generate_messages_check_deps_ActuatorStatistics
Built target actionlib_msgs_generate_messages_py
[  0%] Built target _pr2_mechanism_msgs_generate_messages_check_deps_SwitchControllerFeedback
[  0%] [  0%] Built target _pr2_mechanism_msgs_generate_messages_check_deps_SwitchController
Built target _pr2_mechanism_msgs_generate_messages_check_deps_ControllerStatistics
[  0%] Built target _pr2_mechanism_msgs_generate_messages_check_deps_SwitchControllerActionGoal
[  0%] Built target _pr2_mechanism_msgs_generate_messages_check_deps_SwitchControllerResult
[  0%] Built target _pr2_mechanism_msgs_generate_messages_check_deps_SwitchControllerActionFeedback
[  0%] Built target _pr2_mechanism_msgs_generate_messages_check_deps_ListControllerTypes
[  0%] Built target _pr2_mechanism_msgs_generate_messages_check_deps_MechanismStatistics
[  0%] Built target _pr2_mechanism_msgs_generate_messages_check_deps_JointStatistics
[  0%] Built target _pr2_mechanism_msgs_generate_messages_check_deps_SwitchControllerAction
[  0%] Built target _pr2_mechanism_msgs_generate_messages_check_deps_LoadController
[  0%] Built target _pr2_mechanism_msgs_generate_messages_check_deps_ReloadControllerLibraries
[  0%] Built target actionlib_msgs_generate_messages_lisp
[  0%] [  0%] Built target _pr2_mechanism_msgs_generate_messages_check_deps_SwitchControllerActionResult
Built target actionlib_msgs_generate_messages_cpp
[  0%] Built target geometry_msgs_generate_messages_lisp
[  0%] Built target _pr2_mechanism_msgs_generate_messages_check_deps_UnloadController
[  0%] Built target _pr2_msgs_generate_messages_check_deps_LaserTrajCmd
[  0%] Built target _pr2_msgs_generate_messages_check_deps_LaserScannerSignal
[  0%] Built target _pr2_msgs_generate_messages_check_deps_DashboardState
[  0%] Built target _pr2_msgs_generate_messages_check_deps_BatteryServer2
[  0%] Built target _pr2_msgs_generate_messages_check_deps_BatteryState2
[  0%] Built target _pr2_msgs_generate_messages_check_deps_PowerBoardState
[  0%] Built target _pr2_msgs_generate_messages_check_deps_AccelerometerState
[  0%] Built target _pr2_msgs_generate_messages_check_deps_PressureState
[  0%] Built target _pr2_msgs_generate_messages_check_deps_PeriodicCmd
[  0%] Built target _pr2_msgs_generate_messages_check_deps_AccessPoint
[  0%] Built target _pr2_msgs_generate_messages_check_deps_SetPeriodicCmd
[  0%] Built target _pr2_msgs_generate_messages_check_deps_GPUStatus
[  0%] Built target _pr2_msgs_generate_messages_check_deps_BatteryServer
[  0%] Built target _pr2_msgs_generate_messages_check_deps_BatteryState
[  0%] Built target geometry_msgs_generate_messages_py
[  0%] Built target geometry_msgs_generate_messages_cpp
[  0%] Built target _pr2_msgs_generate_messages_check_deps_PowerState
[  0%] Built target _pr2_msgs_generate_messages_check_deps_SetLaserTrajCmd
[  0%] Built target trajectory_msgs_generate_messages_py
[  0%] Built target _pr2_controllers_msgs_generate_messages_check_deps_Pr2GripperCommandActionResult
[  0%] Built target _pr2_controllers_msgs_generate_messages_check_deps_Pr2GripperCommandAction
[  0%] Built target _pr2_controllers_msgs_generate_messages_check_deps_PointHeadActionResult
[  0%] Built target _pr2_controllers_msgs_generate_messages_check_deps_JointTrajectoryActionFeedback
[  0%] Built target _pr2_controllers_msgs_generate_messages_check_deps_QueryTrajectoryState
[  0%] Built target _pr2_controllers_msgs_generate_messages_check_deps_SingleJointPositionAction
[  0%] Built target _pr2_controllers_msgs_generate_messages_check_deps_PointHeadGoal
[  0%] Built target _pr2_controllers_msgs_generate_messages_check_deps_SingleJointPositionActionResult
[  0%] [  0%] Built target _pr2_controllers_msgs_generate_messages_check_deps_JointTrajectoryAction
Built target _pr2_controllers_msgs_generate_messages_check_deps_SingleJointPositionGoal
[  0%] Built target _pr2_controllers_msgs_generate_messages_check_deps_JointTrajectoryResult
[  0%] Built target _pr2_controllers_msgs_generate_messages_check_deps_PointHeadActionFeedback
[  0%] Built target _pr2_controllers_msgs_generate_messages_check_deps_JointTrajectoryFeedback
[  0%] Built target _pr2_controllers_msgs_generate_messages_check_deps_Pr2GripperCommandGoal
[  0%] Built target _pr2_controllers_msgs_generate_messages_check_deps_JointTrajectoryGoal
[  0%] Built target _pr2_controllers_msgs_generate_messages_check_deps_SingleJointPositionActionFeedback
[  0%] Built target _pr2_controllers_msgs_generate_messages_check_deps_QueryCalibrationState
[  0%] Built target _pr2_controllers_msgs_generate_messages_check_deps_JointTrajectoryActionGoal
[  0%] Built target _pr2_controllers_msgs_generate_messages_check_deps_JointControllerState
[  0%] Built target _pr2_controllers_msgs_generate_messages_check_deps_PointHeadResult
[  0%] Built target _pr2_controllers_msgs_generate_messages_check_deps_SingleJointPositionResult
[  0%] Built target _pr2_controllers_msgs_generate_messages_check_deps_Pr2GripperCommand
[  0%] Built target _pr2_controllers_msgs_generate_messages_check_deps_SingleJointPositionFeedback
[  0%] Built target _pr2_controllers_msgs_generate_messages_check_deps_JointTrajectoryActionResult
[  0%] Built target _pr2_controllers_msgs_generate_messages_check_deps_Pr2GripperCommandActionGoal
[  0%] Built target _pr2_controllers_msgs_generate_messages_check_deps_SingleJointPositionActionGoal
[  0%] Built target _pr2_controllers_msgs_generate_messages_check_deps_PointHeadFeedback
[  0%] Built target _pr2_controllers_msgs_generate_messages_check_deps_Pr2GripperCommandResult
[  0%] Built target _pr2_controllers_msgs_generate_messages_check_deps_JointTrajectoryControllerState
[  0%] Built target _pr2_controllers_msgs_generate_messages_check_deps_Pr2GripperCommandActionFeedback
[  0%] [  0%] Built target trajectory_msgs_generate_messages_cpp
Built target _pr2_controllers_msgs_generate_messages_check_deps_PointHeadAction
[  0%] [  0%] Built target _pr2_controllers_msgs_generate_messages_check_deps_PointHeadActionGoal
Built target trajectory_msgs_generate_messages_lisp
[  0%] [  0%] Built target realtime_tools
Built target _pr2_controllers_msgs_generate_messages_check_deps_Pr2GripperCommandFeedback
[  0%] [  0%] Built target roscpp_generate_messages_lisp
Built target roscpp_generate_messages_cpp
[  0%] Built target rosgraph_msgs_generate_messages_lisp
[  0%] Built target roscpp_generate_messages_py
[  0%] [  0%] Built target rosgraph_msgs_generate_messages_cpp
Built target rosgraph_msgs_generate_messages_py
[  0%] Built target control_toolbox_gencfg
[  0%] Built target actionlib_generate_messages_lisp
[  0%] Built target gtest
[  0%] Built target actionlib_generate_messages_cpp
[  0%] Built target _control_toolbox_generate_messages_check_deps_SetPidGains
[  0%] [  0%] Built target actionlib_generate_messages_py
Built target transmission_interface_parser
[  0%] [  0%] Built target tf_generate_messages_cpp
[  0%] Built target sensor_msgs_generate_messages_cpp
Built target tf_generate_messages_lisp
[  0%] Built target sensor_msgs_generate_messages_lisp
[  0%] [  0%] Built target tf2_msgs_generate_messages_cpp
Built target tf_generate_messages_py
[  0%] Built target sensor_msgs_generate_messages_py
[  0%] Built target tf2_msgs_generate_messages_lisp
[  0%] Built target tf2_msgs_generate_messages_py
[  1%] Built target pr2_mechanism_model
[  1%] Built target _ethercat_trigger_controllers_generate_messages_check_deps_MultiWaveform
[  1%] Built target _ethercat_trigger_controllers_generate_messages_check_deps_MultiWaveformTransition
[  1%] Built target _ethercat_trigger_controllers_generate_messages_check_deps_SetWaveform
[  1%] Built target _ethercat_trigger_controllers_generate_messages_check_deps_SetMultiWaveform
[  1%] Scanning dependencies of target pr2_mechanism_diagnostics
Building CXX object moveit_pr2/pr2_moveit_plugins/pr2_moveit_controller_manager/CMakeFiles/pr2_moveit_controller_manager.dir/src/pr2_moveit_controller_manager.cpp.o
[  1%] Built target pr2_moveit_arm_kinematics
[  2%] Building CXX object moveit_pr2/pr2_moveit_plugins/pr2_moveit_sensor_manager/CMakeFiles/pr2_moveit_sensor_manager.dir/src/pr2_moveit_sensor_manager.cpp.o
[  2%] Built target kinematic_model_tutorial
[  2%] Built target ros_api_tutorial
[  2%] Building CXX object pr2_mechanism/pr2_mechanism_diagnostics/CMakeFiles/pr2_mechanism_diagnostics.dir/src/controller_diagnostics.cpp.o
[  2%] Built target motion_planning_api_tutorial
[  2%] Built target move_group_interface_tutorial
[  2%] Built target planning_pipeline_tutorial
[  2%] Built target planning_scene_ros_api_tutorial
[  3%] Built target planning_scene_tutorial
[  3%] Built target state_display_tutorial
[  3%] Built target attached_body_tutorial
[  3%] Built target collision_contact_tutorial
[  4%] Built target interactivity_tutorial
[  4%] Built target pick_place_tutorial
[  4%] Building CXX object pr2_mechanism/pr2_controller_manager/CMakeFiles/controller_test.dir/test/controllers/test_controller.cpp.o
In file included from /home/lzm/ROS/catkin_ws/src/pr2_mechanism/pr2_mechanism_diagnostics/src/controller_diagnostics.cpp:36:0:
/home/lzm/ROS/catkin_ws/src/pr2_mechanism/pr2_mechanism_diagnostics/include/pr2_mechanism_diagnostics/controller_diagnostics.h:42:52: fatal error: pr2_mechanism_msgs/MechanismStatistics.h: No such file or directory
 #include <pr2_mechanism_msgs/MechanismStatistics.h>
                                                    ^
compilation terminated.
/home/lzm/ROS/catkin_ws/src/moveit_pr2/pr2_moveit_plugins/pr2_moveit_controller_manager/src/pr2_moveit_controller_manager.cpp:43:48: fatal error: pr2_mechanism_msgs/ListControllers.h: No such file or directory
 #include <pr2_mechanism_msgs/ListControllers.h>
                                                ^
compilation terminated.
/home/lzm/ROS/catkin_ws/src/moveit_pr2/pr2_moveit_plugins/pr2_moveit_sensor_manager/src/pr2_moveit_sensor_manager.cpp:43:50: fatal error: pr2_controllers_msgs/PointHeadAction.h: No such file or directory
 #include <pr2_controllers_msgs/PointHeadAction.h>
                                                  ^
compilation terminated.
In file included from /home/lzm/ROS/catkin_ws/src/pr2_mechanism/pr2_controller_manager/test/controllers/test_controller.cpp:1:0:
/home/lzm/ROS/catkin_ws/src/pr2_mechanism/pr2_controller_manager/test/controllers/test_controller.h:5:47: fatal error: pr2_mechanism_msgs/LoadController.h: No such file or directory
 #include <pr2_mechanism_msgs/LoadController.h>
                                               ^
compilation terminated.
make[2]: *** [pr2_mechanism/pr2_mechanism_diagnostics/CMakeFiles/pr2_mechanism_diagnostics.dir/src/controller_diagnostics.cpp.o] Error 1
make[1]: *** [pr2_mechanism/pr2_mechanism_diagnostics/CMakeFiles/pr2_mechanism_diagnostics.dir/all] Error 2
make[1]: *** Waiting for unfinished jobs....
make[2]: *** [moveit_pr2/pr2_moveit_plugins/pr2_moveit_controller_manager/CMakeFiles/pr2_moveit_controller_manager.dir/src/pr2_moveit_controller_manager.cpp.o] Error 1
make[1]: *** [moveit_pr2/pr2_moveit_plugins/pr2_moveit_controller_manager/CMakeFiles/pr2_moveit_controller_manager.dir/all] Error 2
make[2]: *** [moveit_pr2/pr2_moveit_plugins/pr2_moveit_sensor_manager/CMakeFiles/pr2_moveit_sensor_manager.dir/src/pr2_moveit_sensor_manager.cpp.o] Error 1
make[1]: *** [moveit_pr2/pr2_moveit_plugins/pr2_moveit_sensor_manager/CMakeFiles/pr2_moveit_sensor_manager.dir/all] Error 2
make[2]: *** [pr2_mechanism/pr2_controller_manager/CMakeFiles/controller_test.dir/test/controllers/test_controller.cpp.o] Error 1
make[1]: *** [pr2_mechanism/pr2_controller_manager/CMakeFiles/controller_test.dir/all] Error 2
make: *** [all] Error 2
Invoking "make" failed

it seems some head files are missing. I found all the source files in the src directory.
so I follow the CreatingMsgAndSrv tutorial ,try to  generate the missing head files.but it's not working.
Can anybody give me a hint?

Originally posted by iimmer on ROS Answers with karma: 1 on 2014-12-21
Post score: 0

Original comments
Comment by gvdhoorn on 2014-12-22:
Please use the formatting tools for console output (the little '101010' button on the bar). It makes things much easier to read.

A:

It looks like the CMakeLists needs a dependencies on catkin_EXPORTED_TARGETS for the executables and libraries.
The targets are getting built before the dependencies are generated.

In file included from /home/lzm/ROS/catkin_ws/src/pr2_mechanism/pr2_mechanism_diagnostics/src/controller_diagnostics.cpp:36:0:
/home/lzm/ROS/catkin_ws/src/pr2_mechanism/pr2_mechanism_diagnostics/include/pr2_mechanism_diagnostics/controller_diagnostics.h:42:52: fatal error: pr2_mechanism_msgs/MechanismStatistics.h: No such file or directory
#include <pr2_mechanism_msgs/MechanismStatistics.h>

That tells you the controller_diagnostics.h is unable to find the MechanismStatistics message definition. But the compiler tells us

Built target _pr2_mechanism_msgs_generate_messages_check_deps_MechanismStatistics

Which means it was built, so it's there.
If you change this line to your CMakeLists inside the pr2_mechanism_diagnostics/CMakeLists.txt file:

add_library(${PROJECT_NAME}
> src/controller_diagnostics.cpp
> src/joint_diagnostics.cpp)
> target_link_libraries(${PROJECT_NAME}
${catkin_LIBRARIES})

to

add_library(${PROJECT_NAME}
src/controller_diagnostics.cpp
src/joint_diagnostics.cpp)
target_link_libraries(${PROJECT_NAME} ${catkin_LIBRARIES})
> add_dependencies(${PROJECT_NAME} ${catkin_EXPORTED_TARGETS} pr2_mechanism_msgs_gencpp)

Then that executable will compile fine. I think the compiler tries to optimize, and runs several threads to get the job done fast. However, when it reaches this executable before the headers have been installed, this will happen. Since I'm the maintainer of this package, I'll do that for you. You'll have to ask the maintainer of the pr2_moveit_plugins package to do the other packages, or you can make a pull request of the fix (since you know what's wrong).

Originally posted by DevonW with karma: 644 on 2015-01-19
This answer was ACCEPTED on the original site
Post score: 1

