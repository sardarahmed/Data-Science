Q:

How to view map regions with large coordinate values using rviz?

I am experimenting with Open Street Map, and want to visualize my data using rviz.
The problem is that the natural coordinate system to use is UTM, which tends to generate rather large offsets, like (622191, 3362020), from the /map origin.
There must be some way to shift the rviz view from (0, 0) to (622191, 3362020), but I have not discovered a reasonable solution. On Fuerte, I was able to save a view, then edit the .vcg file to fill in the desired coordinates. Messy, but it worked. On Electric, I can't even get that to work.
Surely there is a better approach?

Originally posted by joq on ROS Answers with karma: 25443 on 2012-05-09
Post score: 4

Original comments
Comment by hersh on 2012-05-10:
The coordinate frame for saving view pose changed between Electric and Fuerte.  Fuerte uses a frame consistent with the rest of rviz, where X and Y are on the ground plane and +Z is up.  I think Electric used the typical Ogre frame, where +Y is up, but there were bugs which lead to inconsistencies.

A:

I had a similar problem looking at PointClouds where the x,y,z was UTM northing, easting, altitude. I ran into a number of issues with the numerical stability of things, as rviz (Ogre) internally uses float32's, which don't have enough precision to work with UTM-magnitude transforms (where we often need many digits to represent the northing to good precision). See https://code.ros.org/trac/ros-pkg/ticket/5394 for some explanation by @hersh . (sidenote: PointCloud2's are also made of floats so those also can't hold UTM coordinates very reliably.)
The good news is that TF can handle coordinates that big to enough precision, so if you transform your inputs into some "nearby" reference frame, it will work. Basically something like utm->base_link and a utm->nearby and then set your fixed_frame in rviz to nearby will force TF to transform all of the data.
As far as automatically setting this, perhaps it could be the center of the current UTM zone (perhaps including the latitude band would be best so that the northing is smaller than relative to the equator)?
That doesn't really solve the issue of getting rviz to "snap" to some location (like the center of the currently displayed map tiles), but that could be solved with another transform from say, utm->centered_view so that you could set your target_frame accordingly. Note that none of this changes the actual coordinate system that the map or things like the vehicle's location are in (that can still be UTM), just sets up some extra TF's to make things easier to visualize.

Originally posted by Eric Perko with karma: 8406 on 2012-05-09
This answer was ACCEPTED on the original site
Post score: 5

Original comments
Comment by joq on 2012-05-09:
Thanks, Eric. I was considering a similar approach, based on the hint from @alfa_80. Good to know this works for you.
Comment by Ryan on 2012-05-09:
We do something similar at times as well

