Q:

FOVIS odometry produces NaNs

Good day everyone.
I've tested FOVIS library with Juergen Sturm's datasets and discovered that sometimes (approximately every 500 frames) fovis::VisualOdometry may produce some NaNs in the estimated transformation. The input datasets have no NaN; unknown depth is encoded by zeroes.
Here are the samples: http://vision.in.tum.de/data/datasets/rgbd-dataset. In particular I've used Pioneer and Desk 360.
Now I simply create a new instance of fovis::VisualOdometry every time I see NaN in output, but I don't like this kind of voodoo programming much.
Is it a flaw of the library itself, or maybe there is something I need to fix?
Thanks.

Originally posted by Spym on ROS Answers with karma: 32 on 2013-02-21
Post score: 0

A:

Hi Spym!
It could happen when fovis changes the reference frame. If you launch our wrapper you will see a new ROS topic called /stereo_odometer/info (or the name you set instead). In this topic there is a boolean variable called 'change_reference_frame' which is True when fovis changes the reference frame.
Can you, check if you got the NaN when this variable is True? This could help us to isolate the problem...
If not, check the other variables in the info message, like 'num_total_keypoints' for example. A small value here could produce NaN

Originally posted by Pep Lluis Negre with karma: 111 on 2013-02-27
This answer was ACCEPTED on the original site
Post score: 2

Original comments
Comment by Spym on 2013-02-27:
Here the results: http://pastebin.com/uAXXdSJq. Sadly, I see no corellation neither with frame switching nor number of keypoints. Maybe there are some other interesting parameters I may look closely?
Comment by Pep Lluis Negre on 2013-02-27:
It seems you have sufficient keypoints, and the reference frame is not changing at the moment of NaN. I would suggest you 2 things: Check the way you pass the images to Fovis and try to change some algorithm parameters and see what happens. You can find the parameters in the file stereo-odometry.cpp

