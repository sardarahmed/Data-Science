Q:

ABB IRB120 different in Rviz from Virtual machine than Dual boot

Hello,
I'm trying to get my ABB IRB120 loaded in Rviz.
Everything works fine.
I used to work in a virtual machine using Ubuntu 18.04. When I loaded the demo.launch from the abb abb_experimental package (https://github.com/ros-industrial/abb_experimental), it works fine. But the Virtual machine is a bit slow, so I decided to run a dual boot.
When I do the exact same things as on the virtual machine, I got a different result in my Rviz.
My question is, how can I fix this?
Link to pictures
In the link you can see the 2 pictures.
I'm using Ubuntu 18.04 on both systems and ROS Melodic.
EDIT:
Picture 1: Rviz on the virtual machine

Picture 2: Rviz on the dual boot

EDIT2:
This is the terminal output after the demo.launch:
> ... logging to /home/redouan/.ros/log/9b89edba-e120-11e8-8b50-dc85def7897f/roslaunch-Redouan-17074.log
Checking log directory for disk usage. This may take awhile.
Press Ctrl-C to interrupt
Done checking log file disk usage. Usage is <1GB.

started roslaunch server http://Redouan:42491/

SUMMARY
========

PARAMETERS
 * /joint_state_publisher/use_gui: False
 * /move_group/allow_trajectory_execution: True
 * /move_group/controller_list: [{'joints': ['joi...
 * /move_group/jiggle_fraction: 0.05
 * /move_group/manipulator/longest_valid_segment_fraction: 0.005
 * /move_group/manipulator/planner_configs: ['SBLkConfigDefau...
 * /move_group/manipulator/projection_evaluator: joints(joint_1,jo...
 * /move_group/max_range: 5.0
 * /move_group/max_safe_path_cost: 1
 * /move_group/moveit_controller_manager: moveit_fake_contr...
 * /move_group/moveit_manage_controllers: True
 * /move_group/octomap_resolution: 0.025
 * /move_group/planner_configs/BFMTkConfigDefault/balanced: 0
 * /move_group/planner_configs/BFMTkConfigDefault/cache_cc: 1
 * /move_group/planner_configs/BFMTkConfigDefault/extended_fmt: 1
 * /move_group/planner_configs/BFMTkConfigDefault/heuristics: 1
 * /move_group/planner_configs/BFMTkConfigDefault/nearest_k: 1
 * /move_group/planner_configs/BFMTkConfigDefault/num_samples: 1000
 * /move_group/planner_configs/BFMTkConfigDefault/optimality: 1
 * /move_group/planner_configs/BFMTkConfigDefault/radius_multiplier: 1.0
 * /move_group/planner_configs/BFMTkConfigDefault/type: geometric::BFMT
 * /move_group/planner_configs/BKPIECEkConfigDefault/border_fraction: 0.9
 * /move_group/planner_configs/BKPIECEkConfigDefault/failed_expansion_score_factor: 0.5
 * /move_group/planner_configs/BKPIECEkConfigDefault/min_valid_path_fraction: 0.5
 * /move_group/planner_configs/BKPIECEkConfigDefault/range: 0.0
 * /move_group/planner_configs/BKPIECEkConfigDefault/type: geometric::BKPIECE
 * /move_group/planner_configs/BiESTkConfigDefault/range: 0.0
 * /move_group/planner_configs/BiESTkConfigDefault/type: geometric::BiEST
 * /move_group/planner_configs/BiTRRTkConfigDefault/cost_threshold: 1e300
 * /move_group/planner_configs/BiTRRTkConfigDefault/frountier_node_ratio: 0.1
 * /move_group/planner_configs/BiTRRTkConfigDefault/frountier_threshold: 0.0
 * /move_group/planner_configs/BiTRRTkConfigDefault/init_temperature: 100
 * /move_group/planner_configs/BiTRRTkConfigDefault/range: 0.0
 * /move_group/planner_configs/BiTRRTkConfigDefault/temp_change_factor: 0.1
 * /move_group/planner_configs/BiTRRTkConfigDefault/type: geometric::BiTRRT
 * /move_group/planner_configs/ESTkConfigDefault/goal_bias: 0.05
 * /move_group/planner_configs/ESTkConfigDefault/range: 0.0
 * /move_group/planner_configs/ESTkConfigDefault/type: geometric::EST
 * /move_group/planner_configs/FMTkConfigDefault/cache_cc: 1
 * /move_group/planner_configs/FMTkConfigDefault/extended_fmt: 1
 * /move_group/planner_configs/FMTkConfigDefault/heuristics: 0
 * /move_group/planner_configs/FMTkConfigDefault/nearest_k: 1
 * /move_group/planner_configs/FMTkConfigDefault/num_samples: 1000
 * /move_group/planner_configs/FMTkConfigDefault/radius_multiplier: 1.1
 * /move_group/planner_configs/FMTkConfigDefault/type: geometric::FMT
 * /move_group/planner_configs/KPIECEkConfigDefault/border_fraction: 0.9
 * /move_group/planner_configs/KPIECEkConfigDefault/failed_expansion_score_factor: 0.5
 * /move_group/planner_configs/KPIECEkConfigDefault/goal_bias: 0.05
 * /move_group/planner_configs/KPIECEkConfigDefault/min_valid_path_fraction: 0.5
 * /move_group/planner_configs/KPIECEkConfigDefault/range: 0.0
 * /move_group/planner_configs/KPIECEkConfigDefault/type: geometric::KPIECE
 * /move_group/planner_configs/LBKPIECEkConfigDefault/border_fraction: 0.9
 * /move_group/planner_configs/LBKPIECEkConfigDefault/min_valid_path_fraction: 0.5
 * /move_group/planner_configs/LBKPIECEkConfigDefault/range: 0.0
 * /move_group/planner_configs/LBKPIECEkConfigDefault/type: geometric::LBKPIECE
 * /move_group/planner_configs/LBTRRTkConfigDefault/epsilon: 0.4
 * /move_group/planner_configs/LBTRRTkConfigDefault/goal_bias: 0.05
 * /move_group/planner_configs/LBTRRTkConfigDefault/range: 0.0
 * /move_group/planner_configs/LBTRRTkConfigDefault/type: geometric::LBTRRT
 * /move_group/planner_configs/LazyPRMkConfigDefault/range: 0.0
 * /move_group/planner_configs/LazyPRMkConfigDefault/type: geometric::LazyPRM
 * /move_group/planner_configs/LazyPRMstarkConfigDefault/type: geometric::LazyPR...
 * /move_group/planner_configs/PDSTkConfigDefault/type: geometric::PDST
 * /move_group/planner_configs/PRMkConfigDefault/max_nearest_neighbors: 10
 * /move_group/planner_configs/PRMkConfigDefault/type: geometric::PRM
 * /move_group/planner_configs/PRMstarkConfigDefault/type: geometric::PRMstar
 * /move_group/planner_configs/ProjESTkConfigDefault/goal_bias: 0.05
 * /move_group/planner_configs/ProjESTkConfigDefault/range: 0.0
 * /move_group/planner_configs/ProjESTkConfigDefault/type: geometric::ProjEST
 * /move_group/planner_configs/RRTConnectkConfigDefault/range: 0.0
 * /move_group/planner_configs/RRTConnectkConfigDefault/type: geometric::RRTCon...
 * /move_group/planner_configs/RRTkConfigDefault/goal_bias: 0.05
 * /move_group/planner_configs/RRTkConfigDefault/range: 0.0
 * /move_group/planner_configs/RRTkConfigDefault/type: geometric::RRT
 * /move_group/planner_configs/RRTstarkConfigDefault/delay_collision_checking: 1
 * /move_group/planner_configs/RRTstarkConfigDefault/goal_bias: 0.05
 * /move_group/planner_configs/RRTstarkConfigDefault/range: 0.0
 * /move_group/planner_configs/RRTstarkConfigDefault/type: geometric::RRTstar
 * /move_group/planner_configs/SBLkConfigDefault/range: 0.0
 * /move_group/planner_configs/SBLkConfigDefault/type: geometric::SBL
 * /move_group/planner_configs/SPARSkConfigDefault/dense_delta_fraction: 0.001
 * /move_group/planner_configs/SPARSkConfigDefault/max_failures: 1000
 * /move_group/planner_configs/SPARSkConfigDefault/sparse_delta_fraction: 0.25
 * /move_group/planner_configs/SPARSkConfigDefault/stretch_factor: 3.0
 * /move_group/planner_configs/SPARSkConfigDefault/type: geometric::SPARS
 * /move_group/planner_configs/SPARStwokConfigDefault/dense_delta_fraction: 0.001
 * /move_group/planner_configs/SPARStwokConfigDefault/max_failures: 5000
 * /move_group/planner_configs/SPARStwokConfigDefault/sparse_delta_fraction: 0.25
 * /move_group/planner_configs/SPARStwokConfigDefault/stretch_factor: 3.0
 * /move_group/planner_configs/SPARStwokConfigDefault/type: geometric::SPARStwo
 * /move_group/planner_configs/STRIDEkConfigDefault/degree: 16
 * /move_group/planner_configs/STRIDEkConfigDefault/estimated_dimension: 0.0
 * /move_group/planner_configs/STRIDEkConfigDefault/goal_bias: 0.05
 * /move_group/planner_configs/STRIDEkConfigDefault/max_degree: 18
 * /move_group/planner_configs/STRIDEkConfigDefault/max_pts_per_leaf: 6
 * /move_group/planner_configs/STRIDEkConfigDefault/min_degree: 12
 * /move_group/planner_configs/STRIDEkConfigDefault/min_valid_path_fraction: 0.2
 * /move_group/planner_configs/STRIDEkConfigDefault/range: 0.0
 * /move_group/planner_configs/STRIDEkConfigDefault/type: geometric::STRIDE
 * /move_group/planner_configs/STRIDEkConfigDefault/use_projected_distance: 0
 * /move_group/planner_configs/TRRTkConfigDefault/frountierNodeRatio: 0.1
 * /move_group/planner_configs/TRRTkConfigDefault/frountier_threshold: 0.0
 * /move_group/planner_configs/TRRTkConfigDefault/goal_bias: 0.05
 * /move_group/planner_configs/TRRTkConfigDefault/init_temperature: 10e-6
 * /move_group/planner_configs/TRRTkConfigDefault/k_constant: 0.0
 * /move_group/planner_configs/TRRTkConfigDefault/max_states_failed: 10
 * /move_group/planner_configs/TRRTkConfigDefault/min_temperature: 10e-10
 * /move_group/planner_configs/TRRTkConfigDefault/range: 0.0
 * /move_group/planner_configs/TRRTkConfigDefault/temp_change_factor: 2.0
 * /move_group/planner_configs/TRRTkConfigDefault/type: geometric::TRRT
 * /move_group/planning_plugin: ompl_interface/OM...
 * /move_group/planning_scene_monitor/publish_geometry_updates: True
 * /move_group/planning_scene_monitor/publish_planning_scene: True
 * /move_group/planning_scene_monitor/publish_state_updates: True
 * /move_group/planning_scene_monitor/publish_transforms_updates: True
 * /move_group/request_adapters: default_planner_r...
 * /move_group/start_state_max_bounds_error: 0.1
 * /move_group/trajectory_execution/allowed_execution_duration_scaling: 1.2
 * /move_group/trajectory_execution/allowed_goal_duration_margin: 0.5
 * /move_group/trajectory_execution/allowed_start_tolerance: 0.01
 * /robot_description: <?xml version="1....
 * /robot_description_kinematics/manipulator/kinematics_solver: kdl_kinematics_pl...
 * /robot_description_kinematics/manipulator/kinematics_solver_attempts: 3
 * /robot_description_kinematics/manipulator/kinematics_solver_search_resolution: 0.005
 * /robot_description_kinematics/manipulator/kinematics_solver_timeout: 0.005
 * /robot_description_planning/joint_limits/joint_1/has_acceleration_limits: True
 * /robot_description_planning/joint_limits/joint_1/has_velocity_limits: True
 * /robot_description_planning/joint_limits/joint_1/max_acceleration: 0.87266
 * /robot_description_planning/joint_limits/joint_1/max_velocity: 4.36332
 * /robot_description_planning/joint_limits/joint_2/has_acceleration_limits: True
 * /robot_description_planning/joint_limits/joint_2/has_velocity_limits: True
 * /robot_description_planning/joint_limits/joint_2/max_acceleration: 0.87266
 * /robot_description_planning/joint_limits/joint_2/max_velocity: 4.36332
 * /robot_description_planning/joint_limits/joint_3/has_acceleration_limits: True
 * /robot_description_planning/joint_limits/joint_3/has_velocity_limits: True
 * /robot_description_planning/joint_limits/joint_3/max_acceleration: 0.87266
 * /robot_description_planning/joint_limits/joint_3/max_velocity: 4.36332
 * /robot_description_planning/joint_limits/joint_4/has_acceleration_limits: True
 * /robot_description_planning/joint_limits/joint_4/has_velocity_limits: True
 * /robot_description_planning/joint_limits/joint_4/max_acceleration: 1.11701
 * /robot_description_planning/joint_limits/joint_4/max_velocity: 5.58505
 * /robot_description_planning/joint_limits/joint_5/has_acceleration_limits: True
 * /robot_description_planning/joint_limits/joint_5/has_velocity_limits: True
 * /robot_description_planning/joint_limits/joint_5/max_acceleration: 1.11701
 * /robot_description_planning/joint_limits/joint_5/max_velocity: 5.58505
 * /robot_description_planning/joint_limits/joint_6/has_acceleration_limits: True
 * /robot_description_planning/joint_limits/joint_6/has_velocity_limits: True
 * /robot_description_planning/joint_limits/joint_6/max_acceleration: 1.46608
 * /robot_description_planning/joint_limits/joint_6/max_velocity: 7.33038
 * /robot_description_semantic: <?xml version="1....
 * /rosdistro: melodic
 * /rosversion: 1.14.3
 * /rviz_Redouan_17074_8495880831077487108/manipulator/kinematics_solver: kdl_kinematics_pl...
 * /rviz_Redouan_17074_8495880831077487108/manipulator/kinematics_solver_attempts: 3
 * /rviz_Redouan_17074_8495880831077487108/manipulator/kinematics_solver_search_resolution: 0.005
 * /rviz_Redouan_17074_8495880831077487108/manipulator/kinematics_solver_timeout: 0.005
 * /source_list: ['/move_group/fak...

NODES
  /
    joint_state_publisher (joint_state_publisher/joint_state_publisher)
    move_group (moveit_ros_move_group/move_group)
    robot_state_publisher (robot_state_publisher/robot_state_publisher)
    rviz_Redouan_17074_8495880831077487108 (rviz/rviz)

auto-starting new master
process[master]: started with pid [17084]
ROS_MASTER_URI=http://localhost:11311

setting /run_id to 9b89edba-e120-11e8-8b50-dc85def7897f
process[rosout-1]: started with pid [17095]
started core service [/rosout]
process[joint_state_publisher-2]: started with pid [17102]
process[robot_state_publisher-3]: started with pid [17103]
process[move_group-4]: started with pid [17104]
process[rviz_Redouan_17074_8495880831077487108-5]: started with pid [17105]
[ WARN] [1541439080.812810767]: The root link base_link has an inertia specified in the URDF, but KDL does not support a root link with an inertia.  As a workaround, you can add an extra dummy link to your URDF.
[ INFO] [1541439080.850338811]: Loading robot model 'abb_irb120_3_58'...
[ INFO] [1541439080.886373955]: Loading robot model 'abb_irb120_3_58'...
[ WARN] [1541439080.887812017]: The root link base_link has an inertia specified in the URDF, but KDL does not support a root link with an inertia.  As a workaround, you can add an extra dummy link to your URDF.
[ INFO] [1541439080.900077880]: Publishing maintained planning scene on 'monitored_planning_scene'
[ INFO] [1541439080.904276529]: MoveGroup debug mode is ON
Starting context monitors...
[ INFO] [1541439080.904324463]: Starting scene monitor
[ INFO] [1541439080.908204045]: Listening to '/planning_scene'
[ INFO] [1541439080.908236585]: Starting world geometry monitor
[ INFO] [1541439080.910353380]: Listening to '/collision_object' using message notifier with target frame 'base_link '
[ INFO] [1541439080.911828350]: Listening to '/planning_scene_world' for planning scene world geometry
[ INFO] [1541439080.917269597]: rviz version 1.13.1
[ INFO] [1541439080.917327809]: compiled against Qt version 5.9.5
[ INFO] [1541439080.917349357]: compiled against OGRE version 1.9.0 (Ghadamon)
[ INFO] [1541439080.919063225]: Listening to '/attached_collision_object' for attached collision objects
Context monitors started.
[ INFO] [1541439080.944786500]: Initializing OMPL interface using ROS parameters
[ INFO] [1541439080.959036162]: Using planning interface 'OMPL'
[ INFO] [1541439080.965736771]: Param 'default_workspace_bounds' was not set. Using default value: 10
[ INFO] [1541439080.966215161]: Param 'start_state_max_bounds_error' was set to 0.1
[ INFO] [1541439080.966598090]: Param 'start_state_max_dt' was not set. Using default value: 0.5
[ INFO] [1541439080.967015297]: Param 'start_state_max_dt' was not set. Using default value: 0.5
[ INFO] [1541439080.967353207]: Param 'jiggle_fraction' was set to 0.05
[ INFO] [1541439080.967683404]: Param 'max_sampling_attempts' was not set. Using default value: 100
[ INFO] [1541439080.967752816]: Using planning request adapter 'Add Time Parameterization'
[ INFO] [1541439080.967774898]: Using planning request adapter 'Fix Workspace Bounds'
[ INFO] [1541439080.967792355]: Using planning request adapter 'Fix Start State Bounds'
[ INFO] [1541439080.967809193]: Using planning request adapter 'Fix Start State In Collision'
[ INFO] [1541439080.967824681]: Using planning request adapter 'Fix Start State Path Constraints'
libpng warning: iCCP: known incorrect sRGB profile
libpng warning: iCCP: known incorrect sRGB profile
[ INFO] [1541439080.974405520]: Fake controller 'fake_manipulator_controller' with joints [ joint_1 joint_2 joint_3 joint_4 joint_5 joint_6 ]
[ INFO] [1541439080.974734908]: Returned 1 controllers in list
[ INFO] [1541439080.983836670]: Trajectory execution is managing controllers
Loading 'move_group/ApplyPlanningSceneService'...
Loading 'move_group/ClearOctomapService'...
Loading 'move_group/MoveGroupCartesianPathService'...
Loading 'move_group/MoveGroupExecuteTrajectoryAction'...
Loading 'move_group/MoveGroupGetPlanningSceneService'...
Loading 'move_group/MoveGroupKinematicsService'...
Loading 'move_group/MoveGroupMoveAction'...
Loading 'move_group/MoveGroupPickPlaceAction'...
Loading 'move_group/MoveGroupPlanService'...
Loading 'move_group/MoveGroupQueryPlannersService'...
Loading 'move_group/MoveGroupStateValidationService'...
[ INFO] [1541439081.049138670]: 

********************************************************
* MoveGroup using: 
*     - ApplyPlanningSceneService
*     - ClearOctomapService
*     - CartesianPathService
*     - ExecuteTrajectoryAction
*     - GetPlanningSceneService
*     - KinematicsService
*     - MoveAction
*     - PickPlaceAction
*     - MotionPlanService
*     - QueryPlannersService
*     - StateValidationService
********************************************************

[ INFO] [1541439081.049302647]: MoveGroup context using planning plugin ompl_interface/OMPLPlanner
[ INFO] [1541439081.049380635]: MoveGroup context initialization complete

You can start planning now!

[ INFO] [1541439081.054724112]: Stereo is NOT SUPPORTED
[ INFO] [1541439081.055442935]: OpenGl version: 3 (GLSL 1.3).
libpng warning: iCCP: known incorrect sRGB profile
[ INFO] [1541439084.282534706]: Loading robot model 'abb_irb120_3_58'...
[ INFO] [1541439084.308677398]: Loading robot model 'abb_irb120_3_58'...
[ WARN] [1541439084.312186335]: The root link base_link has an inertia specified in the URDF, but KDL does not support a root link with an inertia.  As a workaround, you can add an extra dummy link to your URDF.
[ INFO] [1541439084.340376512]: Starting scene monitor
[ INFO] [1541439084.342413814]: Listening to '/move_group/monitored_planning_scene'
[ WARN] [1541439084.439956154]: The root link base_link has an inertia specified in the URDF, but KDL does not support a root link with an inertia.  As a workaround, you can add an extra dummy link to your URDF.
[ INFO] [1541439084.441792540]: Constructing new MoveGroup connection for group 'manipulator' in namespace ''
[ INFO] [1541439085.482204765]: Ready to take commands for planning group manipulator.
[ INFO] [1541439085.482350606]: Looking around: no
[ INFO] [1541439085.482428165]: Replanning: no
[ WARN] [1541439085.515700203]: Interactive marker 'EE:goal_tool0' contains unnormalized quaternions. This warning will only be output once but may be true for others; enable DEBUG messages for ros.rviz.quaternions to see more details.

Is this what you need?
EDIT 3:
Every robot shows the same result. An ABB robot, UR robot or the panda robot in the tutorial for moveit (https://ros-planning.github.io/moveit_tutorials/doc/getting_started/getting_started.html).
It looks like the head of the robot is in the base of the robot.

Originally posted by Redouanr21 on ROS Answers with karma: 13 on 2018-10-19
Post score: 0

Original comments
Comment by gvdhoorn on 2018-10-19:
Could you please attach your images directly to this post? I've given you enough karma to do that.
If you would accept the answer to your previous question (#q305835) you would already have had enough karma.
Comment by Redouanr21 on 2018-10-20:
I edited the pictures above.
Comment by gvdhoorn on 2018-10-21:
That's great. What about #q305835?
Comment by Redouanr21 on 2018-10-21:
I'm still stuck at this question. I only added the pictures in the question. Do you know anything how I can resolve this?
About #q305835: I was very busy lately, but I wil try it next week or the week after. I will let you know if it worked.
Comment by gvdhoorn on 2018-10-21:
I'm confused: #q305835 asks how to install and use the packages under Melodic. Your current question is also about Melodic. Have you figured out how to use the packages under Melodic (and this resolved #q305835) or not?
Comment by gvdhoorn on 2018-10-21:
As to this question: you should update your question with the commands you use to start everything. The screenshots are nice, but don't really tell us that much.
Comment by Redouanr21 on 2018-10-21:
I'm sorry for the confusion. #q305835 is about the connection with the real robot. I understand the package partly. Next week I will try to connect it to te real robot.
Comment by Redouanr21 on 2018-10-21:
But this question is about the simulation of the robot.
On both systems I used the following command:
roslaunch abb_irb120_moveit_config demo.lauch.
On the Virtual machine it ended up as in pic 1 and on the dual boot it ended up as in pic 2.
Does this clear anything up?
Comment by gvdhoorn on 2018-10-21:
demo.launch is not a simulation. It's a visualisation of MoveIt's internal state.
As I wrote earlier: you'll need to provide us with much more information to be able to help you. At least a copy-paste of the terminal output after starting demo.launch.
Comment by Redouanr21 on 2018-11-05:
Sorry for the late reply, I edited the question after your note.
Comment by mewbot on 2018-11-06:
check the tf tree
Comment by Redouanr21 on 2018-11-06:
Can you tell me how to do that, because I haven't heard of it.
Thank you

A:

@Redouanr21: I'm thinking you may be running into ros/urdfdom_headers#41.
Can you verify what the locale settings are in your VM and in your native installation?

Originally posted by gvdhoorn with karma: 86574 on 2018-11-07
This answer was ACCEPTED on the original site
Post score: 0

Original comments
Comment by Redouanr21 on 2018-11-08:
I checked https://github.com/ros-industrial/universal_robot/issues/374 this site and eventually run this command: export LC_NUMERIC="en_US.UTF-8"
And then it works.
Thank you for helping me!
I will close this question.
Comment by gvdhoorn on 2018-11-08:
Let's just mark it as answered by ticking the checkmark to the left of the answer.
Comment by gvdhoorn on 2018-11-08:
Also: please note that overriding the LC_NUMERIC env var is a work-around, only needed until the PRs referred to in the various issues are merged and the updated versions released into Ubuntu Bionic.

