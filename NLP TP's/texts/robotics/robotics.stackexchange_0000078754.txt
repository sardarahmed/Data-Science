Q:

ros.spinOnce() during delay

Say I have a ros rate of 10 Hz. Does ros.spinOnce() occur during ros::Duration(2).sleep() ?
Example:
void main(void){
  ros::nh;
  ros::rate r(10);
  while(ros::ok())
  {
    do something;

    ros::Duration(2).sleep();
    ros::spinOnce();
  }
}

Originally posted by roborag on ROS Answers with karma: 11 on 2017-02-03
Post score: 0

Original comments
Comment by afakih on 2017-02-08:
ros::rate r(10); as it is used, is doing nothing. If you want the loop to run at 10Hz you should call r.sleep() at the end of your while loop.
Currently the loop would run at a rate of 1/(2 + call backs processing time).

A:

This has been asked before. See #q203760.
And we could also look at the source: ros::Duration::sleep() eventually calls ros_wallsleep(..), which basically does:
timespec req = { sec, nsec };
timespec rem = {0, 0};
while (nanosleep(&req, &rem) && !g_stopped)
{
  req = rem;
}

and nothing more.

Originally posted by gvdhoorn with karma: 86574 on 2017-02-03
This answer was ACCEPTED on the original site
Post score: 0

