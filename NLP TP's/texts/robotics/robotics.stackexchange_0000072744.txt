Q:

Subscribe and Publish a arbitrary topic!

Hi
I would like to subscribe to the Laserscan data and process it and publish something.
Unfortunately, I keep getting error.
I appreciate if you help.
here is my code:
#include <ros/ros.h>
#include <iostream>
#include <sensor_msgs/LaserScan.h>
#include <std_msgs/Float32.h>

std_msgs::Float32 minval;

void Callback_laser(const sensor_msgs::LaserScan::ConstPtr& scan)
{

minval = scan->ranges[0];
    for(int i=0;i<scan->ranges.size();i++)
    {
        if(scan->ranges[i]<minval or minval!=minval)
           minval=scan->ranges[i];
    }

}

int main(int argc, char** argv)
{
    ros::init(argc, argv, "subscribing"); 
    ros::NodeHandle n;

    ros::Subscriber laser_subscriber = n.subscribe<sensor_msgs::LaserScan>("scan", 1000, Callback_laser);

    ros::Publisher pub=n.advertise<std_msgs::Float32>("minval", 1000);

    ros::Rate loop_rate(10);

      while (ros::ok())
      {
         pub.publish(minval);
         ros::spinOnce();
         loop_rate.sleep();
      }

     return 0; 
}

Thanks in advance for your help.

Originally posted by Reza1984 on ROS Answers with karma: 70 on 2016-03-13
Post score: 0

Original comments
Comment by Martin Peris on 2016-03-13:
Hi, it would be useful if you could attach any error logs.

A:

Thanks I solved my problem. Here is the code:
#include <ros/ros.h>
#include <iostream>
#include <sensor_msgs/LaserScan.h>
#include <std_msgs/Float32.h>

std_msgs::Float32 mindist;

void Callback_laser(const sensor_msgs::LaserScan::ConstPtr& scan)
{

float minval = scan->ranges[0];
    for(int i=0;i<scan->ranges.size();i++)
    {
        if(scan->ranges[i]<minval or minval!=minval)
           minval=scan->ranges[i];
    }

       ROS_INFO("min_range[%f] \n",minval);

       mindist.data=minval;

}

int main(int argc, char** argv)
{
    ros::init(argc, argv, "subscribing"); 

    ros::NodeHandle n;

    ros::Subscriber laser_subscriber = n.subscribe<sensor_msgs::LaserScan>("scan", 1000, Callback_laser);

    ros::Publisher pub=n.advertise<std_msgs::Float32>("mindist", 1000);
     
    ros::Rate loop_rate(10);

      while (ros::ok())
      {

         pub.publish(mindist);
         ros::spinOnce();
         loop_rate.sleep();
      }

     return 0; 

}

Originally posted by Reza1984 with karma: 70 on 2016-03-13
This answer was ACCEPTED on the original site
Post score: 0

