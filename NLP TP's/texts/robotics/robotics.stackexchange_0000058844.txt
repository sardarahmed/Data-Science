Q:

Segfault whilst reading message

Hi we've been writting some code to subscribe to the /joint_states topic produced by the husky simulator.
However we found that even though all the arrays in /joint_states should be the same length, we are getting an empty array for velocity at random intervals. Which causes a seg fault as there appears to be no way to detect it. (checking if msg->velocity == NULL won't compile).
So two questions, is there a way to stop these invalid messages? And if there isn't what is the best way to detect the empty array (gdb says its a boost shared vector).
Thanks,
Harry

Originally posted by hjed on ROS Answers with karma: 3 on 2014-04-18
Post score: 0

A:

The arrays of Float64 data in sensor_msgs/JointState  are represented by a std::vector<double> when using roscpp. You should thus be able to get the length of the vector by calling YOUR_MSG.velocity.size().
The "velocity disappearance" issue sounds like a bug to me, but maybe some other husky user or dev can comment on that one.

Originally posted by Stefan Kohlbrecher with karma: 24361 on 2014-04-18
This answer was ACCEPTED on the original site
Post score: 1

Original comments
Comment by hjed on 2014-04-19:
Thanks, this is a very good fix for the problem

