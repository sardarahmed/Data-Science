Q:

Help with installing and running ARI simulation

I am going through the installation steps for using the ARI simulation as seen here, and have successfully done so in the past without any issues. However, now I am experiencing the following errors after inserting the final roslaunch ari_gazebo ari_gazebo.launch public_sim:=true command for running the simulation:
xacro: in-order processing became default in ROS Melodic. You can drop the option.

resource not found: realsense_simulation

ROS path [0]=/opt/ros/noetic/share/ros
ROS path [1]=/home/cs/ari_public_ws/src/ari_navigation/ari_2dnav
ROS path [2]=/home/cs/ari_public_ws/src/ari_simulation/ari_2dnav_gazebo
ROS path [3]=/home/cs/ari_public_ws/src/ari_robot/ari_bringup
ROS path [4]=/home/cs/ari_public_ws/src/ari_robot/ari_controller_configuration
ROS path [5]=/home/cs/ari_public_ws/src/ari_simulation/ari_controller_configuration_gazebo
ROS path [6]=/home/cs/ari_public_ws/src/ari_simulation/ari_gazebo
ROS path [7]=/home/cs/ari_public_ws/src/ari_navigation/ari_laser_sensors
ROS path [8]=/home/cs/ari_public_ws/src/ari_tutorials/ari_look_to_point
ROS path [9]=/home/cs/ari_public_ws/src/ari_navigation/ari_maps
ROS path [10]=/home/cs/ari_public_ws/src/ari_moveit_config
ROS path [11]=/home/cs/ari_public_ws/src/ari_tutorials/ari_moveit_tutorial
ROS path [12]=/home/cs/ari_public_ws/src/ari_navigation/ari_navigation
ROS path [13]=/home/cs/ari_public_ws/src/ari_navigation/ari_rgbd_sensors
ROS path [14]=/home/cs/ari_public_ws/src/ari_robot/ari_robot
ROS path [15]=/home/cs/ari_public_ws/src/ari_simulation/ari_simulation
ROS path [16]=/home/cs/ari_public_ws/src/ari_tutorials/ari_trajectory_controller
ROS path [17]=/home/cs/ari_public_ws/src/aruco_ros/aruco
ROS path [18]=/home/cs/ari_public_ws/src/aruco_ros/aruco_msgs
ROS path [19]=/home/cs/ari_public_ws/src/aruco_ros/aruco_ros
ROS path [20]=/home/cs/ari_public_ws/src/ari_tutorials/ari_aruco_demo
ROS path [21]=/home/cs/ari_public_ws/src/backward_ros
ROS path [22]=/home/cs/ari_public_ws/src/ros_control/controller_manager_msgs
ROS path [23]=/home/cs/ari_public_ws/src/ddynamic_reconfigure_python
ROS path [24]=/home/cs/ari_public_ws/src/eband_local_planner
ROS path [25]=/home/cs/ari_public_ws/src/gazebo_ros_pkgs/gazebo_dev
ROS path [26]=/home/cs/ari_public_ws/src/gazebo_ros_pkgs/gazebo_msgs
ROS path [27]=/home/cs/ari_public_ws/src/gazebo_ros_pkgs/gazebo_plugins
ROS path [28]=/home/cs/ari_public_ws/src/gazebo_ros_pkgs/gazebo_ros
ROS path [29]=/home/cs/ari_public_ws/src/gazebo_ros_pkgs/gazebo_ros_pkgs
ROS path [30]=/home/cs/ari_public_ws/src/ros_control/hardware_interface
ROS path [31]=/home/cs/ari_public_ws/src/ros_control/combined_robot_hw
ROS path [32]=/home/cs/ari_public_ws/src/ros_control/controller_interface
ROS path [33]=/home/cs/ari_public_ws/src/ros_controllers/actuator_state_controller
ROS path [34]=/home/cs/ari_public_ws/src/ros_control/controller_manager
ROS path [35]=/home/cs/ari_public_ws/src/ros_control/controller_manager_tests
ROS path [36]=/home/cs/ari_public_ws/src/ros_control/combined_robot_hw_tests
ROS path [37]=/home/cs/ari_public_ws/src/ros_controllers/diff_drive_controller
ROS path [38]=/home/cs/ari_public_ws/src/ros_controllers/force_torque_sensor_controller
ROS path [39]=/home/cs/ari_public_ws/src/ros_controllers/forward_command_controller
ROS path [40]=/home/cs/ari_public_ws/src/ros_controllers/effort_controllers
ROS path [41]=/home/cs/ari_public_ws/src/ros_controllers/four_wheel_steering_controller
ROS path [42]=/home/cs/ari_public_ws/src/ros_controllers/gripper_action_controller
ROS path [43]=/home/cs/ari_public_ws/src/head_action
ROS path [44]=/home/cs/ari_public_ws/src/hey5_description
ROS path [45]=/home/cs/ari_public_ws/src/humanoid_msgs/humanoid_msgs
ROS path [46]=/home/cs/ari_public_ws/src/humanoid_msgs/humanoid_nav_msgs
ROS path [47]=/home/cs/ari_public_ws/src/ros_controllers/imu_sensor_controller
ROS path [48]=/home/cs/ari_public_ws/src/ros_control/joint_limits_interface
ROS path [49]=/home/cs/ari_public_ws/src/ros_controllers/joint_state_controller
ROS path [50]=/home/cs/ari_public_ws/src/ros_controllers/joint_torque_sensor_state_controller
ROS path [51]=/home/cs/ari_public_ws/src/ros_controllers/joint_trajectory_controller
ROS path [52]=/home/cs/ari_public_ws/src/teleop_tools/joy_teleop
ROS path [53]=/home/cs/ari_public_ws/src/teleop_tools/key_teleop
ROS path [54]=/home/cs/ari_public_ws/src/teleop_tools/mouse_teleop
ROS path [55]=/home/cs/ari_public_ws/src/range_sensor_layer/navigation_layers
ROS path [56]=/home/cs/ari_public_ws/src/openslam_gmapping
ROS path [57]=/home/cs/ari_public_ws/src/slam_gmapping/gmapping
ROS path [58]=/home/cs/ari_public_ws/src/pal_msgs/pal_behaviour_msgs
ROS path [59]=/home/cs/ari_public_ws/src/pal_statistics/pal_carbon_collector
ROS path [60]=/home/cs/ari_public_ws/src/pal_msgs/pal_common_msgs
ROS path [61]=/home/cs/ari_public_ws/src/pal_msgs/pal_control_msgs
ROS path [62]=/home/cs/ari_public_ws/src/pal_msgs/pal_detection_msgs
ROS path [63]=/home/cs/ari_public_ws/src/ari_tutorials/ari_opencv_tutorial
ROS path [64]=/home/cs/ari_public_ws/src/pal_msgs/pal_device_msgs
ROS path [65]=/home/cs/ari_public_ws/src/pal_gazebo_worlds
ROS path [66]=/home/cs/ari_public_ws/src/pal_gripper/pal_gripper
ROS path [67]=/home/cs/ari_public_ws/src/pal_gripper/pal_gripper_controller_configuration
ROS path [68]=/home/cs/ari_public_ws/src/pal_gripper/pal_gripper_controller_configuration_gazebo
ROS path [69]=/home/cs/ari_public_ws/src/pal_gripper/pal_gripper_gazebo
ROS path [70]=/home/cs/ari_public_ws/src/pal_hardware_interfaces
ROS path [71]=/home/cs/ari_public_ws/src/ros_controllers/mode_state_controller
ROS path [72]=/home/cs/ari_public_ws/src/pal_msgs/pal_interaction_msgs
ROS path [73]=/home/cs/ari_public_ws/src/ari_tutorials/ari_say_something
ROS path [74]=/home/cs/ari_public_ws/src/pal_msgs/pal_motion_model_msgs
ROS path [75]=/home/cs/ari_public_ws/src/pal_msgs/pal_msgs
ROS path [76]=/home/cs/ari_public_ws/src/pal_msgs/pal_multirobot_msgs
ROS path [77]=/home/cs/ari_public_ws/src/pal_gazebo_plugins
ROS path [78]=/home/cs/ari_public_ws/src/pal_navigation_cfg_public/pal_navigation_cfg_ari
ROS path [79]=/home/cs/ari_public_ws/src/pal_navigation_cfg_public/pal_navigation_cfg_omni_base
ROS path [80]=/home/cs/ari_public_ws/src/pal_navigation_cfg_public/pal_navigation_cfg_pmb2
ROS path [81]=/home/cs/ari_public_ws/src/pal_navigation_cfg_public/pal_navigation_cfg_pmb3
ROS path [82]=/home/cs/ari_public_ws/src/pal_navigation_cfg_public/pal_navigation_cfg_tiago
ROS path [83]=/home/cs/ari_public_ws/src/pal_navigation_cfg_public/pal_navigation_cfg_tiago_dual
ROS path [84]=/home/cs/ari_public_ws/src/pal_msgs/pal_navigation_msgs
ROS path [85]=/home/cs/ari_public_ws/src/pal_navigation_sm
ROS path [86]=/home/cs/ari_public_ws/src/pal_gripper/pal_parallel_gripper_wrapper
ROS path [87]=/home/cs/ari_public_ws/src/pal_python
ROS path [88]=/home/cs/ari_public_ws/src/pal_msgs/pal_simulation_msgs
ROS path [89]=/home/cs/ari_public_ws/src/pal_statistics/pal_statistics_msgs
ROS path [90]=/home/cs/ari_public_ws/src/pal_statistics/pal_statistics
ROS path [91]=/home/cs/ari_public_ws/src/dynamic_introspection
ROS path [92]=/home/cs/ari_public_ws/src/pal_msgs/pal_tablet_msgs
ROS path [93]=/home/cs/ari_public_ws/src/pal_msgs/pal_video_recording_msgs
ROS path [94]=/home/cs/ari_public_ws/src/pal_msgs/pal_vision_msgs
ROS path [95]=/home/cs/ari_public_ws/src/pal_msgs/pal_visual_localization_msgs
ROS path [96]=/home/cs/ari_public_ws/src/pal_msgs/pal_walking_msgs
ROS path [97]=/home/cs/ari_public_ws/src/pal_msgs/pal_web_msgs
ROS path [98]=/home/cs/ari_public_ws/src/pal_msgs/pal_wifi_localization_msgs
ROS path [99]=/home/cs/ari_public_ws/src/pal_wsg_gripper/pal_wsg_gripper
ROS path [100]=/home/cs/ari_public_ws/src/pal_wsg_gripper/pal_wsg_gripper_controller_configuration
ROS path [101]=/home/cs/ari_public_ws/src/pal_wsg_gripper/pal_wsg_gripper_controller_configuration_gazebo
ROS path [102]=/home/cs/ari_public_ws/src/pal_wsg_gripper/pal_wsg_gripper_description
ROS path [103]=/home/cs/ari_public_ws/src/pal_wsg_gripper/pal_wsg_gripper_gazebo
ROS path [104]=/home/cs/ari_public_ws/src/play_motion/play_motion_msgs
ROS path [105]=/home/cs/ari_public_ws/src/ros_controllers/position_controllers
ROS path [106]=/home/cs/ari_public_ws/src/play_motion/play_motion
ROS path [107]=/home/cs/ari_public_ws/src/range_sensor_layer/range_sensor_layer
ROS path [108]=/home/cs/ari_public_ws/src/realsense/realsense2_camera
ROS path [109]=/home/cs/ari_public_ws/src/realsense/realsense2_description
ROS path [110]=/home/cs/ari_public_ws/src/realsense_gazebo_plugin
ROS path [111]=/home/cs/ari_public_ws/src/robot_pose
ROS path [112]=/home/cs/ari_public_ws/src/roboticsgroup_gazebo_plugins
ROS path [113]=/home/cs/ari_public_ws/src/ros_control/ros_control
ROS path [114]=/home/cs/ari_public_ws/src/ros_controllers/ros_controllers
ROS path [115]=/home/cs/ari_public_ws/src/ros_control/rqt_controller_manager
ROS path [116]=/home/cs/ari_public_ws/src/ros_controllers/rqt_joint_trajectory_controller
ROS path [117]=/home/cs/ari_public_ws/src/rviz_plugin_covariance
ROS path [118]=/home/cs/ari_public_ws/src/simple_grasping_action
ROS path [119]=/home/cs/ari_public_ws/src/slam_gmapping/slam_gmapping
ROS path [120]=/home/cs/ari_public_ws/src/range_sensor_layer/social_navigation_layers
ROS path [121]=/home/cs/ari_public_ws/src/teleop_tools/teleop_tools
ROS path [122]=/home/cs/ari_public_ws/src/teleop_tools/teleop_tools_msgs
ROS path [123]=/home/cs/ari_public_ws/src/ros_controllers/temperature_sensor_controller
ROS path [124]=/home/cs/ari_public_ws/src/tf_lookup
ROS path [125]=/home/cs/ari_public_ws/src/ros_control/transmission_interface
ROS path [126]=/home/cs/ari_public_ws/src/gazebo_ros_pkgs/gazebo_ros_control
ROS path [127]=/home/cs/ari_public_ws/src/pal_hardware_gazebo
ROS path [128]=/home/cs/ari_public_ws/src/urdf_test
ROS path [129]=/home/cs/ari_public_ws/src/ari_robot/ari_description
ROS path [130]=/home/cs/ari_public_ws/src/pal_gripper/pal_gripper_description
ROS path [131]=/home/cs/ari_public_ws/src/ros_controllers/velocity_controllers
ROS path [132]=/home/cs/ari_public_ws/src/zbar_ros
ROS path [133]=/opt/ros/noetic/share

when processing file: /home/cs/ari_public_ws/src/realsense/realsense2_description/urdf/_d435.urdf.xacro
included from: /home/cs/ari_public_ws/src/ari_robot/ari_description/urdf/head/head.urdf.xacro
included from: /home/cs/ari_public_ws/src/ari_robot/ari_description/robots/ari.urdf.xacro
RLException: while processing /home/cs/ari_public_ws/src/ari_simulation/ari_gazebo/launch/ari_gazebo.launch:
while processing /home/cs/ari_public_ws/src/ari_simulation/ari_gazebo/launch/ari_spawn.launch:
while processing /home/cs/ari_public_ws/src/ari_robot/ari_description/robots/upload.launch:
Invalid <param> tag: Cannot load command parameter [robot_description]: command [['rosrun', 'xacro', 'xacro', '--inorder', '/home/cs/ari_public_ws/src/ari_robot/ari_description/robots/ari.urdf.xacro', 'robot_model:=v1', 'end_effector_right:=ari-hand', 'end_effector_left:=ari-hand', 'laser_model:=sick-571', 'camera_model_head:=raspi', 'front_fisheye_camera:=false', 'back_fisheye_camera:=false', 'has_thermal:=false', 'simulation:=true']] returned with code [2]. 

Param xml is <param name="robot_description" command="rosrun xacro xacro --inorder     '$(find ari_description)/robots/ari.urdf.xacro'     robot_model:=$(arg robot_model)     end_effector_right:=$(arg end_effector_right)     end_effector_left:=$(arg end_effector_left)     laser_model:=$(arg laser_model)     camera_model_head:=$(arg camera_model_head)     front_fisheye_camera:=$(arg front_fisheye_camera)     back_fisheye_camera:=$(arg back_fisheye_camera)     has_thermal:=$(arg has_thermal)     simulation:=$(arg simulation)     $(arg multi)"/>
The traceback for the exception was written to the log file

I have tried running the simulation in both combinations of Ubuntu 18 with melodic and Ubuntu 20 with noetic in two different computers and both replicate the same issue. I have also tried to obtain additional information by running individual commands such as:
rosrun xacro xacro /home/cs/ari_public_ws/src/ari_robot/ari_description/urdf/head/head.urdf.xacro
but they produce the same error messages. I also focused on the installation of the realsense package as I am assuming the error is related to that, but without any success.
Has anyone experienced something similar or can replicate the installation and run the simulation without any problems?

A:

Since I have 18.04 machine with Melodic I thought I'd help you (got greedy for bounty )
Seems main problem is that they removed the this  package from melodic rosinstall:
- git: {local-name: realsense_simulation,    uri: 'https://github.com/pal-robotics/realsense_simulation.git', version: 'noetic-devel'}

the rosdep also didn't install multiple packages:

rosdep install --from-paths src --ignore-src --rosdistro melodic --skip-keys="opencv2 opencv2-nonfree pal_laser_filters speed_limit_node sensor_to_cloud hokuyo_node libdw-dev python-graphitesend-pip python-statsd pal_filters pal_vo_server pal_usb_utils pal_pcl pal_pcl_points_throttle_and_filter pal_karto pal_local_joint_control camera_calibration_files pal_startup_msgs pal-orbbec-openni2 dummy_actuators_manager pal_local_planner gravity_compensation_controller current_limit_controller dynamic_footprint dynamixel_cpp tf_lookup opencv3 librealsense2-dev librealsense2-dkms hey5_transmissions ydlidar_ros_driver" -y

Error:

ERROR: the following packages/stacks could not have their rosdep keys resolved
to system dependencies:
ari_bringup: Cannot locate rosdep definition for [twist_mux]
pal_navigation_cfg_pmb2: Cannot locate rosdep definition for [range_sensor_layer]
pal_navigation_cfg_pmb3: Cannot locate rosdep definition for [teb_local_planner]
pal_navigation_cfg_ari: Cannot locate rosdep definition for [teb_local_planner]
pal_gripper_description: Cannot locate rosdep definition for [urdf_test]
ari_moveit_tutorial: Cannot locate rosdep definition for [moveit_ros_planning_interface]
pal_navigation_cfg_tiago: Cannot locate rosdep definition for [range_sensor_layer]
ari_description: Cannot locate rosdep definition for [urdf_test]
realsense2_camera: Cannot locate rosdep definition for [librealsense2]
play_motion: Cannot locate rosdep definition for [moveit_ros_planning_interface]
ari_moveit_config: Cannot locate rosdep definition for [moveit_setup_assistant]
pal_navigation_cfg_omni_base: Cannot locate rosdep definition for [teb_local_planner]
realsense2_description: Cannot locate rosdep definition for [realsense_simulation]
pal_navigation_cfg_tiago_dual: Cannot locate rosdep definition for [range_sensor_layer]
four_wheel_steering_controller: Cannot locate rosdep definition for [urdf_geometry_parser]

So I installed them by hand:
sudo apt install ros-melodic-twist-mux
sudo apt install ros-melodic-range-sensor-layer
sudo apt install ros-melodic-teb-local-planner
sudo apt install ros-melodic-urdf-test
sudo apt install ros-melodic-moveit-ros-planning-interface
sudo apt install ros-melodic-moveit-setup-assistant
sudo apt install ros-melodic-urdf-geometry-parser

sudo apt install ros-melodic-aruco-ros
sudo apt install ros-melodic-zbar-ros
sudo apt install ros-melodic-four-wheel-steering-msgs

Proof that I got it working:

I spent more time on this that I care to admit, but it was fun to play with old pakcages, maybe I would try to put this into Docker if I could, I doubt there are many people willing to tinker with EOL'ed sources/packages.
(Give me the bounty now!  )

