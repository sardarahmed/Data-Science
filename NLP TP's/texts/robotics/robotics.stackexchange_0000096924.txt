Q:

cv_bridge: boost-python not found (Noetic, Fedora 32)

Any ideas why this fails and what the workaround is?
CMake Error at /usr/share/cmake/Modules/FindPackageHandleStandardArgs.cmake:164 (message):
  Could NOT find Boost (missing: python) (found version "1.69.0")
Call Stack (most recent call first):
  /usr/share/cmake/Modules/FindPackageHandleStandardArgs.cmake:445 (_FPHSA_FAILURE_MESSAGE)
  /usr/share/cmake/Modules/FindBoost.cmake:2166 (find_package_handle_standard_args)
  CMakeLists.txt:14 (find_package)

-- Configuring incomplete, errors occurred!
See also "/root/ros_catkin_ws/build_isolated/cv_bridge/CMakeFiles/CMakeOutput.log".
See also "/root/ros_catkin_ws/build_isolated/cv_bridge/CMakeFiles/CMakeError.log".
<== Failed to process package 'cv_bridge':
  Command '['/root/ros_catkin_ws/install_isolated/env.sh', 'cmake', '/root/ros_catkin_ws/src/vision_opencv/cv_bridge', '-DCATKIN_DEVEL_PREFIX=/root/ros_catkin_ws/devel_isolated/cv_bridge', '-DCMAKE_INSTALL_PREFIX=/root/ros_catkin_ws/install_isolated', '-DCMAKE_BUILD_TYPE=Release', '-G', 'Unix Makefiles']' returned non-zero exit status 1.

Reproduce this error by running:
==> cd /root/ros_catkin_ws/build_isolated/cv_bridge && /root/ros_catkin_ws/install_isolated/env.sh cmake /root/ros_catkin_ws/src/vision_opencv/cv_bridge -DCATKIN_DEVEL_PREFIX=/root/ros_catkin_ws/devel_isolated/cv_bridge -DCMAKE_INSTALL_PREFIX=/root/ros_catkin_ws/install_isolated -DCMAKE_BUILD_TYPE=Release -G 'Unix Makefiles'

Command failed, exiting.

CMake Error at /usr/share/cmake/Modules/FindPackageHandleStandardArgs.cmake:164 (message):
  Could NOT find Boost (missing: python) (found version "1.69.0")
Call Stack (most recent call first):
  /usr/share/cmake/Modules/FindPackageHandleStandardArgs.cmake:445 (_FPHSA_FAILURE_MESSAGE)
  /usr/share/cmake/Modules/FindBoost.cmake:2166 (find_package_handle_standard_args)
  CMakeLists.txt:14 (find_package)
   
-- Configuring incomplete, errors occurred!
See also "/root/ros_catkin_ws/build_isolated/cv_bridge/CMakeFiles/CMakeOutput.log".
See also "/root/ros_catkin_ws/build_isolated/cv_bridge/CMakeFiles/CMakeError.log".
<== Failed to process package 'cv_bridge':
  Command '['/root/ros_catkin_ws/install_isolated/env.sh', 'cmake', '/root/ros_catkin_ws/src/vision_opencv/cv_bridge', '-DCATKIN_DEVEL_PREFIX=/root/ros_catkin_ws/devel_isolated/cv_bridge', '-DCMAKE_INSTALL_PREFIX=/root/ros_catkin_ws/install_isolated', '-DCMAKE_BUILD_TYPE=Release', '-G', 'Unix Makefiles']' returned non-zero exit status 1.

Reproduce this error by running:
==> cd /root/ros_catkin_ws/build_isolated/cv_bridge && /root/ros_catkin_ws/install_isolated/env.sh cmake /root/ros_catkin_ws/src/vision_opencv/cv_bridge -DCATKIN_DEVEL_PREFIX=/root/ros_catkin_ws/devel_isolated/cv_bridge -DCMAKE_INSTALL_PREFIX=/root/ros_catkin_ws/install_isolated -DCMAKE_BUILD_TYPE=Release -G 'Unix Makefiles'

Command failed, exiting.

  pthread_t thread;
  pthread_create(&thread, NULL, test_func, NULL);
  pthread_detach(thread);
  pthread_cancel(thread);
  pthread_join(thread, NULL);
  pthread_atfork(NULL, NULL, NULL);
  pthread_exit(NULL);

  return 0;
}

Determining if the function pthread_create exists in the pthreads failed with the following output:
Change Dir: /root/ros_catkin_ws/build_isolated/cv_bridge/CMakeFiles/CMakeTmp

Run Build Command(s):/usr/bin/gmake cmTC_84cd7/fast && /usr/bin/gmake  -f CMakeFiles/cmTC_84cd7.dir/build.make CMakeFiles/cmTC_84cd7.dir/build
gmake[1]: Entering directory '/root/ros_catkin_ws/build_isolated/cv_bridge/CMakeFiles/CMakeTmp'
Building C object CMakeFiles/cmTC_84cd7.dir/CheckFunctionExists.c.o
/usr/bin/cc   -DCHECK_FUNCTION_EXISTS=pthread_create   -o CMakeFiles/cmTC_84cd7.dir/CheckFunctionExists.c.o   -c /usr/share/cmake/Modules/CheckFunctionExists.c
Linking C executable cmTC_84cd7
/usr/bin/cmake -E cmake_link_script CMakeFiles/cmTC_84cd7.dir/link.txt --verbose=1
/usr/bin/cc  -DCHECK_FUNCTION_EXISTS=pthread_create    -rdynamic CMakeFiles/cmTC_84cd7.dir/CheckFunctionExists.c.o  -o cmTC_84cd7  -lpthreads
/usr/bin/ld: cannot find -lpthreads
collect2: error: ld returned 1 exit status
gmake[1]: *** [CMakeFiles/cmTC_84cd7.dir/build.make:107: cmTC_84cd7] Error 1
gmake[1]: Leaving directory '/root/ros_catkin_ws/build_isolated/cv_bridge/CMakeFiles/CMakeTmp'
gmake: *** [Makefile:141: cmTC_84cd7/fast] Error 2

Originally posted by RobbieTheK on ROS Answers with karma: 43 on 2020-08-25
Post score: 0

A:

Any ideas why this fails and what the workaround is?

The error message seems rather clear:

Could NOT find Boost (missing: python) (found version "1.69.0")

according to CMake, your Boost installation does not have the python module.
So two options:

if you're certain it should be present, try to find out why CMake doesn't find it
if it's not present, make sure to install it

Looks like this documents a similar problem.

Edit: from trying this out in a Docker container (fedora:32), it would appear the version suffix for Boost Python 1.69 on Fedora 32 needs to be python3.8.
So it seems this would need to be changed in cv_bridge/CMakeLists.txt, specifically these lines.

Originally posted by gvdhoorn with karma: 86574 on 2020-08-25
This answer was ACCEPTED on the original site
Post score: 1

Original comments
Comment by RobbieTheK on 2020-08-25:
it's there:
locate libboost_python
/usr/lib64/libboost_python38.a
/usr/lib64/libboost_python38.so
/usr/lib64/libboost_python38.so.1.69.0
Package boost-python3-1.69.0-18.fc32.x86_64 is already installed.

I found a suggestion to use elseif in the CMakeList.txt file, but I'm not sure how to do that and which file that is.
Or does this suggestion to use BOOST_AUTO_LINK_TAGGED or BOOST_AUTO_LINK_VERSIONED or BOOST_AUTO_LINK_SYSTEM apply? Not sure which to choose, unless that's only for Windows.
Comment by gvdhoorn on 2020-08-25:
I have no idea right now.
Does a plain CMakeLists.txt with something like this also fail?
cmake_minimum_required(VERSION 3.5)
project(test CXX)
find_package(Boost REQUIRED COMPONENTS python)

If it does, this would not be a ROS problem any more, but a plain CMake one.

Package boost-python3-1.69.0-18.fc32.x86_64 is already installed.

does that also install the development headers? Those are typically needed, not just the runtime library.

Edit: this is the logic used in cv_bridge/CMakeLists.txt. It could be the conditional there doesn't work on your system.
Perhaps the python there should be python38 or something similar.
Comment by RobbieTheK on 2020-08-25:
I believe the dev headers were already isntalled:
Package boost-python3-devel-1.69.0-18.fc32.x86_64 is already installed.

What folder is the correct CMakeLists.txt file that I should be looking for? Is it ~/src/vision_opencv/cv_bridge/CMakeLists.txt So just remove all of the contents of that file and replace it with your suggested 3 lines?
Comment by gvdhoorn on 2020-08-25:\

So just remove all of the contents of that file and replace it with your suggested 3 lines?

No.
You create a new empty directoy somewhere (perhaps in /tmp), then create a new, empty CMakeList.txt and add those lines. Then save. Then mkdir build; cd build; cmake ...
Comment by RobbieTheK on 2020-08-25:
What would the full cmake command be?
Comment by gvdhoorn on 2020-08-25:
That is the full cmake command.
Comment by RobbieTheK on 2020-08-25:
Perhaps the python there should be python38 or something similar.
I changed in ~/src/vision_opencv/cv_bridge/CMakeLists.txt
    find_package(Boost REQUIRED python3.8)
  else()
    find_package(Boost REQUIRED python3.8)

Now getting a different error:
Errors     << controller_interface:cmake /root/ros_catkin_ws/logs/controller_interface/build.cmake.002.log
CMake Warning at /root/ros_catkin_ws/install/share/catkin/cmake/test/gtest.cmake:160 (message):
  skipping gmock 'controller_base_test' in project 'controller_interface'
  because gmock was not found
Call Stack (most recent call first):
  /root/ros_catkin_ws/install/share/catkin/cmake/test/gtest.cmake:89 (_catkin_add_executable_with_google_test)
  /root/ros_catkin_ws/install/share/catkin/cmake/test/gtest.cmake:63 (_catkin_add_google_test)
  CMakeLists.txt:33 (catkin_add_gmock)

CMake Error at /root/ros_catkin_ws/src/ros_control/controller_interface/CMakeLists.txt:34 (target_link

Comment by RobbieTheK on 2020-08-25:
ok
That is the full cmake command.

Got it thanks see below:
cmake ..
-- The CXX compiler identification is GNU 10.2.1
-- Check for working CXX compiler: /usr/bin/c++
-- Check for working CXX compiler: /usr/bin/c++ - works
-- Detecting CXX compiler ABI info
-- Detecting CXX compiler ABI info - done
-- Detecting CXX compile features
-- Detecting CXX compile features - done
CMake Error at /usr/share/cmake/Modules/FindPackageHandleStandardArgs.cmake:164 (message):
  Could NOT find Boost (missing: python) (found version "1.69.0")
Call Stack (most recent call first):
  /usr/share/cmake/Modules/FindPackageHandleStandardArgs.cmake:445 (_FPHSA_FAILURE_MESSAGE)
  /usr/share/cmake/Modules/FindBoost.cmake:2166 (find_package_handle_standard_args)
  CMakeLists.txt:3 (find_package)
 
-- Configuring incomplete, errors occurred!
See also "/tmp/build/CMakeFiles/CMakeOutput.log".

Comment by gvdhoorn on 2020-08-25:
Your last two comments are confusing.
Did it or did it not work?
Comment by RobbieTheK on 2020-08-25:
Sorry Your last two comments are confusing.
The cmake command from /tmp fails with:
CMake Error at /usr/share/cmake/Modules/FindPackageHandleStandardArgs.cmake:164 (message):
  Could NOT find Boost (missing: python) (found version "1.69.0")
Call Stack (most recent call first):
  /usr/share/cmake/Modules/FindPackageHandleStandardArgs.cmake:445 (_FPHSA_FAILURE_MESSAGE)
  /usr/share/cmake/Modules/FindBoost.cmake:2166 (find_package_handle_standard_args)
  CMakeLists.txt:3 (find_package)

In the mean time I made a change to ~/src/vision_opencv/cv_bridge/CMakeLists.txt and replaced the Python version to 3.8 as noted and now getting a different error when running catkin_build:
CMake Warning at /root/ros_catkin_ws/install/share/catkin/cmake/test/gtest.cmake:160 (message):
  skipping gmock 'controller_base_test' in project 'controller_interface'
  because gmock was not found

But it's there:
gtest-devel-1.10.0-1.fc32.x86_64 & gtest-devel-1.10.0

Comment by gvdhoorn on 2020-08-25:
Can't help you with that I'm afraid.
Your original problem was sort-of solved (ie: problems with Python detection), so I suggest you open a new question.
And mark this one as answered.
Comment by gvdhoorn on 2020-08-25:\

In the mean time I made a change to ~/src/vision_opencv/cv_bridge/CMakeLists.txt and replaced the Python version to 3.8 as noted

it would be good to submit this as a PR to the cv_bridge repository. Otherwise the next person trying to build this on Fedora will run into the same problem(s).
Comment by RobbieTheK on 2020-08-25:
@gvdhoorn is correct ~/src/vision_opencv/cv_bridge/CMakeLists.txt needs to reference Python 3.8. I believe my previous attempts were failing as the original line had:
 if(PYTHONLIBS_VERSION_STRING VERSION_LESS "3.8")

I changed it to the following and even modified the last line in case the version string check failed so it'd always find python3.8:
  if(PYTHONLIBS_VERSION_STRING VERSION_LESS "3.9")
    # Debian Buster
    find_package(Boost REQUIRED python3.8)
  else()
    # Ubuntu Focal
    find_package(Boost REQUIRED python)
  endif()
else()
find_package(Boost REQUIRED python3.8)
endif()

This will probably have to change for Python 3.9
I also do not know how to submit a PR and my hack is probably not the best practice nor most correct way around this.

