Q:

mqtt_bridge's Problem

I just installed mqtt_bridge on the ROS Melodic
But when i use
roslaunch mqtt_bridge demo.launch

it always shown this problem.
i have installed the python module inject
Problem is :
Traceback (most recent call last):
  File "/home/kevin/catkin_ws/src/mqtt_bridge-master/scripts/mqtt_bridge_node.py", line 5, in <module>
    from mqtt_bridge.app import mqtt_bridge_node
  File "/home/kevin/catkin_ws/src/mqtt_bridge-master/src/mqtt_bridge/app.py", line 4, in <module>
    import inject
ImportError: No module named inject
[mqtt_bridge-1] process has died [pid 7778, exit code 1, cmd /home/kevin/catkin_ws/src/mqtt_bridge-master/scripts/mqtt_bridge_node.py __name:=mqtt_bridge __log:=/home/kevin/.ros/log/2b77c57e-5fd2-11ea-bb19-f894c224a270/mqtt_bridge-1.log].
log file: /home/kevin/.ros/log/2b77c57e-5fd2-11ea-bb19-f894c224a270/mqtt_bridge-1*.log
all processes on machine have died, roslaunch will exit

Originally posted by KevinZehou on ROS Answers with karma: 3 on 2020-03-06
Post score: 0

A:

Hi,
I recently struggled with the same problem, so follow these instructions and it would get working:

If you have both Python 2 and Python 3 at the same system then founding the right packages in the right directories can become a big mess. What I did was use Pycharm (virtual environment) and use Python 2.7 as the interpreter when you create a new project.

Use the command 'python -m site' and see the defined directories to look for the required packages. For example, right now it can't find the inject package in the defined directories but the package would be installed (probably in python 3.7 directory).

Install the specified required versions listed in the requirements.txt packages and NOT the latest ones. Use the pip install --target=/someplace package_name.version For example, I downloaded the packages in the python2.7/sitepackages

Start mosquitto by just writing 'mosquitto' in a new terminal.

Run the roslaunch command.

You might also have to install the rosbridge package.

Do these steps and I believe it will get working. I spent a lot of time struggling with the same issue so hopefully it helps :)

Originally posted by Shazam with karma: 26 on 2020-03-08
This answer was ACCEPTED on the original site
Post score: 1

Original comments
Comment by KevinZehou on 2020-03-08:
Thank you very much for your help.
I tried the steps you told, and it really works. I install the modules with the right versions which shown in the requirements. But some problems happened, i tried many ways to solve the problems but it still not work.
When i install the 'bson 0.5.2' , this problems hanppened.
The errors are:
n"/tmp/pip-install-t42_ ev/bson/setup.py"t's flle_ - 1nL '/tmp/pip-lnstall-t42_ ev /bson/setup. py'" '"l;f-getattr(tokenlile'open'do', open)(_ file_ );code-f.read().replace(liairln
Tn"0f.close();exec(complle(code, file_ exec")' egg. info · -egg base 7tmp/plp -install-t42 ev/bson/pip-egg in
cwd: /tmp/pip-install-t42_ ev/bson/
Complete output (5 Lines):
File "/tmp/pip-install-t42 ev/bson/setup.py", line 8, in «module>
from plp import get_ Installed_ distributions
ImportError: cannot tmport name get installed _distributtons
ERROR: Conmand errored out with exit status 1: python setup-py egg info Check the logs for full command output.
Comment by Shazam on 2020-03-08:
Hi,
Is mosquitto running? and secondly uninstall bson. Then install bson it with the specified version in the target directory of python2.7/sitepackages
Comment by KevinZehou on 2020-03-08:
Thank you very much for your help.
It finally working. I installed 'pymongo bson' and did the steps you guide me.
And there is one more problem which is: [WARN] [1583671503.426540]: Inbound TCP/IP connection failed: connection from sender terminated before handshake header received. 0 bytes were received. Please check sender for additional details.
Comment by Shazam on 2020-03-08:
Actually, I'm also facing a similar issue and trying to solve it. Can you please explain what you're trying to do and where you are sending these values through mqtt? Which web platform are you using?
Comment by KevinZehou on 2020-03-08:
Sure.
I was just triyng to test it: Publish "hello" to /echo and see response to /back.
It's not really stable and i am not sure when it happened. When i do it the first time this problem happened but when i try it again, no warning happened.
I am using Ubuntu 18.04LTS, and ROS Melodic.
Comment by Shazam on 2020-03-08:
I'm glad to know it's working. Let me know if you try some application over it by connecting it to a web platform.
Comment by KevinZehou on 2020-03-08:
No Problem. Thanks for your help!!
Comment by Shazam on 2020-06-05:
Hi, did you build anything using this package?

