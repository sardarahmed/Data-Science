Q:

Reading Potentiometer in ROS

Hey Folks,
I am trying to read potentiometer value in ROS, but I stuck with error
#include <ros.h>
#include <ros/time.h>

/*
  AnalogReadSerial
  Reads an analog input on pin 0, prints the result to the serial monitor.
  Graphical representation is available using serial plotter (Tools > Serial Plotter menu)
  Attach the center pin of a potentiometer to pin A0, and the outside pins to +5V and ground.

  This example code is in the public domain.
*/

// the setup routine runs once when you press reset:
void setup() {
  // initialize serial communication at 9600 bits per second:
  Serial.begin(9600);
}

// the loop routine runs over and over again forever:
void loop() {
  // read the input on analog pin 0:
  int sensorValue = analogRead(A0);
  // print out the value you read:
  Serial.println(sensorValue);
  delay(1);        // delay in between reads for stability
}

To be honest, sometimes I don't understand why baudrate is not mentioned in ROSlib. or what the right code I should write for receiving analog signal.
Best,
Marwa

Originally posted by marwa eldiwiny on ROS Answers with karma: 51 on 2016-11-13
Post score: 0

Original comments
Comment by NEngelhard on 2016-11-13:
You forgot to actually describe your problem. What happens? What should happen? Which error message do you get?
Comment by gvdhoorn on 2016-11-13:
Also: even though ros.h is included in the code snippet, nothing of rosserial is used here, so this code cannot communicate with the PC side of rosserial at all. rosserial acts as a bridge, it isn't a generic connect-whatever-to-a-serial-port-and-it-will-work library.

A:

I always get an error (especially unsync errors) when I use Serial.something instructions inside Arduino (your code looks like arduino even you didn't mention it) together with ROS communication. If you use rosserial to communicate with arduino, you have to use nothing but a ROS publisher. But I admit I don't know why.
I mainly followed these tutorial and remove any other Serial.something instructions from arduino code. Changing a bit some of these tutorials I manage to publish in ROS topics: numbers, arrays of numbers, strings. I have some problems with a string subscriber.

Originally posted by marcoresk with karma: 76 on 2016-11-13
This answer was ACCEPTED on the original site
Post score: 0

Original comments
Comment by gvdhoorn on 2016-11-13:\

If you use rosserial to communicate with arduino, you have to use nothing but a ROS publisher. But I admit I don't know why.

that's relatively simple: both Serial.* and ROS will use the serial port to communicate with the other side. The rosserial node(s) running on your PC will not ..
Comment by gvdhoorn on 2016-11-13:
.. deal with anything but the binary protocol used by the Arduino side of rosserial, so if you use anything from Serial, there will be rosserial traffic mixed with other "stuff". rosserial has no way to filter that out, so it cannot deal with that. Only thing it can conclude is that ..
Comment by gvdhoorn on 2016-11-13:
.. some of the bytes it is expecting have been corrupted, leading to a sync error.
It is possible to use Serial.* and rosserial together, but they would have to be configured to use different serial ports.
Comment by marwa eldiwiny on 2016-11-14:
Thanks, simply I am trying read potentiometer values in ROS and plotting them in python plot tool, I am doing this because I don't want to use MATLAB.
I am using arduino uno, potentiometer that is it.
Comment by Taylorson on 2018-11-20:
So in conclusion did you use rosserial or not? Can you update if you have changed anything?

