Q:

Pubish custom odometry information for robot_localization

hello everyone. I am trying to publish a new custom odomtery information for robot_localization package. I have a sensor which is giving me a position x and y and i want to use that to locate my robot. Since i want to fuse this odomtery information with robot's wheel odometry information, Other things like Twist can be zero as i will use robot's odometry for that purpose.My sensor is recording the positioning information in a .txt file and i will be reading that values to use. How should i modify things to get ting running.
#!/usr/bin/env python
# license removed for brevity
import rospy
import time
from std_msgs.msg import String
from nav_msgs.msg import Odometry
def odom1():
    global x
    global y
    pub = rospy.Publisher('odom1', Odometry, queue_size=10)
    rospy.init_node('publisher_turtlebot', anonymous=True)
    rate = rospy.Rate(10) # 10hz
    while not rospy.is_shutdown():
        f= open ("x.txt", "r")
        x= f.readlines()
        f1= open ("y.txt", "r")
        y= f1.readlines()
        odom1= Odometry()
        odom1.header.stamp= rospy.Time.now()
        odom1.header.frame_id = "odom"
        odom1.pose.pose.position.x= x
        odom1.pose.pose.position.y= y
        pub.publish(odom1())
        rate.sleep()
if __name__ == '__main__':
    try:
        odom1()
    except rospy.ROSInterruptException:
        pass``

One file read x and other read y. I am getting this error.
Error: Odometry object is not callable.
What should i do? I am using kinetic kame with ubuntu 16.04 and python.

Originally posted by enthusiast.australia on ROS Answers with karma: 91 on 2019-09-17
Post score: 0

Original comments
Comment by PeteBlackerThe3rd on 2019-09-18:
It sounds like you're trying to integrate a GPS like sensor, those also produce position information but without heading information. Have you looked at the instructions for GPS here?

A:

You can take a look here, you can publish it as either Odometry message or as PoseWithCovarianceStamped. According to this frame_id should be map/odom and child_link should be base_link.
EDIT:
You need to make and odom object of type Odometry(), and add information to it.
odom = Odometry()
odom.header.stamp = rospy.Time.now()
odom.header.frame_id = "odom"
odom.child_frame = "base_link"
odom.pose.pose.position.x = x         # x you read through your text file
odom.pose.pose.position.y = y         # y you read through your text file
pub.publish(odom)

Originally posted by Choco93 with karma: 685 on 2019-09-17
This answer was ACCEPTED on the original site
Post score: 0

Original comments
Comment by enthusiast.australia on 2019-09-17:
My frame id would be odom and child_link be base_link, But i am not sure how to add up this info. Should i format my data and the way it is recording or should i change my code? In either way, what should i do ?
because if i run above code, i get this error.
Invalid number of arguments., arguments should be [header, child_frame_id, pose, twist]  args are [x:1.25254689 y:1.23585785 theta=0]
In case of using Odometry or PoseWithCovarianceStamped, then what things should i do so that i could use it in robot_localization?
Comment by Choco93 on 2019-09-18:
You cannot just read a text file and pass it to a publisher, when making publisher you specifically told it to expect Odometry type message, so you need to provide an Odometry message. Take a look at my edited answer.
Comment by enthusiast.australia on 2019-09-18:
I have changed my question and also have updated the code, but i am still having the problem. Any suggestions??
Comment by Choco93 on 2019-09-18:
change pub.publish(odom1()) to pub.publish(odom1)
Comment by enthusiast.australia on 2019-09-18:
thanks. got it. Silly mistake

