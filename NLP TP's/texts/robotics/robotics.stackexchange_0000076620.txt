Q:

Valgrind and GDB on same roslaunch File

Folks,
How can I launch both valgrind and gdb on the same launch file? It seems that I can only add one "launch-prefix" attribute on my lunch file.
This is what I tried:
launch-prefix="valgrind --vgdb=yes --vgdb-error=0" launch-prefix="xterm -e gdb --args set non-stop off target remote | vgdb run"

but I get that "duplicate attribute" error.
Or is there another way to look for ALL possible errors that can be happening in my program? Can GDB be enough to catch all the program errors, including memory leaks?

Originally posted by Pototo on ROS Answers with karma: 803 on 2016-10-05
Post score: 0

Original comments
Comment by gvdhoorn on 2016-10-06:
I don't think this kind of combination was considered when launch-prefix was designed and implemented. vgdb support in Vagrind is relatively new (~2014?).

A:

I don't think it would be possible to use the launch-prefix route to get what you want. For vgdb to work, your node needs to be loaded into Valgrind, which will then start its own gdb server. The gdb session would then connect to that server. launch-prefix just takes the full path to the node roslaunch would normally start, prefixes it with your set prefix (ie: gdb ..), appends some parameters and the starts the entire command.
In your case it would seem Valgrind should be started with your node, with gdb connecting after that. Problem is that launch-prefix does not support that scenario. Valgrind could perhaps run in the background, but that is not how launch-prefix is supposed to work.
A work-around (for now, until someone comes up with a better way) could be to not launch your node through a launch file, but separately from the command line. The rest of your system could still be configured and setup using a launch file of course.
Another approach which might work is to use a wrapper bash script. That script would take care of starting Valgrind and gdb, and you'd use the wrapper script as a launch-prefix. That would allow you to start your entire system using a launch file. But without starting Valgrind as a background task, I'm not sure how this is going to be different.

Originally posted by gvdhoorn with karma: 86574 on 2016-10-06
This answer was ACCEPTED on the original site
Post score: 0

