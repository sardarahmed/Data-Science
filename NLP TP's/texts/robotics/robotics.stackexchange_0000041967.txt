Q:

ROS Answers SE migration: rviz problems

Hello
I installed some package and run them , after that should open up the visualisation tool, in which I should be able to see the wheelchair moving in the map created using the some data. But when opened the rviz the wheelchair is not moving, I got some warning like 3D acceleration is not enable. Im running ubuntu 10.4 on a Virtual Box machine from Oracle.
This is my launch file and the data bag file.
Perform AMCL localisation: runs several nodes to generate odometry from laser scans (ICP) & IMU, loads a map of the POW assessment area, runs AMCL, plays back a dataset for localisation, and runs the visualiser with the correct visualisation parameters configured.
<node name="rosplay" pkg="rosbag" type="play" args="/home/bojan/Desktop/PowRos/Data/user2/pow_pat1_1_2011-04-01-13-48-20.bag            --clock"/>

<node pkg="tf" type="static_transform_publisher" name="baselink_laser" args="0 0 0 0 0 0 /base_link /laser 10"/>
<node pkg="tf" type="static_transform_publisher" name="laser_imu" args="0 0 0 0 0 0 /laser /base_imu 10"/>
<node pkg="tf" type="static_transform_publisher" name="baselink_camera" args="0 0 0 0 0 0 /base_link /camera 10"/>

<!-- Start the map server node and specify the map file (*.pgm) and the map resolution in metres/pixel -->
<node name="map_server" pkg="map_server" type="map_server" args="$(find amcl_listener)/maps/pow_real_time.yaml"         output="screen"/>

<!--Start the Laser_scan_matcher package, to provide odometry from laser data (ICP)-->
<node pkg="laser_scan_matcher" type="laser_scan_matcher_node" 
    name="laser_scan_matcher_node" output="screen">
    <param name="use_alpha_beta" value="true"/>
    <param name="max_iterations" value="10"/>
</node>

<!-- Start the gmapping node -->
<!--node pkg="gmapping" type="slam_gmapping" name="slam_gmapping" output="screen"/-->

<node pkg="amcl" type="amcl" name="amcl" respawn="true" output="screen">
    <param name="base_frame_id" value="base_link"/>
    <param name="odom_frame_id" value="world"/>
    <param name="global_frame_id" value="map"/>
    <param name="update_min_d" value="0.09"/>   
    <param name="update_min_a" value="0.09"/> 
    <param name="initial_pose_x" value="-1"/>
    <param name="initial_pose_y" value="0"/>
    <param name="initial_pose_a" value="-0.1"/>
    <param name="min_particles" value="6000"/> 
    <param name="max_particles" value="8000"/>
    <param name="odom_model_type" value="diff"/>
    <param name="kld_err" value="0.1"/> 
    <param name="resample_interval" value="1"/>
    <param name="odom_alpha1" value="0.2"/>   
    <param name="odom_alpha2" value="0.2"/>
    <param name="odom_alpha3" value="0.5"/>
    <param name="odom_alpha4" value="0.5"/>
    <param name="laser_max_beams" value="30"/>
</node>

<!--Start the "analyzer_packages"-->
<!-- acml_listener broadcasts markers for the position of the wheelchair, to visualize in Rviz-->
<node pkg="amcl_listener" type="amcl_pose_listener" name="amcl_listener" output="screen"/>
<!-- Object node records minimal ranges from laser, speed_node will record travel speed of wheelchair -->
<node pkg="pow_analyzer" type="object_node" name="object_node" output="screen"/>
<node pkg="pow_analyzer" type="speed_node" name="speed_node" output="screen"/>

<!-- Start an rviz node with a custom configuration for the viewpoint, map_server, trajectory, laser scans, etc -->
<node pkg="rviz" type="rviz" output="screen" name="rviz" args="-d $(find pow_analyzer)/launch/pow_rviz.vcg"/>

Also in the rviz the ROS elapsed time is zero, which should not be the case
Any helpÂ¿
Ok will explain in details.
Yes Rviz is working ( eg with a grid), is initializing and so on. I can see the wheelchair in the map , but can not  see for example the camera window, and also the  wheelchair is not moving in the map ( so nothing happened). Because the wheelchar should be moving in the map created using the some data. OK?
I installed successfully and also compiled the following packages: amcl_listener, pow_analyzer, gps_common, cereal_port, lse_xsens_mti, csm, laser_scan_matcher. So there are 2 internal and 5 external packages. after launch the file, its running and opened the rviz, but during the running in a terminal got that warning about the 3d accelaration.

Originally posted by Astronaut on ROS Answers with karma: 330 on 2012-07-05
Post score: 0

Original comments
Comment by Astronaut on 2012-07-05:
Is this enough or need more exactly states?
Comment by Astronaut on 2012-07-05:
Any help please?
Comment by Astronaut on 2012-07-10:
How to setup to match the data in the logfile? And how to check if odom frame from amcl is "world" or not?
Comment by Astronaut on 2012-07-10:
I should run the command  rosrun tf tf_echo /map /base_link on the terminal before running the launch?
Comment by Astronaut on 2012-07-10:
the  rosrun tf tf_echo /map /base_link does not produce nothing. So what should I do?

A:

Do you see rviz working (e.g. with a grid) or not? i.e. is the problem that rviz works but nothing is happening, or do you not see anything in rviz.
rviz needs 3D acceleration, so this could be problematic in a virtual machine.
For more details please state exactly what you are doing and seeing, "installed some package", "run them", "got some warning" isn't helpful to debug what is going on.
As you can see the grid and model I will assume that rviz itself is working. I guess therefore there is some misconfiguration. Your setup needs to match the data in the logfile. One error might be that the odom frame for amcl is "world", usually it's odom. What is correct depends on the odom in your logfile.
You can check that amcl is producing something by running rosrun tf tf_echo /map /base_link that should give your the robot pose. If that changes the robot should move.
To test that rviz itself displays correctly you can set the fixed frame to your odom frame and should see odom movement.

Originally posted by dornhege with karma: 31395 on 2012-07-05
This answer was ACCEPTED on the original site
Post score: 1

