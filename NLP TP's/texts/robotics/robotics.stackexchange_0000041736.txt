Q:

Problem running pointcloud_to_laserscan launch file

I'm attempting to use the pointcloud_to_laserscan stack with data we have collected from a sonar scan which has been converted in to pointcloud2 data. I'm a little confused at how nodelet's and also pointcloud_to_laserscan's work. I found (and attempted to replicate for this application) the turtlebot launch files for use with Kinect (https://kforge.ros.org/turtlebot/turtlebot/file/ee8b48e42178/turtlebot_bringup/kinect.launch) however it's still a little unclear.
The below launch file runs without error, however no laserScan msg is output.
<launch>
    <!--    DISPLAY NAME    NODE NAME       RUN NAME        ARGUMENTS       -->
    <node name="Scanner"    pkg="sonar"     type="sonar"    />
    <node name="Injector"   pkg="sonarInjector"     type="sonarInjector"    />
    <node name="Pointcloud" pkg="sonarPointCloud"   type="sonarPointCloud"  />

    <!-- fake laser -->
    <node pkg="nodelet" type="nodelet" name="sonarToLaser" args="load pointcloud_to_laserscan/CloudToScan sonarPointCloud">
    <param name="output_frame_id" value="/base_sonar2"/>
    <remap from="cloud" to="sonarPC"/>
    <remap from="scan" to="sonarLaserz"/>
    </node>
</launch>

Any advice on which direction to go in next and what might be wrong.
Thanks

Originally posted by alexsleat on ROS Answers with karma: 41 on 2012-06-26
Post score: 3

A:

I managed to get this working as a nodelet, by just adding a nodelet manager (as below).
I'm still working on getting the sonar data correctly in to it, if I'm successful I will make sure to submit the code.
<launch>

    <!--    DISPLAY NAME    NODE NAME   RUN NAME    ARGUMENTS   -->
    <!-- <node name="Scanner"   pkg="sonar" type="sonar"    /> -->
    <!-- <node name="Injector"  pkg="sonarInjector" type="sonarInjector"    /> -->
    <!-- <node name="Pointcloud"    pkg="sonarPointCloud"   type="sonarPointCloud"  /> -->

    <node pkg="nodelet" type="nodelet" name="sonarManager" output="screen" respawn="true" args="manager"/>

<!-- fake laser -->
    <node pkg="nodelet" type="nodelet" name="sonarToLaser" args="load pointcloud_to_laserscan/CloudToScan sonarManager">
        <param name="output_frame_id" value="/base_sonar"/>
        <remap from="cloud" to="sonarPC"/>
        <remap from="scan" to="sonarLaser"/>
    </node>

</launch>

Originally posted by alexsleat with karma: 41 on 2012-06-27
This answer was ACCEPTED on the original site
Post score: 1

Original comments
Comment by A_Saeed on 2017-05-07:
Hi alex, my work is similar to yours, but I'm directly publishing pointcloud from sonar sensor using range finder, when I use your launch file at start the things work fine but as soon as I subscribe sonarLaser topic the process dies and previous subscription also terminates. Can you guide me please
Comment by M@t on 2017-07-17:
FYI, I found that this code didn't work for me as-is. I got a bunch of errors about "CloudToScan" not being a nodelet package.

