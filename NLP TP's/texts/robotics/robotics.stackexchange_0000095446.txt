Q:

moveit pick failed with controller running

I'm using ubuntu 16.04 on a Huawei Matebook-x, with kernel 4.15.0-91-generic. ROS distro: kinetic and version 1.12.14. Gazebo 7. My repository is at https://github.com/yiyinglai/FetchIt.
I was doing something similar to this tutorial and launched gazebo, rviz and controllers using
roslaunch niryo_one_d415_moveit_config niryo_one_d415_coca_cola.launch

and a niryo_one_pick_place node (I removed the place part from the tutorial) using
roslaunch niryo_one_pick_place pick_place.launch 

When the object is not obstructing the robot (or when gazebo is not even launched, I believe), the pick operation carries out as expected. As shown in the video below, the robot arm approaches, picks up and retreats with the object attached at the tool_link.
IMAGE ALT TEXT HERE http://img.youtube.com/vi/oMA3ixH3ulM/0.jpg
The main logging:
[ INFO] [1586817787.310136812, 17.032000000]: Planning attempt 1 of at most 1
[ INFO] [1586817787.350711758, 17.038000000]: Added plan for pipeline 'pick'. Queue is now of size 1
[ INFO] [1586817787.420852165, 17.051000000]: Planner configuration 'arm' will use planner 'geometric::RRTConnect'. Additional configuration parameters will be set when the planner is constructed.
[ INFO] [1586817787.422522438, 17.051000000]: RRTConnect: Starting planning with 1 states already in datastructure
[ INFO] [1586817787.469576948, 17.061000000]: RRTConnect: Created 5 states (2 start + 3 goal)
[ INFO] [1586817787.476083876, 17.066000000]: Solution found in 0.054375 seconds
[ INFO] [1586817787.550710569, 17.078000000]: SimpleSetup: Path simplification took 0.074395 seconds and changed from 4 to 2 states
[ INFO] [1586817787.561913385, 17.081000000]: Found successful manipulation plan!
[ INFO] [1586817787.562412652, 17.081000000]: Pickup planning completed after 0.252041 seconds
[ INFO] [1586817798.348857044, 21.571000000]: Completed trajectory execution with status SUCCEEDED ...

When the object is actually in place in gazebo, the pick operation failed as shown in the video below.
IMAGE ALT TEXT HERE http://img.youtube.com/vi/EhhIjNf34As/0.jpg
Here is the main logging:
[ INFO] [1586814556.588570711, 20.136000000]: Planning attempt 1 of at most 1
[ INFO] [1586814556.622188757, 20.140000000]: Added plan for pipeline 'pick'. Queue is now of size 1
[ INFO] [1586814556.723219387, 20.167000000]: Manipulation plan 0 failed at stage 'reachable & valid pose filter' on thread 0
[ WARN] [1586814556.724581191, 20.168000000]: All supplied grasps failed. Retrying last grasp in verbose mode.
[ INFO] [1586814556.724829331, 20.168000000]: Re-added last failed plan for pipeline 'pick'. Queue is now of size 1
[ INFO] [1586814556.743553190, 20.168000000]: IK failed
[ INFO] [1586814556.811681475, 20.182000000]: IK failed
[ INFO] [1586814556.816149899, 20.183000000]: Orientation constraint satisfied for link 'tool_link'. Quaternion desired: 0.500000 0.500000 0.500000 0.500000, quaternion actual: 0.497276 0.500788 0.503431 0.498483, error: x=0.003857, y=0.008457, z=0.001453, tolerance: x=0.010000, y=0.010000, z=0.010000
[ INFO] [1586814556.816250318, 20.183000000]: Position constraint satisfied on link 'tool_link'. Desired: 0.365000, 0.000000, 0.350000, current: 0.364621, 0.000658, 0.349397
[ INFO] [1586814556.816288274, 20.183000000]: Differences 0.000379473 -0.00065784 0.000603184
[ INFO] [1586814556.868221647, 20.192000000]: Planner configuration 'arm' will use planner 'geometric::RRTConnect'. Additional configuration parameters will be set when the planner is constructed.
[ INFO] [1586814556.878696365, 20.194000000]: RRTConnect: Starting planning with 1 states already in datastructure
[ INFO] [1586814556.932857325, 20.206000000]: RRTConnect: Created 5 states (2 start + 3 goal)
[ INFO] [1586814556.932964881, 20.206000000]: Solution found in 0.054882 seconds
[ INFO] [1586814557.085873285, 20.274000000]: SimpleSetup: Path simplification took 0.148457 seconds and changed from 4 to 2 states
[ INFO] [1586814557.091500229, 20.274000000]: Found successful manipulation plan!
[ INFO] [1586814557.092162406, 20.274000000]: Pickup planning completed after 0.135788 seconds
[ WARN] [1586814566.283325285, 23.784000000]: Controller handle gripper_controller reports status RUNNING
[ INFO] [1586814566.283490483, 23.784000000]: Completed trajectory execution with status RUNNING ...

and the logging from niryo_one_pick_place node:
[ WARN] [1586814566.613105372, 23.874000000]: Fail: ABORTED: Solution found but controller failed during execution
[ INFO] [1586814567.613333054, 24.195000000]: Bye!
[niryo_one_pick_place-1] process has finished cleanly
log file: /home/yiying/.ros/log/81b0d5c2-7dd0-11ea-be4c-7c11cb4ab0c1/niryo_one_pick_place-1*.log
all processes on machine have died, roslaunch will exit
shutting down processing monitor...
... shutting down processing monitor complete
done

I am guessing when the object is in place, the gripper_joint position (0.75) in the grasp pose specified can never be reached because there is collision between the gripper and the object. As a result, the gripper controller keeps running and the next step, i.e. retreat is aborted.
Can someone telll me how to solve this? I want the robot to pick up the object in gazebo. Thanks in advance!

Originally posted by yiying on ROS Answers with karma: 46 on 2020-04-13
Post score: 1

A:

My guess on the issue is correct. It took trial and error to find the right joint value (0.7) so that

the gripper touches the objects, with the joint value error within move group tolerance, so that the status of grippercommand action is success

using gazebo_grasp_plugin, the gripper is able to securely grasp the object (object attached to gripper).

Originally posted by yiying with karma: 46 on 2020-04-14
This answer was ACCEPTED on the original site
Post score: 1

