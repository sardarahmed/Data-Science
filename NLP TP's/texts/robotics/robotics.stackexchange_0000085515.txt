Q:

[ERROR] [1519470945.359482]: Lost sync with device, restarting

hello everyone i have this error when i connect xbee s1 to my arduino to send sensors data i am using ROS kinetic with ubuntu 16.04
my code
#include <Wire.h>

#include <dht.h>

#include <ros.h>

#include <std_msgs/Float32.h>

#include <sensor_msgs/Temperature.h>

#include <sensor_msgs/RelativeHumidity.h>

//**************************************************************
#define DHT11_PIN 6

float temp ; 

float hum ; 

const int trigPin = 9;

const int echoPin = 10;

float sensorReading =0; 

dht DHT;

long duration;

int distance;

//***********************************************************

std_msgs::Float32 sonar_msg;

sensor_msgs::Temperature temp_msg;

sensor_msgs::RelativeHumidity humidity_msg;

ros::Publisher pub_temp("temperature", &temp_msg);

ros::Publisher pub_humidity("humidity", &humidity_msg);

ros::Publisher pub_sonar("sonar", &sonar_msg);

ros::NodeHandle nh;

//********************************************************

void setup(){

  Serial.begin(57600);

  Wire.begin(); 

  nh.initNode();

  nh.advertise(pub_temp);

  nh.advertise(pub_humidity);

  pinMode(trigPin, OUTPUT); // Sets the trigPin as an Output

  pinMode(echoPin, INPUT); // Sets the echoPin as an Input

  nh.initNode();

  nh.advertise(pub_sonar);

}

 //**************************************************************

void loop()
{ 
nh.spinOnce();
 if (millis()-last_time>=100){

digitalWrite(trigPin, LOW);

delayMicroseconds(2);

digitalWrite(trigPin, HIGH);

delayMicroseconds(10);

digitalWrite(trigPin, LOW);

duration = pulseIn(echoPin, HIGH);

distance= duration*0.034/2;

  int chk = DHT.read11(DHT11_PIN);

  temp = DHT.temperature;

  hum = DHT.humidity; 

  temp_msg.temperature = DHT.temperature ;

  humidity_msg.relative_humidity = DHT.humidity ; 

  pub_temp.publish( &temp_msg);

  nh.spinOnce();

  pub_humidity.publish( &humidity_msg);

  sonar_msg.data = distance;

  pub_sonar.publish(&sonar_msg);
 
 last_time=millis();
 }

}

HERE IS THE ERROR
ERROR badeaa@badeaa-VPCEA22FX:~/sketchbook/libraries$ rosrun rosserial_python serial_node.py /dev/ttyACM1 
[INFO] [1519548036.306024]: ROS Serial Python Node 
[INFO] [1519548036.313912]: Connecting to /dev/ttyACM1 at 57600 baud 
[INFO] [1519548039.022223]: Note: publish buffer size is 512 bytes 
[INFO] [1519548039.023157]: Setup publisher on temperature [sensor_msgs/Temperature] 
[INFO] [1519548039.027670]: Setup publisher on humidity [sensor_msgs/RelativeHumidity] 
[INFO] [1519548039.033109]: Setup publisher on sonar [std_msgs/Float32] 
[ERROR] [1519548071.706710]: Lost sync with device, restarting... 
[ERROR] [1519548086.708586]: Lost sync with device, restarting...

Originally posted by beso on ROS Answers with karma: 1 on 2018-02-24
Post score: 0

Original comments
Comment by jayess on 2018-02-25:
Can you please update your question with a copy and paste of the entire error that you're getting using the preformatted text (101010) button?
Comment by beso on 2018-02-25:
I updated it right now

A:

Do not use Serial.println with rosserial --> serial connection is used for the communication for the serial node with the device, so other outputs will cause trouble and won't end up to the console. Use nh.log_info , nh.log_warn etc. if you want to print something to the console of the serial_node.py and to rosout.
See: http://wiki.ros.org/rosserial/Overview/Logging
Further it would be better not to delay for such a long time as serial_node and device have to sync. This is done in nh.spinOnce(). If you want something to be done e.g. only each second, remember a time stamp and then enter in the loop only accordingly but call spinOnce each time.
E.g.:
uint last_time_action_done_millis = 0;

void loop()
{
  if ( millis() > last_time_action_done_millis + 1000 )
  {
     last_time_action_done_millis = millis();

     // do stuff you want to do once per second
  }

  // call nh.spinOnce() each time in loop
  nh.spinOnce();
}

Originally posted by Wolf with karma: 7555 on 2018-02-25
This answer was ACCEPTED on the original site
Post score: 0

Original comments
Comment by beso on 2018-03-04:
i updated my code but still have the same error.
any recommendations !!!

