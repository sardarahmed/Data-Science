Q:

Configuring robot_localization for loss of sensor data

I am working on an outdoor mobile robot which should be able to localize itself using GPS, IMU and wheel encoder data. The GPS I am using is very precise and because of this I only use that for the (x, y) pose estimate at the moment by use of robot_localizations navsat_transform_node. However, ideally the robot should also be able to localize itself in areas where GPS reception is bad or non-existing for which reason I would like to use the odometry of the robot in such scenarios. How can the ekf_node of robot_localization be configured for such an application where odometry should only be used in the (x, y) pose estimate when the GPS is insufficient. Is it done through covariances, sensor_timeouts, thresholds or something else?

Originally posted by DanielRobotics on ROS Answers with karma: 42 on 2020-05-06
Post score: 0

Original comments
Comment by billy on 2020-05-06:
I asked a similar question a couple years ago.
Solving it is still on my To Do list.
https://answers.ros.org/question/302989/switch-between-gps-and-amcl-based-on-location/

A:

The short answer is that this should "just work."
The longer answer is that you should make sure that you are fusing velocity data from your wheel encoders, and not pose data. Your EKF config should fuse everything: wheel encoder velocity, IMU (velocity or orientation, but if you use the latter, make sure it's consistent with the GPS), and GPS data. Then, when you have GPS data, the filter will fuse those positions into your state estimate, and your EKF state estimate covariance will remain low. If you lose GPS signal, you will continue to have a state estimate, because the filter will keep fusing the wheel encoder velocity data. It's just that the state estimate will drift over time, because you aren't getting absolute pose data from the GPS.
Then, when you get GPS signal again, the state estimate will get corrected again, and your covariance will come back down.
TL;DR, this is something that the EKF should handle well out-of-the-box.

Originally posted by Tom Moore with karma: 13689 on 2020-06-24
This answer was ACCEPTED on the original site
Post score: 2

