Q:

How to implement velocity transformation?

Hi all,
i have the velocity topic /cmd_vel, and it's the type geometry_msgs::Twist, it is given in the object reference frame, and now i need to transform the velocity to another frame, such as my robot's base frame. How can i do that, if i know the translation and rotation between the two frames?
I think it is different from position transformation, because velocity is 6 dimension and position only 3.
Does someone have this knowledge? Any help is appreciated.

Originally posted by Qt_Yeung on ROS Answers with karma: 90 on 2014-09-09
Post score: 4

A:

You can think of linear velocity as a vector with three components. If velocity is given in some frame, and you want it in another frame, it's the same as just giving the vector in the target frame's coordinate system. The tf TransformListener has a handy transform for doing this. It's called transformVector.
http://docs.ros.org/hydro/api/tf/html/c++/tf_8cpp_source.html#l00466
Put the three components of linear velocity into a vector and transform it to the target frame.
Alternatively, you can put the values in a point and just rotate them using the rotation in the target frame's transform (and only the rotation). This should work for the angular velocities as well (e.g., a robot that has positive yaw velocity in its body frame and is rolled over -90 degrees in the odom frame will have positive pitch velocity in the odom frame).

Originally posted by Tom Moore with karma: 13689 on 2014-09-09
This answer was ACCEPTED on the original site
Post score: 3

Original comments
Comment by Qt_Yeung on 2014-09-09:
Do you mean:

Velocity transformation only depends on frame rotation, but not translation?

I can divide the Twist velocity type into two separate vectors, linear velocity vector and angular velocity vector, each with three components, and multiply them by rotation matrix separately?

Comment by Tom Moore on 2014-09-10:
Yes to both your bullet points. Apologies if I was unclear.
Not knowing exactly what you're trying to do, though, it's probably a good idea to check out the code review posted by @tfoote. You can also review some of the tf transform utility methods to see what they're doing.
Comment by claudione on 2018-10-30:
But does transformVector apply a translation to the velocity vector?
Comment by Joy16 on 2020-05-31:
@Tom Moore, Hi, do you know if transforming the linear velocities get affected by the angular velocities?
If I have a TF Tree A-->B--->C, where A is the root node and C is the grandhchild of A. I want to transform the velocity vector v(a twist message that has both linear and angular component) from  C frame to A frame. So, in order to find the linear veclocity vector of v from C to A, do I go about by just multiplying the v.linear with transformation matrix of B and then with transformation matrix of A ? Or should I account for the effects of angular velocity of v.
Comment by Tom Moore on 2020-06-15:
Are you asking about whether this is necessary mathematically, or whether r_l accounts for it?

