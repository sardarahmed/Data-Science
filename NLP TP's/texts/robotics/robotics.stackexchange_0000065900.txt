Q:

rviz seg faults when adding camera, depth cloud or image displays

Hi,
When I try to add one of the three (Camera, Depth Cloud, Image) displays in rviz, it immediately seg faults.
gdb gives me the following output:
Program received signal SIGSEGV, Segmentation fault.
__strcmp_ssse3 () at ../sysdeps/x86_64/multiarch/../strcmp.S:286
286     ../sysdeps/x86_64/multiarch/../strcmp.S: No such file or directory.
(gdb) bt
#0  __strcmp_ssse3 () at ../sysdeps/x86_64/multiarch/../strcmp.S:286
#1  0x00007fff77bd309e in QMetaType::registerNormalizedType(QByteArray const&, void (*)(void*), void* (*)(void const*), void (*)(void*), void* (*)(void*, void const*), int, QFlags<QMetaType::TypeFlag>, QMetaObject const*) () from /usr/lib/x86_64-linux-gnu/libQt5Core.so.5
#2  0x00007fff773c87b7 in ?? () from /usr/lib/x86_64-linux-gnu/libQt5Gui.so.5
#3  0x00007ffff7dea13a in call_init (l=<optimized out>, argc=argc@entry=1, argv=argv@entry=0x7fffffffba88, env=env@entry=0x7fffffffba98) at dl-init.c:78
#4  0x00007ffff7dea223 in call_init (env=<optimized out>, argv=<optimized out>, argc=<optimized out>, l=<optimized out>) at dl-init.c:36
#5  _dl_init (main_map=main_map@entry=0x1494d80, argc=1, argv=0x7fffffffba88, env=0x7fffffffba98) at dl-init.c:126
#6  0x00007ffff7deec70 in dl_open_worker (a=a@entry=0x7fffffff9c68) at dl-open.c:577
#7  0x00007ffff7de9ff4 in _dl_catch_error (objname=objname@entry=0x7fffffff9c58, errstring=errstring@entry=0x7fffffff9c60, mallocedp=mallocedp@entry=0x7fffffff9c50, operate=operate@entry=0x7ffff7dee9a0 <dl_open_worker>, args=args@entry=0x7fffffff9c68) at dl-error.c:187
#8  0x00007ffff7dee3bb in _dl_open (file=0x1426438 "/opt/ros/indigo/lib//libcompressed_depth_image_transport.so", mode=-2147483391, caller_dlopen=<optimized out>, nsid=-2, argc=1, argv=0x7fffffffba88, env=0x7fffffffba98) at dl-open.c:661
#9  0x00007fffedefb02b in dlopen_doit (a=a@entry=0x7fffffff9e80) at dlopen.c:66
#10 0x00007ffff7de9ff4 in _dl_catch_error (objname=0x633770, errstring=0x633778, mallocedp=0x633768, operate=0x7fffedefafd0 <dlopen_doit>, args=0x7fffffff9e80) at dl-error.c:187
#11 0x00007fffedefb62d in _dlerror_run (operate=operate@entry=0x7fffedefafd0 <dlopen_doit>, args=args@entry=0x7fffffff9e80) at dlerror.c:163
#12 0x00007fffedefb0c1 in __dlopen (file=<optimized out>, mode=<optimized out>) at dlopen.c:87
#13 0x00007fffeff40c33 in Poco::SharedLibraryImpl::loadImpl(std::string const&) () from /usr/lib/libPocoFoundation.so.9
#14 0x00007fffeff4114f in Poco::SharedLibrary::SharedLibrary(std::string const&) () from /usr/lib/libPocoFoundation.so.9
#15 0x00007ffff52dae9b in class_loader::class_loader_private::loadLibrary(std::string const&, class_loader::ClassLoader*) () from /opt/ros/indigo/lib/libclass_loader.so
#16 0x00007ffff52d559c in class_loader::ClassLoader::loadLibrary() () from /opt/ros/indigo/lib/libclass_loader.so
#17 0x00007ffff52d57d0 in class_loader::ClassLoader::ClassLoader(std::string const&, bool) () from /opt/ros/indigo/lib/libclass_loader.so
#18 0x00007ffff52de698 in class_loader::MultiLibraryClassLoader::loadLibrary(std::string const&) () from /opt/ros/indigo/lib/libclass_loader.so
#19 0x00007ffff7ac5a5c in pluginlib::ClassLoader<image_transport::SubscriberPlugin>::loadLibraryForClass(std::string const&) () from /opt/ros/indigo/lib/librviz.so
#20 0x00007ffff7acc35c in pluginlib::ClassLoader<image_transport::SubscriberPlugin>::createInstance(std::string const&) () from /opt/ros/indigo/lib/librviz.so
#21 0x00007ffff7ac0298 in rviz::ImageDisplayBase::scanForTransportSubscriberPlugins() () from /opt/ros/indigo/lib/librviz.so
#22 0x00007fff95b01b31 in rviz::ImageDisplay::onInitialize() () from /opt/ros/indigo/lib/libdefault_plugin.so
#23 0x00007ffff7a977ef in rviz::Display::initialize(rviz::DisplayContext*) () from /opt/ros/indigo/lib/librviz.so
#24 0x00007ffff7b48815 in rviz::VisualizationManager::addDisplay(rviz::Display*, bool) () from /opt/ros/indigo/lib/librviz.so
#25 0x00007ffff7b48c66 in rviz::VisualizationManager::createDisplay(QString const&, QString const&, bool) () from /opt/ros/indigo/lib/librviz.so
#26 0x00007ffff7aaad0c in rviz::DisplaysPanel::onNewDisplay() () from /opt/ros/indigo/lib/librviz.so
#27 0x00007ffff2e3a87a in QMetaObject::activate(QObject*, QMetaObject const*, int, void**) () from /usr/lib/x86_64-linux-gnu/libQtCore.so.4
#28 0x00007ffff752d0d2 in QAbstractButton::clicked(bool) () from /usr/lib/x86_64-linux-gnu/libQtGui.so.4
#29 0x00007ffff72909d3 in ?? () from /usr/lib/x86_64-linux-gnu/libQtGui.so.4
#30 0x00007ffff7291b43 in ?? () from /usr/lib/x86_64-linux-gnu/libQtGui.so.4
#31 0x00007ffff7291c2c in QAbstractButton::mouseReleaseEvent(QMouseEvent*) () from /usr/lib/x86_64-linux-gnu/libQtGui.so.4
#32 0x00007ffff6f2e50a in QWidget::event(QEvent*) () from /usr/lib/x86_64-linux-gnu/libQtGui.so.4
#33 0x00007ffff6edee2c in QApplicationPrivate::notify_helper(QObject*, QEvent*) () from /usr/lib/x86_64-linux-gnu/libQtGui.so.4
#34 0x00007ffff6ee55dd in QApplication::notify(QObject*, QEvent*) () from /usr/lib/x86_64-linux-gnu/libQtGui.so.4
#35 0x00007ffff2e264dd in QCoreApplication::notifyInternal(QObject*, QEvent*) () from /usr/lib/x86_64-linux-gnu/libQtCore.so.4
#36 0x00007ffff6ee4d93 in QApplicationPrivate::sendMouseEvent(QWidget*, QMouseEvent*, QWidget*, QWidget*, QWidget**, QPointer<QWidget>&, bool) () from /usr/lib/x86_64-linux-gnu/libQtGui.so.4
#37 0x00007ffff6f599cb in ?? () from /usr/lib/x86_64-linux-gnu/libQtGui.so.4
#38 0x00007ffff6f59269 in QApplication::x11ProcessEvent(_XEvent*) () from /usr/lib/x86_64-linux-gnu/libQtGui.so.4
#39 0x00007ffff6f80b02 in ?? () from /usr/lib/x86_64-linux-gnu/libQtGui.so.4
#40 0x00007ffff1794e04 in g_main_context_dispatch () from /lib/x86_64-linux-gnu/libglib-2.0.so.0
#41 0x00007ffff1795048 in ?? () from /lib/x86_64-linux-gnu/libglib-2.0.so.0
#42 0x00007ffff17950ec in g_main_context_iteration () from /lib/x86_64-linux-gnu/libglib-2.0.so.0
#43 0x00007ffff2e537be in QEventDispatcherGlib::processEvents(QFlags<QEventLoop::ProcessEventsFlag>) () from /usr/lib/x86_64-linux-gnu/libQtCore.so.4
#44 0x00007ffff6f80bb6 in ?? () from /usr/lib/x86_64-linux-gnu/libQtGui.so.4
#45 0x00007ffff2e250af in QEventLoop::processEvents(QFlags<QEventLoop::ProcessEventsFlag>) () from /usr/lib/x86_64-linux-gnu/libQtCore.so.4
#46 0x00007ffff2e253a5 in QEventLoop::exec(QFlags<QEventLoop::ProcessEventsFlag>) () from /usr/lib/x86_64-linux-gnu/libQtCore.so.4
#47 0x00007ffff2e2ab79 in QCoreApplication::exec() () from /usr/lib/x86_64-linux-gnu/libQtCore.so.4
#48 0x0000000000400bc7 in main ()

I am running ROS indigo from the debian packages (ros-indigo-desktop-full) on Ubuntu 14.04. (rviz version 1.11.4)
Any suggestions?
cheers
EDIT
this might be related to image_view,
rosrun image_view image_view gives:
init done 
opengl support available 
(image_view:31483): GLib-GObject-WARNING **: invalid uninstantiatable type '(null)' in cast to 'GtkWidget'
(image_view:31483): GLib-GObject-WARNING **: instance of invalid non-instantiatable type '(null)'
(image_view:31483): GLib-GObject-CRITICAL **: g_signal_connect_data: assertion 'G_TYPE_CHECK_INSTANCE (instance)' failed

as reported on: https://github.com/ros-perception/image_pipeline/issues/83 and http://answers.ros.org/question/35784/image_view-giving-glib-errors-and-not-displaying-a-window/
EDIT 2
Added backtrace above

Originally posted by ffurrer on ROS Answers with karma: 115 on 2015-02-18
Post score: 0

Original comments
Comment by William on 2015-02-18:
I would need a backtrace from gdb (use the bt command after it crashes) to try and diagnose what is the issue. I'm not sure that image_view and rviz use exactly the same code base, so I'm dubious of the relationship, but it is possible. I'll try to reproduce on my machine.
Comment by William on 2015-02-18:
--Also, are you using the shadow-fixed or public deb repository?-- Nvm, you are using 1.11.4, that's in public currently.

A:

Based on your backtrace I would say that you have some problem where the image transport plugin is compiled against Qt5 but rviz is compiled against Qt4. I believe it is related to this issue:
https://github.com/ros-visualization/rviz/issues/696

Originally posted by William with karma: 17335 on 2015-02-19
This answer was ACCEPTED on the original site
Post score: 1

