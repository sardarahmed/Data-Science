Q:

AMCL - Determining an obstacle from forbidden zone on map

Hello,
I have a robot which needs to navigate through a gap by using a map which I created using gmapping + manual editing using Photoshop. As you can see in the map below, there are black lines representing real walls on the map (the right line, opposite line and the gap lines). On the left there is open space however I want the robot to always go through the gap in a straight line and avoid making plans to go on the left zone to reach it goal (not turning around the gap).
Problem:
In order to attempt to resolve this I have manually marked the left zone in a black line but now I am worried that AMCL might think the robot is not localizaed well because it "mistakes" it for another wall. I noticed that when the robot faces the left side it goes into unable to determine pose mode. Am I doing the wrong approach here? Is there a better way to mark a forbidden zone different from real obstacles on a small map?

Originally posted by dgrixti on ROS Answers with karma: 95 on 2017-03-07
Post score: 0

A:

yes, that will definetely affect your localization!
some dirty but fast solutions are:

use two maps, one for navigation with the walls and other for amcl (the original one)
instead of painting "walls" paint "points" close enough that your robot cannot pass between them. In this way most of your scans will reflect the real surrounding and, hopefully, amcl will disregard the "points" as noise.

more elegant solution:

create a special layer and a special sensor in your costmap config that will "see" these walls, which will not be in the map amcl is using.

Originally posted by Procópio with karma: 4402 on 2017-03-09
This answer was ACCEPTED on the original site
Post score: 2

Original comments
Comment by dgrixti on 2017-03-13:
Thanks very much. I have looked into the two maps solutions and I think something like this could work.
Comment by priestoferis on 2019-04-16:
Why would you consider the third option to be more elegant? For the sake of clarity (i.e. as a human I know what I'm defining) and ease-of-use, using for amcl an original map (or maybe a slightly cleared one, where frequently moved objects are removed) and a drawn map with forbidden areas for gmapping seems the best. (I'm not trying to argue in the sense that you are not right, you probably are, I just don't see why, and would like to :)).
Comment by Procópio on 2019-04-17:
@priestoferis, assuming you meant "move_base" instead of "gmapping", that solution would work as long as you configure your sensors layers to not be able to erase the static map layer. That is a valid option, but would have problems on its own, but that is another story.

