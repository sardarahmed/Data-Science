Q:

Unable to open rosbag files in C++

Hello,
I am trying to write a node to edit the timestamps in a bag file, using C++. The code I have written is attached below. I have tried to follow the template given in the rosbag C++ API, but I am unable to open any of the bag files I have, even though they run perfectly well when I play them back using rosbag play. Specifically, I am seeing the error message
terminate called after throwing an instance of 'rosbag::BagIOException'
  what():  Error opening file: ~/catkin_ws/src/publish_text/launch/filtered.bag

I am not quite sure why exactly this is happening. Would greatly appreciate it if anyone had any suggestions!
Thanks. (Code from the main function of my code enclosed below)
ros::init(argc, argv, "postprocessing");

ros::NodeHandle nh("~");

std::string instr, outstr;

rosbag::Bag inbag, outbag;

if (nh.getParam("input_path", instr)) {
  inbag.open(instr, rosbag::bagmode::Read);
} else {
  ROS_ERROR("No input path provided, terminating\n");
  exit(1);
}

if (!nh.getParam("output_path", outstr)) {
  outbag.open(outstr, rosbag::bagmode::Write);
} else {
  ROS_ERROR("No output path provided, terminating\n");
  exit(1);
}

UPDATE: I was able to resolve the issue by replacing the path with an absolute path from the root directory.

Originally posted by jll on ROS Answers with karma: 27 on 2015-12-06
Post score: 2

Original comments
Comment by 2ROS0 on 2016-08-02:
Does rosbag::Bag API support relative paths like this: rosbag::Bag::open("./name_of_bagfile") ? I'm using ROS Groovy default install

A:

terminate called after throwing an instance of 'rosbag::BagIOException'

  what():  Error opening file: ~/catkin_ws/src/publish_text/launch/filtered.bag 

Most likely you are expecting the C++ runtime to resolve/replace the ~ with the path to the users home directory. Afaik that behaviour is implemented by the shell (ie: bash), it's not something that works everywhere.
Can you try to provide an absolute (or even relative) path to rosbag::Bag::open(..)?

Originally posted by gvdhoorn with karma: 86574 on 2015-12-07
This answer was ACCEPTED on the original site
Post score: 1

Original comments
Comment by 2ROS0 on 2016-08-02:
I have the same problem when adding a relative path (absolute path works fine) as such: rosbag::Bag::open("./name_of_bagfile.bag")
Comment by antoineniotna on 2019-05-06:
Did you managed to use the relative path ? I have exactly the same problem, absolute path is working fine but the relative one doesn't. I am using kinetic version.

