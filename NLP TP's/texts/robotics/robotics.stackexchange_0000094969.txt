Q:

Plotting covariance from amcl_pose in Matlab

I have recorded a bag-file and am trying to plot the /amcl_pose/pose/covariance matrix which has a message type geometry_msgs/PoseWithCovarianceStamped. I followed this tutorial on plotting data from topics, however, when I try:
bagselect = select(bag, 'Topic', '/amcl_pose');
msgs = readMessages(bagselect);
ts = timeseries(bagselect, 'Pose.Covariance');

I Get the error:
The Pose.covariance property does not exist for message type geometry_msgs/PoseWithCovarianceStamped. 

What am I doing wrong?

Originally posted by fendrbud on ROS Answers with karma: 48 on 2020-03-05
Post score: 0

A:

I found out I have to read the messages as structures as in this example.
bSel = select(bag, 'Topic', '/amcl_pose');
msgStructs = readMessages(bSel, 'DataFormat', 'struct');

I am then able to read amcl_pose as a struct and can then extract the first covariance matrix by
msgStructs{1}.Pose.Covariance

I now have to iterate through all the matrices and concatenate them in order to plot their values.

Originally posted by fendrbud with karma: 48 on 2020-03-05
This answer was ACCEPTED on the original site
Post score: 0

Original comments
Comment by gvdhoorn on 2020-03-05:
I've converted your comment to an answer as it would appear this is the answer.
To link it to my comment about the covariance field not being at the top-level of the message (but at pose.pose.covariance: it would appear msgStructs{1} contains the top-level message contents. So then pose.covariance does exist there.

