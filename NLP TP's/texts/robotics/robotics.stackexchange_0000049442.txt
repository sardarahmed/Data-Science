Q:

Building gencpp from source

I'm trying to build gencpp from source on a Fedora 18 system. I think I have the prerequisites already built: catkin and genmsg; however, during the build, cmake fails to find the genmsg cmake files. Here's the error:
+ /usr/bin/cmake -DCMAKE_VERBOSE_MAKEFILE=ON -DCMAKE_INSTALL_PREFIX:PATH=/usr -DINCLUDE_INSTALL_DIR:PATH=/usr/include -DLIB_INSTALL_DIR:PATH=/usr/lib64 -DSYSCONF_INSTALL_DIR:PATH=/etc -DSHARE_INSTALL_PREFIX:PATH=/usr/share -DLIB_SUFFIX=64 -DBUILD_SHARED_LIBS:BOOL=ON ..
-- The C compiler identification is GNU 4.7.2
-- The CXX compiler identification is GNU 4.7.2
-- Check for working C compiler: /usr/lib64/ccache/cc
-- Check for working C compiler: /usr/lib64/ccache/cc -- works
-- Detecting C compiler ABI info
-- Detecting C compiler ABI info - done
-- Check for working CXX compiler: /usr/lib64/ccache/c++
-- Check for working CXX compiler: /usr/lib64/ccache/c++ -- works
-- Detecting CXX compiler ABI info
-- Detecting CXX compiler ABI info - done
-- Using CATKIN_DEVEL_PREFIX: /builddir/build/BUILD/gencpp-0.4.12/build/devel
-- Using CMAKE_PREFIX_PATH: 
-- Found PythonInterp: /usr/bin/python (found version "2.7.3") 
-- Found PY_em: /usr/lib/python2.7/site-packages/em.pyc  
-- Found gtest: gtests will be built
-- Using CATKIN_TEST_RESULTS_DIR: /builddir/build/BUILD/gencpp-0.4.12/build/test_results
-- catkin 0.5.64
CMake Error at /usr/share/catkin/cmake/catkinConfig.cmake:72 (find_package):
  Could not find a package configuration file provided by "genmsg" with any
  of the following names:
    genmsgConfig.cmake
    genmsg-config.cmake
  Add the installation prefix of "genmsg" to CMAKE_PREFIX_PATH or set
  "genmsg_DIR" to a directory containing one of the above files.  If "genmsg"
  provides a separate development package or SDK, be sure it has been
  installed.
Call Stack (most recent call first):
  CMakeLists.txt:3 (find_package)
-- Configuring incomplete, errors occurred!
error: Bad exit status from /var/tmp/rpm-tmp.tRuPTe (%build)
    Bad exit status from /var/tmp/rpm-tmp.tRuPTe (%build)

I've tried to define the genmsg_DIR variable as suggested in the error too, but it doesn't seem to make a difference:
+ /usr/bin/cmake -DCMAKE_VERBOSE_MAKEFILE=ON -DCMAKE_INSTALL_PREFIX:PATH=/usr -DINCLUDE_INSTALL_DIR:PATH=/usr/include -DLIB_INSTALL_DIR:PATH=/usr/lib64 -DSYSCONF_INSTALL_DIR:PATH=/etc -DSHARE_INSTALL_PREFIX:PATH=/usr/share -DLIB_SUFFIX=64 -DBUILD_SHARED_LIBS:BOOL=ON .. -Dgenmsg_DIR=/builddir/build/BUILDROOT/ros-gencpp-groovy-0.4.12-1.fc18.x86_64//usr/share/genmsg/cmake
-- The C compiler identification is GNU 4.7.2
-- The CXX compiler identification is GNU 4.7.2
-- Check for working C compiler: /usr/lib64/ccache/cc
-- Check for working C compiler: /usr/lib64/ccache/cc -- works
-- Detecting C compiler ABI info
-- Detecting C compiler ABI info - done
-- Check for working CXX compiler: /usr/lib64/ccache/c++
-- Check for working CXX compiler: /usr/lib64/ccache/c++ -- works
-- Detecting CXX compiler ABI info
-- Detecting CXX compiler ABI info - done
-- Using CATKIN_DEVEL_PREFIX: /builddir/build/BUILD/gencpp-0.4.12/build/devel
-- Using CMAKE_PREFIX_PATH: 
-- Found PythonInterp: /usr/bin/python (found version "2.7.3") 
-- Found PY_em: /usr/lib/python2.7/site-packages/em.pyc  
-- Found gtest: gtests will be built
-- Using CATKIN_TEST_RESULTS_DIR: /builddir/build/BUILD/gencpp-0.4.12/build/test_results
-- catkin 0.5.64
CMake Error at /usr/share/catkin/cmake/catkinConfig.cmake:72 (find_package):
  Could not find a package configuration file provided by "genmsg" with any
  of the following names:
    genmsgConfig.cmake
    genmsg-config.cmake
  Add the installation prefix of "genmsg" to CMAKE_PREFIX_PATH or set

The ros-genmsg-groovy package that I built does have the genmsgConfig.cmake file:
[ankur@dhcppc1  ros-repo]$ rpm -qpl ros-genmsg-groovy-0.4.18-1.fc18.noarch.rpm | egrep cmake
/usr/share/genmsg/cmake
/usr/share/genmsg/cmake/genmsg-extras.cmake
/usr/share/genmsg/cmake/genmsgConfig-version.cmake
/usr/share/genmsg/cmake/genmsgConfig.cmake
/usr/share/genmsg/cmake/pkg-genmsg.cmake.em
/usr/share/genmsg/cmake/pkg-genmsg.context.in
/usr/share/genmsg/cmake/pkg-msg-paths.cmake.in
[ankur@dhcppc1  ros-repo]$

EDIT:
Attempts with the -DCMAKE_PREFIX_PATH addition as suggested:
+ /usr/bin/cmake -DCMAKE_VERBOSE_MAKEFILE=ON -DCMAKE_INSTALL_PREFIX:PATH=/usr -DINCLUDE_INSTALL_DIR:PATH=/usr/include -DLIB_INSTALL_DIR:PATH=/usr/lib64 -DSYSCONF_INSTALL_DIR:PATH=/etc -DSHARE_INSTALL_PREFIX:PATH=/usr/share -DLIB_SUFFIX=64 -DBUILD_SHARED_LIBS:BOOL=ON .. -DCMAKE_PREFIX_PATH=/builddir/build/BUILDROOT/ros-gencpp-groovy-0.4.12-1.fc18.x86_64//usr/share/genmsg/cmake
-- The C compiler identification is GNU 4.7.2
-- The CXX compiler identification is GNU 4.7.2
-- Check for working C compiler: /usr/lib64/ccache/cc
-- Check for working C compiler: /usr/lib64/ccache/cc -- works
-- Detecting C compiler ABI info
-- Detecting C compiler ABI info - done
-- Check for working CXX compiler: /usr/lib64/ccache/c++
-- Check for working CXX compiler: /usr/lib64/ccache/c++ -- works
-- Detecting CXX compiler ABI info
-- Detecting CXX compiler ABI info - done
-- Using CATKIN_DEVEL_PREFIX: /builddir/build/BUILD/gencpp-0.4.12/build/devel
-- Using CMAKE_PREFIX_PATH: /builddir/build/BUILDROOT/ros-gencpp-groovy-0.4.12-1.fc18.x86_64//usr/share/genmsg/cmake
-- Found PythonInterp: /usr/bin/python (found version "2.7.3") 
-- Found PY_em: /usr/lib/python2.7/site-packages/em.pyc  
-- Found gtest: gtests will be built
-- Using CATKIN_TEST_RESULTS_DIR: /builddir/build/BUILD/gencpp-0.4.12/build/test_results
-- catkin 0.5.64
CMake Error at /usr/share/catkin/cmake/catkinConfig.cmake:72 (find_package):
  Could not find a package configuration file provided by "genmsg" with any
  of the following names:
    genmsgConfig.cmake
    genmsg-config.cmake
  Add the installation prefix of "genmsg" to CMAKE_PREFIX_PATH or set
  "genmsg_DIR" to a directory containing one of the above files.  If "genmsg"
  provides a separate development package or SDK, be sure it has been
  installed.
Call Stack (most recent call first):
  CMakeLists.txt:3 (find_package)
-- Configuring incomplete, errors occurred!
error: Bad exit status from /var/tmp/rpm-tmp.TVQb8z (%build)
RPM build errors:
    Bad exit status from /var/tmp/rpm-tmp.TVQb8z (%build)
Child return code was: 1
EXCEPTION: Command failed. See logs for output.

The contents of the genmsg rpm are here: That's all the files it generated. I may have moved them around a little to follow the FHS though.
I'm using the standard Fedora build system, building a tool called "mock" which is really just a build tool. It creates a chroot and installs the build dependencies etc. It follows the normal rpm building workflow. I've placed the "spec files" here.
I need to build the build dependencies for each package before I can attempt to build it, so a sequential order is to be followed.
Any hints on what I'm doing wrong?

Originally posted by FranciscoD on ROS Answers with karma: 128 on 2013-03-16
Post score: 3

A:

I think you need to add the installation prefix of genmsg to your CMAKE_PREFIX_PATH. In your case I think this might be:
-DCMAKE_PREFIX_PATH=/builddir/build/BUILDROOT/ros-gencpp-groovy-0.4.12-1.fc18.x86_64//usr/
But without knowing more about your build environment I don't think I will be able to give you the exact solution.
Also, did you ensure that the genmsg-config.cmake was in the the path you get for genmsg_DIR?
EDIT:
You should look for genmsg-config.cmake OR genmsgConfig.cmake

Originally posted by William with karma: 17335 on 2013-03-17
This answer was ACCEPTED on the original site
Post score: 2

Original comments
Comment by FranciscoD on 2013-03-18:
I've updated the question with more information, on the build system, and attempts with the -DCMAKE_PREFIX_PATH. The genmsg package did not generate a genmsg-config.cmake file though.
Comment by William on 2013-03-18:
It should generate a genmsgConfig.cmake file, I was thinking it was the other one, but in fact its the first.
Comment by FranciscoD on 2013-03-18:
The file is available at: /usr/share/genmsg/cmake/genmsgConfig.cmake. For the buildroot, it would become /builddir/build/BUILDROOT/ros-gencpp-groovy-0.4.12-1.fc18.x86_64//usr/share/genmsg/cmake/genmsgConfig.cmake.  Maybe I need to place the cmake file in another location, where cmake can find it.
Comment by Dirk Thomas on 2013-06-22:
CMake finds config files in various locations http://cmake.org/cmake/help/v2.8.8/cmake.html#command:find_package
catkin uses PREFIX/share/genmsg/cmake/genmsgConfig.cmake. Make sure PREFIX is part of the CMAKE_PREFIX_PATH and the file exists. Also remove previous CMakeCache.txt files.

