Q:

Rosout leaks file descriptors

It is weird that when I launch my ros program my os alert "too many files open". By using "lsof", I found rosout node has numerous sockets with "can't identify protocol"(as the following img shows). How did this happen?

Originally posted by nansmallgong on ROS Answers with karma: 26 on 2016-12-19
Post score: 0

A:

Since these are socket file descriptors, it looks like rosout has a lot of open sockets. ROS creates a socket for each connection between a publisher and a subscriber, so there can be a lot of file descriptors involved, but even on robots with hundreds of nodes this isn't usually a problem.
You may be able to tell what these open sockets are connected to and what state they're in with netstat -lp. The -l option lists open sockets, and the -p option lists the process that owns that socket.

Originally posted by ahendrix with karma: 47576 on 2016-12-21
This answer was ACCEPTED on the original site
Post score: 0

Original comments
Comment by nansmallgong on 2016-12-21:
the problem is caused by rosout do not release file descriptor correctly when a node exit with any error. As what I describe  here
Comment by ahendrix on 2017-11-02:
I had some time to dig into this more deeply and have a proposed fix here: https://github.com/ros/ros_comm/pull/1214

