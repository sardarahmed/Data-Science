Q:

Installing ROS2 Foxy/Galactic on Big Sur M1 ARM - colcon build errors

I am getting an error after following all instructions for ROS2 build on running "colcon build --symlink-install"
There is an error in "fastcdr" that fails while compiling.
There is an error in "console_bridge"  compiling.
reproducing output here:
Starting >>> osrf_testing_tools_cpp
Starting >>> ament_pep8
Finished <<< gtest_vendor [1.72s]                                 
--- stderr: fastcdr
CMake Deprecation Warning at CMakeLists.txt:18 (cmake_minimum_required):
  Compatibility with CMake < 2.8.12 will be removed from a future version of
  CMake.

  Update the VERSION argument <min> value or use a ...<max> suffix to tell
  CMake that the project does not need compatibility with older versions.

ld: unknown option: -soname
clang: error: linker command failed with exit code 1 (use -v to see invocation)
make[2]: *** [src/cpp/libfastcdr.so.1.0.7] Error 1
make[1]: *** [src/cpp/CMakeFiles/fastcdr.dir/all] Error 2
make: *** [all] Error 2
---
Failed   <<< fastcdr [1.75s, exited with code 2]
--- stderr: console_bridge
CMake Deprecation Warning at CMakeLists.txt:1 (cmake_minimum_required):
  Compatibility with CMake < 2.8.12 will be removed from a future version of
  CMake.

  Update the VERSION argument <min> value or use a ...<max> suffix to tell
  CMake that the project does not need compatibility with older versions.

ld: unknown option: -soname
clang: error: linker command failed with exit code 1 (use -v to see invocation)
make[2]: *** [lib/libconsole_bridge.so.0.4] Error 1
make[1]: *** [CMakeFiles/console_bridge.dir/all] Error 2
make: *** [all] Error 2
---
Failed   <<< console_bridge [1.69s, exited with code 2]
Aborted  <<< ament_pep257 [0.14s]
Aborted  <<< osrf_testing_tools_cpp [0.11s]
Aborted  <<< ament_pep8 [0.08s]
Aborted  <<< ament_cmake_core [0.31s]
Aborted  <<< poco_vendor [2.88s]                                 

Summary: 5 packages finished [4.35s]
  2 packages failed: console_bridge fastcdr
  5 packages aborted: ament_cmake_core ament_pep257 ament_pep8 osrf_testing_tools_cpp poco_vendor
  3 packages had stderr output: console_bridge fastcdr poco_vendor
  122 packages not processed

Anyone solved these issues?
The above was for Foxy. Also tried on Galactic.
This is the errors from Galactic.
Summary: 142 packages finished [1min 19s]
  1 package failed: rosidl_generator_py
  5 packages had stderr output: fastcdr orocos_kdl osrf_testing_tools_cpp performance_test_fixture rosidl_generator_py
  161 packages not processed

Originally posted by web.master.mooz on ROS Answers with karma: 3 on 2021-06-13
Post score: 0

A:

Edit: Additionally, there is a current discussion about ROS 2 on macOS on ROS Discourse: macOS support in ROS 2 Galactic and beyond. Link to Github issue tracking these (new) efforts: ros2/ros2#1148.
They don't mention your issue specifically, so either it's new, or there is something else not correct in your setup/approach.

From a quick search it's possible OSX isn't detected properly and then options only supported by GCC (and not Clang) are specified by CMake. This also doesn't appear to be Big Sur specific. It happened to people back in 2011 already.
I'd suggest opening issues on the issue trackers of the packages you mention.
If/when you do, please post a comment here with a link to the issue you opened, so we can keep things connected.

Originally posted by gvdhoorn with karma: 86574 on 2021-06-14
This answer was ACCEPTED on the original site
Post score: 1

Original comments
Comment by web.master.mooz on 2021-06-15:
Thank you so much for pointing me in the right direction. The links above have the answer. Only thing is that I had installed most of the stuff on my Mac M1 with x86 emulation using the arch command. Had to install everything with ARM architecture again. But what is linked above works. Good work by the author!
Comment by gvdhoorn on 2021-06-15:
Have you reported your success? The people involved would probably be interested to hear their work resulted in success.

