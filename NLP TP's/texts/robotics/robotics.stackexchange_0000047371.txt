Q:

Building ROS Groovy from source fails on PCL package

Hello All,
I'm working on an Ubuntu 12.04 32-bit VM trying to install the ROS groovy release from source (following the instructions at ROS wiki. Can't post the link because my karma is insufficient), but I keep running into PCL linking errors on step 2.1.3 Building the catkin Workspace on the instructions.  Specifically, it complains about not being able to find the sensor_msgs, roscpp_serialzation, rosconsole and rostime libraries.  Below is the build output of the PCL error:
==> Processing plain cmake package: 'pcl'
==> Creating build directory: 'build_isolated/pcl'
==> Building with env: '/opt/ros/ros_catkin_ws/install_isolated/env.sh'
==> cmake /opt/ros/ros_catkin_ws/src/pcl -DCMAKE_INSTALL_PREFIX=/opt/ros/ros_catkin_ws/install_isolated
==> make -j8 in '/opt/ros/ros_catkin_ws/build_isolated/pcl'
Scanning dependencies of target pcl_pcd_convert_NaN_nan
Scanning dependencies of target pcl_io_ply
[  0%] [  1%] Building CXX object io/CMakeFiles/pcl_io_ply.dir/src/ply/ply_parser.cpp.o
Building CXX object io/tools/CMakeFiles/pcl_pcd_convert_NaN_nan.dir/pcd_convert_NaN_nan.cpp.o
Scanning dependencies of target pcl_octree
[  1%] Building CXX object octree/CMakeFiles/pcl_octree.dir/src/octree_impl.cpp.o
Scanning dependencies of target pcl_common
[  2%] [  2%] [  3%] [  3%] [  4%] Building CXX object common/CMakeFiles/pcl_common.dir/src/common.cpp.o
Building CXX object common/CMakeFiles/pcl_common.dir/src/io.cpp.o
Building CXX object common/CMakeFiles/pcl_common.dir/src/pcl_base.cpp.o
Building CXX object common/CMakeFiles/pcl_common.dir/src/correspondence.cpp.o
Building CXX object common/CMakeFiles/pcl_common.dir/src/distances.cpp.o
Linking CXX executable ../../bin/pcl_pcd_convert_NaN_nan
[  4%] Built target pcl_pcd_convert_NaN_nan
[  4%] Building CXX object common/CMakeFiles/pcl_common.dir/src/intersections.cpp.o
[  4%] Building CXX object common/CMakeFiles/pcl_common.dir/src/parse.cpp.o
In file included from /opt/ros/ros_catkin_ws/src/pcl/common/include/pcl/point_types.h:301:0,
                 from /opt/ros/ros_catkin_ws/src/pcl/common/src/io.cpp:40:
/opt/ros/ros_catkin_ws/src/pcl/common/include/pcl/impl/point_types.hpp:1009:68: warning: ‘SHOT’ is deprecated [-Wdeprecated-declarations]
In file included from /opt/ros/ros_catkin_ws/src/pcl/common/include/pcl/point_types.h:301:0,
                 from /opt/ros/ros_catkin_ws/src/pcl/common/include/pcl/common/impl/common.hpp:41,
                 from /opt/ros/ros_catkin_ws/src/pcl/common/include/pcl/common/common.h:186,
                 from /opt/ros/ros_catkin_ws/src/pcl/common/src/common.cpp:39:
/opt/ros/ros_catkin_ws/src/pcl/common/include/pcl/impl/point_types.hpp:1009:68: warning: ‘SHOT’ is deprecated [-Wdeprecated-declarations]
In file included from /opt/ros/ros_catkin_ws/src/pcl/common/include/pcl/point_types.h:301:0,
                 from /opt/ros/ros_catkin_ws/src/pcl/common/include/pcl/common/impl/common.hpp:41,
                 from /opt/ros/ros_catkin_ws/src/pcl/common/include/pcl/common/common.h:186,
                 from /opt/ros/ros_catkin_ws/src/pcl/common/include/pcl/common/distances.h:40,
                 from /opt/ros/ros_catkin_ws/src/pcl/common/src/distances.cpp:37:
/opt/ros/ros_catkin_ws/src/pcl/common/include/pcl/impl/point_types.hpp:1009:68: warning: ‘SHOT’ is deprecated [-Wdeprecated-declarations]
In file included from /opt/ros/ros_catkin_ws/src/pcl/common/include/pcl/point_types.h:301:0,
                 from /opt/ros/ros_catkin_ws/src/pcl/octree/src/octree_impl.cpp:40:
/opt/ros/ros_catkin_ws/src/pcl/common/include/pcl/impl/point_types.hpp:1009:68: warning: ‘SHOT’ is deprecated [-Wdeprecated-declarations]
In file included from /opt/ros/ros_catkin_ws/src/pcl/common/include/pcl/point_types.h:301:0,
                 from /opt/ros/ros_catkin_ws/src/pcl/common/include/pcl/common/impl/common.hpp:41,
                 from /opt/ros/ros_catkin_ws/src/pcl/common/include/pcl/common/common.h:186,
                 from /opt/ros/ros_catkin_ws/src/pcl/common/include/pcl/common/intersections.h:41,
                 from /opt/ros/ros_catkin_ws/src/pcl/common/src/intersections.cpp:38:
/opt/ros/ros_catkin_ws/src/pcl/common/include/pcl/impl/point_types.hpp:1009:68: warning: ‘SHOT’ is deprecated [-Wdeprecated-declarations]
[  5%] Building CXX object common/CMakeFiles/pcl_common.dir/src/poses_from_matches.cpp.o
[  5%] Building CXX object common/CMakeFiles/pcl_common.dir/src/print.cpp.o
[  6%] Building CXX object common/CMakeFiles/pcl_common.dir/src/time_trigger.cpp.o
[  6%] Building CXX object common/CMakeFiles/pcl_common.dir/src/gaussian.cpp.o
[  7%] [  7%] Building CXX object common/CMakeFiles/pcl_common.dir/src/range_image.cpp.o
Building CXX object common/CMakeFiles/pcl_common.dir/src/range_image_planar.cpp.o
In file included from /opt/ros/ros_catkin_ws/src/pcl/common/include/pcl/point_types.h:301:0,
                 from /opt/ros/ros_catkin_ws/src/pcl/common/include/pcl/range_image/range_image.h:43,
                 from /opt/ros/ros_catkin_ws/src/pcl/common/src/range_image.cpp:42:
/opt/ros/ros_catkin_ws/src/pcl/common/include/pcl/impl/point_types.hpp:1009:68: warning: ‘SHOT’ is deprecated [-Wdeprecated-declarations]
In file included from /opt/ros/ros_catkin_ws/src/pcl/common/include/pcl/point_types.h:301:0,
                 from /opt/ros/ros_catkin_ws/src/pcl/common/include/pcl/range_image/range_image.h:43,
                 from /opt/ros/ros_catkin_ws/src/pcl/common/include/pcl/range_image/range_image_planar.h:38,
                 from /opt/ros/ros_catkin_ws/src/pcl/common/src/range_image_planar.cpp:41:
/opt/ros/ros_catkin_ws/src/pcl/common/include/pcl/impl/point_types.hpp:1009:68: warning: ‘SHOT’ is deprecated [-Wdeprecated-declarations]
Linking CXX shared library ../lib/libpcl_io_ply.so
[  7%] Built target pcl_io_ply
Scanning dependencies of target pcl_ply2obj
Scanning dependencies of target pcl_ply2raw
Scanning dependencies of target pcl_ply2ply
[  8%] [  9%] [  9%] Building CXX object io/tools/ply/CMakeFiles/pcl_ply2obj.dir/ply2obj.cpp.o
Building CXX object io/tools/ply/CMakeFiles/pcl_ply2raw.dir/ply2raw.cpp.o
Building CXX object io/tools/ply/CMakeFiles/pcl_ply2ply.dir/ply2ply.cpp.o
Scanning dependencies of target pcl_plyheader
[  9%] Building CXX object io/tools/ply/CMakeFiles/pcl_plyheader.dir/plyheader.cpp.o
Linking CXX executable ../../../bin/pcl_plyheader
[  9%] Built target pcl_plyheader
Linking CXX executable ../../../bin/pcl_ply2obj
Linking CXX executable ../../../bin/pcl_ply2raw
[  9%] Built target pcl_ply2obj
[  9%] Built target pcl_ply2raw
Linking CXX shared library ../lib/libpcl_common.so
/usr/bin/ld: cannot find -lsensor_msgs
/usr/bin/ld: cannot find -lroscpp_serialization
/usr/bin/ld: cannot find -lrosconsole
/usr/bin/ld: cannot find -lrostime
collect2: ld returned 1 exit status
make[2]: *** [lib/libpcl_common.so.1.6.0] Error 1
make[1]: *** [common/CMakeFiles/pcl_common.dir/all] Error 2
make[1]: *** Waiting for unfinished jobs....
Linking CXX executable ../../../bin/pcl_ply2ply
[  9%] Built target pcl_ply2ply
Linking CXX shared library ../lib/libpcl_octree.so
[  9%] Built target pcl_octree
make: *** [all] Error 2

<== Failed to process package 'pcl': 
  KeyboardInterrupt
Command failed, exiting.

So when it gets to the part where it's trying to build the pcl_common.so shared library, it errors out.  I'm not sure how to go about fixing this since I'm new to ROS.
Some Observations:

I've looked in my install_isolated folder and found that the roscpp_serialization, rosconsole and rostime shared libraries exist.  So, I'm not sure why they aren't being found by the linker.
I also noticed that the sensor_msgs package builds fine, but no shared library is created.  Only python library modules are created.  Should a sensor_msgs shared library be created installed?
Looking around in the build_isolated/pcl folder, I found various linker.txt files for the various linker commands for the PCL libraries being built.  They all seem to have a dependency on the sensor_msgs shared library (-lsensor_msgs).  But since no libsensor_msgs.so shared library exists, I removed all occurrences of the -lsensor_msgs from the all linker.txt files and the libraries seem to build without any undefined references to sensor_msgs symbols.  So, does PCL really need to depend on sensor_msgs?

Summary
In summary, I'm trying to get the ROS Groovy release built from source, but I can't get past the PCL package linker errors and I'm at a loss right now trying to figure out why I'm getting the errors.  I've made some observation to try and dig deeper into the issue, but haven't gained much progress (probably due to me being a newbie to ROS).  So, if anyone has any insight or answers that may assist me past this roadblock,  I would be greatly appreciated.  Thanks in advanced!

Originally posted by Donny3000 on ROS Answers with karma: 55 on 2013-01-17
Post score: 3

A:

Hi,
This commit should have fixed this bug:
https://github.com/ros-gbp/pcl-release/commit/bf43ffc0eebca4042c6765319c4dd211409d7ace
If not, please open a ticket on github.
Thanks,
Julius

Originally posted by jkammerl with karma: 146 on 2013-01-17
This answer was ACCEPTED on the original site
Post score: 1

Original comments
Comment by Donny3000 on 2013-01-18:
Thanks jkammerl for pointing this out to me.  I actually saw this commit the other day but, didn't know if it pertained to my issue or not.  I will checkout that commit today and report back with my results.
Comment by Donny3000 on 2013-01-18:
jkammerl, blowing away the old src/pcl folder and checking out the commit you mentioned fixed my build issue! Thanks!

