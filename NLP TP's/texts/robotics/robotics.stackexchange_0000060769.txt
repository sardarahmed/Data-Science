Q:

MoveIT! end effector setup question

Hey guys, super noob here.
I am trying to plan for a 6 DOF arm robot from Exact Dynamics. When using the Setup Assistant I am following the PR2 example to assign planning groups for the 'arm' and the 'gripper' generate the package and try to roslaunch using the demo.launch file but it crashes. I am trying to work through this problem but all the combinations of joints and links (I have not used chains yet as I do not fully understand them) I can think of make Rviz crash with this error in the terminal window.
    All is well! Everyone is happy! You can start planning now!

[ INFO] [1405097835.482849916]: Loading robot model 'i_arm'...
[ INFO] [1405097835.801883868]: Loading robot model 'i_arm'...
[ INFO] [1405097835.913759003]: Starting scene monitor
[ INFO] [1405097835.917105272]: Listening to '/move_group/monitored_planning_scene'
[ INFO] [1405097837.711538251]: No active joints or end effectors found for group ''. Make sure you have defined an end effector in your SRDF file and that kinematics.yaml is loaded in this node's namespace.
[rviz_ubuntu_24010_6131403636814191245-4] process has died [pid 24050, exit code -11, cmd /opt/ros/hydro/lib/rviz/rviz -d /home/joso21/catkin_ws/src/iarm_ed_moveit/launch/moveit.rviz __name:=rviz_ubuntu_24010_6131403636814191245 __log:=/home/joso21/.ros/log/44fb4ab6-090c-11e4-93a6-000c298bbf45/rviz_ubuntu_24010_6131403636814191245-4.log].
log file: /home/joso21/.ros/log/44fb4ab6-090c-11e4-93a6-000c298bbf45/rviz_ubuntu_24010_6131403636814191245-4*.log

The force is weak in me and I can't upload screenshots of the setup Assistant steps I am taking. There is another post regarding this issue but the solutions aren't working for me. I thought that my virtual joint may have been an issue as well.
<virtual_joint name="virtual_joint" type="fixed" parent_frame="/world_frame" child_link="base_link" />

I am not sure if the parent frame is defined by me of if there is an existing frame in Rviz that I can attach to? This post seems to refer to this but again not clear as to how I define the parent frame.
Update (7/14/14): I used chains in my urdf to define the planning groups and still the "No active joints or end effectors found..." line in the terminal window is output but the Rviz window will at least open but with a black screen even after multiple launches.
Dropbox Moveit! Package
Dropbox urdf description files
"iarm_ed.urdf" is the file I used with the Moveit! setup assistant
Update (7/15/14): Rviz will open with the robot in the environment (I changed nothing but perhaps the restart closed a redundant process or something...). The end effector issue still remains as it is not being seen and the info message (same as above) is being output. There is an interactive marker associated with the 'arm' planning group in Rviz, but when clicked and moved, the gripper will float away with the marker and the arm stays in the same pose. If the gripper planning group is chosen then the marker disappears. I am using the chain method in the Setup Assistant (base_link >> link5 for 'arm' group   &   link5 >> gripper for 'gripper' group).
It seems like there is a disconnect between the end effector and the rest of the arm but all joints are specified as having a parent and child that connects the entire robot from base to gripper.
Thanks all for the time

Originally posted by JoSo on ROS Answers with karma: 120 on 2014-07-11
Post score: 2

Original comments
Comment by gvdhoorn on 2014-07-12:
Having access to the actual URDF and / or moveit pkg would probably make helping you a bit easier. Also, try a chain, RViz / MoveIt sometimes crashes when using a collection of joints, instead of a chain.
Comment by gvdhoorn on 2014-07-14:
@JoSo: would it be an option to put your pkgs on a github repository? Other option would be a file exchange site / dropbox.

A:

(I have not used chains yet as I do not fully understand them) [..] make Rviz crash with this error in the terminal window.

I don't know why exactly, but RViz and / or MoveIt has a tendency to crash when manipulators are defined as collections of links / joints. Using a chain seems to work around that.

There is an interactive marker associated with the 'arm' planning group in Rviz, but when clicked and moved, the gripper will float away with the marker and the arm stays in the same pose.

In your original description, you state that the iArm is a 6dof manipulator: the URDF you uploaded seems to specify only 5 joints. KDL doesn't work very well with anything < 6dof and you use the KDL kinematics plugin for your arm group (kinematics.yaml in your MoveIt package). I expect things to start working once you add the 6th dof (and regenerate your MoveIt package). Alternatively, you can ask MoveIt to do IK for your current URDF, by checking the Allow Approximate IK Solutions checkbox at the bottom left on the Context tab of the Motion Planning display in RViz.
In any case I'd also recommend generating an IKFast plugin for your manipulator. Such a plugin would also allow 5dof IK to work with MoveIt.

If the gripper planning group is chosen then the marker disappears. I am using the chain method in the Setup Assistant (base_link >> link5 for 'arm' group & link5 >> gripper for 'gripper' group).

One thing to check is that you don't have any overlap between the two groups (see Ioan Sucan's answer in End effector not found on the moveit mailing list). From your description it would seem the two groups share the link5 link.

Originally posted by gvdhoorn with karma: 86574 on 2014-07-16
This answer was ACCEPTED on the original site
Post score: 5

Original comments
Comment by JoSo on 2014-07-16:
@gvdhoorn thanks for the info. What I did was remove the 'gripper' planning group in the SA and change the 'arm' to a chain that includes all the pieces. Which I still don't quite get; how would the chains be attached to one another if there isn't an overlapping link somewhere?
Comment by JoSo on 2014-07-16:
Before I made the change to the planning groups the checkbox worked, now I don't need it.
I will look into IKFast plugin more to get my arm working smoother.
There are 6 DOF in the urdf 'iarm_ed.urdf'. base_joint, shoulder, elbow, wrist_roll, wrist_flex, and gripper_joint.
Thanks again!

