Q:

GumROS log4cxx compilation problem

I want to install GumROS to my Overo Fire. I have followed the tutorial on the ROS wiki[1]. Before compiling ROS, I need to compile and install patched version of log4cxx. I got source then configure it with:
./configure --prefix=/opt/gumros \
            --host=arm-linux \
            --with-apr=/opt/gumros \
            --with-apr-util=/opt/gumros \
            ac_cv_file__dev_zero=yes \
            ac_cv_func_setpgrp_void=yes \
            apr_cv_tcp_nodelay_with_cork=no \
            apr_cv_process_shared_works=no \
            apr_cv_mutex_robust_shared=no \
            ac_cv_sizeof_struct_iovec=8

and then i have managed to make install. Everything was fine up to this point. But while i was trying "sudo make install", i got following error:
libtool: install: warning: relinking `liblog4cxx.la'
/usr/bin/ld: ~/overo-oe/tmp/sysroots/armv7a-angstrom-linux-gnueabi/usr/lib/crti.o: Relocations in generic ELF (EM: 40)
/usr/bin/ld: ~/overo-oe/tmp/sysroots/armv7a-angstrom-linux-gnueabi/usr/lib/crti.o: Relocations in generic ELF (EM: 40)
/usr/bin/ld: ~/overo-oe/tmp/sysroots/armv7a-angstrom-linux-gnueabi/usr/lib/crti.o: Relocations in generic ELF (EM: 40)
/usr/bin/ld: ~/overo-oe/tmp/sysroots/armv7a-angstrom-linux-gnueabi/usr/lib/crti.o: Relocations in generic ELF (EM: 40)
/usr/bin/ld: ~/overo-oe/tmp/sysroots/armv7a-angstrom-linux-gnueabi/usr/lib/crti.o: Relocations in generic ELF (EM: 40)
/usr/bin/ld: ~/overo-oe/tmp/sysroots/armv7a-angstrom-linux-gnueabi/usr/lib/crti.o: Relocations in generic ELF (EM: 40)
~/overo-oe/tmp/sysroots/armv7a-angstrom-linux-gnueabi/usr/lib/crti.o: could not read symbols: File in wrong format
collect2: ld returned 1 exit status
libtool: install: error: relink `liblog4cxx.la' with the above command before installing it
make[4]: *** [install-libLTLIBRARIES] Error 1
make[3]: *** [install-am] Error 2
make[2]: *** [install-recursive] Error 1
make[1]: *** [install-recursive] Error 1
make: *** [install-recursive] Error 1

I especially do not understand the error:
~/overo-oe/tmp/sysroots/armv7a-angstrom-linux-gnueabi/usr/lib/crti.o: could not read symbols: File in wrong format
PS: GCC v4.3.3 (which: ~/overo-oe/tmp/sysroots/i686-linux/usr/armv7a/bin/gcc)
Thanks in advance

Originally posted by dirtyibt on ROS Answers with karma: 46 on 2011-04-25
Post score: 0

Original comments
Comment by dirtyibt on 2011-04-27:
i cannot figure out how to solve this issue. I continued with installing ubuntu on my overo.

A:

Libtool is relinking when doing the install step. Ive not had any other toolchain I've tried with log4cxx, but the angstrom one built from open-embedded does. Oddly enough, it only does it for log4cxx as well, not apr_util, so it maybe a problem with its linking on c++ targets (apr_util is c).
The symptom: when relinking in the install step it links differently than it did in the build step - the notable problem is that it adds -L/usr/lib to the library search path (you should be able to see this a little above the error message), which means it brings the wrong format libraries to the table.
This seems to be a recent common problem with openembedded and their toolchains, see here for details. Lots of other links if you google about it too.
I'm currently looking to see if there's a workaround I can put in eros_log4cxx and also testing to see if the more recent versions of openembedded versions have fixed this problem (I read they addressed it in head).

Originally posted by Daniel Stonier with karma: 3170 on 2011-05-02
This answer was ACCEPTED on the original site
Post score: 0

Original comments
Comment by Daniel Stonier on 2011-05-02:
Quick update : just built a toolchain targeted for the beagleboard via open embedded, and it has no problem when relinking. Who builds your toolchain?

