Q:

/cmd_vel republished as TwistWithCovarianceStamped

Hello,
I am experimenting with robot_localization package, and I understand /cmd_vel has to be TwisthWithCovarianceStamped.
How can I read /cmd_vel and republish it as TwistWithCovarianceStamped?

Originally posted by wintermute on ROS Answers with karma: 180 on 2019-12-04
Post score: 0

A:

This use control (http://docs.ros.org/melodic/api/robot_localization/html/state_estimation_nodes.html#use-control) feature takes a Twist.
You should use that, not using cmd_vel as a state estimation input. No changes required :-)

Originally posted by stevemacenski with karma: 8272 on 2019-12-04
This answer was ACCEPTED on the original site
Post score: 1

Original comments
Comment by wintermute on 2019-12-10:
the documentation states it is a twist, but
[WARN] [1575984102.577068]: Could not process inbound connection: topic types do not match: [geometry_msgs/TwistWithCovarianceStamped] vs. [geometry_msgs/Twist]{'topic': '/cmd_vel', 'tcp_nodelay': '0', 'md5sum': '8927a1a12fb2607ceea095b2dc440a96', 'type': 'geometry_msgs/TwistWithCovarianceStamped', 'callerid': '/ekf_se'}
[ERROR] [1575984102.578052567]: Client [/ekf_se] wants topic /cmd_vel to have datatype/md5sum [geometry_msgs/TwistWithCovarianceStamped/8927a1a12fb2607ceea095b2dc440a96], but our version has [geometry_msgs/Twist/9f195f881246fdfa2798d1d3eebca84a]. Dropping connection.
/ekf_se is almost certainly wants to listen TwistWithCovarianceStamped
Comment by stevemacenski on 2019-12-10:
What are you trying to publish to exactly? Whats your config file? The cmd vel should be in the control input NOT a twist source.
I assure you that it takes a normal twist. https://github.com/cra-ros-pkg/robot_localization/blob/melodic-devel/src/ros_filter.cpp#L1530
Comment by wintermute on 2019-12-10:
If the config file has these statements below, it will try to resubscribe to /cmd_vel as twist with pose:
#twist0: cmd_vel
#twist0_config: [true, false, false,
false, false, true] ...
#twist0_queue_size: 3
#twist0_rejection_threshold: 2
#twist0_nodelay: false
when use control is true, and stamped control is false, ekf-se subscribes to /cmd_vel no problem and uses it.
since I deleted the twist0 .. statements from config file, problem has gone away.
best
Comment by stevemacenski on 2019-12-10:
Yes, you shouldn't have twist0 for cmd_vel, the use control will take care of all of this for you.
If your problem is resolved, can you hit the checkbox by my answer so its removed from the unanswered queue?

