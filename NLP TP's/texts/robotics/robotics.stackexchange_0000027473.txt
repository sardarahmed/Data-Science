Q:

Jackal simulator flipping and flying in Gazebo 5.1

Hi all,
I'm working on a platform related to Jackal, using Jackal's simulator as a base. This is a URDF-described robot which leverages gazebo_ros_control and diff_drive_controller. It seems to work great in Gazebo 2. Description here:
https://github.com/jackal/jackal/blob/indigo-devel/jackal\_description/urdf/jackal.urdf.xacro
https://github.com/jackal/jackal/blob/indigo-devel/jackal\_description/urdf/jackal.gazebo
Unfortunately in Gazebo 5.1, issuing a command causes the robot to do nothing, and then abruptly leap forward in summersaults. It's as if the wheels are being held still and the chassis is being turned relative to the stationary wheel. This is especially apparent when I place the robot on a box so that the wheels are not in contact with anything at all.
Any thoughts what's going on here? Is there a good reference for a wheeled base working in Gazebo 5 with which I can compare?

To reproduce, clone the following repos into your workspace:

https://github.com/jackal/jackal
https://github.com/jackal/jackal_simulator
https://github.com/jackal/jackal_desktop

And run the following:
roslaunch jackal_gazebo jackal_world.launch
roslaunch jackal_viz view_robot.launch

You should be able to drive with the interactive markers, which will trigger the behaviour.

Originally posted by mikepurvis on Gazebo Answers with karma: 67 on 2015-06-25
Post score: 0

Original comments
Comment by scpeters on 2015-06-25:
Can you recommend a set of launch files to reproduce the problem?
Comment by mikepurvis on 2015-06-25:
Whoops, sorry for the oversightâ€” have now added repos and launchers.

A:

Okay, looks like the issue has to do with the built-in PID controller which is used by Gazebo to convert a commanded joint velocity into torque/effort. There doesn't seem to be any documentation covering how this works or how to set the gains for it, but a workaround (at least for ROS robots) is to disable it and instead use the PID controller built into gazebo_ros_control. Example use:
<rosparam param="/gazebo_ros_control/pid_gains">
  front_left_wheel:
    p: 10
    i: 0.1
    d: 0
</rosparam>

No more flipping and flying robots.

Originally posted by mikepurvis with karma: 67 on 2015-07-03
This answer was ACCEPTED on the original site
Post score: 1

