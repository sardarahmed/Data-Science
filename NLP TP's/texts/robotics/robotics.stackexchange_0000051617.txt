Q:

cv_bridge fails to link sensor_msgs on OSX

I decided to rebuild groovy on Mac OSX 10.8 but some weird errors occurred that I have never seen before. I am getting linking errors while building cv_bridge. The linker refers to sensor_msgs, but sensor_msgs does not contain any dynamic libraries, it only contains *.h, *.py and *.pyc.
Do you have  any ideas how to fix this?
Here is the log

Linking CXX shared library /Users/me/Documents/Research/rosws/ros_catkin_ws/devel_isolated/cv_bridge/lib/libcv_bridge.dylib
ld: warning: directory not found for option '-L/opt/ros/groovy/share/OpenCV/3rdparty/lib'
Undefined symbols for architecture x86_64:
  "sensor_msgs::image_encodings::TYPE_16SC1", referenced from:
      cv_bridge::getCvType(std::string const&) in cv_bridge.cpp.o
  "sensor_msgs::image_encodings::TYPE_16SC2", referenced from:
      cv_bridge::getCvType(std::string const&) in cv_bridge.cpp.o
  "sensor_msgs::image_encodings::TYPE_16SC3", referenced from:
      cv_bridge::getCvType(std::string const&) in cv_bridge.cpp.o
  "sensor_msgs::image_encodings::TYPE_16SC4", referenced from:
      cv_bridge::getCvType(std::string const&) in cv_bridge.cpp.o
  "sensor_msgs::image_encodings::TYPE_16UC1", referenced from:
      cv_bridge::getCvType(std::string const&) in cv_bridge.cpp.o
  "sensor_msgs::image_encodings::TYPE_16UC2", referenced from:
      cv_bridge::getCvType(std::string const&) in cv_bridge.cpp.o
  "sensor_msgs::image_encodings::TYPE_16UC3", referenced from:
      cv_bridge::getCvType(std::string const&) in cv_bridge.cpp.o
  "sensor_msgs::image_encodings::TYPE_16UC4", referenced from:
      cv_bridge::getCvType(std::string const&) in cv_bridge.cpp.o
  "sensor_msgs::image_encodings::TYPE_32FC1", referenced from:
      cv_bridge::getCvType(std::string const&) in cv_bridge.cpp.o
  "sensor_msgs::image_encodings::TYPE_32FC2", referenced from:
      cv_bridge::getCvType(std::string const&) in cv_bridge.cpp.o
  "sensor_msgs::image_encodings::TYPE_32FC3", referenced from:
      cv_bridge::getCvType(std::string const&) in cv_bridge.cpp.o
  "sensor_msgs::image_encodings::TYPE_32FC4", referenced from:
      cv_bridge::getCvType(std::string const&) in cv_bridge.cpp.o
  "sensor_msgs::image_encodings::TYPE_32SC1", referenced from:
      cv_bridge::getCvType(std::string const&) in cv_bridge.cpp.o
  "sensor_msgs::image_encodings::TYPE_32SC2", referenced from:
      cv_bridge::getCvType(std::string const&) in cv_bridge.cpp.o
  "sensor_msgs::image_encodings::TYPE_32SC3", referenced from:
      cv_bridge::getCvType(std::string const&) in cv_bridge.cpp.o
  "sensor_msgs::image_encodings::TYPE_32SC4", referenced from:
      cv_bridge::getCvType(std::string const&) in cv_bridge.cpp.o
  "sensor_msgs::image_encodings::TYPE_64FC1", referenced from:
      cv_bridge::getCvType(std::string const&) in cv_bridge.cpp.o
  "sensor_msgs::image_encodings::TYPE_64FC2", referenced from:
      cv_bridge::getCvType(std::string const&) in cv_bridge.cpp.o
  "sensor_msgs::image_encodings::TYPE_64FC3", referenced from:
      cv_bridge::getCvType(std::string const&) in cv_bridge.cpp.o
  "sensor_msgs::image_encodings::TYPE_64FC4", referenced from:
      cv_bridge::getCvType(std::string const&) in cv_bridge.cpp.o
  "sensor_msgs::image_encodings::BAYER_BGGR8", referenced from:
      cv_bridge::getCvType(std::string const&) in cv_bridge.cpp.o
      cv_bridge::getFormat(std::string const&) in cv_bridge.cpp.o
  "sensor_msgs::image_encodings::BAYER_GBRG8", referenced from:
      cv_bridge::getCvType(std::string const&) in cv_bridge.cpp.o
      cv_bridge::getFormat(std::string const&) in cv_bridge.cpp.o
  "sensor_msgs::image_encodings::BAYER_GRBG8", referenced from:
      cv_bridge::getCvType(std::string const&) in cv_bridge.cpp.o
      cv_bridge::getFormat(std::string const&) in cv_bridge.cpp.o
  "sensor_msgs::image_encodings::BAYER_RGGB8", referenced from:
      cv_bridge::getCvType(std::string const&) in cv_bridge.cpp.o
      cv_bridge::getFormat(std::string const&) in cv_bridge.cpp.o
  "sensor_msgs::image_encodings::numChannels(std::string const&)", referenced from:
      cv_bridge::getConversionCode(std::string, std::string) in cv_bridge.cpp.o
  "sensor_msgs::image_encodings::BAYER_BGGR16", referenced from:
      cv_bridge::getCvType(std::string const&) in cv_bridge.cpp.o
      cv_bridge::getFormat(std::string const&) in cv_bridge.cpp.o
  "sensor_msgs::image_encodings::BAYER_GBRG16", referenced from:
      cv_bridge::getCvType(std::string const&) in cv_bridge.cpp.o
      cv_bridge::getFormat(std::string const&) in cv_bridge.cpp.o
  "sensor_msgs::image_encodings::BAYER_GRBG16", referenced from:
      cv_bridge::getCvType(std::string const&) in cv_bridge.cpp.o
      cv_bridge::getFormat(std::string const&) in cv_bridge.cpp.o
  "sensor_msgs::image_encodings::BAYER_RGGB16", referenced from:
      cv_bridge::getCvType(std::string const&) in cv_bridge.cpp.o
      cv_bridge::getFormat(std::string const&) in cv_bridge.cpp.o
  "sensor_msgs::image_encodings::BGR8", referenced from:
      cv_bridge::getCvType(std::string const&) in cv_bridge.cpp.o
      cv_bridge::getFormat(std::string const&) in cv_bridge.cpp.o
  "sensor_msgs::image_encodings::RGB8", referenced from:
      cv_bridge::getCvType(std::string const&) in cv_bridge.cpp.o
      cv_bridge::getFormat(std::string const&) in cv_bridge.cpp.o
  "sensor_msgs::image_encodings::BGR16", referenced from:
      cv_bridge::getCvType(std::string const&) in cv_bridge.cpp.o
      cv_bridge::getFormat(std::string const&) in cv_bridge.cpp.o
  "sensor_msgs::image_encodings::BGRA8", referenced from:
      cv_bridge::getCvType(std::string const&) in cv_bridge.cpp.o
      cv_bridge::getFormat(std::string const&) in cv_bridge.cpp.o
  "sensor_msgs::image_encodings::MONO8", referenced from:
      cv_bridge::getCvType(std::string const&) in cv_bridge.cpp.o
      cv_bridge::getFormat(std::string const&) in cv_bridge.cpp.o
  "sensor_msgs::image_encodings::RGB16", referenced from:
      cv_bridge::getCvType(std::string const&) in cv_bridge.cpp.o
      cv_bridge::getFormat(std::string const&) in cv_bridge.cpp.o
  "sensor_msgs::image_encodings::RGBA8", referenced from:
      cv_bridge::getCvType(std::string const&) in cv_bridge.cpp.o
      cv_bridge::getFormat(std::string const&) in cv_bridge.cpp.o
  "sensor_msgs::image_encodings::BGRA16", referenced from:
      cv_bridge::getCvType(std::string const&) in cv_bridge.cpp.o
      cv_bridge::getFormat(std::string const&) in cv_bridge.cpp.o
  "sensor_msgs::image_encodings::MONO16", referenced from:
      cv_bridge::getCvType(std::string const&) in cv_bridge.cpp.o
      cv_bridge::getFormat(std::string const&) in cv_bridge.cpp.o
  "sensor_msgs::image_encodings::RGBA16", referenced from:
      cv_bridge::getCvType(std::string const&) in cv_bridge.cpp.o
      cv_bridge::getFormat(std::string const&) in cv_bridge.cpp.o
  "sensor_msgs::image_encodings::YUV422", referenced from:
      cv_bridge::getCvType(std::string const&) in cv_bridge.cpp.o
      cv_bridge::getFormat(std::string const&) in cv_bridge.cpp.o
      cv_bridge::getConversionCode(std::string, std::string) in cv_bridge.cpp.o
  "sensor_msgs::image_encodings::isMono(std::string const&)", referenced from:
      cv_bridge::getConversionCode(std::string, std::string) in cv_bridge.cpp.o
  "sensor_msgs::image_encodings::isBayer(std::string const&)", referenced from:
      cv_bridge::getConversionCode(std::string, std::string) in cv_bridge.cpp.o
  "sensor_msgs::image_encodings::isColor(std::string const&)", referenced from:
      cv_bridge::getConversionCode(std::string, std::string) in cv_bridge.cpp.o
  "sensor_msgs::image_encodings::bitDepth(std::string const&)", referenced from:
      cv_bridge::getConversionCode(std::string, std::string) in cv_bridge.cpp.o
      cv_bridge::toCvCopyImpl(cv::Mat const&, std_msgs::Header_<std::allocator<void> > const&, std::string const&, std::string const&) in cv_bridge.cpp.o
  "sensor_msgs::image_encodings::TYPE_8SC1", referenced from:
      cv_bridge::getCvType(std::string const&) in cv_bridge.cpp.o
  "sensor_msgs::image_encodings::TYPE_8SC2", referenced from:
      cv_bridge::getCvType(std::string const&) in cv_bridge.cpp.o
  "sensor_msgs::image_encodings::TYPE_8SC3", referenced from:
      cv_bridge::getCvType(std::string const&) in cv_bridge.cpp.o
  "sensor_msgs::image_encodings::TYPE_8SC4", referenced from:
      cv_bridge::getCvType(std::string const&) in cv_bridge.cpp.o
  "sensor_msgs::image_encodings::TYPE_8UC1", referenced from:
      cv_bridge::getCvType(std::string const&) in cv_bridge.cpp.o
  "sensor_msgs::image_encodings::TYPE_8UC2", referenced from:
      cv_bridge::getCvType(std::string const&) in cv_bridge.cpp.o
  "sensor_msgs::image_encodings::TYPE_8UC3", referenced from:
      cv_bridge::getCvType(std::string const&) in cv_bridge.cpp.o
  "sensor_msgs::image_encodings::TYPE_8UC4", referenced from:
      cv_bridge::getCvType(std::string const&) in cv_bridge.cpp.o
ld: symbol(s) not found for architecture x86_64
clang: error: linker command failed with exit code 1 (use -v to see invocation)
make[2]: *** [/Users/me/Documents/Research/rosws/ros_catkin_ws/devel_isolated/cv_bridge/lib/libcv_bridge.dylib] Error 1
make[1]: *** [src/CMakeFiles/cv_bridge.dir/all] Error 2
make: *** [all] Error 2
Traceback (most recent call last):
  File "./src/catkin/bin/../python/catkin/builder.py", line 658, in build_workspace_isolated
    number=index + 1, of=len(ordered_packages)
  File "./src/catkin/bin/../python/catkin/builder.py", line 443, in build_package
    install, jobs, force_cmake, quiet, last_env, cmake_args, make_args
  File "./src/catkin/bin/../python/catkin/builder.py", line 297, in build_catkin_package
    run_command(make_cmd, build_dir, quiet)
  File "./src/catkin/bin/../python/catkin/builder.py", line 186, in run_command
    raise subprocess.CalledProcessError(proc.returncode, ' '.join(cmd))
CalledProcessError: Command '/opt/ros/groovy/env.sh make -j8 -l8' returned non-zero exit status 2
<== Failed to process package 'cv_bridge': 
  Command '/opt/ros/groovy/env.sh make -j8 -l8' returned non-zero exit status 2

Reproduce this error by running:
==> /opt/ros/groovy/env.sh make -j8 -l8

Command failed, exiting.

Originally posted by Artem on ROS Answers with karma: 709 on 2013-06-01
Post score: 0

A:

The problem is solved by downgrading cmake back to 2.8.10.2. Apparently cmake ver 2.8.11 breaks the building process.
Here is the solution
brew uninstall cmake
cd /usr/local/Cellar
brew versions cmake
git checkout 68c419b /usr/local/Library/Formula/cmake.rb
brew install cmake

Originally posted by Artem with karma: 709 on 2013-06-02
This answer was ACCEPTED on the original site
Post score: 0

