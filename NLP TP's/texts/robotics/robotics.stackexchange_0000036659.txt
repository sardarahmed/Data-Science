Q:

TransformListener Could not find a common time /base_link and /map

I recorded bags on different computers/robots during an experiment and now I'm trying to replay them. All computers were synchronized with chrony. Now, I play all bags with the same rosbag command.
However, when I call listener.lookupTransform("/map", "/base_link", ros::Time(0), transformStamped); from another node, I get the error Could not find a common time /base_link and /map.
Everything is fine when I look with RVIZ, same with roswtf. I ran tf view_frames and everything seems normal to me.
I also tried rosparam set /use_sim_time "True" and then rosbag play --clock, but it does not seem to make any difference.
One of my colleagues recommend that I always call waitForTransform before lookupTransform. Is this required, or should lookupTransform work on its own?
frames2.png

Originally posted by Benoit Larochelle on ROS Answers with karma: 867 on 2011-12-21
Post score: 0

A:

Adding a call to canTransform or waitForTransform before lookupTransform solves the problem. For example, listener.waitForTransform("/map", "/base_link", ros::Time(0),ros::Duration(1)); the line before lookupTransform makes everything work.

Originally posted by Benoit Larochelle with karma: 867 on 2011-12-22
This answer was ACCEPTED on the original site
Post score: 1

Original comments
Comment by tfoote on 2011-12-22:
You will likely want to use waitForTransform documented in the tf tutorials http://www.ros.org/wiki/tf/Tutorials or if you are performance limited the tf::MessageFilter will allow you to do it without blocking execution http://ros.org/doc/electric/api/tf/html/c++/classtf_1_1MessageFilter.html

