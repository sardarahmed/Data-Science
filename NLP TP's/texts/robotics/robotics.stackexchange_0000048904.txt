Q:

Catkin_make generate services .h after building c++ code file?

Hi, I have a problem with catkin_make that stop me from building my project. He seems to compile my c++ file before generating my message and service.
####
#### Running command: "make -j1 -l1" in "/home/philippe/design3/app/build"
####
Scanning dependencies of target Kinocto
[  7%] Building CXX object kinocto/CMakeFiles/Kinocto.dir/src/Kinocto.cpp.o
In file included from /home/philippe/design3/app/src/kinocto/src/Kinocto.cpp:1:0:
**/home/philippe/design3/app/src/kinocto/include/Kinocto.h:10:34: fatal error: kinocto/StartKinocto.h: No such file or directory**
compilation terminated.
make[2]: *** [kinocto/CMakeFiles/Kinocto.dir/src/Kinocto.cpp.o] Error 1
make[1]: *** [kinocto/CMakeFiles/Kinocto.dir/all] Error 2

In bold, wecan see that he can't find my service StartKinocto.h that doesnt exist because it havent been generated first... If I comment the code that use this service the service file is generated after Kinocto.cpp :
#### Running command: "make -j1 -l1" in "/home/philippe/design3/app/build"
####
Scanning dependencies of target Kinocto
[  7%] Building CXX object kinocto/CMakeFiles/Kinocto.dir/src/Kinocto.cpp.o
Linking CXX executable /home/philippe/design3/app/devel/lib/kinocto/Kinocto
[  7%] Built target Kinocto
Scanning dependencies of target kinocto_gencpp
[ 15%] Generating C++ code from kinocto/Num.msg
[ 23%] Generating C++ code from kinocto/AddTwoInts.srv
**[ 30%] Generating C++ code from kinocto/StartKinocto.srv**
[ 30%] Built target kinocto_gencpp
Scanning dependencies of target kinocto_genlisp
[ 38%] Generating Lisp code from kinocto/Num.msg
[ 46%] Generating Lisp code from kinocto/AddTwoInts.srv
**[ 53%] Generating Lisp code from kinocto/StartKinocto.srv**

Is that normal? What should I do?

Originally posted by phbou72 on ROS Answers with karma: 130 on 2013-03-02
Post score: 0

A:

OK, so I found out what was the problem... Even if your .srv is in your package you still need to add your package to his own dependencies... Kind of weird.
In my CMakeList.txt of the package kinocto I had:
add_executable(Kinocto src/Kinocto.cpp)

After the line above, I simply added this :
add_dependencies(Kinocto kinocto_gencpp) 

No more error and the .srv files are generated.
I think it should be documented in the tutorials...

Originally posted by phbou72 with karma: 130 on 2013-03-02
This answer was ACCEPTED on the original site
Post score: 4

Original comments
Comment by KruseT on 2013-03-02:
It is documented in this tutorial: http://www.ros.org/wiki/ROS/Tutorials/WritingPublisherSubscriber%28c%2B%2B%29 (catkin). if you see another tutotiral that misses that, tell us of fix it.
Comment by Sergio MP on 2015-01-29:
@KruseT It should be documented in the CreatingMsgAndSrv Tutorial. This issue has proven to be a headache.

