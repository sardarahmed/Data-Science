Q:

Getting rosparam from node namespace within bash script?

How do I duplicate the behavior in a bash script of python or c++ nodes where getting a rosparam gets it relative to the nodehandle/rospy namespace?  I'd like to launch a .sh node in a roslaunch file and set parameters in the node namespace, but how does the shell script know what that namespace is when it runs rosparam get to get it?
roslaunch file:
<node name="foo" pkg="bar" type="test.sh">
  <param name="do_something" value="true" />
</node>

And then test.sh:
#!/bin/sh
...
do_something=`rosparam get do_something`

But that will get /do_something, not the node namespace.

Originally posted by lucasw on ROS Answers with karma: 8729 on 2015-11-13
Post score: 0

A:

An obvious answer would be that you could use the full name of the parameter e.g. /foo/do_something.
I'm guessing you are looking for something a bit fancier. If the ROS_NAMESPACE environment variable is set, then the call to rosparam will automatically happen inside of that namespace. So you could use the <env> tag to set that environment variable to be the same as your node name, then the name should get resolved correctly.
I'm not exactly sure if that answers your question, there may be other solutions as well.
EDIT
Here's an example... I tested this and it works.
Launch File:
<launch>
  <node name="foo" pkg="bar" type="test.sh" output="screen">
    <env name="ROS_NAMESPACE" value="foo" />
    <param name="do_something" value="true" />
  </node>
</launch>

test.sh:
#!/bin/bash
val=$(rosparam get do_something)
echo "PARAM = ${val}"

Originally posted by jarvisschultz with karma: 9031 on 2015-11-13
This answer was ACCEPTED on the original site
Post score: 1

Original comments
Comment by lucasw on 2015-11-14:
Tracking the namespace manually gets error prone and cumbersome for nested namespaces, it would be nice if there was a special roslaunch variable that was the current namespace.

