Q:

Sending the image using cvbridge

I am getting in image from a webcam using cvbridge. What I want to be able to do is change a few things to that image, and finally publish it.
When I try to create another cvImagePtr and change the image associated with it to finally publish it using
image_final.copyTo(cv_ptr_image_final->image);
and then using   "->toImageMsg()" to send the image,
It gives me an error saying
/usr/include/boost/smart_ptr/shared_ptr.hpp:418: T* boost::shared_ptr<  >::operator->() const [with T = cv_bridge::CvImage]: Assertion `px != 0' failed.
Aborted
What should I do to update the image in one of the cvBridge vairables so that I can publish it ?
Thx a lot

Originally posted by navderm_2 on ROS Answers with karma: 21 on 2011-10-05
Post score: 2

A:

The issue with your approach is, that just creating a variable of type "CvImagePtr" will not give you anything useful... ;) The "Ptr" means "pointer", in this case boost::shared_ptr. So you have a pointer poing to null. That's what the assertion is trying to tell you.
Maybe it will help, to create a CvImage with new in the follwing way:
CvImagePtr cv_ptr_image_final(new CvImage());

This will give you a shared pointer pointing to some empty CvImage. But I think, before you can really send the image, you need to fill the header and encoding members of your new CvImage, too. In most cases it should be possible to just copy them from the old CvImage.

Originally posted by Achim with karma: 390 on 2011-10-07
This answer was ACCEPTED on the original site
Post score: 5

Original comments
Comment by Lorenzo Riano on 2011-10-08:
I never liked typedeffing pointers. It never makes things easier and it becomes confusing when one has to know which data type he's dealing with.

