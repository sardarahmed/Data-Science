Q:

Rospy callback attribute error

Am following a youtube tutorial (https://www.youtube.com/watch?v=DLVyc9hOvk8) with my own code:
Executable:
import rospy
from tf2_msgs.msg import TFMessage
import math #mathsssss
def callback(msg): #global cariable
    x = msg.transforms.transform.translation.x
    y = msg.transforms.transform.translation.y
    rospy.loginfo('x: {}, y: {}'.format(x,y))
def main():
    rospy.init_node('location_monitor')  #makes this code into a ROS node
    rospy.Subscriber("/tf", TFMessage, callback)
    # to sub: give (name of topic, messageclass, callback you want to do
    rospy.spin() # loop
if __name__ == '__main__':
    main()

Shell returns:
[ERROR] [1511523182.758203]: bad callback: <function callback at 0x7f1cd923e668>
Traceback (most recent call last):
  File "/opt/ros/kinetic/lib/python2.7/dist-packages/rospy/topics.py", line 750, in _invoke_callback
    cb(msg)
  File "/home/username/catkin_ws/src/pkgname/src/location_monitor_node.py", line 9, in callback
    x = msg.transforms.translation.x
AttributeError: 'list' object has no attribute 'translation'

Have searched other questions. Tried importing things from TFMessage, checking my capital letters, using it with .transform, and such. Nothing works.
Am pretty new to ROS.

Originally posted by anonymous32749 on ROS Answers with karma: 62 on 2017-11-24
Post score: 0

A:

According to the documentation for tf2_msgs/TFMessage (here), the transforms field is a list/array, so you'll need to index into it:
geometry_msgs/TransformStamped[] transforms

Something like msg.transforms[0].transform.translation.x.
But realise that you may receive multiple TransformStampeds in a single message, so always using the first might not be what you want.

Originally posted by gvdhoorn with karma: 86574 on 2017-11-24
This answer was ACCEPTED on the original site
Post score: 4

Original comments
Comment by gvdhoorn on 2017-11-24:
Note btw that subscribing to /tf like that is not typical usage. It's possible, but you might want to use the tf2 infrastructure (with Listeners, Buffers, etc).
Comment by ramkumar on 2022-10-13:
hi,
i'm trying somthing similar to this.
i'm trying to use your suggestion (msg.transforms[0].transform.translation.x), but completely confused.
can you explain with small sample code !...
please!!

