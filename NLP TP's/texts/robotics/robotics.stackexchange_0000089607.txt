Q:

How to add message field in a rosbag

I got a rosbag with a number of topics being played.
I am interested in adding a Header (more specifically, a frame_id) to the message received so some 3d points in it are automatically displayed in RViz in the correct frame defined.
Is this possible? I know you can iterate a rosbag with the type of loop:
for topic, msg, t in inbag.read_messages():

        if topic == "/desired_topic":

            outbag.write(topic,msg.h,t)

        if topic not in ["/desired_topic"]:
            outbag.write(topic,msg,t)
                
    outbag.close()

But I don't know how to add a field to the incoming message and save it in a new bag.

Originally posted by thepirate16 on ROS Answers with karma: 101 on 2018-11-15
Post score: 0

A:

The rosbag_storage package described here allows you to access and modify the contents of a bag file without playing it back as you would normally have to. Using this you can look through all of the messages in a bag file and write messages into a bag file too.
However you cannot add a field into a message, the structure of messages is fixed and they can only contain the fields they are defined with. Some message types however include a normal type and 'Stamped' type which is the same message with an additional Header.
For example if your bag file contains geometry_msgs/pose messages then you could read these and create geometry_msgs/PoseStamped with the additional frame_id information in the header and write them back to the file. Only some messages have a stamped version though.
Hope this helps.

Originally posted by PeteBlackerThe3rd with karma: 9529 on 2018-11-15
This answer was ACCEPTED on the original site
Post score: 0

