Q:

[ROS2] rviz2 and rqt do not shown published image

Hi,
I have created a Gazebo world with a camera and the image is publishing to a topic of type sensor_msgs/msg/Image. I opened rviz2 and rqt to see the published image. But both tools shown a empty image.

When I run the ros2 topic echo command I see that image data is published.
To test it you can use the gazebo_ros_camera_demo.world from the gazebo_plugin package.
Is this a bug of rviz and rqt or is there a missing setting?

EDIT:
QoS are the the same by default. I ran the command ros2 topic info -v /demo_cam/camera1/image_raw and got following output:
Type: sensor_msgs/msg/Image

Publisher count: 1

Node name: camera_controller
Node namespace: /demo_cam
Topic type: sensor_msgs/msg/Image
Endpoint type: PUBLISHER
GID: 01.0f.0d.01.ba.44.00.00.01.00.00.00.00.00.12.03.00.00.00.00.00.00.00.00
QoS profile:
  Reliability: RMW_QOS_POLICY_RELIABILITY_BEST_EFFORT
  Durability: RMW_QOS_POLICY_DURABILITY_VOLATILE
  Lifespan: 2147483651294967295 nanoseconds
  Deadline: 2147483651294967295 nanoseconds
  Liveliness: RMW_QOS_POLICY_LIVELINESS_AUTOMATIC
  Liveliness lease duration: 2147483651294967295 nanoseconds

Subscription count: 1

Node name: rviz
Node namespace: /
Topic type: sensor_msgs/msg/Image
Endpoint type: SUBSCRIPTION
GID: 01.0f.0d.01.99.45.00.00.01.00.00.00.00.00.26.04.00.00.00.00.00.00.00.00
QoS profile:
  Reliability: RMW_QOS_POLICY_RELIABILITY_RELIABLE
  Durability: RMW_QOS_POLICY_DURABILITY_VOLATILE
  Lifespan: 2147483651294967295 nanoseconds
  Deadline: 2147483651294967295 nanoseconds
  Liveliness: RMW_QOS_POLICY_LIVELINESS_AUTOMATIC
  Liveliness lease duration: 2147483651294967295 nanoseconds

Originally posted by lmiller on ROS Answers with karma: 219 on 2020-08-13
Post score: 4

Original comments
Comment by Phgo on 2020-08-13:
I tried to reproduce your problem in eloquent and experienced the same issue in rviz. However, rqt works out of the box for me. Looks like rviz requires the tf transform from your fixed frame to camera_link to be available. Try setting your fixed frame to camera_link or providing a tf transform.
Another common issue in this context are mismatching Quality of Service settings. However, it works fine with the default settings in my case. (not sure whether rqt's default QoS settings changed in foxy)
Comment by lmiller on 2020-08-13:
Thanks for your reply. I have edited my question with the QoS.
I also tried to set the fixed frame in RViz to camera_link but I dont get it working
Comment by Phgo on 2020-08-13:
@lmiller you wrote in your edit, that the QoS settings are the same but your log output shows that your publisher is reliability BEST_EFFORT, while the subscriber is set to RELIABLE.
This is not a compatible configuration (see here).
Have you tried changing your rviz subscriber to best effort in the topic section?
Comment by lmiller on 2020-08-13:
@Phgo Oh I didnt see that. I set the reliability QoS to Best Effort in RViz & the world frame to camera_link and now it works in RViz.
Comment by Phgo on 2020-08-13:
@lmiller as far as I know is not yet possible to change the QoS in rqt GUI (The issue addressing this is still open)
Do you need any further help on this or does this answer your question?
Comment by lmiller on 2020-08-13:
@Phgo Thanks this answered my question

A:

As @Phgo answered in the comments the QoS were mismatched. Also the frame in RViz was not set correctly.
The image plugin in RQT has no option to set the QoS (see in that issue)

Originally posted by lmiller with karma: 219 on 2020-08-13
This answer was ACCEPTED on the original site
Post score: 3

Original comments
Comment by 808brick on 2021-03-30:
Is there a reason why the fixed frame needs to be the camera link? Does that mean I would have to open another RViz instance jut to view my robot model / localization instancesfrom my base link?
Comment by lmiller on 2021-03-31:
If you have a TF from your fixed frame to your camera_link, then No there is no reason.
In my Case i had not any TF to my camera_link
Comment by 808brick on 2021-03-31:
Hmm, it seems it does not count "revolute" joints. I am able to view images using the link I joined to the camera using "fixed", but then that link is joined via revolute joint to my base, and I am not able to view using the base as my frame.
Comment by lmiller on 2021-03-31:
Please open a new question if it doesnt work for you.
So other people can join the discussion and may help you. Dont forget to post all relevant stuff like ROS distro, Code, etc...
Comment by 808brick on 2021-03-31:
Understood. Apologies for getting off topic.

