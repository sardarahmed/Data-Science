Q:

Unable to include a header-only library

I have the following project structure:
utils 
 include 
  image_utils.h
 CMakelists.txt
 package.xml
graph
 src
  graph.cpp
 CMakelists.txt
 package.xml

I am trying to use image_utils.h in graph.cpp.
The CMakelists inside utils looks like this:
cmake_minimum_required(VERSION 3.0.2)
project(utils)

find_package(catkin REQUIRED COMPONENTS roscpp)
catkin_package(
  INCLUDE_DIRS include
  LIBRARIES ${PROJECT_NAME}
  CATKIN_DEPENDS roscpp 
)
include_directories(
  include
  ${catkin_INCLUDE_DIRS}
)

install(
  DIRECTORY include/
  DESTINATION ${CATKIN_PACKAGE_INCLUDE_DESTINATION}
  FILES_MATCHING PATTERN "*.h"
)

And in the CMakelists inside graph i call find_package(catkin REQUIRED COMPONENTS roscpp utils).
My error message is:
  Project 'graph' tried to find library 'utils'.  The library is neither
  a target nor built/installed properly.  Did you compile project 'utils'?
  Did you find_package() it before the subdirectory containing its code is
  included?
Call Stack (most recent call first):
  /opt/ros/melodic/share/catkin/cmake/catkinConfig.cmake:76 (find_package)
  CMakeLists.txt:7 (find_package)

Any idea what I am doing wrong here?

Originally posted by milano on ROS Answers with karma: 3 on 2023-02-08
Post score: 0

A:

You have this:

catkin_package(

  INCLUDE_DIRS include
  LIBRARIES ${PROJECT_NAME}
  CATKIN_DEPENDS roscpp 
)

Note the LIBRARIES ${PROJECT_NAME} specifically.
This makes Catkin export a library target called ${PROJECT_NAME} (in this case that would be equal to utils) to all your dependents.
This causes CMake, when parsing utils/CMakeLists.txt to expect a utils library target to exist (ie: be exported) by your graph project.
Since utils is header-only (according to you), there is no such utils library, hence the error message.
If you remove the LIBRARIES ${PROJECT_NAME}, things should start working (or at least: you shouldn't get that error any more).
PS: there are quite a few duplicates of this question here on ROS Answers. I've not looked them up this time, but please try to search before posting. Use Google, and append site:answers.ros.org to your query.

Originally posted by gvdhoorn with karma: 86574 on 2023-02-09
This answer was ACCEPTED on the original site
Post score: 1

Original comments
Comment by milano on 2023-02-09:
Now it works, thank you!
Sorry, I searched for similar issues, but none of the solutions I found worked.
Comment by gvdhoorn on 2023-02-09:
No need to apologise.

