Q:

Proper way to set the size.z of 

To put things into context I have a DEM stored in a geotiff with proper gdal metadata set, I am using Gazebo9.
Let's say the DEM has max_elevation of 5.0 and and a min_elevation value of 1.0.
How do I correctly set the value of z_scale value (shown below) if I want to maintain the same height values stored in the dem?
<heightmap><size>desired_width desired_height z_scale</size></heightmap>

By examining https://github.com/osrf/gazebo/blob/gazebo9/gazebo/physics/HeightmapShape.cc and https://github.com/osrf/gazebo/blob/gazebo9/gazebo/rendering/Heightmap.cc gazebo seems to use the following formula (max_elevation-min_elevation)/max_elevation, this means that z_scale would be (5.0-1.0)/5.0=0.8.
I read somewhere that I should be using the formula max_elevation-min_elevation which mean the z_scale value would 5.0-1.0=4.0. Is this correct?
Also how much reliable is the GDAL metadata parsing code within Gazebo9. Can I just rely on that?

Originally posted by Samahu on Gazebo Answers with karma: 56 on 2020-07-27
Post score: 2

Original comments
Comment by scpeters on 2020-08-07:\

how much reliable is the GDAL metadata parsing code within Gazebo9. Can I just rely on that?
If you explicitly set <size>, gazebo will use that, but if not it will infer the size from the DEM file. I haven't done benchmarking on its accuracy or tested for bugs, but I will be happy to investigate any bug reports about it.
https://github.com/osrf/gazebo/blob/gazebo9_9.13.1/gazebo/physics/HeightmapShape.cc#L93-L103

Comment by Samahu on 2020-08-12:
@scpeters At one point, I tried omitting the  for a tiff height-map that had associated geo-reference information, gazebo loads the map with proper elevation (I measured that) but the desired_width & desired_height was not in line with the geo-reference information. The map had a size of 5mx5m but gazebo gave me 20mx20m. How do I report a bug?

A:

You should be using the formula max_elevation-min_elevation which mean the z_scale value would 5.0-1.0=4.0.

Originally posted by lakshmi with karma: 26 on 2020-08-06
This answer was ACCEPTED on the original site
Post score: 1

Original comments
Comment by scpeters on 2020-08-07:
yes, I believe this is the right way to compute the scale, which should have units of length

