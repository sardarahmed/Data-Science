Q:

Unable to read a file while using relative path

Hi,
I want to read a file inside python script in ros indigo in the following way -
file_name = rospy.get_param("~file", None)

Below is the snippet of launch file -
<launch>
    <arg name="file"  default="$(find kinematics)/sample/joint_states.csv" />
    <arg name="animation" default="true" />  <!-- run animation -->
    <group if="$(arg animation)">
        <node pkg="kinematics" type="trajectory.py" name="trajectory_animation" respawn="true">
            <param name="file" value="$(arg file)" />
        </node>
    </group>
</launch>

While providing the file parameter as a command line argument, it says No such file or directory. Below is the output of terminal -
ravi@ravi-pc:~/ros_ws$ roslaunch kinematics baxter.launch file:=src/../../Desktop/joint_states.csv 
  File "/home/ravi/ros_ws/src/kinematics/src/trajectory.py", line 19, in __init__
    with open(file_name, 'r') as f:
IOError: [Errno 2] No such file or directory: 'src/../../Desktop/joint_states.csv'
ravi@ravi-pc:~/ros_ws$ ll src/../../Desktop/joint_states.csv
-rw-rw-r-- 1 ravi ravi 179308 May 19 20:46 src/../../Desktop/joint_states.csv
ravi@ravi-pc:~/ros_ws$ roslaunch kinematics baxter.launch file:=src/kinematics/sample/joint_states.csv
  File "/home/ravi/ros_ws/src/kinematics/src/trajectory.py", line 19, in __init__
    with open(file_name, 'r') as f:
IOError: [Errno 2] No such file or directory: 'src/kinematics/sample/joint_states.csv'
ravi@ravi-pc:~/ros_ws$ ll src/kinematics/sample/joint_states.csv
-rw-rw-r-- 1 tom tom 179308 May 19 20:46 src/kinematics/sample/joint_states.csv

Originally posted by ravijoshi on ROS Answers with karma: 1744 on 2016-05-27
Post score: 1

A:

You are probably not aware that by default, the working directory of all nodes is set to $ROS_HOME, which in most cases will be $HOME/.ros, not the base of your catkin workspace.
Some earlier questions and answers about this:

How to save file to the current directory with roslaunch?
roslaunch prevents node from creating/writing to file
Write to a file from a C++ ROS node?

Note: you don't want to go and change the value of ROS_HOME. Instead, either specify an absolute path, or place data in a package that is on the ROS_PACKAGE_PATH and use $(find ..)/path/to/data.file (as you are doing in your launch file). Note that the equivalent of $(find ..) in your launch file is rospack find .. on the command line.

Edit: and a direct link to the wiki page documenting this: roslaunch/XML/node - Attributes. Look for the cwd attribute.

Originally posted by gvdhoorn with karma: 86574 on 2016-05-27
This answer was ACCEPTED on the original site
Post score: 9

Original comments
Comment by ravijoshi on 2016-05-27:
Many thanks. I still didn't get the answer. One of the link suggest to provide the absolute path, which I don't prefer. Another link suggest to keep the data file inside the package and use rospack find command. I don't prefer this too, as the file is provided by user as input. Please suggest.
Comment by gvdhoorn on 2016-05-27:
There is nothing to suggest. Those are the two supported options.

keep the data file inside the package

Note that the suggestion is to keep it inside a package, not necessarily your package.
Comment by gvdhoorn on 2016-05-27:
I've no idea of the side effects / consequences, but you could see whether you can work around this by using something like chdir(..) or current_path(..) from Boost.
Comment by gvdhoorn on 2016-05-27:
Another option could be to pass the cwd to your node as a parameter, and prefix the file parameter with that.

