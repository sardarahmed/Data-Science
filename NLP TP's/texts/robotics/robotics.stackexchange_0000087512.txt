Q:

Kill rosrun gracefully

Hi All,
I am running a rosrun command to generate and publish messages continuously from a node X. But I am not able to gracefully kill the session. I am currently closing the terminal in order to stop the task.
Kindly let me know if the below 2 approaches are correct and how to implement it.

Open a new terminal and kill the node X
Ctrl+C to stop the the publishing of messages and return to the terminal (This is what I am actually looking for)

Code Snippet;
     while(ros :: ok)
     {
         ros_time = ros:Time::now();
         publish the message;
         update the message;
         ros::SpinOnce();
      }

I would create a package and then run rosrun
Thank you.

Originally posted by kk2105 on ROS Answers with karma: 262 on 2018-06-23
Post score: 0

Original comments
Comment by gvdhoorn on 2018-06-23:
It's likely the node you cannot shutdown is not correctly programmed. Common cause: not checking ros::ok() in your while-loop. Please show us some code of the node or check it yourself.
Comment by gvdhoorn on 2018-06-23:
Note btw: even if things were working correctly, you'd not be "killing rosrun", but would be shutting down the node.
Comment by kk2105 on 2018-06-23:
@gvdhoorn Thank you for the response... code snippet does have ros::ok() condition in while loop...
Is there a way I can use Ctrl+C to terminate the rosrun .?
Comment by gvdhoorn on 2018-06-23:
Then please show your code, otherwise we can only guess why things don't work the way they should.
Comment by kk2105 on 2018-06-26:
@gvdhoorn I was able to stop the node by killing it in another terminal.. however I need to know how can I use Ctrl+C to come out of terminal in this case..  I update the code soon.

A:

I believe this was already covered in your other question (#q294951), but this:
while(ros :: ok)

is not correct.
It should be: ros::ok(). It's a function, not a variable.
What you have now probably checks a function pointer, which will evaluate to true, hence making your while-loop equivalent to while (true).
In addition: you don't have a ros::Rate with a rate.sleep() in there anywhere. Adding one will probably help.

Originally posted by gvdhoorn with karma: 86574 on 2018-06-26
This answer was ACCEPTED on the original site
Post score: 3

Original comments
Comment by kk2105 on 2018-06-26:
@gvdhoorn ros:ok() worked like a champ.. Now I am able to Ctrl+C to come out of the terminal.. That small mistake was ruining my day...
Comment by gvdhoorn on 2018-06-26:
If you haven't, do add the ros::Rate. If you don't add it, your little node will be using 100% cpu even when it's doing nothing.
Comment by kk2105 on 2018-06-26:
@gvdhoorn thank you.. Yep.. I have added the ros::Rate and sleep.rate()..

