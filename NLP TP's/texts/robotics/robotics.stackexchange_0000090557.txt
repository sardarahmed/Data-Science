Q:

QR codes with visp_auto_tracker: coin not detected with ViSP, cannot load model

Hello,
my version of ROS is Melodic and I use Ubuntu 18.04 on my laptop.
Im trying to work on detecting QR codes with latest visp_auto_tracker package but I get an error.
It is my terminal output after typing roslaunch visp_auto_tracker tracklive_usb.launch:
SUMMARY
========

PARAMETERS
 * /rosdistro: melodic
 * /rosversion: 1.14.3
 * /usb_cam/camera_info_url: package://visp_au...
 * /usb_cam/camera_name: /camera/image_raw
 * /usb_cam/image_height: 480
 * /usb_cam/image_width: 640
 * /usb_cam/pixel_format: yuyv
 * /usb_cam/video_device: /dev/video0
 * /visp_auto_tracker/debug_display: True
 * /visp_auto_tracker/model_name: pattern
 * /visp_auto_tracker/model_path: /home/jakub/catki...

NODES
  /
    usb_cam (usb_cam/usb_cam_node)
    visp_auto_tracker (visp_auto_tracker/visp_auto_tracker)

ROS_MASTER_URI=http://localhost:11311

process[visp_auto_tracker-1]: started with pid [7582]
process[usb_cam-2]: started with pid [7583]
[ INFO] [1550488098.514886713]: camera calibration URL: package://visp_auto_tracker/models/calibration.ini
[ INFO] [1550488098.516649168]: model full path=/home/jakub/catkin_ws/src/vision_visp/visp_auto_tracker/models/pattern
[ INFO] [1550488098.517216626]: Starting '/camera/image_raw' (/dev/video0) at 640x480 via mmap (yuyv) at 30 FPS
[ INFO] [1550488098.519081130]: Model content=#VRML V2.0 utf8

DEF fst_0 Group {
children [

# Object "cube"
Shape {

geometry DEF cube IndexedFaceSet {

coord Coordinate { 
point [
-0.0765  -0.0765    0.000
 0.0765  -0.0765    0.000
 0.0765  0.0765 0.000
-0.0765  0.0765 0.000
-0.03825  -0.03825  0.000   
 0.03825  -0.03825  0.000
 0.03825  0.03825   0.000
-0.03825  0.03825   0.000 
 ]
}

coordIndex [
 0,1,2,3,-1,
 4,5,6,7,-1,
]}
}

]
}

starting tracker
 *********** Parsing XML for Mb Edge Tracker ************ 
ecm : mask : size : 5
ecm : mask : nb_mask : 180
ecm : range : tracking : 10
ecm : contrast : threshold 5000
ecm : contrast : mu1 0.5
ecm : contrast : mu2 0.5
ecm : sample : sample_step : 10 (default)
[DEPRECATED] sample : sample_step : 4
  WARNING : This node (sample) is deprecated.
  It should be moved in the ecm node (ecm : sample).
klt : Mask Border : 0
klt : Max Features : 10000
klt : Windows Size : 5
klt : Quality : 0.05
klt : Min Distance : 20
klt : Harris Parameter : 0.01
klt : Block Size : 3
klt : Pyramid Levels : 3
face : Angle Appear : 75
face : Angle Disappear : 75
camera : u0 : 192 (default)
camera : v0 : 144 (default)
camera : px : 600 (default)
camera : py : 600 (default)
lod : use lod : 0 (default)
lod : min line length threshold : 50 (default)
lod : min polygon area threshold : 2500 (default)
terminate called after throwing an instance of 'vpException'
  what():  coin not detected with ViSP, cannot load model
[ WARN] [1550488098.669955032]: unknown control 'focus_auto'

[visp_auto_tracker-1] process has died [pid 7582, exit code -6, cmd /home/jakub/catkin_ws/devel/lib/visp_auto_tracker/visp_auto_tracker /visp_auto_tracker/camera_info:=/usb_cam/camera_info /visp_auto_tracker/image_raw:=/usb_cam/image_raw __name:=visp_auto_tracker __log:=/home/jakub/.ros/log/ec341c80-336a-11e9-b427-5453ed225862/visp_auto_tracker-1.log].
log file: /home/jakub/.ros/log/ec341c80-336a-11e9-b427-5453ed225862/visp_auto_tracker-1*.log

When I try to launch tutorial.launch file from visp_auto_tracker package I get this:
terminate called after throwing an instance of 'vpException'
  what():  coin not detected with ViSP, cannot load model
[visp_auto_tracker-2] process has died [pid 7719, exit code -6, cmd /home/jakub/catkin_ws/devel/lib/visp_auto_tracker/visp_auto_tracker /visp_auto_tracker/camera_info:=/camera/camera_info /visp_auto_tracker/image_raw:=/camera/image_raw __name:=visp_auto_tracker __log:=/home/jakub/.ros/log/ec341c80-336a-11e9-b427-5453ed225862/visp_auto_tracker-2.log].
log file: /home/jakub/.ros/log/ec341c80-336a-11e9-b427-5453ed225862/visp_auto_tracker-2*.log

Have someone had an error like this and could help to fix this?

Originally posted by kubchud on ROS Answers with karma: 26 on 2019-02-18
Post score: 1

A:

Hello,
I fixed the problem.
Firstly, you have build VISP (standard, not for ROS) using for example ccmake. Then in configuration you have to switch USE_COIN3D to NO, generate and use "make".

Originally posted by kubchud with karma: 26 on 2019-03-03
This answer was ACCEPTED on the original site
Post score: 0

Original comments
Comment by Mars_RMC on 2019-04-15:
Can you add the links and cli commands you did to get this fixed? I am currently having the same issue and have tried following what you did to fix it, however, i am still getting this error. Thanks for your time.
Comment by Filip4 on 2019-04-17:
Hey,
we repaired it by imposing the use of a *.cao file. In cmd_line.cpp comment lines:
std::string CmdLine:: get_mbt_cad_file() const{
  //if(vpIoTools::checkFilename(get_data_dir() + get_pattern_name() + std::string(".wrl")))
    //return get_data_dir() + get_pattern_name() + std::string(".wrl");
  //else if (vpIoTools::checkFilename(get_data_dir() + get_pattern_name() + std::string(".cao")))
    return get_data_dir() + get_pattern_name() + std::string(".cao");
  //else
    //return get_data_dir() + get_pattern_name() + std::string(".wrl");
}

Comment by Mars_RMC on 2019-04-18:
After commenting those lines out, i am still getting the same error. Here is the steps that i have done.
Building the Ubuntu version from source:
cd ViSP
git clone https://github.com/lagadic/visp.git

Configuring ViSP:
cd ViSP-build
ccmake . 

In ccmake turned USE_COIN3D to NO and then generate
To build
sudo make install```

Moving into my catkin_ws folder i ran:
`git clone https://github.com/lagadic/vision_visp.git`

And finally tried to run:
`roslaunch visp_auto_tracker tracklive_usb.launch`

And this still returns the `what():  coin not detected with ViSP, cannot load model`

Is there something else that you have done to fix this, or did i miss a step? Thanks for your time

