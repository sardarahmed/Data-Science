Q:

cv_bridge::Exception bayer_rggb8 vs 8UC3

I'm publishing /camera/image_raw of type sensor_msgs/Image from PointgreyDriver :
image_transport::SubscriberStatusCallback cb = boost::bind(&PointGreyCameraNodelet::connectCb, this);
it_pub_ = it_->advertiseCamera("image_raw", 5, cb, cb);

On the other hand I'm subscribing to that topic:
 this->sub = new image_transport::Subscriber(this->imageTransport->subscribe("/camera/image_raw",1000,&p_vision_apriltags::callback,this));
imgTmp = cv_bridge::toCvCopy(msg,sensor_msgs::image_encodings::TYPE_8UC3);

The error I'm getting is an exception:
terminate called after throwing an instance of 'cv_bridge::Exception'
  what():  [bayer_rggb8] is a color format but [8UC3] is not so they must have the same OpenCV type, CV_8UC3, CV16UC1 ....
[AprilTagsDetector-1] process has died [pid 29207, exit code -6, cmd /home/jaouadros/catkin_ws/devel/lib/p_vision_apriltags/p_vision_apriltags __name:=AprilTagsDetector __log:=/home/jaouadros/.ros/log/da606018-a91e-11e7-80aa-0024d7d045f0/AprilTagsDetector-1.log].
log file: /home/jaouadros/.ros/log/da606018-a91e-11e7-80aa-0024d7d045f0/AprilTagsDetector-1*.log
all processes on machine have died, roslaunch will exit

When I change TYPE_8UC3 to bgr8 it shows frames with random uniform colors.
What types should I be using?
normally TYPE_8UC3 works with image_raw !

Originally posted by ROSkinect on ROS Answers with karma: 751 on 2017-10-04
Post score: 0

A:

sensor_msgs::image_encodings::TYPE_8UC3 is not a color format, it is a data type with 3 channels of 8 bits each (but with no information of what each channel mean), so cv_bridge::toCvCopy doesn't know who to transform from bayer_rggb8 color format.
I assume that what you really want is to transform the original image received in bayer_rggb8 format to the more commonly used BGR8 format.
In that case try the following:
 imgTmp = cv_bridge::toCvCopy(msg, sensor_msgs::image_encodings::BGR8);

Now, BGR8 is a color format, it also has 3 channels of 8 bits each, but now you know that the first channel corresponds to Blue, the second corresponds to Green and the third corresponds to Red.
If by doing this you get random uniform colors, then make sure that the original image published by the driver is actually in bayer_rggb8 format.

Originally posted by Martin Peris with karma: 5625 on 2017-10-04
This answer was ACCEPTED on the original site
Post score: 1

Original comments
Comment by ROSkinect on 2017-10-05:
BGR8 gives me a uniform color each frame. How can I make sure that it is of type bayer_rggb8? rostopic info /camera/image_raw doesn't give much information?
Comment by Martin Peris on 2017-10-05:
You should check the specifications of your camera, which camera are you using?
Comment by ROSkinect on 2017-10-06:
I'm using this camera Blackfly 0.9 MP Color GigE PoE

