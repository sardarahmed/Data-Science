Q:

joint state publisher dies, cannot attach wheels with continuous joint

Hi,
I am currently trying to create a simple differential drive robot model with 2 wheels and 2 caster wheels, but I cannot attach the wheels to the chassis with continuous/revolute joints and I do not get the transforms of course, but I can connect them with fixed joints and I also get the correct transforms with the fixed joints.
I am using ros melodic with Ubuntu 18.04.3 LTS on VM 6.0.12

/rosdistro: melodic
/rosversion: 1.14.3

Here is the error message I get:
Error Message
SUMMARY

PARAMETERS 
* /joint_state_publisher/use_gui: True 
* /robot_description: <?xml version="1....
* /rosdistro: melodic
* /rosversion: 1.14.3

NODES 
/ joint_state_publisher (joint_state_publisher/joint_state_publisher)
 robot_state_publisher (robot_state_publisher/state_publisher) 
 rviz (rviz/rviz)

auto-starting new master 
process[master]: started with pid [18519] 
ROS_MASTER_URI=http://localhost:11311

setting /run_id to 2a1bb272-f0b9-11e9-b0ed-080027935df5 
process[rosout-1]: started with pid [18530] 
started core service [/rosout] 
process[joint_state_publisher-2]: started with pid [18533] 
process[robot_state_publisher-3]: started with pid [18538] 
process[rviz-4]: started with pid [18539] 
Traceback (most recent call last): File "/opt/ros/melodic/lib/joint_state_publisher/joint_state_publisher", line 474, in jsp = JointStatePublisher() 
File "/opt/ros/melodic/lib/joint_state_publisher/joint_state_publisher", line 149, in init robot = xml.dom.minidom.parseString(description) 
File "/usr/lib/python2.7/xml/dom/minidom.py", line 1928, in parseString return expatbuilder.parseString(string) 
File "/usr/lib/python2.7/xml/dom/expatbuilder.py", line 940, in parseString return builder.parseString(string) 
File "/usr/lib/python2.7/xml/dom/expatbuilder.py", line 223, in parseString parser.Parse(string, True) 
UnicodeEncodeError: 'ascii' codec can't encode character u'\u202c' in position 5988: ordinal not in range(128) [joint_state_publisher-2] process has died [pid 18533, exit code 1, cmd /opt/ros/melodic/lib/joint_state_publisher/joint_state_publisher __name:=joint_state_publisher __log:=/home/user/.ros/log/2a1bb272-f0b9-11e9-b0ed-080027935df5/joint_state_publisher-2.log]. log file: /home/user/.ros/log/2a1bb272-f0b9-11e9-b0ed-080027935df5/joint_state_publisher-2*.log 

URDF file
<?xml version="1.0" ?>
<robot name="mybot">
  
  <link name="base_footprint"/>

  <joint name="base_joint" type="fixed">
    <parent link="base_footprint"/>
    <child link="chassis" />
    <origin xyz="0 0 0.010" rpy="0 0 0"/>
  </joint>

  <link name="chassis">
    <collision name="base_collision">
      <origin rpy="0 0 0" xyz="0 0 0.35"/>
      <geometry>
        <box size="1 1.8 0.4"/>
      </geometry>
    </collision>
    <visual name="base_visual">
      <origin rpy="0 0 0" xyz="0 0 0.35"/>
      <geometry>
        <box size="1 1.8 0.4"/>
      </geometry>
    </visual>
    <collision name="l_side_collision">
      <origin rpy="0 0 0" xyz="-0.475 0 1.18"/>
      <geometry>
        <box size="0.05 1.8 2.0"/>
      </geometry>
    </collision>
    <visual name="l_side_visual">
      <origin rpy="0 0 0" xyz="-0.475 0 1.18"/>
      <geometry>
        <box size="0.05 1.8 2.0"/>
      </geometry>
    </visual>
    <collision name="r_side_long_collision">
      <origin rpy="0 0 0" xyz="0.475 0.45 1.18"/>
      <geometry>
        <box size="0.05 0.9 2.0"/>
      </geometry>
    </collision>
    <visual name="r_side_long_visual">
      <origin rpy="0 0 0" xyz="0.475 0.45 1.18"/>  
      <geometry>
        <box size="0.05 0.9 2.0"/>
      </geometry>
    </visual>
    <collision name="r_side_short_collision">
      <origin rpy="0 0 0" xyz="0.475 -0.45 0.68"/>
      <geometry>  
        <box size="0.05 0.9 1.0"/>
      </geometry>
    </collision>
    <visual name="r_side_short_visual">
      <origin rpy="0 0 0" xyz="0.475 -0.45 0.68"/>
      <geometry>
        <box size="0.05 0.9 1.0"/>
      </geometry>
    </visual>
    <collision name="l_lidar_sup_collision">
      <origin rpy="0 0 0" xyz="-0.45 -0.95 1.2"/>
      <geometry>
        <box size="0.1 0.1 0.025"/>
      </geometry>
    </collision>
    <visual name="l_lidar_sup_visual">
      <origin rpy="0 0 0" xyz="-0.45 -0.95 1.2"/>
      <geometry>
        <box size="0.1 0.1 0.025"/>
      </geometry>
    </visual>
    <collision name="r_lidar_sup_collision">
      <origin rpy="0 0 0" xyz="0.45 0.95 1.2"/>
      <geometry>
        <box size="0.1 0.1 0.025"/>
      </geometry>
    </collision>
    <visual name="r_lidar_sup_visual">
      <origin rpy="0 0 0" xyz="0.45 0.95 1.2"/>
      <geometry>
        <box size="0.1 0.1 0.025"/>
      </geometry>
    </visual>
    <collision name="roof_collision">
      <origin rpy="0 0 0" xyz="0 0 2.18"/>
      <geometry>
        <box size="1 1.8 0.05"/>
      </geometry>
    </collision>
    <visual name="roof_visual">
      <origin rpy="0 0 0" xyz="0 0 2.18"/>
      <geometry>
        <box size="1 1.8 0.05"/>
      </geometry>
    </visual>
    <collision name='caster_collision_front'>
      <origin rpy="0 0 0" xyz="0 -0.72 0.17"/>
      <geometry>
        <sphere radius=".18"/>
      </geometry>
    </collision>
    <visual name='caster_visual_front'>
      <origin rpy="0 0 0" xyz="0 -0.72 0.17"/>
      <geometry>
        <sphere radius=".18"/>
      </geometry>
    </visual>
    <collision name='caster_collision_back'>
      <origin rpy="0 0 0" xyz="0 0.72 0.17"/>
      <geometry>
        <sphere radius=".18"/>
      </geometry>
    </collision>
    <visual name='caster_visual_back'>
      <origin rpy="0 0 0" xyz="0 0.72 0.17"/>
      <geometry>
        <sphere radius=".18"/>
      </geometry>
    </visual>
  </link>

  <link name="l_wheel">
    <collision name="l_wheel_collision">
      <origin rpy="0 0 0" xyz="0 0 -0.025"/>
      <geometry>
        <cylinder radius="0.18" length="0.05"/>
      </geometry>
    </collision>
    <visual name="l_wheel_visual">
      <origin rpy="0 0 0" xyz="0 0 -0.025"/>
      <geometry>
        <cylinder radius="0.18" length="0.05"/>
      </geometry>
      <material name="red"/>
    </visual>
  </link>
  
  <link name="r_wheel">
    <collision name="r_wheel_collision">
      <origin rpy="0 0 0" xyz="0 0 0.025"/>
      <geometry>
        <cylinder radius="0.18" length="0.05"/>
      </geometry>
    </collision>
    <visual name="r_wheel_visual">
      <origin rpy="0 0 0" xyz="0 0 0.025"/>
      <geometry>
        <cylinder radius="0.18" length="0.05"/>
      </geometry>
      <material name="green"/>
    </visual>
  </link>

  <joint type="revolute" name="l_wheel_hinge">
    <parent link="chassis"/>
    <child link="l_wheel"/>
    <axis xyz="0 0 1"/>
    <origin rpy="0 1.57 0" xyz="-0.5 0 0.17"/>
    <limit lower="-0.2" upper="0.2" effort="0.1" velocity="0.005"/>
  </joint>

  <joint type="revolute" name="r_wheel_hinge">
    <parent link="chassis"/>
    <child link="r_wheel"/>
    <axis xyz="0 0 1"/>
    <origin rpy="0 1.57 0" xyz="0.5 0 0.17"/>
    <limit lower="-0.2" upper="0.2" effort="0.1" velocity="0.005"/>
  </joint>

</robot>

Launch- File
<?xml version="1.0" encoding="UTF-8"?>
<launch>
 <!-- USE: roslaunch min_examp urdf_visualize.launch model:='$(find min_examp)/urdf/myrobot.urdf'-->
   <arg name="model" default=""/>
   
   <param name="robot_description" command="cat $(arg model)"/>
   <!--param name="robot_description" command="cat $(arg urdf_robot_file)"/-->

   <!-- send fake joint values -->
   <node name="joint_state_publisher" pkg="joint_state_publisher" type="joint_state_publisher">
     <param name="use_gui" value="TRUE"/>
   </node>

   <!-- combine joint vlues -->
   <node name="robot_state_publisher" pkg="robot_state_publisher" type="state_publisher"/>

   <node name="rviz" pkg="rviz" type="rviz"/>
</launch>

Thank you very much in advance!

Originally posted by chillbird on ROS Answers with karma: 38 on 2019-10-17
Post score: 0

A:

It's very likely this has nothing to do with continuous or fixed joints:

UnicodeEncodeError: 'ascii' codec can't encode character u'\u202c' in position 5988: ordinal not in range(128)

\u202c is (according to this random unicode website) a "POP DIRECTIONAL FORMATTING" character.
And it goes on to mention that this character is often used in .pdf files.
Did you by any chance copy some limits or other pieces of text from a .pdf into your .urdf?
If so, that is most likely where the problem is.
It's all parsed as ASCII text, so you'll need to make sure there are no extended or UTF characters in your .urdf. Otherwise, you'll get (variants) of the error message you posted.

Edit: according to this SO question, you could use the following pgrep command to search for the non-ASCII characters:
grep --color='auto' -P -n "[\x80-\xFF]" /path/to/your/file.urdf

or:
grep --color='auto' -P -n "[^\x00-\x7F]" /path/to/your/file.urdf

Originally posted by gvdhoorn with karma: 86574 on 2019-10-17
This answer was ACCEPTED on the original site
Post score: 1

Original comments
Comment by chillbird on 2019-10-17:
thank soo much!

