Q:

Cannot rosbag record -a from electric openni

OpenNI starts up fine, and I can use rviz, etc., but when I want to save the bags out -- OpenNI's stack dies..
First all starts ok -- but dies complaining about IR and RGB.
roslaunch openni_launch openni.launch
(in another window)
rosbag record -b 2048  -O test.bag -a
When I -x out "/camera/ir(.*)" -- it dies still with an even more obscure error...
BTW -- 2.6.35-28-generic #50-Ubuntu SMP Fri Mar 18 18:42:20 UTC 2011 x86_64 GNU/Linux
NOTE -- lots of info
[ INFO] [1313893203.118028525]: Number devices connected: 1
[ INFO] [1313893203.118184242]: 1. device on bus 001:14 is a Xbox NUI Camera (2ae) from Microsoft (45e) with serial id 'B00364611855051B'
[ INFO] [1313893203.119212409]: Searching for device with index = 1
[ INFO] [1313893203.169810408]: Opened 'Xbox NUI Camera' on bus 1:14 with serial number 'B00364611855051B'
[ INFO] [1313893203.204956990]: rgb_frame_id = '/camera_rgb_optical_frame' 
[ INFO] [1313893203.204992411]: depth_frame_id = '/camera_depth_optical_frame' 
[ INFO] [1313893203.207416573]: using default calibration URL
[ INFO] [1313893203.207466453]: camera calibration URL: file:///home/markc/.ros/camera_info/rgb_B00364611855051B.yaml
[ERROR] [1313893203.207554999]: Unable to open camera calibration file [/home/markc/.ros/camera_info/rgb_B00364611855051B.yaml]
[ WARN] [1313893203.207588545]: Camera calibration file /home/markc/.ros/camera_info/rgb_B00364611855051B.yaml not found.
[ INFO] [1313893203.208563311]: using default calibration URL
[ INFO] [1313893203.208590715]: camera calibration URL: file:///home/markc/.ros/camera_info/depth_B00364611855051B.yaml
[ERROR] [1313893203.208615349]: Unable to open camera calibration file [/home/markc/.ros/camera_info/depth_B00364611855051B.yaml]
[ WARN] [1313893203.208634926]: Camera calibration file /home/markc/.ros/camera_info/depth_B00364611855051B.yaml not found.
[ WARN] [1313893203.209323348]: Using default parameters for RGB camera calibration.
[ WARN] [1313893203.209348312]: Using default parameters for IR camera calibration.
[ERROR] [1313893203.667063017]: Tried to advertise a service that is already advertised in this node [/camera/depth_registered/image_rect_raw/compressed/set_parameters]
[ERROR] [1313893203.673611007]: Tried to advertise a service that is already advertised in this node [/camera/depth_registered/image_rect_raw/theora/set_parameters]
[ERROR] [1313893219.381133111]: Cannot stream RGB and IR at the same time. Streaming RGB only.
[ERROR] [1313893219.381449652]: Cannot stream RGB and IR at the same time. Streaming RGB only.
[ERROR] [1313893219.381575808]: Cannot stream RGB and IR at the same time. Streaming RGB only.
[ERROR] [1313893219.381847566]: Cannot stream RGB and IR at the same time. Streaming RGB only.
OpenCV Error: Image step is wrong () in cvInitMatHeader, file /tmp/buildd/libopencv-2.3.1+svn6514+branch23/modules/core/src/array.cpp, line 162
[ERROR] [1313893219.381938778]: Cannot stream RGB and IR at the same time. Streaming RGB only.
[ERROR] [1313893219.382660492]: Cannot stream RGB and IR at the same time. Streaming RGB only.
[ERROR] [1313893219.382995474]: Cannot stream RGB and IR at the same time. Streaming RGB only.
[ERROR] [1313893219.383094324]: Cannot stream RGB and IR at the same time. Streaming RGB only.
[ERROR] [1313893219.383176384]: Cannot stream RGB and IR at the same time. Streaming RGB only.
[ERROR] [1313893219.383251578]: Cannot stream RGB and IR at the same time. Streaming RGB only.
[ERROR] [1313893219.383335205]: Cannot stream RGB and IR at the same time. Streaming RGB only.
[ERROR] [1313893219.383411773]: Cannot stream RGB and IR at the same time. Streaming RGB only.
[ERROR] [1313893219.383489394]: Cannot stream RGB and IR at the same time. Streaming RGB only.
[ERROR] [1313893219.383563268]: Cannot stream RGB and IR at the same time. Streaming RGB only.
[ERROR] [1313893219.383635985]: Cannot stream RGB and IR at the same time. Streaming RGB only.
[ERROR] [1313893219.383709582]: Cannot stream RGB and IR at the same time. Streaming RGB only.
[ERROR] [1313893219.383785216]: Cannot stream RGB and IR at the same time. Streaming RGB only.
[ERROR] [1313893219.383858317]: Cannot stream RGB and IR at the same time. Streaming RGB only.
[ERROR] [1313893219.383931938]: Cannot stream RGB and IR at the same time. Streaming RGB only.
[ERROR] [1313893219.384007871]: Cannot stream RGB and IR at the same time. Streaming RGB only.
[ERROR] [1313893219.384083402]: Cannot stream RGB and IR at the same time. Streaming RGB only.
[ERROR] [1313893219.384179648]: Cannot stream RGB and IR at the same time. Streaming RGB only.
[ERROR] [1313893219.384259930]: Cannot stream RGB and IR at the same time. Streaming RGB only.
[ERROR] [1313893219.384338790]: Cannot stream RGB and IR at the same time. Streaming RGB only.
[ERROR] [1313893219.384418650]: Cannot stream RGB and IR at the same time. Streaming RGB only.
[ERROR] [1313893219.384496304]: Cannot stream RGB and IR at the same time. Streaming RGB only.
[ERROR] [1313893219.384566532]: Cannot stream RGB and IR at the same time. Streaming RGB only.
[    ERROR] [1313893219.384640509]: Cannot stream RGB and IR at the same time. Streaming RGB only.
[ERROR] [1313893219.384718729]: Cannot stream RGB and IR at the same time. Streaming RGB only.
[ERROR] [1313893219.384796380]: Cannot stream RGB and IR at the same time. Streaming RGB only.
[ERROR] [1313893219.384871621]: Cannot stream RGB and IR at the same time. Streaming RGB only.
terminate called after throwing an instance of 'cv::Exception'
  what():  /tmp/buildd/libopencv-2.3.1+svn6514+branch23/modules/core/src/array.cpp:162: error: (-13)  in function cvInitMatHeader

[camera_nodelet_manager-2] process has died [pid 27935, exit code -6].
log files: /home/markc/.ros/log/10a49c78-cb9c-11e0-aedb-001cc0fb9b9c/camera_nodelet_manager-2*.log                                                                                                                                                                             
[camera/register_depth_rgb-12] process has finished cleanly.
log file: /home/markc/.ros/log/10a49c78-cb9c-11e0-aedb-001cc0fb9b9c/camera-register_depth_rgb-12*.log
[camera/depth/metric_rect-8] process has finished cleanly.
log file: /home/markc/.ros/log/10a49c78-cb9c-11e0-aedb-001cc0fb9b9c/camera-depth-metric_rect-8*.log
[camera/depth/points-11] process has finished cleanly.
log file: /home/markc/.ros/log/10a49c78-cb9c-11e0-aedb-001cc0fb9b9c/camera-depth-points-11*.log
[camera/depth_registered/rectify_depth-13] process has finished cleanly.
log file: /home/markc/.ros/log/10a49c78-cb9c-11e0-aedb-001cc0fb9b9c/camera-depth_registered-rectify_depth-13*.log
[camera/rgb/rectify_color-5] process has finished cleanly.
log file: /home/markc/.ros/log/10a49c78-cb9c-11e0-aedb-001cc0fb9b9c/camera-rgb-rectify_color-5*.log
[camera/depth_registered/metric-15] process has finished cleanly.
log file: /home/markc/.ros/log/10a49c78-cb9c-11e0-aedb-001cc0fb9b9c/camera-depth_registered-metric-15*.log
[camera/rgb/rectify_mono-4] process has finished cleanly.
log file: /home/markc/.ros/log/10a49c78-cb9c-11e0-aedb-001cc0fb9b9c/camera-rgb-rectify_mono-4*.log
[camera/depth/metric-9] process has finished cleanly.
log file: /home/markc/.ros/log/10a49c78-cb9c-11e0-aedb-001cc0fb9b9c/camera-depth-metric-9*.log
[camera/depth_registered/metric_rect-14] process has finished cleanly.
log file: /home/markc/.ros/log/10a49c78-cb9c-11e0-aedb-001cc0fb9b9c/camera-depth_registered-metric_rect-14*.log
[camera/depth_registered/disparity-16] process has finished cleanly.
log file: /home/markc/.ros/log/10a49c78-cb9c-11e0-aedb-001cc0fb9b9c/camera-depth_registered-disparity-16*.log
[camera/points_xyzrgb_depth_rgb-17] process has finished cleanly.
log file: /home/markc/.ros/log/10a49c78-cb9c-11e0-aedb-001cc0fb9b9c/camera-points_xyzrgb_depth_rgb-17*.log
[camera/depth/disparity-10] process has finished cleanly.
log file: /home/markc/.ros/log/10a49c78-cb9c-11e0-aedb-001cc0fb9b9c/camera-depth-disparity-10*.log
[camera/ir/rectify_ir-6] process has finished cleanly.
log file: /home/markc/.ros/log/10a49c78-cb9c-11e0-aedb-001cc0fb9b9c/camera-ir-rectify_ir-6*.log
[camera/depth/rectify_depth-7] process has finished cleanly.
log file: /home/markc/.ros/log/10a49c78-cb9c-11e0-aedb-001cc0fb9b9c/camera-depth-rectify_depth-7*.log
[camera/driver-3] process has finished cleanly.
log file: /home/markc/.ros/log/10a49c78-cb9c-11e0-aedb-001cc0fb9b9c/camera-driver-3*.log

Originally posted by weaponeer on ROS Answers with karma: 1 on 2011-08-20
Post score: 1

A:

Cannot stream RGB and IR at the same time

This explains why -a doesn't work; you can't subscribe to both the IR and RGB camera streams at the same time. This is a limitation of the driver; see this question for details about the driver. Also, take a look at sglaser's answer to this question for why rosbag -a with a Kinect is a Very Bad Idea.

Originally posted by Mac with karma: 4119 on 2011-08-21
This answer was ACCEPTED on the original site
Post score: 4

Original comments
Comment by Mac on 2011-08-22:
If this solves your problem, please accept the answer (karma!).
Comment by weaponeer on 2011-08-21:
I'll give openni_camera_unstable a go, that looks ideal.  I could never get a -x (exclude) formulated that would please electric.  Cheers,  MarkC

