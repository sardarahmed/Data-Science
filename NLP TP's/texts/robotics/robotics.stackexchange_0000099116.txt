Q:

All builds failed on build farm

We recently released a bunch of packages in rosdistro (https://github.com/ros/rosdistro/pull/29559). I did prerelease tests via ROS-buildfarm emulation, and everything was fine. But two days later we noticed that builds of two our packages failed (https://build.ros.org/view/Mbin_uB64/job/Mbin_uB64__clover_simulation__ubuntu_bionic_amd64__binary/) (https://build.ros.org/view/Mbin_uB64/job/Mbin_uB64__aruco_pose__ubuntu_bionic_amd64__binary/).
Soon i realized that i forgot to include changes into our release tag. I updated the tag and generated new files for release repository But subsequent builds still were failed with same errors as if ROS-buildfarm tried to build from cached buggy files instead of fetching new files from release repository. What could i do to to fix this?

Originally posted by deadln on ROS Answers with karma: 3 on 2021-05-26
Post score: 0

A:

I updated the tag and generated new files for release repository

that's not something you should do.
Tags are supposed to be immutable and should never change.

But subsequent builds still were failed with same errors as if ROS-buildfarm tried to build from cached buggy files instead of fetching new files from release repository.

the buildfarm does not fetch sources from your source repository during build.
I don't see any new release after your initial one in CopterExpress/clover-release. That's why the buildfarm keeps building your 0.21.2-1 release.
You need to make a new release and then Bloom it.
I'd suggest to:

revert your changes to the tag in your source repository (ie: place the tag back where it was before you changed it)
perform the release preparation steps again (ie: update changelog, add new tag)
run Bloom again (release new version of previously release package)

If there are no more problems with your sources, the buildfarm builds should start succeeding after your new release gets merged.

Originally posted by gvdhoorn with karma: 86574 on 2021-05-26
This answer was ACCEPTED on the original site
Post score: 1

Original comments
Comment by deadln on 2021-05-26:
Thank you for your answer. I also want to know what should i do with release repository. Here is the actions i did:

I made first release of 0.21.2 with bloom-release and created pull request to ros distro
My pull request was merged but two days later i noticed that build on build farm fails.
I deleted tag 0.21.2 in upstream repo and reset release repository to it's initial state
I again released 0.21.2 with bloom-release but without pull request

If i need to revert changes tag back should i also reset release repo and run bloom-release for reverted tag?
Comment by gvdhoorn on 2021-05-26:
Don't ever do that again -- without good reason.
Almost all release problems can be fixed by just releasing a package again. Not by nuke-ing your release repository.
I'd suggest to just attempt a new release. Don't touch your release repository, let Bloom take care of things.
I'd still recommend to put the 0.21.2 tag in your source repository back to where it was before you started manually changing things.
Then do a normal release, as I described in my answer (so update changelogs, new tag, etc, etc).
I would expect that to fix things.

