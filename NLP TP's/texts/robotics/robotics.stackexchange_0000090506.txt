Q:

Set start position of robot within amcl

Hi, I'm working with a mobile robot. Every time I start it I have to start at the same point(the point which is the origin in the map_server map config file). But I want to save the last position of the base_link(to a file for example, no problem with that) when I shutdown the system to let him know at restarting where it was. Is there any way to set a default value for a transform beetween 2 frames with tf2?
Thank you

Originally posted by FaliRey on ROS Answers with karma: 23 on 2019-02-13
Post score: 2

Original comments
Comment by PeteBlackerThe3rd on 2019-02-13:
This is not really anything to do with the TF2 system, but the localisation system that is being used on the robot. There will probably be a method to set the initial pose of the robot there.
Comment by mgruhler on 2019-02-13:
do you use your own localisation system, or something provided as debian pkg, like amcl? If you let us know, we can help more.
Comment by FaliRey on 2019-02-13:
Yes, sorry, I use amcl localisation system with a front laser.
Comment by mgruhler on 2019-02-15:
FYI: I took the liberty of rephrasing your question to better reflect the actual problem.

A:

For amcl you have to options:
Publish to initalpose (after startup) or set the intial_pose_x/y/a parameters (before startup of amcl). Check the wiki for details.
You can obviously use those by writing your own node which does the saving to file, loading from file and publish/set parameters. Only thing to somehow keep track of is wether this has the desired effect, i.e. some kind of state checking which distinguishes between "amcl started, but at origin location" and "amcl started and read start parameters / got initialpose". As both, setting the parameters before amcl starts and sending to a topic is not easy to get feedback on, you'd need to be creative :-)
Edit:
actually, there is a third option, which is calling the set_map service. This allows you to send a map together with the inital pose. As this is a service, you'll receive notifications about wether this has been successfull.

Originally posted by mgruhler with karma: 12390 on 2019-02-13
This answer was ACCEPTED on the original site
Post score: 2

