Q:

Simulated quadrotor is slowly drifting on its own

Hello, I've noticed that on my install (fuerte from debs, quadrotor from svn -r 403), according to the "ground truth state", the quadrotor slowly drifts when not provided with a control input.
The onboard camera confirms this motion as well.
Is this something that others have observed, or can repeat?
 roslaunch hector_quadrotor_demo outdoor_flight_gazebo.launch & 
 rostopic echo -p /ground_truth/state/pose/pose/position/z

To be clear, so far, publishing '[0.0,0.0,0.0]' '[0.0,0.0,0.0]' doesn't appear to change the outcome for me, but other non-zero control do. (still trying to clear this up)
The first seven seconds of the position data also have some interesting dynamics, which I assume are because the odom messages have not yet been published. If this is the case, is this an example of how numerical uncertainty grows in the physics engine?

Originally posted by SL Remy on ROS Answers with karma: 2022 on 2012-06-22
Post score: 2

Original comments
Comment by SL Remy on 2012-06-22:
Setting the linear.z attribute of the twist message to -.0049 causes neutral buoyancy (with a small bounded oscillation)
Comment by SL Remy on 2012-07-02:
Still no answers, and none of the the xacro files, the world files, nor the launch files are providing any clues.

A:

The hector_quadrotor_simple_controller plugin that controls the simulated quadrotor is currently not intended to control the absolute position of the vehicle. It realizes a velocity controller by adding more or less realistic forces and torques to the vehicle.
From that starting point it is not surprising that the quadrotor drifts slowly due to numerical inaccuracies in Gazebo's physics engine even when using noise-free ground-truth information for control and in the absence of external disturbances like wind. Most real quadrotors would also show this behavior, as it is not that easy to observe the velocity and position at least in indoor environments. If you want to control the absolute position, you can either implement your own position controller that publishes /cmd_vel or add an additional cascade to the simple controller plugin.
The hector_quadrotor_simple_controller plugin only subscribes a nav_msgs/Odometry for the vehicle's state and a sensor_msgs/Imu topic for the orientation and angular rate if the appropriate parameters are set in the URDF file. Otherwise, the true state variables from Gazebo are used for control. By default, the controller subscribes the /ground_truth/state topic published by the gazebo_ros_p3d plugin and the /raw_imu topic from the hector_gazebo_ros_imu plugin. You can try to delete these two parameters and see if that changes anything.

Originally posted by Johannes Meyer with karma: 1266 on 2012-07-09
This answer was ACCEPTED on the original site
Post score: 2

Original comments
Comment by SL Remy on 2012-07-13:
But (according to the urdf) there's no gravity on the base link, so with no external forces, why are the numerical inaccuracies causing drift only in the positive z direction? This effect could suggest that  Gazebo/ODE might be (over)compensating for gravity. A body at rest should stay at rest...
Comment by Johannes Meyer on 2012-08-14:
There must be a gravity acting on the model as the controller plugin just adds the forces and moments generated by the motors. I am not aware of the exact details of Gazebo's configuration files. Why do you think gravity is disabled for the base_link?
Comment by SL Remy on 2012-08-16:
hmm... maybe I misread this earlier... false... but in any case there have been updates to the urdf.xacro file. In about a week I should be able to update and confirm whether this drift is still happening.
Comment by SL Remy on 2012-09-02:
It seems that updating was a very bad idea.. I did notice that there was an error message associated with conflicting "gravity turn off" so I updated ros as well and now nothing gets past rosmake
Comment by SL Remy on 2012-09-02:
What versions of ubuntu/ros/gazebo/hector_quadrotor currently work together?
Comment by Johannes Meyer on 2012-09-04:
We are currently using hector_quadrotor in fuerte with simulator_gazebo 1.6.4 and in electric with simulator_gazebo 1.4.15. Note that you have to checkout the hector_quadrotor stacks from /branches/fuerte if you have upgraded to fuerte.
Comment by Ryan_Dirgantara on 2018-06-08:
Does removing gazebo_ros_p3d plugin or imu plugin solved this problem?

