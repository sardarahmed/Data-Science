Q:

How to setforce at a constant interval?

I use gazebo7.12.0 and want to write a model plugin to apply torque to a joint at a constant interval of 0.01 sec. It seems that the update rate of gazebo is 1000Hz, so I wirte the following code in OnUpdate(). This is not a good way because it's not exact 1000Hz in simulation from my testing. Is there other way to do it?
int count = 0;
public: void OnUpdate()
{
  if (count <= 10)
     this->model->GetJoint("joint")->SetForce(0,5);
  else if (count > 10 && count <= 20)
     this->model->GetJoint("joint")->SetForce(0,5);
  ...
  count++;
};

Originally posted by jwchang on Gazebo Answers with karma: 15 on 2018-06-11
Post score: 0

A:

Why do you say it's not at 1000 Hz? Try changing the callback to OnUpdate(const common::UpdateInfo &_info) and print _info.simTime.

Originally posted by chapulina with karma: 7504 on 2018-06-12
This answer was ACCEPTED on the original site
Post score: 0

Original comments
Comment by jwchang on 2018-06-13:
Thank you. I change my code to store the torque values into an array, which is SetForce(0,torque[count++]); usleep(10000);, and it works.

