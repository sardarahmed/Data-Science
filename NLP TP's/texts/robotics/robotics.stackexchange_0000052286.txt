Q:

How can I publish an integer and string (Int16 & String) using roslibjs?

hi
I am recently learning robotic web tools.In git has some samples. I want to publish an indeger / string message .On refreshing the browser I want to get the string message in command prompt. But In my code it is not publish anything right now. Any helps are appreciated.
I run
 roscore
 rostopic echo /buttons
 roslaunch rosbridge_server rosbridge_websocket.launch
 

I am use the following code
 <!DOCTYPE html>
 <html>
 <head>
 <meta charset="utf-8" />
 <script src="../include/EventEmitter2/eventemitter2.js"></script>
 <script src="../build/roslib.js"></script>

 <script>
   // Connecting to ROS
   // -----------------
   var ros = new ROSLIB.Ros();

   // If there is an error on the backend, an 'error' emit will be emitted.
   ros.on('error', function(error) {
     console.log(error);
   });

   // Find out exactly when we made a connection.
   ros.on('connection', function() {
     console.log('Connection made!');
   });

   // Create a connection to the rosbridge WebSocket server.
   ros.connect('ws://localhost:9090');

   // Publishing a Topic
   // ------------------

   // First, we create a Topic object with details of the topic's name and      message type.
   var testStr = new ROSLIB.Topic({
     ros : ros,
     name : '/buttons',
     messageType : 'std_msgs/String'
   });
   // Then we create the payload to be published. The object we pass in to ros.Message matches the 
   // fields defined in the geometry_msgs/Twist.msg definition.
   var str = new ROSLIB.Message(
         a:'hello'
    );

   // And finally, publish.
   testStr.publish(str);

 </script>
 </head>

 <body>
   <h1></h1>
   <p></p>
   <ol>
     <li><tt>roscore</tt></li>
     <li><tt>rostopic echo /buttons</tt></li>
     <li><tt>roslaunch rosbridge_server rosbridge_websocket.launch</tt></li>
   </ol>
 </body>
 </html>

My Doubts

Is it there in any problem of the syntax I used?

how can I publish Int16 messages?

Originally posted by unais on ROS Answers with karma: 313 on 2013-06-26
Post score: 1

A:

You have both a syntax error and a bug in your message definition. To catch syntax errors, it's useful to run the JavaScript error console your web browser provides.
var str = new ROSLIB.Message({
  a:'hello'
});

The syntax error is that you are missing brackets { } around the message data.
Secondly, you have defined your message type as std_msgs/String which does not have a field called a (see http://ros.org/doc/api/std_msgs/html/msg/String.html). Instead, the field is called data:
var str = new ROSLIB.Message({
  data : 'hello'
});

With the above change, everything should work.
To publish an std_msgs/Int16 message, simply change your data type:
var testInt = new ROSLIB.Topic({
  ros : ros,
  name : '/ints',
  messageType : 'std_msgs/Int16'
});

var int = new ROSLIB.Message({
  data : 5
});

testInt.publish(int);

Originally posted by rtoris288 with karma: 1173 on 2013-06-26
This answer was ACCEPTED on the original site
Post score: 5

Original comments
Comment by unais on 2013-06-27:
hi ... thank you very much.. I have one more doubt... how can I publish a variable as an integer message...ie var int = new ROSLIB.Message({
data : int_variable
});    instead of 5 just want to use a variable
Comment by Wilianson on 2016-11-07:
It helps me to to publish a std_msgs/Int32, I was a little lost with this work. Thank you :D

