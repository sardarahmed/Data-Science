Q:

/clock rate is lower than set in ROS2 Gazebo

I changed publish_rate and /clock rate was changed successfully, but the rate is lower than set.
For example, when I changed it to 1000Hz, which can be achieved in ROS Noetic, the result shows:
average rate: 683.508
    min: 0.001s max: 0.003s std dev: 0.00051s window: 686
average rate: 663.025
    min: 0.000s max: 0.004s std dev: 0.00051s window: 1329
average rate: 657.239
    min: 0.000s max: 0.004s std dev: 0.00051s window: 1976
average rate: 649.790
    min: 0.000s max: 0.004s std dev: 0.00052s window: 2604
average rate: 649.542
    min: 0.000s max: 0.007s std dev: 0.00053s window: 3253
average rate: 642.903
    min: 0.000s max: 0.007s std dev: 0.00053s window: 3863

And changing to 500hz gets a result about 400Hz, changing to 100Hz gets a result about 95Hz.
This problem may lead to another problem that other publisher's rate is lower too. For example, I created a publisher with 100Hz, but it published at a lower rate. And /clock rate is lower, the publisher's rate is lower too.
So how to solve this problem? All programs written in C++.
Thanks!

Originally posted by muronglindong on ROS Answers with karma: 46 on 2021-11-14
Post score: 1

A:

Hi @muronglindong
Based on the title of your question your issue is specific with Gazebo 11 simulation with ROS 2. There is a discussion in Discourse: https://community.gazebosim.org/t/gazebo-faster-than-realtime-operation/925
One of the suggestions by @chapulina
The RTF measures the physics update rate, but that may not be the same update rate as the sensors. You can use the new Lockstep of physics and sensors 8 feature to ensure that sensors and physics run in sync, which will essentially slow down physics.

This point to two great tutorials: http://gazebosim.org/tutorials?tut=lockstep_physics_sensors&cat=sensors
and http://gazebosim.org/tutorials?tut=performance_metrics&cat=tools_utilities
This is just a gist of the discussion, so I suggest to read over it and perhaps you will get more feedback in the https://answers.gazebosim.org/questions/

Originally posted by osilva with karma: 1650 on 2021-11-17
This answer was ACCEPTED on the original site
Post score: 0

Original comments
Comment by muronglindong on 2021-12-06:
Thank you, I learned the tutorials, but it doesn't seem work. I'm still trying to find some ways...

