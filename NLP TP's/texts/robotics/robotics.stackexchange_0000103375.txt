Q:

Universal Robots Driver ROS2 not working

I'm trying to control an UR5 Robot arm using ROS2.
To achieve this i've been using the following repo as guideline:
https://github.com/UniversalRobots/Universal_Robots_ROS2_Driver/tree/humble
I'm running this on Ubuntu 22.04.02 and using ROS2 Humble
When i try to launch the driver i get the following logs:
ros2 launch ur_robot_driver ur_control.launch.py ur_type:=ur5 robot_ip:=10.100.129.39 launch_rviz:=false

[INFO] [launch]: All log files can be found below /home/ur-control/.ros/log/2023-06-27-15-10-38-716282-u22lts-urcontrol-46884
[INFO] [launch]: Default logging verbosity is set to INFO
[INFO] [dashboard_client-2]: process started with pid [46889]
[INFO] [controller_stopper_node-3]: process started with pid [46891]
[INFO] [ur_ros2_control_node-1]: process started with pid [46887]
[INFO] [robot_state_publisher-4]: process started with pid [46893]
[INFO] [spawner-5]: process started with pid [46895]
[INFO] [spawner-6]: process started with pid [46897]
[INFO] [spawner-7]: process started with pid [46899]
[INFO] [spawner-8]: process started with pid [46901]
[INFO] [spawner-9]: process started with pid [46930]
[INFO] [spawner-10]: process started with pid [46937]
[dashboard_client-2] [INFO] [1687871439.398742580] [UR_Client_Library]: Connected: Universal Robots Dashboard Server
[dashboard_client-2] 
[controller_stopper_node-3] [INFO] [1687871439.398103120] [Controller stopper]: Waiting for switch controller service to come up on controller_manager/switch_controller
[ur_ros2_control_node-1] terminate called after throwing an instance of 'std::runtime_error'
[ur_ros2_control_node-1]   what():  text not specified in the tf_prefix tag
[robot_state_publisher-4] [INFO] [1687871439.427927325] [robot_state_publisher]: got segment base
[robot_state_publisher-4] [INFO] [1687871439.428226479] [robot_state_publisher]: got segment base_link
[robot_state_publisher-4] [INFO] [1687871439.428249023] [robot_state_publisher]: got segment base_link_inertia
[robot_state_publisher-4] [INFO] [1687871439.428257832] [robot_state_publisher]: got segment flange
[robot_state_publisher-4] [INFO] [1687871439.428265292] [robot_state_publisher]: got segment forearm_link
[robot_state_publisher-4] [INFO] [1687871439.428272157] [robot_state_publisher]: got segment ft_frame
[robot_state_publisher-4] [INFO] [1687871439.428278847] [robot_state_publisher]: got segment shoulder_link
[robot_state_publisher-4] [INFO] [1687871439.428285812] [robot_state_publisher]: got segment tool0
[robot_state_publisher-4] [INFO] [1687871439.428292984] [robot_state_publisher]: got segment upper_arm_link
[robot_state_publisher-4] [INFO] [1687871439.428301409] [robot_state_publisher]: got segment world
[robot_state_publisher-4] [INFO] [1687871439.428312288] [robot_state_publisher]: got segment wrist_1_link
[robot_state_publisher-4] [INFO] [1687871439.428322226] [robot_state_publisher]: got segment wrist_2_link
[robot_state_publisher-4] [INFO] [1687871439.428332326] [robot_state_publisher]: got segment wrist_3_link
[ERROR] [ur_ros2_control_node-1]: process has died [pid 46887, exit code -6, cmd '/home/ur-control/workspace/ros_ur_driver/install/ur_robot_driver/lib/ur_robot_driver/ur_ros2_control_node --ros-args --params-file /tmp/launch_params_v5mj3prx --params-file /home/ur-control/workspace/ros_ur_driver/install/ur_robot_driver/share/ur_robot_driver/config/ur5e_update_rate.yaml --params-file /home/ur-control/workspace/ros_ur_driver/install/ur_robot_driver/share/ur_robot_driver/config/ur_controllers.yaml'].
[spawner-10] [INFO] [1687871441.826413906] [spawner_forward_position_controller]: Waiting for '/controller_manager' node to exist
[spawner-5] [INFO] [1687871441.848227602] [spawner_scaled_joint_trajectory_controller]: Waiting for '/controller_manager' node to exist
[spawner-6] [INFO] [1687871441.886653953] [spawner_joint_state_broadcaster]: Waiting for '/controller_manager' node to exist
[spawner-9] [INFO] [1687871441.903905257] [spawner_force_torque_sensor_broadcaster]: Waiting for '/controller_manager' node to exist
[spawner-8] [INFO] [1687871441.911055867] [spawner_speed_scaling_state_broadcaster]: Waiting for '/controller_manager' node to exist
[spawner-7] [INFO] [1687871441.920189700] [spawner_io_and_status_controller]: Waiting for '/controller_manager' node to exist
[spawner-10] [INFO] [1687871443.849888060] [spawner_forward_position_controller]: Waiting for '/controller_manager' node to exist
[spawner-5] [INFO] [1687871443.871522619] [spawner_scaled_joint_trajectory_controller]: Waiting for '/controller_manager' node to exist
[spawner-6] [INFO] [1687871443.910050317] [spawner_joint_state_broadcaster]: Waiting for '/controller_manager' node to exist
[spawner-9] [INFO] [1687871443.926036279] [spawner_force_torque_sensor_broadcaster]: Waiting for '/controller_manager' node to exist
[spawner-8] [INFO] [1687871443.934576269] [spawner_speed_scaling_state_broadcaster]: Waiting for '/controller_manager' node to exist
[spawner-7] [INFO] [1687871443.943109006] [spawner_io_and_status_controller]: Waiting for '/controller_manager' node to exist
[spawner-10] [INFO] [1687871445.872573721] [spawner_forward_position_controller]: Waiting for '/controller_manager' node to exist
[spawner-5] [INFO] [1687871445.892843767] [spawner_scaled_joint_trajectory_controller]: Waiting for '/controller_manager' node to exist
[spawner-6] [INFO] [1687871445.932238611] [spawner_joint_state_broadcaster]: Waiting for '/controller_manager' node to exist
[spawner-9] [INFO] [1687871445.946847240] [spawner_force_torque_sensor_broadcaster]: Waiting for '/controller_manager' node to exist
[spawner-8] [INFO] [1687871445.956192171] [spawner_speed_scaling_state_broadcaster]: Waiting for '/controller_manager' node to exist
[spawner-7] [INFO] [1687871445.966376156] [spawner_io_and_status_controller]: Waiting for '/controller_manager' node to exist
[spawner-10] [INFO] [1687871447.894589500] [spawner_forward_position_controller]: Waiting for '/controller_manager' node to exist
[spawner-5] [INFO] [1687871447.915575034] [spawner_scaled_joint_trajectory_controller]: Waiting for '/controller_manager' node to exist
[spawner-6] [INFO] [1687871447.954223894] [spawner_joint_state_broadcaster]: Waiting for '/controller_manager' node to exist
[spawner-9] [INFO] [1687871447.968323321] [spawner_force_torque_sensor_broadcaster]: Waiting for '/controller_manager' node to exist
[spawner-8] [INFO] [1687871447.978319658] [spawner_speed_scaling_state_broadcaster]: Waiting for '/controller_manager' node to exist
[spawner-7] [INFO] [1687871447.989146442] [spawner_io_and_status_controller]: Waiting for '/controller_manager' node to exist
[spawner-10] [ERROR] [1687871449.917023615] [spawner_forward_position_controller]: Controller manager not available
[spawner-5] [ERROR] [1687871449.939288109] [spawner_scaled_joint_trajectory_controller]: Controller manager not available
[spawner-6] [ERROR] [1687871449.974735907] [spawner_joint_state_broadcaster]: Controller manager not available
[spawner-9] [ERROR] [1687871449.990382404] [spawner_force_torque_sensor_broadcaster]: Controller manager not available
[spawner-8] [ERROR] [1687871450.001533371] [spawner_speed_scaling_state_broadcaster]: Controller manager not available
[spawner-7] [ERROR] [1687871450.012905398] [spawner_io_and_status_controller]: Controller manager not available
[ERROR] [spawner-10]: process has died [pid 46937, exit code 1, cmd '/opt/ros/humble/lib/controller_manager/spawner forward_position_controller --controller-manager /controller_manager --controller-manager-timeout 10 --inactive --ros-args'].
[ERROR] [spawner-5]: process has died [pid 46895, exit code 1, cmd '/opt/ros/humble/lib/controller_manager/spawner scaled_joint_trajectory_controller -c /controller_manager --controller-manager-timeout 10 --ros-args'].
[ERROR] [spawner-6]: process has died [pid 46897, exit code 1, cmd '/opt/ros/humble/lib/controller_manager/spawner joint_state_broadcaster --controller-manager /controller_manager --controller-manager-timeout 10 --ros-args'].
[ERROR] [spawner-9]: process has died [pid 46930, exit code 1, cmd '/opt/ros/humble/lib/controller_manager/spawner force_torque_sensor_broadcaster --controller-manager /controller_manager --controller-manager-timeout 10 --ros-args'].
[ERROR] [spawner-8]: process has died [pid 46901, exit code 1, cmd '/opt/ros/humble/lib/controller_manager/spawner speed_scaling_state_broadcaster --controller-manager /controller_manager --controller-manager-timeout 10 --ros-args'].
[ERROR] [spawner-7]: process has died [pid 46899, exit code 1, cmd '/opt/ros/humble/lib/controller_manager/spawner io_and_status_controller --controller-manager /controller_manager --controller-manager-timeout 10 --ros-args'].

I've also tried using the recommended IP settings, however this did not make any difference. I'm pretty confident that the communication between the UR5 and my PC is working, since i was able to extract some callibration data using this comand:
$ ros2 launch ur_calibration calibration_correction.launch.py \
robot_ip:=<robot_ip> target_filename:="${HOME}/my_robot_calibration.yaml"

Im very much a noob at ROS but i'm pretty sure that the issue lies with the 'tf_prefix' variable somehow or there is an issue with missing packages.
If anyone can help me solve this or give me some pointers to find the issue, i would be very thankfull.
I've followed this section of the documentation to install and setup my workspace:
https://github.com/UniversalRobots/Universal_Robots_ROS2_Driver/tree/humble#build-from-source
Heres some additional information about my ROS enviroment:
ROS_VERSION=2
ROS_PYTHON_VERSION=3
ROS_LOCALHOST_ONLY=0
ROS_DISTRO=humble

If any other information would be helpfull, i will be happy to provide it asap.

Originally posted by ledrag on ROS Answers with karma: 1 on 2023-06-27
Post score: 0

Original comments
Comment by gvdhoorn on 2023-06-27:
Looks like UniversalRobots/Universal_Robots_ROS2_Driver#718.
As this is an actual problem with the sw, as opposed to some configuration or usage question, I'd recommend diagnosing on the issue tracker instead of here on ROS Answers.

A:

As a follow-up: This has been resolved in the driver. See https://github.com/UniversalRobots/Universal_Robots_ROS2_Driver/issues/677

Originally posted by fexner with karma: 221 on 2023-07-07
This answer was ACCEPTED on the original site
Post score: 0

