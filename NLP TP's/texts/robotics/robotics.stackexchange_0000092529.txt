Q:

RTABmap corrupted database

Everytime when I perfrom SLAM with RTABMAP, I get a map with some warning like:
Memory.cpp:1746::forget() Less signatures transferred (3) than added (4)! The working memory cannot decrease in size

But when I start the localization part (on a 2nd time), the database gets corrupted and I get this error everytime:
VWDictionary.cpp:616::addWordRef() Not found word

How can I fix it?

Originally posted by EdwardNur on ROS Answers with karma: 115 on 2019-07-14
Post score: 0

A:

Hi,
For the first warning, it is because memory management is enabled and for some reasons rtabmap cannot transfer enough locations to long-term memory to decrease Working Memory size. Unless you understand very well how memory management is done, I suggest to disable it while you are debugging the mapping. To do so, make sure parameter Rtabmap/TimeThr and Rtabmap/MemoryThr are 0 (by default they are 0).
For the error "VWDictionary.cpp:616::addWordRef() Not found word", it means the database has some data missing (because for example the database was not correctly closed). To repair the database, we have a tool called rtabmap-recovery:
$ rtabmap-recovery ~/.ros/rtabmap.db

To make sure the database is correctly saved, after doing ctrl-c on terminal that started rtabmap, you should see:
rtabmap: Saving database/long-term memory...done! (located at /home/user/.ros/rtabmap.db, 76 MB)

cheers,
Mathieu

Originally posted by matlabbe with karma: 6409 on 2019-07-15
This answer was ACCEPTED on the original site
Post score: 0

Original comments
Comment by EdwardNur on 2019-07-15:
@matlabbe so how can I properly close after finishing the SLAM?
Comment by matlabbe on 2019-07-17:
I updated the answer

