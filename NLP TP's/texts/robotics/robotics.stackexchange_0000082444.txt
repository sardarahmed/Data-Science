Q:

mavros offboard no GPS

Hi, have recently been trying to control a rover equipped with a Pixhawk2 in an indoor environment.
For this purpose, I have followed the steps outlined in the mavros_offboard tutorial. I also had to change a few parameters on the PX4 firmware to allow the rover to arm without a GPS lock etc..
After running a script similar to the tutorial one, I was able to switch to offboard mode, see below the echo of topic /mavros/state
header: 
  seq: 3105
  stamp: 
    secs: 1503352094
    nsecs: 242159569
  frame_id: ''
connected: True
armed: True
guided: True
mode: OFFBOARD
system_status: 4

However, the mavros node interfacing with the rover is printing the following output:
[ WARN] [1503352273.909538514]: GP: No GPS fix
[ INFO] [1503352280.350340503]: HP: requesting home position

I have tried to set this position with no success.
If any of you have managed to run a px4/apm robot in an offboard mode with no GPS I would be grateful for information on:

Telling  mavros/pixhawk not to expect a GPS fix

Getting the tf topic to publish something (I guess this is related to 1.)

Thanks for any help.

Originally posted by gpldecha on ROS Answers with karma: 285 on 2017-08-21
Post score: 0

Original comments
Comment by jayess on 2017-08-21:
I definitely could be wrong but I believe that a GPS source is needed (whether it's real or faked).
Comment by gpldecha on 2017-08-22:
@jayess, not sure either. I will ask on the px4 forum and see if anybody has an idea.

A:

Assuming that you have PX4 Firmware somewhere above 1.6.0, you could try to set EKF2_AID_MASK bitmask's least significant bit -which is fuse gps option- to 0 in order to stop fusing GPS. If you're using LPE, you could do a similar thing on its bitmask on LPE_FUSION parameter. You could as well change CBRK_GPSFAIL parameter to 240024 in order for the Pixhawk to ignore checking whether you have GPS receiver or not.

Originally posted by deksprime with karma: 26 on 2017-10-05
This answer was ACCEPTED on the original site
Post score: 1

