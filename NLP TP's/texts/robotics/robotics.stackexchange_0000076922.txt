Q:

gazebo spawn_model from .py source code

env: Ubuntu 14.04, ROS Indigo.
Is there a way to spawn models from the code?
I was referring to gazebo_msgs/SpawnModel.srv. Tried,
#!/usr/bin/env python

import rospy, tf
from gazebo_msgs.srv import DeleteModel, SpawnModel
from geometry_msgs.msg import *

if __name__ == '__main__':
    print("Waiting for gazebo services...")
    rospy.init_node("spawn_products_in_bins")
    rospy.wait_for_service("gazebo/delete_model")
    rospy.wait_for_service("gazebo/spawn_model")
    print("Got it.")
    delete_model = rospy.ServicePoxy("gazebo/delete_model", DeleteModel)
    spawn_model = rospy.ServiceProxy("gazebo/spawn_model", SpawnModel)
    
    with open("$GAZEBO_MODEL_PATH/product_0/model.sdf", "r") as f:
        product_xml = f.read()
        
    orient = Quaternion(tf.transformations.quaternion_from_euler(0,0,0))
    
    for num in xrange(0,12):
        item_name = "product_{0}_0".format(num)
        print("Deleting model:%s", item_name)
        delete_model(item_name)
        
    for num in xrange(0,12):
        bin_y   =   2.8 *   (num    /   6)  -   1.4 
        bin_x   =   0.5 *   (num    %   6)  -   1.5
        item_name   =   "product_{0}_0".format(num)
        print("Spawning model:%s", item_name)
        item_pose   =   Pose(Point(x=bin_x, y=bin_y,    z=2),   orient)
        spawn_model(item_name, product_xml, "", item_pose, "world")

But the services never start,
josh@jUbuntu:~/ros/stockroom_ws$ rosrun stock_bot spawn_products_in_bins.py
Waiting for gazebo services...

Could not find any topics with /gazebo/spawn_model or /gazebo/delete_model even with rostopic list
PS: I'm running a gazebo simulation during the whole time.

Originally posted by r0josh on ROS Answers with karma: 3 on 2016-10-25
Post score: 0

A:

I'm running a gazebo simulation during the whole time.

I suspect that you run the gazebo ^ using gazebo command.
You need to run gazebo_ros instead.. Try :
rosrun gazebo_ros gazebo

Then you can find the gazebo services and topics when you call rostopic list and rosservice list.
PS: Make sure you've called roscore first
EDIT:
First, spawn and delete are services NOT topics. So you must check it using rosservice NOT rostopic!
When you rosservice list, the service you'll see is /gazebo/spawn_sdf_model NOT gazebo/spawn_model,
which means that gazebo/spawn_model is NOT the correct service name. Therefore you should
change this line below
rospy.wait_for_service("gazebo/spawn_model")

to
rospy.wait_for_service("gazebo/spawn_sdf_model")

AND this line below
spawn_model = rospy.ServiceProxy("gazebo/spawn_model", SpawnModel)

to
s = rospy.ServiceProxy("gazebo/spawn_sdf_model", SpawnModel)

Originally posted by alienmon with karma: 582 on 2016-10-25
This answer was ACCEPTED on the original site
Post score: 2

Original comments
Comment by r0josh on 2016-10-25:
Yeah, tried that. These are the topics listed
/clock
/gazebo/link_states
/gazebo/model_states
/gazebo/parameter_descriptions
/gazebo/parameter_updates
/gazebo/set_link_state
/gazebo/set_model_state
/rosout
/rosout_agg

No sign of /spawn_model :(
Comment by r0josh on 2016-10-25:
Of course gazebo_msgs/SpawnModel shows up after rossv list. But that does not mean its 'ACTIVE' or the server is up, does it?
Comment by alienmon on 2016-10-25:
First, spawn and delete are service , so you suppose to check it using rosservice
Comment by alienmon on 2016-10-25:
When you rosservice you will see that there are : gazebo/spawn_sdf_model so in your code instead of gazebo/spawn_model it should be gazebo/spawn_sdf_model
Comment by alienmon on 2016-10-25:
@r0josh I edited my answer.
Comment by r0josh on 2016-10-26:
Thanks a bunch!

