Q:

cv_bridge build fails

I'm trying to install cv_bridge on a BeagleBone running Debian.  I am using ROS Indigo.
I am getting the following error:
[  5%] Building CXX object vision_opencv/cv_bridge/src/CMakeFiles/cv_bridge_boost.dir/module_opencv2.cpp.o
/home/debian/catkin_ws/src/vision_opencv/cv_bridge/src/module_opencv2.cpp:124:16: error: cannot declare variable ‘g_numpyAllocator’ to be of abstract type ‘NumpyAllocator’
/home/debian/catkin_ws/src/vision_opencv/cv_bridge/src/module_opencv2.cpp:71:7: note:   because the following virtual functions are pure within ‘NumpyAllocator’:
/usr/local/include/opencv2/core/mat.hpp:417:23: note:   virtual cv::UMatData* cv::MatAllocator::allocate(int, const int*, int, void*, size_t*, int, cv::UMatUsageFlags) const
/usr/local/include/opencv2/core/mat.hpp:419:18: note:   virtual bool cv::MatAllocator::allocate(cv::UMatData*, int, cv::UMatUsageFlags) const
/usr/local/include/opencv2/core/mat.hpp:420:18: note:   virtual void cv::MatAllocator::deallocate(cv::UMatData*) const
/home/debian/catkin_ws/src/vision_opencv/cv_bridge/src/module_opencv2.cpp: In function ‘int convert_to_CvMat2(const PyObject*, cv::Mat&)’:
/home/debian/catkin_ws/src/vision_opencv/cv_bridge/src/module_opencv2.cpp:206:11: error: ‘class cv::Mat’ has no member named ‘refcount’
make[2]: *** [vision_opencv/cv_bridge/src/CMakeFiles/cv_bridge_boost.dir/module_opencv2.cpp.o] Error 1
make[1]: *** [vision_opencv/cv_bridge/src/CMakeFiles/cv_bridge_boost.dir/all] Error 2
make: *** [all] Error 2

Tried the usual Google searching and couldn't find an answer.  I have OpenCV installed (3.1.0), and verified that OpenCV is working.
Anyone have any thoughts/suggestions?
Thanks
Mark

Originally posted by MarkG on ROS Answers with karma: 30 on 2016-02-11
Post score: 0

A:

doing some more searching, this link
http://answers.ros.org/question/133416/opencv-30-and-cv-bridge/
and this repository
https://github.com/mikejmills/vision_opencv
works.  It seems it is a matter of using the latest openCV 3.1.0, 3.1.0 does not work with the standard cv_bridge.
Used mikejmills version and compiled correctly.

Originally posted by MarkG with karma: 30 on 2016-02-12
This answer was ACCEPTED on the original site
Post score: 0

