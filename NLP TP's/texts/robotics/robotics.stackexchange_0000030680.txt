Q:

Segmentation fault in rtt_ros_integration_example

Hi,
I'm trying to run the hello world example in rtt_ros_integration_example and I get a segmentation fault after (or while, not sure) importing the ROS types. Last lines before the segfault are:
0.084 [ Info   ][TypekitRepository::Import] Loading Typekit ros-primitives.
0.084 [ Debug  ][TypekitRepository::Import] Registered Type name 'time' to the Orocos Type System.
0.084 [ Debug  ][TypekitRepository::Import] Registered Type name 'int8' to the Orocos Type System.
0.084 [ Debug  ][TypekitRepository::Import] Registered Type name 'int8[]' to the Orocos Type System.
0.084 [ Debug  ][TypekitRepository::Import] Registered Type name 'uint8' to the Orocos Type System.
0.084 [ Debug  ][TypekitRepository::Import] Registered Type name 'uint8[]' to the Orocos Type System.
0.084 [ Debug  ][TypekitRepository::Import] Registered Type name 'int16' to the Orocos Type System.
0.084 [ Debug  ][TypekitRepository::Import] Registered Type name 'int16[]' to the Orocos Type System.
0.084 [ Debug  ][TypekitRepository::Import] Registered Type name 'uint16' to the Orocos Type System.
0.084 [ Debug  ][TypekitRepository::Import] Registered Type name 'uint16[]' to the Orocos Type System.
0.084 [ Debug  ][TypekitRepository::Import] Registered Type name 'int32' to the Orocos Type System.
0.085 [ Warning][TypekitRepository::Import] Overriding TypeInfo for 'ints' with 'int32[]'.
0.085 [ Debug  ][TypekitRepository::Import] Registered Type name 'int32[]' to the Orocos Type System.
0.085 [ Debug  ][TypekitRepository::Import] Registered Type name 'uint32' to the Orocos Type System.
0.085 [ Debug  ][TypekitRepository::Import] Registered Type name 'uint32[]' to the Orocos Type System.
0.085 [ Debug  ][TypekitRepository::Import] Registered Type name 'int64' to the Orocos Type System.
0.085 [ Debug  ][TypekitRepository::Import] Registered Type name 'int64[]' to the Orocos Type System.
0.085 [ Debug  ][TypekitRepository::Import] Registered Type name 'uint64' to the Orocos Type System.
0.085 [ Debug  ][TypekitRepository::Import] Registered Type name 'uint64[]' to the Orocos Type System.
0.085 [ Debug  ][TypekitRepository::Import] Registered Type name 'float32' to the Orocos Type System.
0.085 [ Debug  ][TypekitRepository::Import] Registered Type name 'float32[]' to the Orocos Type System.
0.085 [ Debug  ][TypekitRepository::Import] Registered Type name 'float64' to the Orocos Type System.
0.085 [ Debug  ][TypekitRepository::Import] Registered Type name 'float64[]' to the Orocos Type System.
0.085 [ Debug  ][TypekitRepository::Import] Registered Type name 'string' to the Orocos Type System.
Segmentation fault

I'm running ROS diamondback using pre-compiled debian packages. Has anyone managed to run this example? Any idea of what might be going wrong?
Edit: I provide a gdb backtrace, as Ruben suggested.
6.331 [ Debug  ][TypekitRepository::Import] Registered Type name 'string' to the Orocos Type System.

Program received signal SIGSEGV, Segmentation fault.
0x00007ffff0a69dd7 in ros_integration::ROSPrimitivesTypekitPlugin::loadConstructors (this=<value optimised out>)
    at /tmp/buildd/ros-diamondback-orocos-toolchain-ros-0.2.1/debian/ros-diamondback-orocos-toolchain-ros/opt/ros/diamondback/stacks/orocos_toolchain_ros/rtt_ros_integration/src/orocos/types/ros_primitives_typekit_plugin.cpp:122
122 /tmp/buildd/ros-diamondback-orocos-toolchain-ros-0.2.1/debian/ros-diamondback-orocos-toolchain-ros/opt/ros/diamondback/stacks/orocos_toolchain_ros/rtt_ros_integration/src/orocos/types/ros_primitives_typekit_plugin.cpp: No such file or directory.
    in /tmp/buildd/ros-diamondback-orocos-toolchain-ros-0.2.1/debian/ros-diamondback-orocos-toolchain-ros/opt/ros/diamondback/stacks/orocos_toolchain_ros/rtt_ros_integration/src/orocos/types/ros_primitives_typekit_plugin.cpp
(gdb) backtrace
#0  0x00007ffff0a69dd7 in ros_integration::ROSPrimitivesTypekitPlugin::loadConstructors (this=<value optimised out>)
    at /tmp/buildd/ros-diamondback-orocos-toolchain-ros-0.2.1/debian/ros-diamondback-orocos-toolchain-ros/opt/ros/diamondback/stacks/orocos_toolchain_ros/rtt_ros_integration/src/orocos/types/ros_primitives_typekit_plugin.cpp:122
#1  0x00007ffff78fb88f in RTT::types::TypekitRepository::Import (tkp=0x66ad20)
    at /tmp/buildd/ros-diamondback-orocos-toolchain-ros-0.2.1/debian/ros-diamondback-orocos-toolchain-ros/opt/ros/diamondback/stacks/orocos_toolchain_ros/rtt/rtt/types/TypekitRepository.cpp:70
#2  0x00007ffff0a68f6e in loadRTTPlugin (tc=<value optimised out>)
    at /tmp/buildd/ros-diamondback-orocos-toolchain-ros-0.2.1/debian/ros-diamondback-orocos-toolchain-ros/opt/ros/diamondback/stacks/orocos_toolchain_ros/rtt_ros_integration/src/orocos/types/ros_primitives_typekit_plugin.cpp:175
#3  0x00007ffff7905d7c in RTT::plugin::PluginLoader::loadInProcess (this=<value optimised out>, file=<value optimised out>, shortname=<value optimised out>, kind=<value optimised out>, log_error=<value optimised out>)
    at /tmp/buildd/ros-diamondback-orocos-toolchain-ros-0.2.1/debian/ros-diamondback-orocos-toolchain-ros/opt/ros/diamondback/stacks/orocos_toolchain_ros/rtt/rtt/plugin/PluginLoader.cpp:451
#4  0x00007ffff7906ee0 in RTT::plugin::PluginLoader::loadPluginsInternal (this=<value optimised out>, path_list=<value optimised out>, subdir=<value optimised out>, kind=<value optimised out>)
    at /tmp/buildd/ros-diamondback-orocos-toolchain-ros-0.2.1/debian/ros-diamondback-orocos-toolchain-ros/opt/ros/diamondback/stacks/orocos_toolchain_ros/rtt/rtt/plugin/PluginLoader.cpp:279
#5  0x00007ffff7908a2f in RTT::plugin::PluginLoader::loadTypekits (this=0x6225c0, path_list=...)
    at /tmp/buildd/ros-diamondback-orocos-toolchain-ros-0.2.1/debian/ros-diamondback-orocos-toolchain-ros/opt/ros/diamondback/stacks/orocos_toolchain_ros/rtt/rtt/plugin/PluginLoader.cpp:193
#6  0x00007ffff731b4ce in OCL::ComponentLoader::import (this=<value optimised out>, path_list=<value optimised out>)
    at /tmp/buildd/ros-diamondback-orocos-toolchain-ros-0.2.1/debian/ros-diamondback-orocos-toolchain-ros/opt/ros/diamondback/stacks/orocos_toolchain_ros/ocl/deployment/ComponentLoader.cpp:143
#7  0x00007ffff731a2cc in OCL::ComponentLoader::import (this=<value optimised out>, package=<value optimised out>, path_list=<value optimised out>)
    at /tmp/buildd/ros-diamondback-orocos-toolchain-ros-0.2.1/debian/ros-diamondback-orocos-toolchain-ros/opt/ros/diamondback/stacks/orocos_toolchain_ros/ocl/deployment/ComponentLoader.cpp:232
#8  0x00007ffff72835b4 in OCL::DeploymentComponent::import (this=<value optimised out>, package=...)
    at /tmp/buildd/ros-diamondback-orocos-toolchain-ros-0.2.1/debian/ros-diamondback-orocos-toolchain-ros/opt/ros/diamondback/stacks/orocos_toolchain_ros/ocl/deployment/DeploymentComponent.cpp:1447
#9  0x00007ffff728dbc9 in OCL::DeploymentComponent::loadComponentsInGroup (this=<value optimised out>, configurationfile=<value optimised out>, group=<value optimised out>)
    at /tmp/buildd/ros-diamondback-orocos-toolchain-ros-0.2.1/debian/ros-diamondback-orocos-toolchain-ros/opt/ros/diamondback/stacks/orocos_toolchain_ros/ocl/deployment/DeploymentComponent.cpp:583
#10 0x00007ffff72915af in OCL::DeploymentComponent::kickStart (this=0x7ffff58afe40, configurationfile=...)
    at /tmp/buildd/ros-diamondback-orocos-toolchain-ros-0.2.1/debian/ros-diamondback-orocos-toolchain-ros/opt/ros/diamondback/stacks/orocos_toolchain_ros/ocl/deployment/DeploymentComponent.cpp:490
#11 0x000000000040cab0 in main (argc=<value optimised out>, argv=<value optimised out>)
    at /tmp/buildd/ros-diamondback-orocos-toolchain-ros-0.2.1/debian/ros-diamondback-orocos-toolchain-ros/opt/ros/diamondback/stacks/orocos_toolchain_ros/ocl/bin/deployer.cpp:150
(gdb) 

Originally posted by Miguel Prada on ROS Answers with karma: 1071 on 2011-03-24
Post score: 0

A:

Ok, it's really strange that no-one, including me, never bumped into this one. It looks like the 'float' type is not known to the RTT typesystem before importing the ros_primitives typekit. This can happen if the rtt_primitives typekit is not loaded yet.
Could you retry after exporting
 RTT_COMPONENT_PATH=`rospack find rtt`/install/lib/orocos

this should make sure the rtt_primitives are loaded at startup. Can you verify this in the log?
If it still does not work, could you post the entire log so I can see why the rtt_primitives are not loaded?
-- Ruben

Originally posted by Ruben Smits with karma: 543 on 2011-03-28
This answer was ACCEPTED on the original site
Post score: 1

Original comments
Comment by Miguel Prada on 2011-03-28:
It does work now. I can see that the 'float' type gets loaded from librtt-typekit-gnulinux.so (I guess this is the typekit you're referring to) before being overriden by float32 in librtt-ros-primitives-typekit-gnulinux.so. If you need me to run any other test to see why it happens, please ask.

