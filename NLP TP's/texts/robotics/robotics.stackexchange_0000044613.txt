Q:

How to set up image_proc/crop_decimate nodelet properly?

Sorry for this question but I'm newbie about ros nodelets. I'd like to use  image_proc/crop_decimate to do a cropping on the rectified images. This is a rectified image:

As you can see, It has a little black border on the right and on the bottom, so I 'd like to crop it.
This is my rxgraph connections:

I've tried to set cropping with the following command, but It has no effect:
rosrun nodelet nodelet standalone image_proc/crop_decimate _x_offset=1 _y_offset=1 _width=639 _height=439  /camera:=/image_rect_color

How to set image_proc/crop_decimate properly?
this is my rostopic list:
aldo@aldo-ubuntu:/opt/ros/electric/stacks/image_pipeline/image_proc$ rostopic list
/gscam/camera_info
/gscam/image_raw
/gscam/image_raw/compressed
/gscam/image_raw/compressed/parameter_descriptions
/gscam/image_raw/compressed/parameter_updates
/gscam/image_raw/theora
/gscam/image_raw/theora/parameter_descriptions
/gscam/image_raw/theora/parameter_updates
/image_color
/image_color/compressed
/image_color/compressed/parameter_descriptions
/image_color/compressed/parameter_updates
/image_color/theora
/image_color/theora/parameter_descriptions
/image_color/theora/parameter_updates
/image_mono
/image_mono/compressed
/image_mono/compressed/parameter_descriptions
/image_mono/compressed/parameter_updates
/image_mono/theora
/image_mono/theora/parameter_descriptions
/image_mono/theora/parameter_updates
/image_proc_debayer/parameter_descriptions
/image_proc_debayer/parameter_updates
/image_proc_rectify_color/parameter_descriptions
/image_proc_rectify_color/parameter_updates
/image_proc_rectify_mono/parameter_descriptions
/image_proc_rectify_mono/parameter_updates
/image_rect
/image_rect/compressed
/image_rect/compressed/parameter_descriptions
/image_rect/compressed/parameter_updates
/image_rect/theora
/image_rect/theora/parameter_descriptions
/image_rect/theora/parameter_updates
/image_rect_color
/image_rect_color/compressed
/image_rect_color/compressed/parameter_descriptions
/image_rect_color/compressed/parameter_updates
/image_rect_color/theora
/image_rect_color/theora/parameter_descriptions
/image_rect_color/theora/parameter_updates
/rosout
/rosout_agg

Originally posted by aldo85ita on ROS Answers with karma: 252 on 2012-10-04
Post score: 3

A:

As this node is a bit complex to launch and requires remapping and argument passing. I would suggest that you write a roslaunch file. The syntax is way easier to understand than the command line arguments (converting '~' to '_' where needed is tricky).
Here is a a roslaunch file adapted to your needs:
<?xml version="1" encoding="utf-8"?>
<launch>
<node pkg="nodelet" type="nodelet"
      args="standalone image_proc/crop_decimate"
      name="my_decimator">
  <param name="x_offset" type="int" value="1" />
  <param name="y_offset" type="int" value="1" />
  <param name="width" type="int" value="639" />
  <param name="height" type="int" value="439" />

  <!-- remap input topics -->
  <remap from="camera/image_raw" to="/image_rect_color"/>
  <remap from="camera/image_info" to="/gscam/camera_info"/>

  <!-- remap output topics -->
  <remap from="camera_out/image_raw" to="/camera_crop/image_rect_color"/>
  <remap from="camera_out/image_info" to="/camera_crop/camera_info"/>
</node>
</launch>

Please see the roslaunch wiki page for more information.
Here is a complete ROS launch file which works on my computer (Ubuntu 10.04 / Electric):
<?xml version="1" encoding="utf-8"?>
<launch>

<node pkg="gscam" type="gscam"
      name="gscam"
      cwd="node">
  <env name="GSCAM_CONFIG"
       value="v4l2src device=/dev/video0 ! video/x-raw-rgb,framerate=30/1 ! ffmpegcolorspace"/>

</node>

<node pkg="image_proc" type="image_proc"
      ns="gscam"
      name="image_proc">
</node>

<node pkg="nodelet" type="nodelet"
      args="standalone image_proc/crop_decimate"
      name="my_decimator">
  <param name="x_offset" type="int" value="1" />
  <param name="y_offset" type="int" value="1" />
  <param name="width" type="int" value="639" />
  <param name="height" type="int" value="439" />

  <!-- remap input topics -->
  <remap from="camera/image_raw" to="/gscam/image_rect_color"/>
  <remap from="camera/image_info" to="/gscam/camera_info"/>

  <!-- remap output topics -->
  <remap from="camera_out/image_raw" to="/camera_crop/image_rect_color"/>
  <remap from="camera_out/image_info" to="/camera_crop/camera_info"/>
</node>
</launch>

Originally posted by Thomas with karma: 4478 on 2012-10-04
This answer was ACCEPTED on the original site
Post score: 7

Original comments
Comment by aldo85ita on 2012-10-09:
Hi @Thomas,my problem is not how to set the parameters of nodelet, but what values to remap. My image_proc node has /gscam/camera_info(sensor_msgs/CameraInfo) and /gscam/image_raw (sensor_msgs/Image) as input,/image_rect_color(sensor_msgs/Image) as output. How to set the nodelet to crop...
Comment by aldo85ita on 2012-10-09:
...on image_rect_color?
Comment by Thomas on 2012-10-10:
This corresponds to the two lines below "edit values here". Ie. /your/image/topic should be /something/image_rect_color and /your/image/info/topic should be /something/camera_info where /something is the image_rect topic prefix.
Comment by Thomas on 2012-10-10:
BTW, if it is still unclear, give me the output of rostopic list and I'll give you the exact result in your particular case.
Comment by aldo85ita on 2012-10-10:
@Thomas, I published  "rostopic list" results above, in my first post.
Comment by Thomas on 2012-10-10:
Ok, I edited the XML file to match what I think is correct. Let me know if it works ;)
Comment by aldo85ita on 2012-10-10:
Thank you @Thomas again, your last launch file work: all nodes are connected properly. But,If I look at rxgraph (my_decimator properties), I read Subscriptions:

/camera_info [unknown type]
/image_rect_color [sensor_msgs/Image] and so, no image is published by my_decimator node. any idea?

Comment by Thomas on 2012-10-10:
Hum ok. Not sure what the problem is so I wrote the full launch file. Maybe by looking at yours and mine you'll figure out the mistake :)

