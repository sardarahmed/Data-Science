Q:

Using tf to transform a point

Hello,
I am trying to transform a point from one frame (/kinect_frame) to another (/base_link).
This is the pdf I get from 'rosrun tf view_frames' :

but still when I try to transform my point using a tf::TransformListener and tf::TransformListener::transformPoint like this :
mTransformListener.transformPoint("/base_link", qc.response.points[0], result);
I get the following error :
[ERROR] [1339062545.681343977]: Unable to lookup transform, cache is empty, when looking up transform from frame [/kinect_frame] to frame [/base_link]

But there is a link visible between kinect_frame and base_link, what am I doing wrong ?

Originally posted by Hansg91 on ROS Answers with karma: 1909 on 2012-06-06
Post score: 2

A:

You need to make sure that TF has a valid and complete TF tree to transform from the kinect frame at the time stamp of the point you are transforming. That's the case when TF received a transform with a stamp greater or equal than the time stamp of the point you are trying to transform. The reason is that TF tries to interpolate positions and orientations, but does not extrapolate. Of course, for interpolation, TF needs at least two transforms, one after and one before the time stamp you are trying to transform.
The static_transform_publisher future-dates transforms to make sure that all data that uses ros::Time::now()  can actually be transformed and to avoid unnecessary delays but it cannot be assumed that frames published by other nodes are future dated as well. For instance, when you have a moving frame (e.g. a PTU), you can only use the current position of the frame (i.e. ros::Time::now()) to publish a frame, everything in the future would be extrapolation again. For that reason, TF provides the method waitForTransform that allows to block until a timeout expires or the transformation into a frame becomes possible. Alternatively, tf::MessageFilter can be used to postpone a subscriber callback on a stamped message until the transformation into a specific frame is possible.

Originally posted by Lorenz with karma: 22731 on 2012-06-07
This answer was ACCEPTED on the original site
Post score: 8

Original comments
Comment by Hansg91 on 2012-06-08:
Thanks :) One last question, when I have the StampedTransform from lookupTransform, how do I use that to transform a point from frame A to frame B ? I couldn't find it in the tutorials and I don't think it is a big enough question to start a new post :)
Comment by Lorenz on 2012-06-08:
Use transformPoint instead of lookupTransform. It's a member function of tf::TransformListener (quick link: http://ros.org/doc/fuerte/api/tf/html/c++/classtf_1_1TransformListener.html).
Comment by Hansg91 on 2012-06-08:
Silly me, I thought I had to use lookupTransform after waitForTransform, but transformPoint will do :D thnx again

