Q:

Unable to interface moveit with gazebo - Controllers not loaded and unable to spawn robot model

I'm trying to interface moveit with gazebo for simulation.
I'm following the construct sim tutorial for the same,  which uses ubuntu 16.04 and ros-kinetic
https://www.theconstructsim.com/control-gazebo-simulated-robot-moveit-video-answer/
I'm using ros-melodic and ubuntu 18.04 with gazebo - version 9.12
Linux 5.3.0-42-generic x86_64
HP pavillion notebook
UR package that i downloaded for urdf from melodic-devel branch
https://github.com/ros-industrial/universal_robot/tree/melodic-devel
Question 1 : I'm unable to see the action servers having type of controller FollowJointTrajectory as it is given in the tutorial when i run [ $ rostopic list ] after launching ur5.launch in the ur package
Terminal shows this
$ rostopic list
/calibrated
/clock
/gazebo/link_states
/gazebo/model_states
/gazebo/parameter_descriptions
/gazebo/parameter_updates
/gazebo/set_link_state
/gazebo/set_model_state
/joint_group_position_controller/command
/joint_states
/rosout
/rosout_agg
/tf

and i suppose this could be one of the reasons of not getting the controllers loaded to gazebo.
The model also gets loaded to gazebo which is very translucent as in i think it is not spawned correctly and i recieve this error
    $ roslaunch ur_gazebo ur5.launch 
    
    Checking log directory for disk usage. This may take a while.
    Press Ctrl-C to interrupt
    Done checking log file disk usage. Usage is <1GB.
    
    xacro: in-order processing became default in ROS Melodic. You can drop the option.
    started roslaunch server http://xxxx-HP-Pavilion-Laptop-xxxxxxx/
    
    SUMMARY
    ========
    
    PARAMETERS
     * /arm_controller/action_monitor_rate: 10
     * /arm_controller/constraints/elbow_joint/goal: 0.1
     * /arm_controller/constraints/elbow_joint/trajectory: 0.1
     * /arm_controller/constraints/goal_time: 0.6
     * /arm_controller/constraints/shoulder_lift_joint/goal: 0.1
     * /arm_controller/constraints/shoulder_lift_joint/trajectory: 0.1
     * /arm_controller/constraints/shoulder_pan_joint/goal: 0.1
     * /arm_controller/constraints/shoulder_pan_joint/trajectory: 0.1
     * /arm_controller/constraints/stopped_velocity_tolerance: 0.05
     * /arm_controller/constraints/wrist_1_joint/goal: 0.1
     * /arm_controller/constraints/wrist_1_joint/trajectory: 0.1
     * /arm_controller/constraints/wrist_2_joint/goal: 0.1
     * /arm_controller/constraints/wrist_2_joint/trajectory: 0.1
     * /arm_controller/constraints/wrist_3_joint/goal: 0.1
     * /arm_controller/constraints/wrist_3_joint/trajectory: 0.1
     * /arm_controller/joints: ['shoulder_pan_jo...
     * /arm_controller/state_publish_rate: 25
     * /arm_controller/stop_trajectory_duration: 0.5
     * /arm_controller/type: position_controll...
     * /gazebo/enable_ros_network: True
     * /joint_group_position_controller/joints: ['shoulder_pan_jo...
     * /joint_group_position_controller/type: position_controll...
     * /joint_state_controller/publish_rate: 50
     * /joint_state_controller/type: joint_state_contr...
     * /robot_description: <?xml version="1....
     * /robot_state_publisher/publish_frequency: 50.0
     * /robot_state_publisher/tf_prefix: 
     * /rosdistro: melodic
     * /rosversion: 1.14.5
     * /use_sim_time: True
    
    NODES
      /
        arm_controller_spawner (controller_manager/controller_manager)
        fake_joint_calibration (rostopic/rostopic)
        gazebo (gazebo_ros/gzserver)
        gazebo_gui (gazebo_ros/gzclient)
        joint_state_controller_spawner (controller_manager/controller_manager)
        robot_state_publisher (robot_state_publisher/robot_state_publisher)
        ros_control_controller_manager (controller_manager/controller_manager)
        spawn_gazebo_model (gazebo_ros/spawn_model)
    
    auto-starting new master
    process[master]: started with pid [24412]
    ROS_MASTER_URI=http://localhost:11311
    
    setting /run_id to 8a547ef4-75d3-11ea-bcec-302432c29868
    process[rosout-1]: started with pid [24423]
    started core service [/rosout]
    process[gazebo-2]: started with pid [24430]
    process[gazebo_gui-3]: started with pid [24435]
    process[spawn_gazebo_model-4]: started with pid [24440]
    process[robot_state_publisher-5]: started with pid [24441]
    process[fake_joint_calibration-6]: started with pid [24442]
    process[joint_state_controller_spawner-7]: started with pid [24448]
    process[arm_controller_spawner-8]: started with pid [24450]
    process[ros_control_controller_manager-9]: started with pid [24451]
    [ INFO] [1585936203.649255599]: Finished loading Gazebo ROS API Plugin.
    [ INFO] [1585936203.651239013]: waitForService: Service [/gazebo/set_physics_properties] has not been advertised, waiting...
    [ INFO] [1585936203.713316303]: Finished loading Gazebo ROS API Plugin.
    [ INFO] [1585936203.715368125]: waitForService: Service [/gazebo_gui/set_physics_properties] has not been advertised, waiting...
    [INFO] [1585936203.982848, 0.000000]: Loading model XML from ros parameter robot_description
    [INFO] [1585936203.991291, 0.000000]: Waiting for service /gazebo/spawn_urdf_model
    [ INFO] [1585936204.108098098]: waitForService: Service [/gazebo/set_physics_properties] is now available.
    [ INFO] [1585936204.176096535, 0.061000000]: Physics dynamic reconfigure ready.
    [INFO] [1585936204.297095, 0.174000]: Calling service /gazebo/spawn_urdf_model
    [INFO] [1585936204.624149, 0.348000]: Spawn status: SpawnModel: Successfully spawned entity
    [ INFO] [1585936204.675743037, 0.348000000]: Loading gazebo_ros_control plugin
    [ INFO] [1585936204.675917775, 0.348000000]: Starting gazebo_ros_control plugin in namespace: /
    [ INFO] [1585936204.677101870, 0.348000000]: gazebo_ros_control plugin is waiting for model URDF in parameter [robot_description] on the ROS param server.
    [ERROR] [1585936204.799004180, 0.348000000]: No p gain specified for pid.  Namespace: /gazebo_ros_control/pid_gains/shoulder_pan_joint
    [ERROR] [1585936204.800050099, 0.348000000]: No p gain specified for pid.  Namespace: /gazebo_ros_control/pid_gains/shoulder_lift_joint
    [ERROR] [1585936204.801109164, 0.348000000]: No p gain specified for pid.  Namespace: /gazebo_ros_control/pid_gains/elbow_joint
    [ERROR] [1585936204.802086064, 0.348000000]: No p gain specified for pid.  Namespace: /gazebo_ros_control/pid_gains/wrist_1_joint
    [ERROR] [1585936204.802965703, 0.348000000]: No p gain specified for pid.  Namespace: /gazebo_ros_control/pid_gains/wrist_2_joint
    [ERROR] [1585936204.803927588, 0.348000000]: No p gain specified for pid.  Namespace: /gazebo_ros_control/pid_gains/wrist_3_joint
    [ INFO] [1585936204.809656297, 0.348000000]: Loaded gazebo_ros_control.
    [spawn_gazebo_model-4] process has finished cleanly
  
    Loaded 'joint_state_controller'
    Started ['joint_state_controller'] successfully
    [ERROR] [1585936204.891563571, 0.398000000]: Could not load controller 'arm_controller' because controller type 'position_controllers/JointTrajectoryController' does not exist.
    [ERROR] [1585936204.891626027, 0.398000000]: Use 'rosservice call controller_manager/list_controller_types' to get the available types
    Error when loading 'arm_controller'
    [ERROR] [1585936204.895865189, 0.403000000]: Could not start controller with name 'arm_controller' because no controller with this name exists
    Error when starting ['arm_controller'] and stopping []
    Loaded 'joint_group_position_controller'
    [joint_state_controller_spawner-7] process has finished cleanly
    log file
    [arm_controller_spawner-8] process has finished cleanly
   log file
    [ros_control_controller_manager-9] process has finished cleanly
    log file
    [ WARN] [1585936973.534349503, 638.841000000]: Shutdown request received.
    [ WARN] [1585936973.535242619, 638.841000000]: Reason given for shutdown: [new node registered with same name]
    [ERROR] [1585936974.053903144, 639.253000000]: SpawnModel: Failure - model name robot already exist.
    [ WARN] [1585937062.800113468, 710.530000000]: Shutdown request received.
    [ WARN] [1585937062.805011167, 710.532000000]: Reason given for shutdown: [new node registered with same name]
    [robot_state_publisher-5] process has finished cleanly

    [ERROR] [1585937067.597536341, 712.694000000]: SpawnModel: Failure - model name robot already exist.
    [gazebo_gui-3] process has finished cleanly
    

As i follow the tutorials further and do the exact same replacements in the config and launch folders of the demo_moveit_config package created by the moveit_setup_assistant
Please check the link of the tutorial for the controllers.yaml file if i have missed some information
and at the end launch the demo_planning_execution.launch i get this error
$ roslaunch demo_moveit_config demo_planning_execution.launch 

Checking log directory for disk usage. This may take a while.
Press Ctrl-C to interrupt
Done checking log file disk usage. Usage is <1GB.

RLException: unused args [config] for include of [/home/xxxxx/ns_ws/src/demo_moveit_config/launch/moveit_rviz.launch]
The traceback for the exception was written to the log file

for clarification i'm also uploading moveit_rviz.launch
<launch>

  <arg name="debug" default="false" />
  <arg unless="$(arg debug)" name="launch_prefix" value="" />
  <arg     if="$(arg debug)" name="launch_prefix" value="gdb --ex run --args" />

  <arg name="rviz_config" default="" />
  <arg     if="$(eval rviz_config=='')" name="command_args" value="" />
  <arg unless="$(eval rviz_config=='')" name="command_args" value="-d $(arg rviz_config)" />

  <node name="$(anon rviz)" launch-prefix="$(arg launch_prefix)" pkg="rviz" type="rviz" respawn="false"
    args="$(arg command_args)" output="screen">
    <rosparam command="load" file="$(find demo_moveit_config)/config/kinematics.yaml"/>
  </node>

</launch>

THIS IS HOW I'M UNABLE TO INTERFACE MOVEIT WITH GAZEBO

Originally posted by R_CODEC on ROS Answers with karma: 16 on 2020-04-03
Post score: 0

A:

I solved the error after upgrading the ros-control-package
Now it's working.

Originally posted by R_CODEC with karma: 16 on 2020-04-12
This answer was ACCEPTED on the original site
Post score: 0

