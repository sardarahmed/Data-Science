Q:

[Crystal] rosdep cannot find all required resources

I'm having trouble with rosdep check on 18.04 and Crystal. I've done this:
pip install -U rosdep
sudo rm /etc/ros/rosdep/sources.list.d/20-default.list
sudo rosdep init
rosdep update
cd ~/ros2/orca_ws
. /opt/ros/crystal/setup.bash
colcon build --event-handlers console_direct+
. install/setup.bash
rosdep check orca_base

The output of rosdep is:
ERROR: Rosdep cannot find all required resources to answer your query
Missing resource orca_base
ROS path [0]=/home/clyde/ros2/orca_ws/install/orca_topside/share

orca_topside is one of the packages in my workspace. But why doesn't rosdep know about all of them?
As a workaround, I set ROS_PACKAGE_PATH:
export ROS_PACKAGE_PATH=/home/clyde/ros2/orca_ws/install/orca_base/share
rosdep check orca_base

New output:
All system dependencies have been satisfied
ERROR[orca_base]: Cannot locate rosdep definition for [orca_msgs]
    rosdep key : orca_msgs
    OS name    : ubuntu
    OS version : bionic
    Data: <no data>

Do I need to manually maintain ROS_PACKAGE_PATH for my workspace?
Thanks.
Edit -- the results of colcon version-check
colcon-argcomplete 0.3.2: up-to-date
colcon-bash 0.3.1: up-to-date
colcon-cmake 0.2.7: newer version available (0.2.8)
colcon-core 0.3.17: up-to-date
colcon-defaults 0.2.1: up-to-date
colcon-devtools 0.2.1: up-to-date
colcon-library-path 0.2.1: up-to-date
colcon-metadata 0.2.1: up-to-date
colcon-notification 0.2.6: up-to-date
colcon-output 0.2.3: up-to-date
colcon-package-information 0.2.2: up-to-date
colcon-package-selection 0.2.3: up-to-date
colcon-parallel-executor 0.2.3: up-to-date
colcon-pkg-config 0.1.0: up-to-date
colcon-powershell 0.3.3: up-to-date
colcon-python-setup-py 0.2.1: up-to-date
colcon-recursive-crawl 0.2.0: up-to-date
colcon-ros 0.3.7: up-to-date
colcon-test-result 0.3.1: up-to-date
colcon-zsh 0.3.1: up-to-date

Originally posted by clyde on ROS Answers with karma: 1247 on 2019-02-11
Post score: 0

A:

The ROS_PACKAGE_PATH needs to contain a list of the paths to all the packages. The way you're exporting a path to it you're not chaining onto the original value so you're losing all the other paths.
All of your exports need to have :$ROS_PACKAGE_PATH on the end of them so they are concatenated onto the original value as shown below:
export ROS_PACKAGE_PATH=/home/clyde/ros2/orca_ws/install/orca_base/share:$ROS_PACKAGE_PATH

If you create a new terminal and use this command it should hopefully fix things.

Originally posted by PeteBlackerThe3rd with karma: 9529 on 2019-02-11
This answer was ACCEPTED on the original site
Post score: 1

Original comments
Comment by clyde on 2019-02-11:
Sounds like I need to set & maintain ROS_PACKAGE_PATH by hand. Somehow I thought that Colcon would do this for me. Thanks for the answer.
Comment by Geoff on 2019-02-11:
Since ROS_PACKAGE_PATH is deprecated in favour of workspace chaining, colcon doesn't really do anything with it.
Comment by Dirk Thomas on 2019-02-11:
~~That is incorrect.~~ colcon-ros does extend the ROS_PACKAGE_PATH environment variable for you: https://github.com/colcon/colcon-ros/blob/0d1a43e6907a794b5d5a4249fb6893a39c2a1540/colcon_ros/task/catkin/build.py#L75-L77
Please check that you use the latest versions of all the colcon packages.
Comment by Geoff on 2019-02-11:
Today's new thing learned! (I did look through the colcon docs but didn't find anything; obviously I was looking in the wrong place.)
If it is not obsolete then that wiki page should be updated with how it is actually used and managed now.
Comment by Dirk Thomas on 2019-02-11:
I am sorry I missed the context of the question. The logic I referenced is only for ROS 1 / catkin packages. It would be good to open a ticket on rosdep for this.
Comment by clyde on 2019-02-11:
Ticket created: https://github.com/colcon/colcon-ros/issues/51
Thanks!
Comment by Dirk Thomas on 2019-02-11:
I was referring to this repo: https://github.com/ros-infrastructure/rosdep
Comment by clyde on 2019-02-12:
Ticket created: https://github.com/ros-infrastructure/rosdep/issues/660. I will mark the question as "answered." Thanks, all.

