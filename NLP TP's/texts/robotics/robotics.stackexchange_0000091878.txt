Q:

How to use Float32MultiArray (Publisher)

Hello,
I am trying to write a python code using the Float32MultiArray to run my robot's motors.
The code is below:
motor = rospy.Publisher('encoder', Float32MultiArray, queue_size = 2)

while not rospy is shutdown():
   
    arg = Float32MultiArray()
    arg.layout.dim[0].label ="x"
    arg.layout.dim[0].size = 1
    arg.layout.dim[0].stride = 1
   
    arg.layout.dim[1].label ="y"
    arg.layout.dim[1].size = 1
    arg.layout.dim[1].stride = 1
    
    arg.layout.data_offset = 1
    arg.data = [100, 100]

    motor.publish(arg)
However, I have the error below:
TypeError: Invalid number of arguments, arg should be ['layout','data'] args are(0.0)
Could you please help me ?
Thank you in advance,
Shanika

Originally posted by Shanika on ROS Answers with karma: 66 on 2019-06-03
Post score: 2

A:

You have to allocate the arrays, when you're trying to access dim[] and data[] you haven't yet allocated it to have any size or inserted something into it.
E.i.
thing = MultiArrayDimension()
thing.label = "x"
thing.size = 1
thing.stride = 1
arg.layout.dim.append(thing)

Originally posted by stevemacenski with karma: 8272 on 2019-06-03
This answer was ACCEPTED on the original site
Post score: 1

Original comments
Comment by Shanika on 2019-06-04:
Thank you, I will try this right now
Comment by wydmynd on 2020-10-21:
I looked a long time for this information

