Q:

Getting node name namespace from rclcpp

Hi is there a way to get to a node namespace in some clean way before that node is constructed using make shared?
Processing argv doesn't seem like a good idea :/
Let's say
int main(int argc, char **argv) {
  rclcpp_init(argc, argv);
  // i want to get to the namespace and name here
  auto node = std::make_shared<MyCustomNode>();
  // currently this is the way I do this, but this is
  auto ns = node->get_namespace();
  auto name = node->get_name()
}

to get the namespace I could create some simple node, but that will collide with my desired one, when I want to get the name (I think?)

Originally posted by Serafadam on ROS Answers with karma: 170 on 2021-05-24
Post score: 2

A:

I did some digging, and while there might have been something I missed, I do not believe it is possible. The function that gets the namespace at the lower level is rcl_node_get_namespace() but that still takes in a node field. Looking into its implementation does indeed require that a node exists so there's not some simplifed code you could easily rip out to find it.
Source: https://github.com/ros2/rcl/blob/b6f0ef2df5454208bc5904191558e1b169dfbe18/rcl/src/rcl/node.c#L440-L447
The creation of this is called on the node rcl init functions, which then is called when a node is created. Digging in deeper leads to the RMW layer at which I stopped trying to track it. If you need to go that low level, you're not in for a good time.
Edit: Found where it remaps the namespace in rcl https://github.com/ros2/rcl/blob/b6f0ef2df5454208bc5904191558e1b169dfbe18/rcl/src/rcl/node.c#L228 but as you can see, it relies on the global_arguments, which I believe is the global namespace potential remaps (if you're trying to find the remapped name) but that requires a valid context to exist, which is created with the node.
tl;dr: No, you need a node object to exist so that there's at least a context in the process to gather that information.

Originally posted by stevemacenski with karma: 8272 on 2021-05-24
This answer was ACCEPTED on the original site
Post score: 3

