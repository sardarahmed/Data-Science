Q:

Quando é que se começou a usar «ch», «lh» e «nh» como em «chato», «filho» e «vinho»?

Creio que o ch deve ser anterior ao tempo dos afonsinhos, pois existe também noutras línguas para representar o mesmo som ou um som parecido. Mas o lh e o nh parecem só existir no português. O som que nós representamos por nh é representado por gn no francês e italiano, e por ñ no espanhol:

Espanhol, español, espagnol, spagnolo

E o que nós representamos por lh, é representado por ll no espanhol, e por gli no italiano:

Maravilha, maravilla, maraviglia.

O lh e o nh devem portanto ter sido invenções nossas, a menos que os outros as tenham também usado e depois abandonado, o que me parece menos provável. Quando apareceram então o lh e o nh?

A:

No artigo de Wikipédia da língua occitana, eles escrevem que esta ortografia entrou no idioma português pela influência de um bispo de Braga (1047 ᴀ.ᴅ.) que veio originalmente duma cidade francesa de fala occitana (em inglês, pois a versão em português não tem esse detalhe):

The Occitan classical orthography and the Catalan orthography are quite similar: They show the very close ties of both languages. The digraphs lh and nh, used in the classical orthography, were adopted by the orthography of Portuguese, presumably by Gerald of Braga, a monk from Moissac, who became bishop of Braga in Portugal in 1047, playing a major role in modernizing written Portuguese using classical Occitan norms.[55]

Jean-Pierre Juge (2001) Petit précis – Chronologie occitane – Histoire & civilisation, p. 25

